<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Generated from file '/Library/Caches/com.apple.xbs/Sources/tcl/tcl-129.100.1/tcl_ext/tcllib/tcllib/modules/fumagic/rtcore.man' by tcllib/doctools with format 'nroff'
  
   The definitions below are for supplemental macros used in Tcl/Tk
   manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO
  	Start of list of standard options for a Tk widget.  The
  	options follow on successive lines, in four columns separated
  	by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   RCS: @(#) $Id: man.macros,v 1.1 2009/01/30 04:56:47 andreas_kupries Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
  	# Start an argument description
  .b
  	# define tabbing values for .AP
  
  	# BS - start boxed text
  	# ^y = starting y location
  	# ^b = 1
  	# BE - end boxed text (draw box now)
  	Draw four-sided box normally, but don't draw top of
  	box if the box started on an earlier page.
  	# VS - start vertical sidebar
  	# ^Y = starting y location
  	# ^v = 1 (for troff;  for nroff this doesn't matter)
  	# VE - end of vertical sidebar
  	# Special macro to handle page bottom:  finish off current
  	# box/sidebar if in box/sidebar mode, then invoked standard
  	# page bottom macro.
  	Draw three-sided box if this is the box's first page,
  	draw two sides but no top otherwise.
  	# DS - begin display
  	# DE - end display
  	# SO - start of list of standard options
  	# SE - end of list of standard options
  	# OP - start of full description for a single option
  	# CS - begin code excerpt
  	# CE - end code excerpt
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>fileutil::magic::rt(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">fileutil::magic::rt(n)</td>
    <td class="head-vol">file utilities</td>
    <td class="head-rtitle">fileutil::magic::rt(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>

</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
fileutil::magic::rt - Runtime core for file type recognition engines written in
  pure Tcl
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
package require <b>Tcl 8.4</b>
<p class="Pp">package require <b>fileutil::magic::rt ?1.0?</b></p>
<p class="Pp"><b>::fileutil::magic::rt::open</b> <i>filename</i></p>
<p class="Pp"><b>::fileutil::magic::rt::close</b></p>
<p class="Pp"><b>::fileutil::magic::rt::file_start</b> <i>name</i></p>
<p class="Pp"><b>::fileutil::magic::rt::result</b> ?<i>msg</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::resultv</b> ?<i>msg</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::emit</b> <i>msg</i></p>
<p class="Pp"><b>::fileutil::magic::rt::offset</b> <i>where</i></p>
<p class="Pp"><b>::fileutil::magic::rt::Nv</b> <i>type</i> <i>offset</i>
    ?<i>qual</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::N</b> <i>type</i> <i>offset</i>
    <i>comp</i> <i>val</i> ?<i>qual</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::Nvx</b> <i>atlevel</i> <i>type</i>
    <i>offset</i> ?<i>qual</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::Nx</b> <i>atlevel</i> <i>type</i>
    <i>offset</i> <i>comp</i> <i>val</i> ?<i>qual</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::S</b> <i>offset</i> <i>comp</i>
    <i>val</i> ?<i>qual</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::Sx</b> <i>atlevel</i> <i>offset</i>
    <i>comp</i> <i>val</i> ?<i>qual</i>?</p>
<p class="Pp"><b>::fileutil::magic::rt::L</b> <i>newlevel</i></p>
<p class="Pp"><b>::fileutil::magic::rt::I</b> <i>base</i> <i>type</i>
    <i>delta</i></p>
<p class="Pp"><b>::fileutil::magic::rt::R</b> <i>offset</i></p>
<p class="Pp"></p>
<pre>

</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This package provides the runtime core for file type recognition engines written
  in pure Tcl and is thus used by all other packages in this module, i.e. the
  two frontend packages <b>fileutil::magic::mimetypes</b> and
  <b>fileutil::magic::filetypes</b>, and the two engine compiler packages
  <b>fileutil::magic::cgen</b> and <b>fileutil::magic::cfront</b>.
</section>
<section class="Sh">
<h1 class="Sh" id="COMMANDS"><a class="permalink" href="#COMMANDS">COMMANDS</a></h1>
<dl class="Bl-tag">
  <dt><b>::fileutil::magic::rt::open</b> <i>filename</i></dt>
  <dd>This command initializes the runtime and prepares the file <i>filename</i>
      for use by the system. This command has to be invoked first, before any
      other command of this package.
    <p class="Pp">The command returns the channel handle of the opened file as
        its result.</p>
  </dd>
  <dt><b>::fileutil::magic::rt::close</b></dt>
  <dd>This command closes the last file opened via
      <b>::fileutil::magic::rt::open</b> and shuts the runtime down. This
      command has to be invoked last, after the file has been dealt with
      completely. Afterward another invokation of
      <b>::fileutil::magic::rt::open</b> is required to process another file.
    <p class="Pp">This command returns the empty string as its result.</p>
  </dd>
  <dt><b>::fileutil::magic::rt::file_start</b> <i>name</i></dt>
  <dd>This command marks the start of a magic file when debugging. It returns
      the empty string as its result.</dd>
  <dt><b>::fileutil::magic::rt::result</b> ?<i>msg</i>?</dt>
  <dd>This command returns the current result and stops processing.
    <p class="Pp">If <i>msg</i> is specified its text is added to the result
        before it is returned. See <b>::fileutil::magic::rt::emit</b> for the
        allowed special character sequences.</p>
  </dd>
  <dt><b>::fileutil::magic::rt::resultv</b> ?<i>msg</i>?</dt>
  <dd>This command returns the current result. In contrast to
      <b>::fileutil::magic::rt::result</b> processing continues.
    <p class="Pp">If <i>msg</i> is specified its text is added to the result
        before it is returned. See <b>::fileutil::magic::rt::emit</b> for the
        allowed special character sequences.</p>
  </dd>
  <dt><b>::fileutil::magic::rt::emit</b> <i>msg</i></dt>
  <dd>This command adds the text <i>msg</i> to the result buffer. The message
      may contain the following special character sequences. They will be
      replaced with buffered values before the message is added to the result.
      The command returns the empty string as its result.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>\b</b></dt>
  <dd>This sequence is removed</dd>
  <dt><b>%s</b></dt>
  <dd>Replaced with the last buffered string value.</dd>
  <dt><b>%ld</b></dt>
  <dd>Replaced with the last buffered numeric value.</dd>
  <dt><b>%d</b></dt>
  <dd>See above.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt><b>::fileutil::magic::rt::Nv</b> <i>type</i> <i>offset</i>
    ?<i>qual</i>?</dt>
  <dd>This command fetches the numeric value with <i>type</i> from the absolute
      location <i>offset</i> and returns it as its result. The fetched value is
      further stored in the numeric buffer.
    <p class="Pp">If <i>qual</i> is specified it is considered to be a mask and
        applied to the fetched value before it is stored and returned. It has to
        have the form of a partial Tcl bit-wise expression, i.e.</p>
    <pre>
	&amp; number
    </pre>
    For example:
    <pre>
	Nv lelong 0 &amp;0x8080ffff
    </pre>
    For the possible types see section <b>NUMERIC TYPES</b>.</dd>
  <dt><b>::fileutil::magic::rt::N</b> <i>type</i> <i>offset</i> <i>comp</i>
    <i>val</i> ?<i>qual</i>?</dt>
  <dd>This command behaves mostly like <b>::fileutil::magic::rt::Nv</b>, except
      that it compares the fetched and masked value against <i>val</i> as
      specified with <i>comp</i> and returns the result of that comparison.
    <p class="Pp">The argument <i>comp</i> has to contain one of Tcl's
        comparison operators, and the comparison made will be</p>
    <pre>
	&lt;val&gt; &lt;comp&gt; &lt;fetched-and-masked-value&gt;
    </pre>
    <p class="Pp">The special comparison operator <b>x</b> signals that no
        comparison should be done, or, in other words, that the fetched value
        will always match <i>val</i>.</p>
  </dd>
  <dt><b>::fileutil::magic::rt::Nvx</b> <i>atlevel</i> <i>type</i> <i>offset</i>
    ?<i>qual</i>?</dt>
  <dd>This command behaves like <b>::fileutil::magic::rt::Nv</b>, except that it
      additionally remembers the location in the file after the fetch in the
      calling context, for the level <i>atlevel</i>, for later use by
      <b>::fileutil::magic::rt::R</b>.</dd>
  <dt><b>::fileutil::magic::rt::Nx</b> <i>atlevel</i> <i>type</i> <i>offset</i>
    <i>comp</i> <i>val</i> ?<i>qual</i>?</dt>
  <dd>This command behaves like <b>::fileutil::magic::rt::N</b>, except that it
      additionally remembers the location in the file after the fetch in the
      calling context, for the level <i>atlevel</i>, for later use by
      <b>::fileutil::magic::rt::R</b>.</dd>
  <dt><b>::fileutil::magic::rt::S</b> <i>offset</i> <i>comp</i> <i>val</i>
    ?<i>qual</i>?</dt>
  <dd>This command behaves like <b>::fileutil::magic::rt::N</b>, except that it
      fetches and compares strings, not numeric data. The fetched value is also
      stored in the internal string buffer instead of the numeric buffer.</dd>
  <dt><b>::fileutil::magic::rt::Sx</b> <i>atlevel</i> <i>offset</i> <i>comp</i>
    <i>val</i> ?<i>qual</i>?</dt>
  <dd>This command behaves like <b>::fileutil::magic::rt::S</b>, except that it
      additionally remembers the location in the file after the fetch in the
      calling context, for the level <i>atlevel</i>, for later use by
      <b>::fileutil::magic::rt::R</b>.</dd>
  <dt><b>::fileutil::magic::rt::L</b> <i>newlevel</i></dt>
  <dd>This command sets the current level in the calling context to
      <i>newlevel</i>. The command returns the empty string as its result.</dd>
  <dt><b>::fileutil::magic::rt::I</b> <i>base</i> <i>type</i> <i>delta</i></dt>
  <dd>This command handles base locations specified indirectly through the
      contents of the inspected file. It returns the sum of <i>delta</i> and the
      value of numeric <i>type</i> fetched from the absolute location
      <i>base</i>.
    <p class="Pp">For the possible types see section <b>NUMERIC TYPES</b>.</p>
  </dd>
  <dt><b>::fileutil::magic::rt::R</b> <i>offset</i></dt>
  <dd>This command handles base locations specified relative to the end of the
      last field one level above.
    <p class="Pp">In other words, the command computes an absolute location in
        the file based on the relative <i>offset</i> and returns it as its
        result. The base the offset is added to is the last location remembered
        for the level in the calling context.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="NUMERIC_TYPES"><a class="permalink" href="#NUMERIC_TYPES">NUMERIC
  TYPES</a></h1>
<dl class="Bl-tag">
  <dt><b>byte</b></dt>
  <dd>8-bit integer</dd>
  <dt><b>short</b></dt>
  <dd>16-bit integer, stored in native endianess</dd>
  <dt><b>beshort</b></dt>
  <dd>see above, stored in big endian</dd>
  <dt><b>leshort</b></dt>
  <dd>see above, stored in small/little endian</dd>
  <dt><b>long</b></dt>
  <dd>32-bit integer, stored in native endianess</dd>
  <dt><b>belong</b></dt>
  <dd>see above, stored in big endian</dd>
  <dt><b>lelong</b></dt>
  <dd>see above, stored in small/little endian</dd>
</dl>
<p class="Pp">All of the types above exit in an unsigned form as well. The type
    names are the same, with the character &quot;u&quot; added as prefix.</p>
<dl class="Bl-tag">
  <dt><b>date</b></dt>
  <dd>32-bit integer timestamp, stored in native endianess</dd>
  <dt><b>bedate</b></dt>
  <dd>see above, stored in big endian</dd>
  <dt><b>ledate</b></dt>
  <dd>see above, stored in small/little endian</dd>
  <dt><b>ldate</b></dt>
  <dd>32-bit integer timestamp, stored in native endianess</dd>
  <dt><b>beldate</b></dt>
  <dd>see above, stored in big endian</dd>
  <dt><b>leldate</b></dt>
  <dd>see above, stored in small/little endian</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS,_IDEAS,_FEEDBACK"><a class="permalink" href="#BUGS,_IDEAS,_FEEDBACK">BUGS,
  IDEAS, FEEDBACK</a></h1>
This document, and the package it describes, will undoubtedly contain bugs and
  other problems. Please report such in the category <i>fileutil :: magic</i> of
  the <i>Tcllib SF Trackers</i>
  [http://sourceforge.net/tracker/?group_id=12883]. Please also report any ideas
  for enhancements you may have for either package and/or documentation.
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
file(1), fileutil, magic(5)
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
file recognition, file type, file utilities, mime, type
</section>
<section class="Sh">
<h1 class="Sh" id="CATEGORY"><a class="permalink" href="#CATEGORY">CATEGORY</a></h1>
Programming tools
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1.0</td>
    <td class="foot-os">fumagic</td>
  </tr>
</table>
</body>
</html>
