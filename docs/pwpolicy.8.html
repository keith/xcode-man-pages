<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
  	$Id: pwpolicy.8,v 1.7 2006/05/02 23:06:14 snsimon Exp $
  
   Copyright (c) 2002-2014 Apple Inc., all rights reserved.
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>pwpolicy(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">pwpolicy(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">pwpolicy(8)</td>
  </tr>
</table>
<div class="manual-text">
<p class="Pp"></p>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">pwpolicy</code> &#x2014; <span class="Nd">gets
    and sets password policies</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">pwpolicy</code></td>
    <td>[<code class="Fl">-h</code>]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">pwpolicy</code></td>
    <td>[<code class="Fl">-v</code>] [<code class="Fl">-a</code>
      <var class="Ar">authenticator</var>] [<code class="Fl">-p</code>
      <var class="Ar">password</var>] [<code class="Fl">-u</code>
      <var class="Ar">username</var> | <code class="Fl">-c</code>
      <var class="Ar">computername</var>] [<code class="Fl">-n</code>
      <var class="Ar">nodename</var>] command command-arg</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">pwpolicy</code></td>
    <td>[<code class="Fl">-v</code>] [<code class="Fl">-a</code>
      <var class="Ar">authenticator</var>] [<code class="Fl">-p</code>
      <var class="Ar">password</var>] [<code class="Fl">-u</code>
      <var class="Ar">username</var> | <code class="Fl">-c</code>
      <var class="Ar">computername</var>] [<code class="Fl">-n</code>
      <var class="Ar">nodename</var>] command &quot;policy1=value1
      policy2=value2 ...&quot;
    <p class="Pp"></p>
    </td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><code class="Nm">pwpolicy</code> manipulates password
  policies.</p>
<section class="Ss">
<h2 class="Ss" id="Options"><a class="permalink" href="#Options">Options</a></h2>
<dl class="Bl-tag">
  <dt id="a"><a class="permalink" href="#a"><code class="Fl">-a</code></a></dt>
  <dd>name of the authenticator</dd>
  <dt id="c"><a class="permalink" href="#c"><code class="Fl">-c</code></a></dt>
  <dd>name of the computer account to modify</dd>
  <dt id="p"><a class="permalink" href="#p"><code class="Fl">-p</code></a></dt>
  <dd>password (omit this option for a secure prompt)</dd>
  <dt id="u"><a class="permalink" href="#u"><code class="Fl">-u</code></a></dt>
  <dd>name of the user account to modify</dd>
  <dt id="n"><a class="permalink" href="#n"><code class="Fl">-n</code></a></dt>
  <dd>use a specific directory node; the search node is used by default.</dd>
  <dt id="v"><a class="permalink" href="#v"><code class="Fl">-v</code></a></dt>
  <dd>verbose</dd>
  <dt id="h"><a class="permalink" href="#h"><code class="Fl">-h</code></a></dt>
  <dd>help</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Commands"><a class="permalink" href="#Commands">Commands</a></h2>
<dl class="Bl-tag Bl-compact">
  <dt id="getglobalpolicy"><a class="permalink" href="#getglobalpolicy"><code class="Fl">-getglobalpolicy</code></a></dt>
  <dd>Get global policies. DEPRECATED.</dd>
  <dt id="setglobalpolicy"><a class="permalink" href="#setglobalpolicy"><code class="Fl">-setglobalpolicy</code></a></dt>
  <dd>Set global policies. DEPRECATED.</dd>
  <dt id="getpolicy"><a class="permalink" href="#getpolicy"><code class="Fl">-getpolicy</code></a></dt>
  <dd>Get policies for a user. DEPRECATED.</dd>
  <dt id="get-effective-policy"><a class="permalink" href="#get-effective-policy"><code class="Fl">--get-effective-policy</code></a></dt>
  <dd>Gets the combination of global and user policies that apply to the user.
      DEPRECATED.</dd>
  <dt id="setpolicy"><a class="permalink" href="#setpolicy"><code class="Fl">-setpolicy</code></a></dt>
  <dd>Set policies for a user. DEPRECATED.</dd>
  <dt id="setpassword"><a class="permalink" href="#setpassword"><code class="Fl">-setpassword</code></a></dt>
  <dd>Set a new password for a user. Non-administrators can use this command to
      change their own passwords.</dd>
  <dt id="enableuser"><a class="permalink" href="#enableuser"><code class="Fl">-enableuser</code></a></dt>
  <dd>Enable a user account that was disabled by a password policy event.</dd>
  <dt id="disableuser"><a class="permalink" href="#disableuser"><code class="Fl">-disableuser</code></a></dt>
  <dd>Disable a user account.</dd>
  <dt id="getglobalhashtypes"><a class="permalink" href="#getglobalhashtypes"><code class="Fl">-getglobalhashtypes</code></a></dt>
  <dd>Returns the default list of password hashes stored on disk for this
      system.</dd>
  <dt id="setglobalhashtypes"><a class="permalink" href="#setglobalhashtypes"><code class="Fl">-setglobalhashtypes</code></a></dt>
  <dd>Edits the default list of password hashes stored on disk for this
    system.</dd>
  <dt id="gethashtypes"><a class="permalink" href="#gethashtypes"><code class="Fl">-gethashtypes</code></a></dt>
  <dd>Returns a list of password hashes stored on disk for a user account.</dd>
  <dt id="sethashtypes"><a class="permalink" href="#sethashtypes"><code class="Fl">-sethashtypes</code></a></dt>
  <dd>Edits the list of password hashes stored on disk for a user account.</dd>
  <dt id="setaccountpolicies"><a class="permalink" href="#setaccountpolicies"><code class="Fl">-setaccountpolicies</code></a></dt>
  <dd>Sets (replaces) the account polices for the specified user. If no user is
      specified, sets the global account policies. Takes one argument: the name
      of the file containing the policies.</dd>
  <dt id="getaccountpolicies"><a class="permalink" href="#getaccountpolicies"><code class="Fl">-getaccountpolicies</code></a></dt>
  <dd>Gets the account policies for the specified user. If no user is specified,
      gets the global account policies.</dd>
  <dt id="clearaccountpolicies"><a class="permalink" href="#clearaccountpolicies"><code class="Fl">-clearaccountpolicies</code></a></dt>
  <dd>Removes all of the account policies for the specified user. If no user is
      specified, removes the global account policies.</dd>
  <dt id="authentication-allowed"><a class="permalink" href="#authentication-allowed"><code class="Fl">-authentication-allowed</code></a></dt>
  <dd>Determines if the policies allow the user to authenticate</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Account_Policies"><a class="permalink" href="#Account_Policies">Account
  Policies</a></h2>
<p class="Pp">Account policies are the replacement for the deprecated legacy
    global and user policies. Account policies are specified as a dictionary
    containing three keys, one key for each policy category. Note that the
    dictionary is not required to contain all of the policy categories. Valid
    keys for the policy categories are:</p>
<p class="Pp"></p>
<dl class="Bl-tag Bl-compact">
  <dt>policyCategoryAuthentication</dt>
  <dd>Controls when a user may login/authenticate.</dd>
  <dt>policyCategoryPasswordChange</dt>
  <dd>Determines if/when a user is required to change their password</dd>
  <dt>policyCategoryPasswordContent</dt>
  <dd>Controls the set of allowable characters in a password.</dd>
</dl>
<p class="Pp">Each policy category contains an array of individual policy
    dictionaries. Valid keys in the policy dictionary are:</p>
<dl class="Bl-tag">
  <dt>policyIdentifier</dt>
  <dd>A user-defined unique identifier for the policy.</dd>
  <dt>policyParameters</dt>
  <dd>An optional key that contains a dictionary of parameters to be used in the
      policy or used for display purposes.</dd>
  <dt>policyContent</dt>
  <dd>The actual policy string, from which an NSPredicate can be created. Any
      valid NSPredicate keyword may be used, as well as certain parameters from
      the user's record and the policy's parameters dictionary.</dd>
</dl>
<p class="Pp">Below is an example account policy dictionary. Not all policy
    categories need be present in the dictionary.</p>
<div class="Bd Li">
<pre>&lt;dict&gt;
    &lt;key&gt;policyCategoryPasswordAuthentication&lt;/key&gt;
    &lt;array&gt;
        &lt;dict&gt;
            &lt;key&gt;policyContent&lt;/key&gt;
            &lt;string&gt;policyAttributeMaximumFailedAuthentications &amp;lt; policyAttributeFailedAuthentications&lt;/string&gt;
            &lt;key&gt;policyIdentifier&lt;/key&gt;
            &lt;string&gt;failed auths&lt;/string&gt;
        &lt;/dict&gt;
    &lt;/array&gt;
    &lt;key&gt;policyCategoryPasswordChange&lt;/key&gt;
    &lt;array&gt;
        &lt;dict&gt;
            &lt;key&gt;policyContent&lt;/key&gt;
            &lt;string&gt;policyAttributeCurrentTime &amp;gt; policyAttributeLastPasswordChangeTime + policyAttributeExpiresEveryNDays * DAYS_TO_SECONDS&lt;/string&gt;
            &lt;key&gt;policyIdentifier&lt;/key&gt;
            &lt;string&gt;Change every 30 days&lt;/string&gt;
            &lt;key&gt;policyParameters&lt;/key&gt;
                &lt;dict&gt;
                &lt;key&gt;policyAttributeExpiresEveryNDays&lt;key&gt;
                &lt;integer&gt;30&lt;/integer&gt;
       &lt;/dict&gt;
    &lt;/array&gt;
    &lt;key&gt;policyCategoryPasswordContent&lt;/key&gt;
    &lt;array&gt;
        &lt;dict&gt;
            &lt;key&gt;policyContent&lt;/key&gt;
            &lt;string&gt;policyAttributePassword matches '.{3,}+'&lt;/string&gt;
            &lt;key&gt;policyIdentifier&lt;/key&gt;
            &lt;string&gt;com.apple.policy.legacy.minChars&lt;/string&gt;
            &lt;key&gt;policyParameters&lt;/key&gt;
            &lt;dict&gt;
                &lt;key&gt;minimumLength&lt;/key&gt;
                &lt;integer&gt;3&lt;/integer&gt;
            &lt;/dict&gt;
        &lt;/dict&gt;
    &lt;/array&gt;
&lt;/dict&gt;</pre>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Account_Policy_Keywords"><a class="permalink" href="#Account_Policy_Keywords">Account
  Policy Keywords</a></h2>
<p class="Pp">The following keywords may be used in the policy content. The
    values from the user's record will be substitued for the keyword when the
    policy is evaluated. User-defined keywords may also be used, as long the
    keyword is present in the policy's parameters dictionary.</p>
<p class="Pp"></p>
<dl class="Bl-tag Bl-compact">
  <dt>policyAttributePassword</dt>
  <dd>User's new password.</dd>
  <dt>policyAttributePasswordHashes</dt>
  <dd>Hashes of the new password. Compared against the history.</dd>
  <dt>policyAttributePasswordHistory</dt>
  <dd>User's password history.</dd>
  <dt>policyAttributePasswordHistoryDepth</dt>
  <dd>How much password history to keep.</dd>
  <dt>policyAttributeCurrentDate</dt>
  <dd>Current date and time as an NSDate. Use for comparing localized
    NSDates.</dd>
  <dt>policyAttributeCurrentTime</dt>
  <dd>Current date and time in seconds. Used for date/time calculations, i.e.
      date + interval.</dd>
  <dt>policyAttributeCurrentDayOfWeek</dt>
  <dd>Current day of the week (integer).</dd>
  <dt>policyAttributeCurrentTimeOfDay</dt>
  <dd>Current time of day (0000 to 2359).</dd>
  <dt>policyAttributeFailedAuthentications</dt>
  <dd>Number of consecutive failed authentication attempts.</dd>
  <dt>policyAttributeMaximumFailedAuthentications</dt>
  <dd>Maximum allowed consecutive failed authentication attempts.</dd>
  <dt>policyAttributeLastFailedAuthenticationTime</dt>
  <dd>Time of the last failed authentication.</dd>
  <dt>policyAttributeLastAuthenticationTime</dt>
  <dd>Time of the last successful authentication.</dd>
  <dt>policyAttributeLastPasswordChangeTime</dt>
  <dd>Time of the last password change.</dd>
  <dt>policyAttributeNewPasswordRequiredTime</dt>
  <dd>Time when a new password is required.</dd>
  <dt>policyAttributeCreationTime</dt>
  <dd>Time when the account was created.</dd>
  <dt>policyAttributeConsecutiveCharacters</dt>
  <dd>Number of consecutive (i.e. run of the same) characters in a
    password.</dd>
  <dt>policyAttributeMaximumConsecutiveCharacters</dt>
  <dd>Maximum number of consectuive characters allowed in a password.</dd>
  <dt>policyAttributeSequentialCharacters</dt>
  <dd>Number of sequention (ascending or descending) characters in a
    password.</dd>
  <dt>policyAttributeMaximumSequentialCharacters</dt>
  <dd>Maximum allowed nmber of sequention (ascending or descending) characters
      in a password.</dd>
  <dt>policyAttributeExpiresEveryNDays</dt>
  <dd>Expires every n number of days.</dd>
  <dt>policyAttributeDaysUntilExpiration</dt>
  <dd>Synonym for the above.</dd>
  <dt>policyAttributeEnableOnDate</dt>
  <dd>Date on which the account is enabled (localized NSDate).</dd>
  <dt>policyAttributeExpiresOnDate</dt>
  <dd>Date on which the account will expire (localized NSdate).</dd>
  <dt>policyAttributeEnableOnDayOfWeek</dt>
  <dd>Day of week on which the account is enabled (integer).</dd>
  <dt>policyAttributeExpiresOnDayOfWeek</dt>
  <dd>Day of week on which the account will expire (integer).</dd>
  <dt>policyAttributeEnableAtTimeOfDay</dt>
  <dd>Time of day at which the account is enabled (integer, 0000-2359).</dd>
  <dt>policyAttributeExpiresAtTimeOfDay</dt>
  <dd>Time of day at which the account will expire (integer, 0000-2359).</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Legacy_Global_Policies_(DEPRECATED)"><a class="permalink" href="#Legacy_Global_Policies_(DEPRECATED)">Legacy
  Global Policies (DEPRECATED)</a></h2>
<dl class="Bl-tag Bl-compact">
  <dt id="usingHistory"><a class="permalink" href="#usingHistory"><code class="Ev">usingHistory</code></a></dt>
  <dd>0 = user can reuse the current password, 1 = user cannot reuse the current
      password, 2-15 = user cannot reuse the last n passwords.</dd>
  <dt id="usingExpirationDate"><a class="permalink" href="#usingExpirationDate"><code class="Ev">usingExpirationDate</code></a></dt>
  <dd>If 1, user is required to change password on the date in
    expirationDateGMT</dd>
  <dt id="usingHardExpirationDate"><a class="permalink" href="#usingHardExpirationDate"><code class="Ev">usingHardExpirationDate</code></a></dt>
  <dd>If 1, user's account is disabled on the date in hardExpireDateGMT</dd>
  <dt id="requiresAlpha"><a class="permalink" href="#requiresAlpha"><code class="Ev">requiresAlpha</code></a></dt>
  <dd>If 1, user's password is required to have a character in [A-Z][a-z].</dd>
  <dt id="requiresNumeric"><a class="permalink" href="#requiresNumeric"><code class="Ev">requiresNumeric</code></a></dt>
  <dd>If 1, user's password is required to have a character in [0-9].</dd>
  <dt id="expirationDateGMT"><a class="permalink" href="#expirationDateGMT"><code class="Ev">expirationDateGMT</code></a></dt>
  <dd>Date for the password to expire, format must be: mm/dd/yy</dd>
  <dt id="hardExpireDateGMT"><a class="permalink" href="#hardExpireDateGMT"><code class="Ev">hardExpireDateGMT</code></a></dt>
  <dd>Date for the user's account to be disabled, format must be: mm/dd/yy</dd>
  <dt id="validAfter"><a class="permalink" href="#validAfter"><code class="Ev">validAfter</code></a></dt>
  <dd>Date for the user's account to be enabled, format must be: mm/dd/yy</dd>
  <dt id="maxMinutesUntilChangePassword"><a class="permalink" href="#maxMinutesUntilChangePassword"><code class="Ev">maxMinutesUntilChangePassword</code></a></dt>
  <dd>user is required to change the password at this interval</dd>
  <dt id="maxMinutesUntilDisabled"><a class="permalink" href="#maxMinutesUntilDisabled"><code class="Ev">maxMinutesUntilDisabled</code></a></dt>
  <dd>user's account is disabled after this interval</dd>
  <dt id="maxMinutesOfNonUse"><a class="permalink" href="#maxMinutesOfNonUse"><code class="Ev">maxMinutesOfNonUse</code></a></dt>
  <dd>user's account is disabled if it is not accessed by this interval</dd>
  <dt id="maxFailedLoginAttempts"><a class="permalink" href="#maxFailedLoginAttempts"><code class="Ev">maxFailedLoginAttempts</code></a></dt>
  <dd>user's account is disabled if the failed login count exceeds this
    number</dd>
  <dt id="minChars"><a class="permalink" href="#minChars"><code class="Ev">minChars</code></a></dt>
  <dd>passwords must contain at least minChars</dd>
  <dt id="maxChars"><a class="permalink" href="#maxChars"><code class="Ev">maxChars</code></a></dt>
  <dd>passwords are limited to maxChars</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Additional_Legacy_User_Policies_(DEPRECATED)"><a class="permalink" href="#Additional_Legacy_User_Policies_(DEPRECATED)">Additional
  Legacy User Policies (DEPRECATED)</a></h2>
<dl class="Bl-tag Bl-compact">
  <dt id="isDisabled"><a class="permalink" href="#isDisabled"><code class="Ev">isDisabled</code></a></dt>
  <dd>If 1, user account is not allowed to authenticate, ever.</dd>
  <dt id="isAdminUser"><a class="permalink" href="#isAdminUser"><code class="Ev">isAdminUser</code></a></dt>
  <dd>If 1, this user can administer accounts on the password server.</dd>
  <dt id="newPasswordRequired"><a class="permalink" href="#newPasswordRequired"><code class="Ev">newPasswordRequired</code></a></dt>
  <dd>If 1, the user will be prompted for a new password at the next
      authentication. Applications that do not support change password will not
      authenticate.</dd>
  <dt id="canModifyPasswordforSelf"><a class="permalink" href="#canModifyPasswordforSelf"><code class="Ev">canModifyPasswordforSelf</code></a></dt>
  <dd>If 1, the user can change the password.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Stored_Hash_Types"><a class="permalink" href="#Stored_Hash_Types">Stored
  Hash Types</a></h2>
<dl class="Bl-tag Bl-compact">
  <dt id="CRAM-MD5"><a class="permalink" href="#CRAM-MD5"><code class="Ev">CRAM-MD5</code></a></dt>
  <dd>Required for IMAP.</dd>
  <dt id="RECOVERABLE"><a class="permalink" href="#RECOVERABLE"><code class="Ev">RECOVERABLE</code></a></dt>
  <dd>Required for APOP and WebDAV. Only available on Mac OS X Server
    edition.</dd>
  <dt id="SALTED-SHA512-PBKDF2"><a class="permalink" href="#SALTED-SHA512-PBKDF2"><code class="Ev">SALTED-SHA512-PBKDF2</code></a></dt>
  <dd>The default for loginwindow.</dd>
  <dt id="SALTED-SHA512"><a class="permalink" href="#SALTED-SHA512"><code class="Ev">SALTED-SHA512</code></a></dt>
  <dd>Legacy hash for loginwindow.</dd>
  <dt id="SMB-NT"><a class="permalink" href="#SMB-NT"><code class="Ev">SMB-NT</code></a></dt>
  <dd>Required for compatibility with Windows NT/XP file sharing.</dd>
  <dt id="SALTED-SHA1"><a class="permalink" href="#SALTED-SHA1"><code class="Ev">SALTED-SHA1</code></a></dt>
  <dd>Legacy hash for loginwindow.</dd>
  <dt id="SHA1"><a class="permalink" href="#SHA1"><code class="Ev">SHA1</code></a></dt>
  <dd>Legacy hash for loginwindow.</dd>
</dl>
<p class="Pp"></p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">To get global policies:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li><code class="Nm">pwpolicy</code> -getglobalpolicy</li>
</ul>
<p class="Pp">To set global policies:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li><code class="Nm">pwpolicy</code> -a authenticator -setglobalpolicy
      &quot;minChars=4 maxFailedLoginAttempts=3&quot;</li>
</ul>
<p class="Pp">To get policies for a specific user account:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li><code class="Nm">pwpolicy</code> -u user -getpolicy</li>
  <li><code class="Nm">pwpolicy</code> -u user -n /NetInfo/DefaultLocalNode
      -getpolicy</li>
</ul>
<p class="Pp">To set policies for a specific user account:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li><code class="Nm">pwpolicy</code> -a authenticator -u user -setpolicy
      &quot;minChars=4 maxFailedLoginAttempts=3&quot;</li>
</ul>
<p class="Pp">To change the password for a user:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li><code class="Nm">pwpolicy</code> -a authenticator -u user -setpassword
      newpassword</li>
</ul>
<p class="Pp">To set the list of hash types for local accounts:</p>
<p class="Pp"></p>
<ul class="Bl-item Bd-indent Bl-compact">
  <li><code class="Nm">pwpolicy</code> -a authenticator -setglobalhashtypes
      SMB-LAN-MANAGER off SMB-NT on</li>
</ul>
<p class="Pp"></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">PasswordService(8)</a></p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">13 November 2002</td>
    <td class="foot-os">Mac OS X</td>
  </tr>
</table>
</body>
</html>
