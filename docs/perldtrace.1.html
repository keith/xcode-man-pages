<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>PERLDTRACE(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PERLDTRACE(1)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">PERLDTRACE(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
perldtrace - Perl's support for DTrace
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    # dtrace -Zn 'perl::sub-entry, perl::sub-return { trace(copyinstr(arg0)) }'
    dtrace: description 'perl::sub-entry, perl::sub-return ' matched 10 probes

    # perl -E 'sub outer { inner(@_) } sub inner { say shift } outer(&quot;hello&quot;)'
    hello

    (dtrace output)
    CPU     ID                    FUNCTION:NAME
      0  75915       Perl_pp_entersub:sub-entry   BEGIN
      0  75915       Perl_pp_entersub:sub-entry   import
      0  75922      Perl_pp_leavesub:sub-return   import
      0  75922      Perl_pp_leavesub:sub-return   BEGIN
      0  75915       Perl_pp_entersub:sub-entry   outer
      0  75915       Perl_pp_entersub:sub-entry   inner
      0  75922      Perl_pp_leavesub:sub-return   inner
      0  75922      Perl_pp_leavesub:sub-return   outer
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
DTrace is a framework for comprehensive system- and application-level tracing.
  Perl is a DTrace <i>provider</i>, meaning it exposes several <i>probes</i> for
  instrumentation. You can use these in conjunction with kernel-level probes, as
  well as probes from other providers such as MySQL, in order to diagnose
  software defects, or even just your application's bottlenecks.
<p class="Pp">Perl must be compiled with the
    <span class="Li">&quot;-Dusedtrace&quot;</span> option in order to make use
    of the provided probes. While DTrace aims to have no overhead when its
    instrumentation is not active, Perl's support itself cannot uphold that
    guarantee, so it is built without DTrace probes under most systems. One
    notable exception is that Mac OS X ships a <i>/usr/bin/perl</i> with DTrace
    support enabled.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
<dl class="Bl-tag">
  <dt>5.10.1</dt>
  <dd>Perl's initial DTrace support was added, providing
      <span class="Li">&quot;sub-entry&quot;</span> and
      <span class="Li">&quot;sub-return&quot;</span> probes.</dd>
  <dt>5.14.0</dt>
  <dd>The <span class="Li">&quot;sub-entry&quot;</span> and
      <span class="Li">&quot;sub-return&quot;</span> probes gain a fourth
      argument: the package name of the function.</dd>
  <dt>5.16.0</dt>
  <dd>The <span class="Li">&quot;phase-change&quot;</span> probe was added.</dd>
  <dt>5.18.0</dt>
  <dd>The <span class="Li">&quot;op-entry&quot;</span>,
      <span class="Li">&quot;loading-file&quot;</span>, and
      <span class="Li">&quot;loaded-file&quot;</span> probes were added.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="PROBES"><a class="permalink" href="#PROBES">PROBES</a></h1>
<dl class="Bl-tag">
  <dt>sub-entry(SUBNAME, FILE, LINE, PACKAGE)</dt>
  <dd>Traces the entry of any subroutine. Note that all of the variables refer
      to the subroutine that is being invoked; there is currently no way to get
      ahold of any information about the subroutine's <i>caller</i> from a
      DTrace action.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    :*perl*::sub-entry {
        printf(&quot;%s::%s entered at %s line %d\n&quot;,
               copyinstr(arg3), copyinstr(arg0), copyinstr(arg1), arg2);
    }
    </pre>
  </dd>
  <dt>sub-return(SUBNAME, FILE, LINE, PACKAGE)</dt>
  <dd>Traces the exit of any subroutine. Note that all of the variables refer to
      the subroutine that is returning; there is currently no way to get ahold
      of any information about the subroutine's <i>caller</i> from a DTrace
      action.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    :*perl*::sub-return {
        printf(&quot;%s::%s returned at %s line %d\n&quot;,
               copyinstr(arg3), copyinstr(arg0), copyinstr(arg1), arg2);
    }
    </pre>
  </dd>
  <dt>phase-change(NEWPHASE, OLDPHASE)</dt>
  <dd>Traces changes to Perl's interpreter state. You can internalize this as
      tracing changes to Perl's
      <span class="Li">&quot;${^GLOBAL_PHASE}&quot;</span> variable, especially
      since the values for <span class="Li">&quot;NEWPHASE&quot;</span> and
      <span class="Li">&quot;OLDPHASE&quot;</span> are the strings that
      <span class="Li">&quot;${^GLOBAL_PHASE}&quot;</span> reports.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    :*perl*::phase-change {
        printf(&quot;Phase changed from %s to %s\n&quot;,
            copyinstr(arg1), copyinstr(arg0));
    }
    </pre>
  </dd>
  <dt>op-entry(OPNAME)</dt>
  <dd>Traces the execution of each opcode in the Perl runloop. This probe is
      fired before the opcode is executed. When the Perl debugger is enabled,
      the DTrace probe is fired <i>after</i> the debugger hooks (but still
      before the opcode itself is executed).
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    :*perl*::op-entry {
        printf(&quot;About to execute opcode %s\n&quot;, copyinstr(arg0));
    }
    </pre>
  </dd>
  <dt>loading-file(FILENAME)</dt>
  <dd>Fires when Perl is about to load an individual file, whether from
      <span class="Li">&quot;use&quot;</span>,
      <span class="Li">&quot;require&quot;</span>, or
      <span class="Li">&quot;do&quot;</span>. This probe fires before the file
      is read from disk. The filename argument is converted to local filesystem
      paths instead of providing
      <span class="Li">&quot;Module::Name&quot;</span>-style names.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    :*perl*:loading-file {
        printf(&quot;About to load %s\n&quot;, copyinstr(arg0));
    }
    </pre>
  </dd>
  <dt>loaded-file(FILENAME)</dt>
  <dd>Fires when Perl has successfully loaded an individual file, whether from
      <span class="Li">&quot;use&quot;</span>,
      <span class="Li">&quot;require&quot;</span>, or
      <span class="Li">&quot;do&quot;</span>. This probe fires after the file is
      read from disk and its contentss evaluated. The filename argument is
      converted to local filesystem paths instead of providing
      <span class="Li">&quot;Module::Name&quot;</span>-style names.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
    :*perl*:loaded-file {
        printf(&quot;Successfully loaded %s\n&quot;, copyinstr(arg0));
    }
    </pre>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<dl class="Bl-tag">
  <dt>Most frequently called functions</dt>
  <dd><span class="Li"></span>
    <pre>
    # dtrace -qZn 'sub-entry { @[strjoin(strjoin(copyinstr(arg3),&quot;::&quot;),copyinstr(arg0))] = count() } END {trunc(@, 10)}'

    Class::MOP::Attribute::slots                                    400
    Try::Tiny::catch                                                411
    Try::Tiny::try                                                  411
    Class::MOP::Instance::inline_slot_access                        451
    Class::MOP::Class::Immutable::Trait:::around                    472
    Class::MOP::Mixin::AttributeCore::has_initializer               496
    Class::MOP::Method::Wrapped::__ANON__                           544
    Class::MOP::Package::_package_stash                             737
    Class::MOP::Class::initialize                                  1128
    Class::MOP::get_metaclass_by_name                              1204
    </pre>
  </dd>
  <dt>Trace function calls</dt>
  <dd><span class="Li"></span>
    <pre>
    # dtrace -qFZn 'sub-entry, sub-return { trace(copyinstr(arg0)) }'

    0  -&gt; Perl_pp_entersub                        BEGIN
    0  &lt;- Perl_pp_leavesub                        BEGIN
    0  -&gt; Perl_pp_entersub                        BEGIN
    0    -&gt; Perl_pp_entersub                      import
    0    &lt;- Perl_pp_leavesub                      import
    0  &lt;- Perl_pp_leavesub                        BEGIN
    0  -&gt; Perl_pp_entersub                        BEGIN
    0    -&gt; Perl_pp_entersub                      dress
    0    &lt;- Perl_pp_leavesub                      dress
    0    -&gt; Perl_pp_entersub                      dirty
    0    &lt;- Perl_pp_leavesub                      dirty
    0    -&gt; Perl_pp_entersub                      whiten
    0    &lt;- Perl_pp_leavesub                      whiten
    0  &lt;- Perl_dounwind                           BEGIN
    </pre>
  </dd>
  <dt>Function calls during interpreter cleanup</dt>
  <dd><span class="Li"></span>
    <pre>
    # dtrace -Zn 'phase-change /copyinstr(arg0) == &quot;END&quot;/ { self-&gt;ending = 1 } sub-entry /self-&gt;ending/ { trace(copyinstr(arg0)) }'

    CPU     ID                    FUNCTION:NAME
      1  77214       Perl_pp_entersub:sub-entry   END
      1  77214       Perl_pp_entersub:sub-entry   END
      1  77214       Perl_pp_entersub:sub-entry   cleanup
      1  77214       Perl_pp_entersub:sub-entry   _force_writable
      1  77214       Perl_pp_entersub:sub-entry   _force_writable
    </pre>
  </dd>
  <dt>System calls at compile time</dt>
  <dd><span class="Li"></span>
    <pre>
    # dtrace -qZn 'phase-change /copyinstr(arg0) == &quot;START&quot;/ { self-&gt;interesting = 1 } phase-change /copyinstr(arg0) == &quot;RUN&quot;/ { self-&gt;interesting = 0 } syscall::: /self-&gt;interesting/ { @[probefunc] = count() } END { trunc(@, 3) }'

    lseek                                                           310
    read                                                            374
    stat64                                                         1056
    </pre>
  </dd>
  <dt>Perl functions that execute the most opcodes</dt>
  <dd><span class="Li"></span>
    <pre>
    # dtrace -qZn 'sub-entry { self-&gt;fqn = strjoin(copyinstr(arg3), strjoin(&quot;::&quot;, copyinstr(arg0))) } op-entry /self-&gt;fqn != &quot;&quot;/ { @[self-&gt;fqn] = count() } END { trunc(@, 3) }'

    warnings::unimport                                             4589
    Exporter::Heavy::_rebuild_cache                                5039
    Exporter::import                                              14578
    </pre>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="REFERENCES"><a class="permalink" href="#REFERENCES">REFERENCES</a></h1>
<dl class="Bl-tag">
  <dt>DTrace Dynamic Tracing Guide</dt>
  <dd>&lt;http://dtrace.org/guide/preface.html&gt;</dd>
  <dt>DTrace: Dynamic Tracing in Oracle Solaris, Mac OS X and FreeBSD</dt>
  <dd>&lt;http://www.amazon.com/DTrace-Dynamic-Tracing-Solaris-FreeBSD/dp/0132091518/&gt;</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<dl class="Bl-tag">
  <dt>Devel::DTrace::Provider</dt>
  <dd>This CPAN module lets you create application-level DTrace probes written
      in Perl.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
Shawn M Moore <span class="Li">&quot;sartak@gmail.com&quot;</span>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2014-09-30</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
