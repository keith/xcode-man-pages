<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 2004-2016 Apple Inc. All rights reserved.
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>vmmap(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">vmmap(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">vmmap(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">vmmap</code> &#x2014; <span class="Nd">Display
    the virtual memory regions allocated in a process</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">vmmap</code></td>
    <td>[<code class="Fl">-s</code>] [<code class="Fl">-w</code>]
      [<code class="Fl">-v</code>] [<code class="Fl">-pages</code>]
      [<code class="Fl">-interleaved</code>] [<code class="Fl">-submap</code>]
      [<code class="Fl">-allSplitLibs</code>]
      [<code class="Fl">-noCoalesce</code>] [<code class="Fl">-summary</code>]
      <var class="Ar">pid</var> | <var class="Ar">partial-executable-name</var>
      | <var class="Ar">memory-graph-file</var>
      [<var class="Ar">address</var>]</td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><code class="Nm">vmmap</code> displays the virtual memory regions
    allocated in a specified process, helping a programmer understand how memory
    is being used, and what the purposes of memory at a given address may
  be.</p>
<p class="Pp"><code class="Nm">vmmap</code> requires one argument -- either the
    process ID or the full or partial executable name of the process to examine,
    or the pathname of a memory graph file generated by
    <code class="Nm">leaks</code> or the Xcode Memory Graph Debugger.</p>
<p class="Pp">If the optional <var class="Ar">address</var> is given,
    information is only shown for the VM region containing that address (if any)
    and the regions around it.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="s,"><a class="permalink" href="#s,"><code class="Fl">-s,</code></a>
    <code class="Fl">-sortBySize</code></dt>
  <dd>Print sorted regions and malloc zones by size (dirty + swapped)</dd>
  <dt id="w,"><a class="permalink" href="#w,"><code class="Fl">-w,</code></a>
    <code class="Fl">-wide</code></dt>
  <dd>Print wide output, to show full paths of mapped files.</dd>
  <dt id="v,"><a class="permalink" href="#v,"><code class="Fl">-v,</code></a>
    <code class="Fl">-verbose</code></dt>
  <dd>Equivalent to <code class="Fl">-w</code> <code class="Fl">-submap</code>
      <code class="Fl">-allSplitLibs</code>
    <code class="Fl">-noCoalesce</code></dd>
  <dt id="pages"><a class="permalink" href="#pages"><code class="Fl">-pages</code></a></dt>
  <dd>Print region sizes in page counts rather than kilobytes.</dd>
  <dt id="interleaved"><a class="permalink" href="#interleaved"><code class="Fl">-interleaved</code></a></dt>
  <dd>Print all regions in ascending order of starting address, rather than
      printing all non-writable regions followed by all writable regions.</dd>
  <dt id="submap"><a class="permalink" href="#submap"><code class="Fl">-submap</code></a></dt>
  <dd>Print information about VM submaps.</dd>
  <dt id="allSplitLibs"><a class="permalink" href="#allSplitLibs"><code class="Fl">-allSplitLibs</code></a></dt>
  <dd>Print information about all shared system split libraries, even those not
      loaded by this process.</dd>
  <dt id="noCoalesce"><a class="permalink" href="#noCoalesce"><code class="Fl">-noCoalesce</code></a></dt>
  <dd>Do not coalesce adjacent identical regions. Default is to coalesce for
      more concise output.</dd>
  <dt id="summary"><a class="permalink" href="#summary"><code class="Fl">-summary</code></a></dt>
  <dd>Print only the summary of VM usage, not the individual region detail.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXPLANATION_OF_OUTPUT"><a class="permalink" href="#EXPLANATION_OF_OUTPUT">EXPLANATION
  OF OUTPUT</a></h1>
<p class="Pp">For each region, <code class="Nm">vmmap</code> describes the
    starting address, ending address, size of the region (in kilobytes or
    pages), read/write permissions for the page, sharing mode for the page, and
    the purpose of the pages.</p>
<p class="Pp">The size of the virtual memory region represents the virtual
    memory pages reserved, but not necessarily allocated. For example, using the
    vm_allocate Mach system call reserves the pages, but physical memory won't
    be allocated for the page until the memory is actually touched. A
    memory-mapped file may have a virtual memory page reserved, but the pages
    are not instantiated until a read or write happens. Thus, this size may not
    correctly describe the application's true memory usage.</p>
<p class="Pp">By default, the sizes are shown in kilobytes or megabytes. If the
    <code class="Fl">-pages</code> flag is given, then the sizes are in number
    of VM pages.</p>
<p class="Pp">The protection mode describes if the memory is readable, writable,
    or executable. Each virtual memory region has a current permission, and a
    maximum permission. In the line for a virtual memory region, the current
    permission is displayed first, the maximum permission second. For example,
    the first page of an application (starting at address 0x00000000) permits
    neither reads, writes, or execution (&quot;---&quot;), ensuring that any
    reads or writes to address 0, or dereferences of a NULL pointer immediately
    cause a bus error. Pages representing an executable always have the execute
    and read bits set (&quot;r-x&quot;). The current permissions usually do not
    permit writing to the region. However, the maximum permissions allow writing
    so that the debugger can request write access to a page to insert
    breakpoints. Permissions for executables appear as &quot;r-x/rwx&quot; to
    indicate these permissions.</p>
<p class="Pp">The share mode describes whether pages are shared between
    processes,and what happens when pages are modified. Private pages (PRV) are
    pages only visible to this process. They are allocated as they are written
    to, and can be paged out to disk. Copy-on-write (COW) pages are shared by
    multiple processes (or shared by a single process in multiple locations).
    When the page is modified, the writing process then receives its own private
    copy of the page. Empty (NUL) sharing implies that the page does not really
    exist in physical memory. Aliased (ALI) and shared (SHM) memory is shared
    between processes.</p>
<p class="Pp">The share mode typically describes the general mode controlling
    the region. For example, as copy-on-write pages are modified, they become
    private to the application. Even with the private pages, the region is still
    COW until all pages become private. Once all pages are private, then the
    share mode would change to private.</p>
<p class="Pp">The far left column names the purpose of the memory: malloc
    regions, stack, text or data segment, etc. For regions loaded from binaries,
    the far right shows the library loaded into the memory.</p>
<p class="Pp">If the <code class="Fl">-submaps</code> flag is given, then
    vmmap's output includes descriptions of submaps. A submap is a shared set of
    virtual memory page descriptions that the operating system can reuse between
    multiple processes. Submaps minimize the operating system's memory usage by
    representing the virtual memory regions only once. Submaps can either be
    shared by all processes (machine-wide) or local to the process
    (process-only). (Understanding where submaps are located is irrelevant for
    most developers, but may be interesting for anyone working with low levels
    of the virtual memory system.)</p>
<p class="Pp">For example, one submap contains the read-only portions of the
    most common dynamic libraries. These libraries are needed by most programs
    on the system, and because they are read-only, they will never be changed.
    As a result, the operating system shares these pages between all the
    processes, and only needs to create a single data structure to describe how
    this memory is laid out in every process.</p>
<p class="Pp">That section of memory is referred to as the &quot;split library
    region&quot;, and it is shared system-wide. So, technically, all of the
    dynamic libraries that have been loaded into that region are in the VM map
    of every process, even though some processes may not be using some of those
    libraries. By default, vmmap shows only those shared system split libraries
    that have been loaded into the specified target process. If the
    <code class="Fl">-allSplitLibs</code> flag is given, information about all
    shared system split libraries will be printed, regardless of whether they've
    been loaded into the specified target process or not.</p>
<p class="Pp">If the contents of a machine-wide submap are changed -- for
    example, the debugger makes a section of memory for a dylib writable so it
    can insert debugging traps -- then the submap becomes local, and the kernel
    will allocate memory to store the extra copy.</p>
<p class="Pp">% FRAG, fragmentation, in the MALLOC ZONE summary is computed by
    the following method:</p>
<p class="Pp">
  <br/>
   % FRAG = 100 - (100 * Allocated / (Dirty + Swapped))</p>
<p class="Pp">Dirty and swapped are memory which has been written to by the
    process. Allocated is the number of bytes currently allocated from
  malloc.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">heap(1)</a>, <a class="Xr">leaks(1)</a>,
    <a class="Xr">malloc_history(1)</a>, <a class="Xr">stringdups(1)</a>,
    <a class="Xr">lsof(8)</a></p>
<p class="Pp">The heap, leaks, and malloc_history commands can be used to look
    at various aspects of a process's memory usage.</p>
<p class="Pp">The lsof command can be used to get a list of open and mapped
    files in one or more processes, which can help determine why a volume can't
    be unmounted or ejected, for example.</p>
<p class="Pp">The Xcode developer tools also include Instruments, a graphical
    application that can give information similar to that provided by
    <code class="Nm">vmmap.</code> The Allocations instrument graphically
    displays dynamic, real-time information about the object and memory use in
    an application (including VM allocations), as well as backtraces of where
    the allocations occurred. The VM Tracker instrument in the Allocations
    template graphically displays information about the virtual memory regions
    in a process.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">August 9, 2022</td>
    <td class="foot-os">Mac OS X 14</td>
  </tr>
</table>
</body>
</html>
