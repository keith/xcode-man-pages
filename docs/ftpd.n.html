<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   The definitions below are for supplemental macros used in Tcl/Tk
   manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO
  	Start of list of standard options for a Tk widget.  The
  	options follow on successive lines, in four columns separated
  	by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   RCS: @(#) $Id: man.macros,v 1.1 2009/01/30 04:56:47 andreas_kupries Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>ftpd(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ftpd(n)</td>
    <td class="head-vol">Tcl FTP Server Package</td>
    <td class="head-rtitle">ftpd(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>
</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">ftpd - Tcl FTP server implementation</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">package require <b>Tcl 8.3</b></p>
<p class="Pp">package require <b>ftpd ?1.2.5?</b></p>
<p class="Pp"><b>::ftpd::server</b> ?<i>myaddr</i>?</p>
<p class="Pp"><b>::ftpd::config</b> ?<i>option value</i>? ?<i>option value
    ...</i>?</p>
<p class="Pp"><i>fsCmd</i> <b>append</b> <i>path</i></p>
<p class="Pp"><i>fsCmd</i> <b>delete</b> <i>path</i> <i>channel</i></p>
<p class="Pp"><i>fsCmd</i> <b>dlist</b> <i>path</i> <i>style</i>
  <i>channel</i></p>
<p class="Pp"><i>fsCmd</i> <b>exists</b> <i>path</i></p>
<p class="Pp"><i>fsCmd</i> <b>mkdir</b> <i>path</i> <i>channel</i></p>
<p class="Pp"><i>fsCmd</i> <b>mtime</b> <i>path</i> <i>channel</i></p>
<p class="Pp"><i>fsCmd</i> <b>permissions</b> <i>path</i></p>
<p class="Pp"><i>fsCmd</i> <b>rename</b> <i>path</i> <i>newpath</i>
    <i>channel</i></p>
<p class="Pp"><i>fsCmd</i> <b>retr</b> <i>path</i></p>
<p class="Pp"><i>fsCmd</i> <b>rmdir</b> <i>path</i> <i>channel</i></p>
<p class="Pp"><i>fsCmd</i> <b>size</b> <i>path</i> <i>channel</i></p>
<p class="Pp"><i>fsCmd</i> <b>store</b> <i>path</i></p>
<p class="Pp"></p>
<pre>
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The <b>ftpd</b> package provides a simple Tcl-only server library
    for the FTP protocol as specified in RFC 959
    (<i>http://www.rfc-editor.org/rfc/rfc959.txt</i>). It works by listening on
    the standard FTP socket. Most server errors are returned as error messages
    with the appropriate code attached to them. Since the server code for the
    ftp daemon is executed in the event loop, it is possible that a
    <b>bgerror</b> will be thrown on the server if there are problems with the
    code in the module.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COMMANDS"><a class="permalink" href="#COMMANDS">COMMANDS</a></h1>
<dl class="Bl-tag">
  <dt><b>::ftpd::server</b> ?<i>myaddr</i>?</dt>
  <dd>Open a listening socket to listen to and accept ftp connections. myaddr is
      an optional argument. <i>myaddr</i> is the domain-style name or numerical
      IP address of the client-side network interface to use for the
    connection.</dd>
  <dt><b>::ftpd::config</b> ?<i>option value</i>? ?<i>option value ...</i>?</dt>
  <dd>The value is always the name of the command to call as the callback. The
      option specifies which callback should be configured. See section
      <b>CALLBACKS</b> for descriptions of the arguments and return values for
      each of the callbacks.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="authIpCmd"><a class="permalink" href="#authIpCmd">-authIpCmd
    <i>proc</i></a></dt>
  <dd>Callback to authenticate new connections based on the ip-address of the
      peer.</dd>
  <dt id="authUsrCmd"><a class="permalink" href="#authUsrCmd">-authUsrCmd
    <i>proc</i></a></dt>
  <dd>Callback to authenticate new connections based on the user logging in (and
      the users password).</dd>
  <dt id="authFileCmd"><a class="permalink" href="#authFileCmd">-authFileCmd
    <i>proc</i></a></dt>
  <dd>Callback to accept or deny a users access to read and write to a specific
      path or file.</dd>
  <dt id="logCmd"><a class="permalink" href="#logCmd">-logCmd
    <i>proc</i></a></dt>
  <dd>Callback for log information generated by the FTP engine.</dd>
  <dt id="fsCmd"><a class="permalink" href="#fsCmd">-fsCmd <i>proc</i></a></dt>
  <dd>Callback to connect the engine to the filesystem it operates on.</dd>
  <dt id="closeCmd"><a class="permalink" href="#closeCmd">-closeCmd
    <i>proc</i></a></dt>
  <dd>Callback to be called when a connection is closed. This allows the
      embedding application to perform its own cleanup operations.</dd>
  <dt id="xferDoneCmd"><a class="permalink" href="#xferDoneCmd">-xferDoneCmd
    <i>proc</i></a></dt>
  <dd>Callback for transfer completion notification. In other words, it is
      called whenever a transfer of data to or from the client has
    completed.</dd>
</dl>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="CALLBACKS"><a class="permalink" href="#CALLBACKS">CALLBACKS</a></h1>
<dl class="Bl-tag">
  <dt id="authIpCmd~2"><a class="permalink" href="#authIpCmd~2"><b>authIpCmd</b>
    callback</a></dt>
  <dd>The authIpCmd receives the ip-address of the peer attempting to connect to
      the ftp server as its argument. It returns a 1 to allow users from the
      specified IP to attempt to login and a 0 to reject the login attempt from
      the specified IP.</dd>
  <dt id="authUsrCmd~2"><a class="permalink" href="#authUsrCmd~2"><b>authUsrCmd</b>
    callback</a></dt>
  <dd>The authUsrCmd receives the username and password as its two arguments. It
      returns a 1 to accept the attempted login to the ftpd and a 0 to reject
      the attempted login.</dd>
  <dt id="authFileCmd~2"><a class="permalink" href="#authFileCmd~2"><b>authFileCmd</b>
    callback</a></dt>
  <dd>The authFileCmd receives the user (that is currently logged in), the path
      or filename that is about to be read or written, and <b>read</b> or
      <b>write</b> as its three arguments. It returns a 1 to allow the path or
      filename to be read or written, and a 0 to reject the attempted read or
      write with a permissions error code.</dd>
  <dt id="logCmd~2"><a class="permalink" href="#logCmd~2"><b>logCmd</b>
    callback</a></dt>
  <dd>The logCmd receives a severity and a message as its two arguments. The
      severities used within the ftpd package are <b>note</b>, <b>debug</b>, and
      <b>error</b>. The logCmd doesn't return anything.</dd>
  <dt id="fsCmd~2"><a class="permalink" href="#fsCmd~2"><b>fsCmd</b>
    callback</a></dt>
  <dd>The fsCmd receives a subcommand, a filename or path, and optional
      additional arguments (depending on the subcommand).
    <p class="Pp">The subcommands supported by the fsCmd are:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="fsCmd~3"><a class="permalink" href="#fsCmd~3"><i>fsCmd</i>
    <b>append</b> <i>path</i></a></dt>
  <dd>The append subcommand receives the filename to append to as its argument.
      It returns a writable tcl channel as its return value.</dd>
  <dt id="fsCmd~4"><a class="permalink" href="#fsCmd~4"><i>fsCmd</i>
    <b>delete</b> <i>path</i> <i>channel</i></a></dt>
  <dd>The delete subcommand receives the filename to delete, and a channel to
      write to as its two arguments. The file specified is deleted and the
      appropriate ftp message is written to the channel that is passed as the
      second argument. The delete subcommand returns nothing.</dd>
  <dt id="fsCmd~5"><a class="permalink" href="#fsCmd~5"><i>fsCmd</i>
    <b>dlist</b> <i>path</i> <i>style</i> <i>channel</i></a></dt>
  <dd>The dlist subcommand receives the path that it should list the files that
      are in, the style in which the files should be listed which is either
      <b>nlst</b> or <b>list</b>, and a channel to write to as its three
      arguments. The files in the specified path are printed to the specified
      channel one per line. If the style is <b>nlst</b> only the name of the
      file is printed to the channel. If the style is <b>list</b> then the file
      permissions, number of links to the file, the name of the user that owns
      the file, the name of the group that owns the file, the size (in bytes) of
      the file, the modify time of the file, and the filename are printed out to
      the channel in a formatted space separated format. The <b>dlist</b>
      subcommand returns nothing.</dd>
  <dt id="fsCmd~6"><a class="permalink" href="#fsCmd~6"><i>fsCmd</i>
    <b>exists</b> <i>path</i></a></dt>
  <dd>The exists subcommand receives the name of a file to check the existence
      of as its only argument. The exists subcommand returns a 1 if the path
      specified exists and the path is not a directory.</dd>
  <dt id="fsCmd~7"><a class="permalink" href="#fsCmd~7"><i>fsCmd</i>
    <b>mkdir</b> <i>path</i> <i>channel</i></a></dt>
  <dd>The mkdir subcommand receives the path of a directory to create and a
      channel to write to as its two arguments. The mkdir subcommand creates the
      specified directory if necessary and possible. The mkdir subcommand then
      prints the appropriate success or failure message to the channel. The
      mkdir subcommand returns nothing.</dd>
  <dt id="fsCmd~8"><a class="permalink" href="#fsCmd~8"><i>fsCmd</i>
    <b>mtime</b> <i>path</i> <i>channel</i></a></dt>
  <dd>The mtime subcommand receives the path of a file to check the modify time
      on and a channel as its two arguments. If the file exists the mtime is
      printed to the channel in the proper FTP format, otherwise an appropriate
      error message and code are printed to the channel. The mtime subcommand
      returns nothing.</dd>
  <dt id="fsCmd~9"><a class="permalink" href="#fsCmd~9"><i>fsCmd</i>
    <b>permissions</b> <i>path</i></a></dt>
  <dd>The permissions subcommand receives the path of a file to retrieve the
      permissions of. The permissions subcommand returns the octal file
      permissions of the specified file. The file is expected to exist.</dd>
  <dt id="fsCmd~10"><a class="permalink" href="#fsCmd~10"><i>fsCmd</i>
    <b>rename</b> <i>path</i> <i>newpath</i> <i>channel</i></a></dt>
  <dd>The rename subcommand receives the path of the current file, the new file
      path, and a channel to write to as its three arguments. The rename
      subcommand renames the current file to the new file path if the path to
      the new file exists, and then prints out the appropriate message to the
      channel. If the new file path doesn't exist the appropriate error message
      is printed to the channel. The rename subcommand returns nothing.</dd>
  <dt id="fsCmd~11"><a class="permalink" href="#fsCmd~11"><i>fsCmd</i>
    <b>retr</b> <i>path</i></a></dt>
  <dd>The retr subcommand receives the path of a file to read as its only
      argument. The retr subcommand returns a readable channel that the
      specified file can be read from.</dd>
  <dt id="fsCmd~12"><a class="permalink" href="#fsCmd~12"><i>fsCmd</i>
    <b>rmdir</b> <i>path</i> <i>channel</i></a></dt>
  <dd>The rmdir subcommand receives the path of a directory to remove and a
      channel to write to as its two arguments. The rmdir subcommand removes the
      specified directory (if possible) and prints the appropriate message to
      the channel (which may be an error if the specified directory does not
      exist or is not empty). The rmdir subcommand returns nothing.</dd>
  <dt id="fsCmd~13"><a class="permalink" href="#fsCmd~13"><i>fsCmd</i>
    <b>size</b> <i>path</i> <i>channel</i></a></dt>
  <dd>The size subcommand receives the path of a file to get the size (in bytes)
      of and a channel to write to as its two arguments. The size subcommand
      prints the appropriate code and the size of the file if the specified path
      is a file, otherwise an appropriate error code and message are printed to
      the channel. The size subcommand returns nothing.</dd>
  <dt id="fsCmd~14"><a class="permalink" href="#fsCmd~14"><i>fsCmd</i>
    <b>store</b> <i>path</i></a></dt>
  <dd>The store subcommand receives the path of a file to write as its only
      argument. The store subcommand returns a writable channel.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="closeCmd~2"><a class="permalink" href="#closeCmd~2"><b>closeCmd</b></a></dt>
  <dd>The <b>closeCmd</b> receives no arguments when it is invoked, and any
      return value it may generate is discarded.</dd>
  <dt id="xferDoneCmd~2"><a class="permalink" href="#xferDoneCmd~2"><b>xferDoneCmd</b>
    sock sock2 file bytes filename err</a></dt>
  <dd>The <b>xferDoneCmd</b> receives six arguments when invoked. These are, in
      this order, the channel handle of the control socket for the connection,
      the channel handle of the data socket used for the transfer (already
      closed), the handle of the channel containing the transfered file, the
      number of bytes transfered, the path of the file which was transfered, and
      a (possibly empty) error message. Any return value it may generate is
      discarded.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="VARIABLES"><a class="permalink" href="#VARIABLES">VARIABLES</a></h1>
<dl class="Bl-tag">
  <dt><b>::ftpd::cwd</b></dt>
  <dd>The current working directory for a session when someone first connects to
      the FTPD or when the <b>REIN</b> ftp command is received.</dd>
  <dt><b>::ftpd::contact</b></dt>
  <dd>The e-mail address of the person that is the contact for the ftp server.
      This address is printed out as part of the response to the <b>FTP HELP</b>
      command.</dd>
  <dt><b>::ftpd::port</b></dt>
  <dd>The port that the ftp server should listen on. If port is specified as
      zero, the operating system will allocate an unused port for use as a
      server socket; afterwards, the variable will contain the port number that
      was allocated.</dd>
  <dt><b>::ftpd::welcome</b></dt>
  <dd>The message that is printed out when the user first connects to the ftp
      server.</dd>
  <dt><b>::ftpd::CurrentSocket</b></dt>
  <dd>Accessible to all callbacks and all filesystem commands (which are a
      special form of callback) and contains the handle of the socket channel
      which was active when the callback was invoked.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS,_IDEAS,_FEEDBACK"><a class="permalink" href="#BUGS,_IDEAS,_FEEDBACK">BUGS,
  IDEAS, FEEDBACK</a></h1>
<p class="Pp">This document, and the package it describes, will undoubtedly
    contain bugs and other problems. Please report such in the category
    <i>ftpd</i> of the <i>Tcllib SF Trackers</i>
    [http://sourceforge.net/tracker/?group_id=12883]. Please also report any
    ideas for enhancements you may have for either package and/or
  documentation.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
<p class="Pp">ftp, ftpd, ftpserver, rfc 959, services</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CATEGORY"><a class="permalink" href="#CATEGORY">CATEGORY</a></h1>
<p class="Pp">Networking</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1.2.5</td>
    <td class="foot-os">ftpd</td>
  </tr>
</table>
</body>
</html>
