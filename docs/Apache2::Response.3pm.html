<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>install::TempContent::Objects::mod_perl-2.0.12::docs::api::Apache2::Response(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">install::TempContent::Objects::mod_perl-2.0.12::docs::api::Apache2::Response(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">install::TempContent::Objects::mod_perl-2.0.12::docs::api::Apache2::Response(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">Apache2::Response - Perl API for Apache HTTP request response
    methods</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Synopsis"><a class="permalink" href="#Synopsis">Synopsis</a></h1>
<pre>  use Apache2::Response ();
  
  $r-&gt;custom_response(Apache2::Const::FORBIDDEN, &quot;No Entry today&quot;);
  
  $etag = $r-&gt;make_etag($force_weak);
  $r-&gt;set_etag();
  $status = $r-&gt;meets_conditions();
  
  $mtime_rat = $r-&gt;rationalize_mtime($mtime);
  $r-&gt;set_last_modified($mtime);
  $r-&gt;update_mtime($mtime);
  
  $r-&gt;send_cgi_header($buffer);
  
  $r-&gt;set_content_length($length);
  
  $ret = $r-&gt;set_keepalive();
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="Description"><a class="permalink" href="#Description">Description</a></h1>
<p class="Pp"><span class="Li">&quot;Apache2::Response&quot;</span> provides the
    Apache request object utilities API for dealing with HTTP response
    generation process.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="API"><a class="permalink" href="#API">API</a></h1>
<p class="Pp"><span class="Li">&quot;Apache2::Response&quot;</span> provides the
    following functions and/or methods:</p>
<section class="Ss">
<h2 class="Ss" id="_custom_response_"><a class="permalink" href="#_custom_response_">&quot;custom_response&quot;</a></h2>
<p class="Pp">Install a custom response handler for a given status</p>
<p class="Pp"></p>
<pre>  $r-&gt;custom_response($status, $string);
</pre>
<dl class="Bl-tag">
  <dt id="obj:"><a class="permalink" href="#obj:">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="arg1:"><a class="permalink" href="#arg1:">arg1: $status (
    &quot;Apache2::Const constant&quot; )</a></dt>
  <dd>The status for which the custom response should be used (e.g.
      <span class="Li">&quot;Apache2::Const::AUTH_REQUIRED&quot;</span>)</dd>
  <dt id="arg2:"><a class="permalink" href="#arg2:">arg2: $string
    (string)</a></dt>
  <dd>The custom response to use. This can be a static string, or a URL, full or
      just the uri path (<i>/foo/bar.txt</i>).</dd>
  <dt id="ret:"><a class="permalink" href="#ret:">ret: no return value</a></dt>
  <dd></dd>
  <dt id="since:"><a class="permalink" href="#since:">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
<p class="Pp"><span class="Li">&quot;custom_response()&quot;</span> doesn't
    alter the response code, but is used to replace the standard response body.
    For example, here is how to change the response body for the access handler
    failure:</p>
<p class="Pp"></p>
<pre>  package MyApache2::MyShop;
  use Apache2::Response ();
  use Apache2::Const -compile =&gt; qw(FORBIDDEN OK);
  sub access {
      my $r = shift;
   
      if (MyApache2::MyShop::tired_squirrels()) {
          $r-&gt;custom_response(Apache2::Const::FORBIDDEN,
              &quot;It's siesta time, please try later&quot;);
          return Apache2::Const::FORBIDDEN;
      }
  
      return Apache2::Const::OK;
  }
  ...
  # httpd.conf
  PerlModule MyApache2::MyShop
  &lt;Location /TestAPI__custom_response&gt;
      AuthName dummy
      AuthType none
      PerlAccessHandler   MyApache2::MyShop::access
      PerlResponseHandler MyApache2::MyShop::response
  &lt;/Location&gt;
</pre>
<p class="Pp">When squirrels can't run any more, the handler will return 403,
    with the custom message:</p>
<p class="Pp"></p>
<pre>  It's siesta time, please try later
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="_make_etag_"><a class="permalink" href="#_make_etag_">&quot;make_etag&quot;</a></h2>
<p class="Pp">Construct an entity tag from the resource information. If it's a
    real file, build in some of the file characteristics.</p>
<p class="Pp"></p>
<pre>  $etag = $r-&gt;make_etag($force_weak);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~2"><a class="permalink" href="#obj:~2">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="arg1:~2"><a class="permalink" href="#arg1:~2">arg1: $force_weak
    (number)</a></dt>
  <dd>Force the entity tag to be weak - it could be modified again in as short
      an interval.</dd>
  <dt id="ret:~2"><a class="permalink" href="#ret:~2">ret: $etag
    (string)</a></dt>
  <dd>The entity tag</dd>
  <dt id="since:~2"><a class="permalink" href="#since:~2">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="_meets_conditions_"><a class="permalink" href="#_meets_conditions_">&quot;meets_conditions&quot;</a></h2>
<p class="Pp">Implements condition <span class="Li">&quot;GET&quot;</span> rules
    for HTTP/1.1 specification. This function inspects the client headers and
    determines if the response fulfills the specified requirements.</p>
<p class="Pp"></p>
<pre>  $status = $r-&gt;meets_conditions();
</pre>
<dl class="Bl-tag">
  <dt id="obj:~3"><a class="permalink" href="#obj:~3">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="ret:~3"><a class="permalink" href="#ret:~3">ret: $status (
    &quot;Apache2::Const status constant&quot; )</a></dt>
  <dd><span class="Li">&quot;Apache2::Const::OK&quot;</span> if the response
      fulfills the condition GET rules. Otherwise some other status code (which
      should be returned to Apache).</dd>
  <dt id="since:~3"><a class="permalink" href="#since:~3">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
<p class="Pp">Refer to the Generating Correct HTTP Headers document for an
    indepth discussion of this method.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_rationalize_mtime_"><a class="permalink" href="#_rationalize_mtime_">&quot;rationalize_mtime&quot;</a></h2>
<p class="Pp">Return the latest rational time from a request/mtime pair.</p>
<p class="Pp"></p>
<pre>  $mtime_rat = $r-&gt;rationalize_mtime($mtime);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~4"><a class="permalink" href="#obj:~4">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="arg1:~3"><a class="permalink" href="#arg1:~3">arg1: $mtime ( time in
    seconds )</a></dt>
  <dd>The last modified time</dd>
  <dt id="ret:~4"><a class="permalink" href="#ret:~4">ret: $mtime_rat ( time in
    seconds )</a></dt>
  <dd>the latest rational time from a request/mtime pair. Mtime is returned
      unless it's in the future, in which case we return the current time.</dd>
  <dt id="since:~4"><a class="permalink" href="#since:~4">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="_send_cgi_header_"><a class="permalink" href="#_send_cgi_header_">&quot;send_cgi_header&quot;</a></h2>
<p class="Pp">Parse the header</p>
<p class="Pp"></p>
<pre>  $r-&gt;send_cgi_header($buffer);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~5"><a class="permalink" href="#obj:~5">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd></dd>
  <dt id="arg1:~4"><a class="permalink" href="#arg1:~4">arg1: $buffer
    (string)</a></dt>
  <dd>headers and optionally a response body</dd>
  <dt id="ret:~5"><a class="permalink" href="#ret:~5">ret: no return
    value</a></dt>
  <dd></dd>
  <dt id="since:~5"><a class="permalink" href="#since:~5">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
<p class="Pp">This method is really for back-compatibility with mod_perl 1.0.
    It's very inefficient to send headers this way, because of the parsing
    overhead.</p>
<p class="Pp">If there is a response body following the headers it'll be handled
    too (as if it was sent via <span class="Li">&quot;print()&quot;</span>).</p>
<p class="Pp">Notice that if only HTTP headers are included they won't be sent
    until some body is sent (again the &quot;send&quot; part is retained from
    the mod_perl 1.0 method).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_set_content_length_"><a class="permalink" href="#_set_content_length_">&quot;set_content_length&quot;</a></h2>
<p class="Pp">Set the content length for this request.</p>
<p class="Pp"></p>
<pre>  $r-&gt;set_content_length($length);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~6"><a class="permalink" href="#obj:~6">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="arg1:~5"><a class="permalink" href="#arg1:~5">arg1: $length
    (integer)</a></dt>
  <dd>The new content length</dd>
  <dt id="ret:~6"><a class="permalink" href="#ret:~6">ret: no return
    value</a></dt>
  <dd></dd>
  <dt id="since:~6"><a class="permalink" href="#since:~6">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="_set_etag_"><a class="permalink" href="#_set_etag_">&quot;set_etag&quot;</a></h2>
<p class="Pp">Set the E-tag outgoing header</p>
<p class="Pp"></p>
<pre>  $r-&gt;set_etag();
</pre>
<dl class="Bl-tag">
  <dt id="obj:~7"><a class="permalink" href="#obj:~7">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd></dd>
  <dt id="ret:~7"><a class="permalink" href="#ret:~7">ret: no return
    value</a></dt>
  <dd></dd>
  <dt id="since:~7"><a class="permalink" href="#since:~7">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="_set_keepalive_"><a class="permalink" href="#_set_keepalive_">&quot;set_keepalive&quot;</a></h2>
<p class="Pp">Set the keepalive status for this request</p>
<p class="Pp"></p>
<pre>  $ret = $r-&gt;set_keepalive();
</pre>
<dl class="Bl-tag">
  <dt id="obj:~8"><a class="permalink" href="#obj:~8">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="ret:~8"><a class="permalink" href="#ret:~8">ret: $ret ( boolean
    )</a></dt>
  <dd>true if keepalive can be set, false otherwise</dd>
  <dt id="since:~8"><a class="permalink" href="#since:~8">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
<p class="Pp">It's called by
    <span class="Li">&quot;ap_http_header_filter()&quot;</span>. For the
    complete complicated logic implemented by this method see
    <i>httpd-2.0/server/http_protocol.c</i>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_set_last_modified_"><a class="permalink" href="#_set_last_modified_">&quot;set_last_modified&quot;</a></h2>
<p class="Pp">sets the <span class="Li">&quot;Last-Modified&quot;</span>
    response header field to the value of the mtime field in the request
    structure -- rationalized to keep it from being in the future.</p>
<p class="Pp"></p>
<pre>  $r-&gt;set_last_modified($mtime);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~9"><a class="permalink" href="#obj:~9">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd></dd>
  <dt id="opt"><a class="permalink" href="#opt">opt arg1: $mtime ( time in
    seconds )</a></dt>
  <dd>if the <span class="Li">$mtime</span> argument is passed,
      <span class="Li">$r</span>-&gt;update_mtime will be first run with that
      argument.</dd>
  <dt id="ret:~9"><a class="permalink" href="#ret:~9">ret: no return
    value</a></dt>
  <dd></dd>
  <dt id="since:~9"><a class="permalink" href="#since:~9">since: 2.0.00</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="_update_mtime_"><a class="permalink" href="#_update_mtime_">&quot;update_mtime&quot;</a></h2>
<p class="Pp">Set the <span class="Li">&quot;$r-&gt;mtime&quot;</span> field to
    the specified value if it's later than what's already there.</p>
<p class="Pp"></p>
<pre>  $r-&gt;update_mtime($mtime);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~10"><a class="permalink" href="#obj:~10">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="arg1:~6"><a class="permalink" href="#arg1:~6">arg1: $mtime ( time in
    seconds )</a></dt>
  <dd></dd>
  <dt id="ret:~10"><a class="permalink" href="#ret:~10">ret: no return
    value</a></dt>
  <dd></dd>
  <dt id="since:~10"><a class="permalink" href="#since:~10">since:
    2.0.00</a></dt>
  <dd></dd>
</dl>
<p class="Pp">See also: <span class="Li">$r</span>-&gt;set_last_modified.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="Unsupported_API"><a class="permalink" href="#Unsupported_API">Unsupported
  API</a></h1>
<p class="Pp"><span class="Li">&quot;Apache2::Response&quot;</span> also
    provides auto-generated Perl interface for a few other methods which aren't
    tested at the moment and therefore their API is a subject to change. These
    methods will be finalized later as a need arises. If you want to rely on any
    of the following methods please contact the the mod_perl development mailing
    list so we can help each other take the steps necessary to shift the method
    to an officially supported API.</p>
<section class="Ss">
<h2 class="Ss" id="_send_error_response_"><a class="permalink" href="#_send_error_response_">&quot;send_error_response&quot;</a></h2>
<p class="Pp">Send an &quot;error&quot; response back to client. It is used for
    any response that can be generated by the server from the request record.
    This includes all 204 (no content), 3xx (redirect), 4xx (client error), and
    5xx (server error) messages that have not been redirected to another handler
    via the ErrorDocument feature.</p>
<p class="Pp"></p>
<pre>  $r-&gt;send_error_response($recursive_error);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~11"><a class="permalink" href="#obj:~11">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="arg1:~7"><a class="permalink" href="#arg1:~7">arg1: $recursive_error (
    boolean )</a></dt>
  <dd>the error status in case we get an error in the process of trying to deal
      with an <span class="Li">&quot;ErrorDocument&quot;</span> to handle some
      other error. In that case, we print the default report for the first thing
      that went wrong, and more briefly report on the problem with the
      <span class="Li">&quot;ErrorDocument&quot;</span>.</dd>
  <dt id="ret:~11"><a class="permalink" href="#ret:~11">ret: no return
    value</a></dt>
  <dd></dd>
  <dt id="since:~11"><a class="permalink" href="#since:~11">since:
    2.0.00</a></dt>
  <dd></dd>
</dl>
<p class="Pp">META: it's really an internal Apache method, I'm not quite sure
    how can it be used externally.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_send_mmap_"><a class="permalink" href="#_send_mmap_">&quot;send_mmap&quot;</a></h2>
<p class="Pp">META: Autogenerated - needs to be reviewed/completed</p>
<p class="Pp">Send an MMAP'ed file to the client</p>
<p class="Pp"></p>
<pre>  $ret = $r-&gt;send_mmap($mm, $offset, $length);
</pre>
<dl class="Bl-tag">
  <dt id="obj:~12"><a class="permalink" href="#obj:~12">obj: $r (
    &quot;Apache2::RequestRec object&quot; )</a></dt>
  <dd>The current request</dd>
  <dt id="arg1:~8"><a class="permalink" href="#arg1:~8">arg1: $mm
    (&quot;APR::Mmap&quot;)</a></dt>
  <dd>The MMAP'ed file to send</dd>
  <dt id="arg2:~2"><a class="permalink" href="#arg2:~2">arg2: $offset
    (number)</a></dt>
  <dd>The offset into the MMAP to start sending</dd>
  <dt id="arg3:"><a class="permalink" href="#arg3:">arg3: $length
    (integer)</a></dt>
  <dd>The amount of data to send</dd>
  <dt id="ret:~12"><a class="permalink" href="#ret:~12">ret: $ret
    (integer)</a></dt>
  <dd>The number of bytes sent</dd>
  <dt id="since:~12"><a class="permalink" href="#since:~12">since:
    2.0.00</a></dt>
  <dd></dd>
</dl>
<p class="Pp">META: requires a working APR::Mmap, which is not supported at the
    moment.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="See_Also"><a class="permalink" href="#See_Also">See
  Also</a></h1>
<p class="Pp">mod_perl 2.0 documentation.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Copyright"><a class="permalink" href="#Copyright">Copyright</a></h1>
<p class="Pp">mod_perl 2.0 and its core modules are copyrighted under The Apache
    Software License, Version 2.0.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Authors"><a class="permalink" href="#Authors">Authors</a></h1>
<p class="Pp">The mod_perl development team and numerous contributors.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2015-06-18</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
