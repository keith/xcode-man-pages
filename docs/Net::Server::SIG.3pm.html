<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>Net::Server::SIG(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Net::Server::SIG(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Net::Server::SIG(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Net::Server::SIG - adpf - Safer signal handling
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    use Net::Server::SIG qw(register_sig check_sigs);
    use IO::Select ();
    use POSIX qw(WNOHANG);

    my $select = IO::Select-&gt;new();

    register_sig(PIPE =&gt; 'IGNORE',
                 HUP  =&gt; 'DEFAULT',
                 USR1 =&gt; sub { print &quot;I got a SIG $_[0]\n&quot;; },
                 USR2 =&gt; sub { print &quot;I got a SIG $_[0]\n&quot;; },
                 CHLD =&gt; sub { 1 while waitpid(-1, WNOHANG) &gt; 0; },
                 );

    # add some handles to the select
    $select-&gt;add(\*STDIN);

    # loop forever trying to stay alive
    while (1) {

        # do a timeout to see if any signals got passed us
        # while we were processing another signal
        my @fh = $select-&gt;can_read(10);

        my $key;
        my $val;

        # this is the handler for safe (fine under unsafe also)
        if (check_sigs()) {
          # or my @sigs = check_sigs();
          next unless @fh;
        }

        my $handle = $fh[@fh];

        # do something with the handle

    }
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
Signals prior in Perl prior to 5.7 were unsafe. Since then signals have been
  implemented in a more safe algorithm. Net::Server::SIG provides backwards
  compatibility, while still working reliably with newer releases.
<p class="Pp">Using a property of the <i>select()</i> function, Net::Server::SIG
    attempts to fix the unsafe problem. If a process is blocking on
    <i>select()</i> any signal will short circuit the select. Using this
    concept, Net::Server::SIG does the least work possible (changing one bit
    from 0 to 1). And depends upon the actual processing of the signals to take
    place immediately after the the select call via the &quot;check_sigs&quot;
    function. See the example shown above and also see the sigtest.pl script
    located in the examples directory of this distribution.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FUNCTIONS"><a class="permalink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<dl class="Bl-tag">
  <dt>&quot;register_sig($SIG =&gt; \&amp;code_ref)&quot;</dt>
  <dd>Takes key/value pairs where the key is the signal name, and the argument
      is either a code ref, or the words 'DEFAULT' or 'IGNORE'. The function
      register_sig must be used in conjunction with check_sigs, and with a
      blocking <i>select()</i> function call -- otherwise, you will observe the
      registered signal mysteriously vanish.</dd>
  <dt>&quot;unregister_sig($SIG)&quot;</dt>
  <dd>Takes the name of a signal as an argument. Calls register_sig with a this
      signal name and 'DEFAULT' as arguments (same as
      register_sig(SIG,'DEFAULT')</dd>
  <dt>&quot;check_sigs()&quot;</dt>
  <dd>Checks to see if any registered signals have occured. If so, it will play
      the registered code ref for that signal. Return value is array containing
      any SIGNAL names that had occured.</dd>
  <dt>&quot;sig_is_registered($SIG)&quot;</dt>
  <dd>Takes a signal name and returns any registered code_ref for that
    signal.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
Paul Seamons (paul@seamons.com)
<p class="Pp">Rob B Brown (rob@roobik.com) - Provided a sounding board and
    feedback in creating Net::Server::SIG and sigtest.pl.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="LICENSE"><a class="permalink" href="#LICENSE">LICENSE</a></h1>
<span class="Li"></span>
<pre>
  This package may be distributed under the terms of either the
  GNU General Public License
    or the
  Perl Artistic License

  All rights reserved.
</pre>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-01-09</td>
    <td class="foot-os">perl v5.18.2</td>
  </tr>
</table>
</body>
</html>
