<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>Class::C3(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Class::C3(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Class::C3(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Class::C3 - A pragma to use the C3 method resolution order algorithm
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    # NOTE - DO NOT USE Class::C3 directly as a user, use MRO::Compat instead!
    package ClassA;
    use Class::C3;
    sub hello { 'A::hello' }

    package ClassB;
    use base 'ClassA';
    use Class::C3;

    package ClassC;
    use base 'ClassA';
    use Class::C3;

    sub hello { 'C::hello' }

    package ClassD;
    use base ('ClassB', 'ClassC');
    use Class::C3;

    # Classic Diamond MI pattern
    #    &lt;A&gt;
    #   /   \
    # &lt;B&gt;   &lt;C&gt;
    #   \   /
    #    &lt;D&gt;

    package main;

    # initializez the C3 module
    # (formerly called in INIT)
    Class::C3::initialize();

    print join ', ' =&gt; Class::C3::calculateMRO('ClassD'); # prints ClassD, ClassB, ClassC, ClassA

    print ClassD-&gt;hello(); # prints 'C::hello' instead of the standard p5 'A::hello'

    ClassD-&gt;can('hello')-&gt;();          # can() also works correctly
    UNIVERSAL::can('ClassD', 'hello'); # as does UNIVERSAL::can()
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This is pragma to change Perl 5's standard method resolution order from
  depth-first left-to-right (a.k.a - pre-order) to the more sophisticated C3
  method resolution order.
<p class="Pp"><b>NOTE:</b> YOU SHOULD NOT USE THIS MODULE DIRECTLY - The feature
    provided is integrated into perl version &gt;= 5.9.5, and you should use
    MRO::Compat instead, which will use the core implementation in newer perls,
    but fallback to using this implementation on older perls.</p>
<section class="Ss">
<h2 class="Ss" id="What_is_C3?"><a class="permalink" href="#What_is_C3?">What is
  C3?</a></h2>
C3 is the name of an algorithm which aims to provide a sane method resolution
  order under multiple inheritance. It was first introduced in the language
  Dylan (see links in the &quot;SEE ALSO&quot; section), and then later adopted
  as the preferred MRO (Method Resolution Order) for the new-style classes in
  Python 2.3. Most recently it has been adopted as the 'canonical' MRO for Perl
  6 classes, and the default MRO for Parrot objects as well.
</section>
<section class="Ss">
<h2 class="Ss" id="How_does_C3_work."><a class="permalink" href="#How_does_C3_work.">How
  does C3 work.</a></h2>
C3 works by always preserving local precedence ordering. This essentially means
  that no class will appear before any of its subclasses. Take the classic
  diamond inheritance pattern for instance:
<p class="Pp"><span class="Li"></span></p>
<pre>
     &lt;A&gt;
    /   \
  &lt;B&gt;   &lt;C&gt;
    \   /
     &lt;D&gt;
</pre>
<p class="Pp">The standard Perl 5 MRO would be (D, B, A, C). The result being
    that <b>A</b> appears before <b>C</b>, even though <b>C</b> is the subclass
    of <b>A</b>. The C3 MRO algorithm however, produces the following MRO (D, B,
    C, A), which does not have this same issue.</p>
<p class="Pp">This example is fairly trivial, for more complex examples and a
    deeper explanation, see the links in the &quot;SEE ALSO&quot; section.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="How_does_this_module_work?"><a class="permalink" href="#How_does_this_module_work?">How
  does this module work?</a></h2>
This module uses a technique similar to Perl 5's method caching. When
  <span class="Li">&quot;Class::C3::initialize&quot;</span> is called, this
  module calculates the MRO of all the classes which called
  <span class="Li">&quot;use Class::C3&quot;</span>. It then gathers information
  from the symbol tables of each of those classes, and builds a set of method
  aliases for the correct dispatch ordering. Once all these C3-based method
  tables are created, it then adds the method aliases into the local classes
  symbol table.
<p class="Pp">The end result is actually classes with pre-cached method
    dispatch. However, this caching does not do well if you start changing your
    <span class="Li">@ISA</span> or messing with class symbol tables, so you
    should consider your classes to be effectively closed. See the CAVEATS
    section for more details.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONAL_LOWERCASE_PRAGMA"><a class="permalink" href="#OPTIONAL_LOWERCASE_PRAGMA">OPTIONAL
  LOWERCASE PRAGMA</a></h1>
This release also includes an optional module <b>c3</b> in the <i>opt/</i>
  folder. I did not include this in the regular install since lowercase module
  names are considered <i>&quot;bad&quot;</i> by some people. However I think
  that code looks much nicer like this:
<p class="Pp"><span class="Li"></span></p>
<pre>
  package MyClass;
  use c3;
</pre>
<p class="Pp">This is more clunky:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  package MyClass;
  use Class::C3;
</pre>
<p class="Pp">But hey, it's your choice, that's why it is optional.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FUNCTIONS"><a class="permalink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<dl class="Bl-tag">
  <dt><b>calculateMRO ($class)</b></dt>
  <dd>Given a <span class="Li">$class</span> this will return an array of class
      names in the proper C3 method resolution order.</dd>
  <dt><b>initialize</b></dt>
  <dd>This <b>must be called</b> to initialize the C3 method dispatch tables,
      this module <b>will not work</b> if you do not do this. It is advised to
      do this as soon as possible <b>after</b> loading any classes which use C3.
      Here is a quick code example:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  package Foo;
  use Class::C3;
  # ... Foo methods here

  package Bar;
  use Class::C3;
  use base 'Foo';
  # ... Bar methods here

  package main;

  Class::C3::initialize(); # now it is safe to use Foo and Bar
    </pre>
    <p class="Pp">This function used to be called automatically for you in the
        INIT phase of the perl compiler, but that lead to warnings if this
        module was required at runtime. After discussion with my user base (the
        DBIx::Class folks), we decided that calling this in INIT was more of an
        annoyance than a convenience. I apologize to anyone this causes problems
        for (although I would be very surprised if I had any other users other
        than the DBIx::Class folks). The simplest solution of course is to
        define your own INIT method which calls this function.</p>
    <p class="Pp">NOTE:</p>
    <p class="Pp">If <span class="Li">&quot;initialize&quot;</span> detects that
        <span class="Li">&quot;initialize&quot;</span> has already been
        executed, it will &quot;uninitialize&quot; and clear the MRO cache
        first.</p>
  </dd>
  <dt><b>uninitialize</b></dt>
  <dd>Calling this function results in the removal of all cached methods, and
      the restoration of the old Perl 5 style dispatch order (depth-first,
      left-to-right).</dd>
  <dt><b>reinitialize</b></dt>
  <dd>This is an alias for &quot;initialize&quot; above.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="METHOD_REDISPATCHING"><a class="permalink" href="#METHOD_REDISPATCHING">METHOD
  REDISPATCHING</a></h1>
It is always useful to be able to re-dispatch your method call to the &quot;next
  most applicable method&quot;. This module provides a pseudo package along the
  lines of <span class="Li">&quot;SUPER::&quot;</span> or
  <span class="Li">&quot;NEXT::&quot;</span> which will re-dispatch the method
  along the C3 linearization. This is best shown with an example.
<p class="Pp"><span class="Li"></span></p>
<pre>
  # a classic diamond MI pattern ...
  #    &lt;A&gt;
  #   /   \
  # &lt;B&gt;   &lt;C&gt;
  #   \   /
  #    &lt;D&gt;

  package A;
  use c3;
  sub foo { 'A::foo' }

  package B;
  use base 'A';
  use c3;
  sub foo { 'B::foo =&gt; ' . (shift)-&gt;next::method() }

  package C;
  use base 'A';
  use c3;
  sub foo { 'C::foo =&gt; ' . (shift)-&gt;next::method() }

  package D;
  use base ('B', 'C');
  use c3;
  sub foo { 'D::foo =&gt; ' . (shift)-&gt;next::method() }

  print D-&gt;foo; # prints out &quot;D::foo =&gt; B::foo =&gt; C::foo =&gt; A::foo&quot;
</pre>
<p class="Pp">A few things to note. First, we do not require you to add on the
    method name to the <span class="Li">&quot;next::method&quot;</span> call
    (this is unlike <span class="Li">&quot;NEXT::&quot;</span> and
    <span class="Li">&quot;SUPER::&quot;</span> which do require that). This
    helps to enforce the rule that you cannot dispatch to a method of a
    different name (this is how <span class="Li">&quot;NEXT::&quot;</span>
    behaves as well).</p>
<p class="Pp">The next thing to keep in mind is that you will need to pass all
    arguments to <span class="Li">&quot;next::method&quot;</span>. It can not
    automatically use the current <span class="Li">@_</span>.</p>
<p class="Pp">If <span class="Li">&quot;next::method&quot;</span> cannot find a
    next method to re-dispatch the call to, it will throw an exception. You can
    use <span class="Li">&quot;next::can&quot;</span> to see if
    <span class="Li">&quot;next::method&quot;</span> will succeed before you
    call it like so:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  $self-&gt;next::method(@_) if $self-&gt;next::can;
</pre>
<p class="Pp">Additionally, you can use
    <span class="Li">&quot;maybe::next::method&quot;</span> as a shortcut to
    only call the next method if it exists. The previous example could be simply
    written as:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  $self-&gt;maybe::next::method(@_);
</pre>
<p class="Pp">There are some caveats about using
    <span class="Li">&quot;next::method&quot;</span>, see below for those.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
This module used to be labeled as <i>experimental</i>, however it has now been
  pretty heavily tested by the good folks over at DBIx::Class and I am confident
  this module is perfectly usable for whatever your needs might be.
<p class="Pp">But there are still caveats, so here goes ...</p>
<dl class="Bl-tag">
  <dt>Use of &quot;SUPER::&quot;.</dt>
  <dd>The idea of <span class="Li">&quot;SUPER::&quot;</span> under multiple
      inheritance is ambiguous, and generally not recommended anyway. However,
      its use in conjunction with this module is very much not recommended, and
      in fact very discouraged. The recommended approach is to instead use the
      supplied <span class="Li">&quot;next::method&quot;</span> feature, see
      more details on its usage above.</dd>
  <dt>Changing @ISA.</dt>
  <dd>It is the author's opinion that changing <span class="Li">@ISA</span> at
      runtime is pure insanity anyway. However, people do it, so I must caveat.
      Any changes to the <span class="Li">@ISA</span> will not be reflected in
      the MRO calculated by this module, and therefore probably won't even show
      up. If you do this, you will need to call
      <span class="Li">&quot;reinitialize&quot;</span> in order to recalculate
      <b>all</b> method dispatch tables. See the
      <span class="Li">&quot;reinitialize&quot;</span> documentation and an
      example in <i>t/20_reinitialize.t</i> for more information.</dd>
  <dt>Adding/deleting methods from class symbol tables.</dt>
  <dd>This module calculates the MRO for each requested class by interrogating
      the symbol tables of said classes. So any symbol table manipulation which
      takes place after our INIT phase is run will not be reflected in the
      calculated MRO. Just as with changing the <span class="Li">@ISA</span>,
      you will need to call <span class="Li">&quot;reinitialize&quot;</span> for
      any changes you make to take effect.</dd>
  <dt>Calling &quot;next::method&quot; from methods defined outside the
    class</dt>
  <dd>There is an edge case when using
      <span class="Li">&quot;next::method&quot;</span> from within a subroutine
      which was created in a different module than the one it is called from. It
      sounds complicated, but it really isn't. Here is an example which will not
      work correctly:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  *Foo::foo = sub { (shift)-&gt;next::method(@_) };
    </pre>
    <p class="Pp">The problem exists because the anonymous subroutine being
        assigned to the glob <span class="Li">*Foo::foo</span> will show up in
        the call stack as being called
        <span class="Li">&quot;__ANON__&quot;</span> and not
        <span class="Li">&quot;foo&quot;</span> as you might expect. Since
        <span class="Li">&quot;next::method&quot;</span> uses
        <span class="Li">&quot;caller&quot;</span> to find the name of the
        method it was called in, it will fail in this case.</p>
    <p class="Pp">But fear not, there is a simple solution. The module
        <span class="Li">&quot;Sub::Name&quot;</span> will reach into the perl
        internals and assign a name to an anonymous subroutine for you. Simply
        do this:</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  use Sub::Name 'subname';
  *Foo::foo = subname 'Foo::foo' =&gt; sub { (shift)-&gt;next::method(@_) };
    </pre>
    <p class="Pp">and things will Just Work. Of course this is not always
        possible to do, but to be honest, I just can't manage to find a
        workaround for it, so until someone gives me a working patch this will
        be a known limitation of this module.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="COMPATIBILITY"><a class="permalink" href="#COMPATIBILITY">COMPATIBILITY</a></h1>
If your software requires Perl 5.9.5 or higher, you do not need Class::C3, you
  can simply <span class="Li">&quot;use mro 'c3'&quot;</span>, and not worry
  about <span class="Li">&quot;initialize()&quot;</span>, avoid some of the
  above caveats, and get the best possible performance. See mro for more
  details.
<p class="Pp">If your software is meant to work on earlier Perls, use Class::C3
    as documented here. Class::C3 will detect Perl 5.9.5+ and take advantage of
    the core support when available.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Class::C3::XS"><a class="permalink" href="#Class::C3::XS">Class::C3::XS</a></h1>
This module will load Class::C3::XS if it's installed and you are running on a
  Perl version older than 5.9.5. The optional module will be automatically
  installed for you if a C compiler is available, as it results in significant
  performance improvements (but unlike the 5.9.5+ core support, it still has all
  of the same caveats as Class::C3).
</section>
<section class="Sh">
<h1 class="Sh" id="CODE_COVERAGE"><a class="permalink" href="#CODE_COVERAGE">CODE
  COVERAGE</a></h1>
Devel::Cover was reporting 94.4% overall test coverage earlier in this module's
  life. Currently, the test suite does things that break under coverage testing,
  but it is fair to assume the coverage is still close to that value.
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<section class="Ss">
<h2 class="Ss" id="The_original_Dylan_paper"><a class="permalink" href="#The_original_Dylan_paper">The
  original Dylan paper</a></h2>
<dl class="Bl-tag">
  <dt>&lt;http://www.webcom.com/haahr/dylan/linearization-oopsla96.html&gt;</dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="The_prototype_Perl_6_Object_Model_uses_C3"><a class="permalink" href="#The_prototype_Perl_6_Object_Model_uses_C3">The
  prototype Perl 6 Object Model uses C3</a></h2>
<dl class="Bl-tag">
  <dt>&lt;http://svn.openfoundry.org/pugs/perl5/Perl6-MetaModel/&gt;</dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Parrot_now_uses_C3"><a class="permalink" href="#Parrot_now_uses_C3">Parrot
  now uses C3</a></h2>
<dl class="Bl-tag">
  <dt>&lt;http://aspn.activestate.com/ASPN/Mail/Message/perl6-internals/2746631&gt;</dt>
  <dd></dd>
  <dt>&lt;http://use.perl.org/~autrijus/journal/25768&gt;</dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Python_2.3__s-1MRO_s0_related_links"><a class="permalink" href="#Python_2.3__s-1MRO_s0_related_links">Python
  2.3 MRO related links</a></h2>
<dl class="Bl-tag">
  <dt>&lt;http://www.python.org/2.3/mro.html&gt;</dt>
  <dd></dd>
  <dt>&lt;http://www.python.org/2.2.2/descrintro.html#mro&gt;</dt>
  <dd></dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="C3_for_TinyCLOS"><a class="permalink" href="#C3_for_TinyCLOS">C3
  for TinyCLOS</a></h2>
<dl class="Bl-tag">
  <dt>&lt;http://www.call-with-current-continuation.org/eggs/c3.html&gt;</dt>
  <dd></dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ACKNOWLEGEMENTS"><a class="permalink" href="#ACKNOWLEGEMENTS">ACKNOWLEGEMENTS</a></h1>
<dl class="Bl-tag">
  <dt>Thanks to Matt S. Trout for using this module in his module DBIx::Class
    and finding many bugs and providing fixes.</dt>
  <dd></dd>
  <dt>Thanks to Justin Guenther for making &quot;next::method&quot; more robust
    by handling calls inside &quot;eval&quot; and anon-subs.</dt>
  <dd></dd>
  <dt>Thanks to Robert Norris for adding support for &quot;next::can&quot; and
    &quot;maybe::next::method&quot;.</dt>
  <dd></dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
Stevan Little, &lt;stevan@iinteractive.com&gt;
<p class="Pp">Brandon L. Black, &lt;blblack@gmail.com&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
Copyright 2005, 2006 by Infinity Interactive, Inc.
<p class="Pp">&lt;http://www.iinteractive.com&gt;</p>
<p class="Pp">This library is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-07-04</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
