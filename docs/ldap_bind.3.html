<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>LDAP_BIND(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">LDAP_BIND(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">LDAP_BIND(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
ldap_bind, ldap_bind_s, ldap_simple_bind, ldap_simple_bind_s, ldap_sasl_bind,
  ldap_sasl_bind_s, ldap_sasl_interactive_bind_s, ldap_parse_sasl_bind_result,
  ldap_unbind, ldap_unbind_s, ldap_unbind_ext, ldap_unbind_ext_s,
  ldap_set_rebind_proc - LDAP bind routines
</section>
<section class="Sh">
<h1 class="Sh" id="LIBRARY"><a class="permalink" href="#LIBRARY">LIBRARY</a></h1>
OpenLDAP LDAP (libldap, -lldap)
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
<b>#include &lt;ldap.h&gt;</b>
</pre>
<pre>
<b>int ldap_bind(LDAP *</b><i>ld</i><b>, const char *</b><i>who</i><b>, const char *</b><i>cred</i><b>,</b>
</pre>
<div class="Bd-indent">
<pre>
<b>int </b><i>method</i><b>);</b>
</pre>
</div>
<pre>
<b>int ldap_bind_s(LDAP *</b><i>ld</i><b>, const char *</b><i>who</i><b>, const char *</b><i>cred</i><b>,</b>
</pre>
<div class="Bd-indent">
<pre>
<b>int </b><i>method</i><b>);</b>
</pre>
</div>
<pre>
<b>int ldap_simple_bind(LDAP *</b><i>ld</i><b>, const char *</b><i>who</i><b>, const char *</b><i>passwd</i><b>);</b>
</pre>
<pre>
<b>int ldap_simple_bind_s(LDAP *</b><i>ld</i><b>, const char *</b><i>who</i><b>, const char *</b><i>passwd</i><b>);</b>
</pre>
<pre>
<b>int ldap_sasl_bind(LDAP *</b><i>ld</i><b>, const char *</b><i>dn</i><b>, const char *</b><i>mechanism</i><b>,</b>
</pre>
<div class="Bd-indent">
<pre>
<b>struct berval *</b><i>cred</i><b>, LDAPControl *</b><i>sctrls</i><b>[],</b>
<b>LDAPControl *</b><i>cctrls</i><b>[], int *</b><i>msgidp</i><b>);</b>
</pre>
</div>
<pre>
<b>int ldap_sasl_bind_s(LDAP *</b><i>ld</i><b>, const char *</b><i>dn</i><b>, const char *</b><i>mechanism</i><b>,</b>
</pre>
<div class="Bd-indent">
<pre>
<b>struct berval *</b><i>cred</i><b>, LDAPControl *</b><i>sctrls</i><b>[],</b>
<b>LDAPControl *</b><i>cctrls</i><b>[], struct berval **</b><i>servercredp</i><b>);</b>
</pre>
</div>
<pre>
<b>int ldap_parse_sasl_bind_result(LDAP *</b><i>ld</i><b>, LDAPMessage *</b><i>res</i><b>,</b>
</pre>
<div class="Bd-indent">
<pre>
<b>struct berval **</b><i>servercredp</i><b>, int </b><i>freeit</i><b>);</b>
</pre>
</div>
<pre>
<b>int ldap_sasl_interactive_bind_s(LDAP *</b><i>ld</i><b>, const char *</b><i>dn</i><b>,</b>
</pre>
<div class="Bd-indent">
<pre>
<b>const char *</b><i>mechs</i><b>,</b>
<b>LDAPControl *</b><i>sctrls</i><b>[], LDAPControl *</b><i>cctrls</i><b>[],</b>
<b>unsigned </b><i>flags</i><b>, LDAP_SASL_INTERACT_PROC *</b><i>interact</i><b>,</b>
<b>void *</b><i>defaults</i><b>);</b>
</pre>
</div>
<pre>
<b>int ldap_sasl_interactive_bind(LDAP *</b><i>ld</i><b>, const char *</b><i>dn</i><b>,</b>
</pre>
<div class="Bd-indent">
<pre>
<b>const char *</b><i>mechs</i><b>,</b>
<b>LDAPControl *</b><i>sctrls</i><b>[], LDAPControl *</b><i>cctrls</i><b>[],</b>
<b>unsigned </b><i>flags</i><b>, LDAP_SASL_INTERACT_PROC *</b><i>interact</i><b>,</b>
<b>void *</b><i>defaults</i><b>, LDAPMessage *</b><i>result</i><b>,</b>
<b>const char **</b><i>rmechp</i><b>, int *</b><i>msgidp</i><b>);</b>
</pre>
</div>
<pre>
<b>int (LDAP_SASL_INTERACT_PROC)(LDAP *</b><i>ld</i><b>, unsigned </b><i>flags</i><b>, void *</b><i>defaults</i><b>, void *</b><i>sasl_interact</i><b>);</b>
</pre>
<pre>
<b>int ldap_unbind(LDAP *</b><i>ld</i><b>);</b>
</pre>
<pre>
<b>int ldap_unbind_s(LDAP *</b><i>ld</i><b>);</b>
</pre>
<pre>
<b>int ldap_unbind_ext(LDAP *</b><i>ld</i><b>, LDAPControl *</b><i>sctrls</i><b>[],</b>
</pre>
<div class="Bd-indent">
<pre>
<b>LDAPControl *</b><i>cctrls</i><b>[]);</b>
</pre>
</div>
<pre>
<b>int ldap_unbind_ext_s(LDAP *</b><i>ld</i><b>, LDAPControl *</b><i>sctrls</i><b>[],</b>
</pre>
<div class="Bd-indent">
<pre>
<b>LDAPControl *</b><i>cctrls</i><b>[]);</b>
</pre>
</div>
<pre>
<b>int ldap_set_rebind_proc (LDAP *</b><i>ld</i><b>, LDAP_REBIND_PROC *</b><i>ldap_proc</i><b>, void *</b><i>params</i><b>);</b>
</pre>
<pre>
<b>int (LDAP_REBIND_PROC)(LDAP *</b><i>ld</i><b>, LDAP_CONST char *</b><i>url</i><b>, ber_tag_t </b><i>request</i><b>, ber_int_t </b><i>msgid</i><b>, void *</b><i>params</i><b>);</b>
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
These routines provide various interfaces to the LDAP bind operation. After an
  association with an LDAP server is made using <b>ldap_init</b>(3), an LDAP
  bind operation should be performed before other operations are attempted over
  the connection. An LDAP bind is required when using Version 2 of the LDAP
  protocol; it is optional for Version 3 but is usually needed due to security
  considerations.
<p class="Pp">There are three types of bind calls, ones providing simple
    authentication, ones providing SASL authentication, and general routines
    capable of doing either simple or SASL authentication.</p>
<p class="Pp"><b>SASL</b> (Simple Authentication and Security Layer) can
    negotiate one of many different kinds of authentication. Both synchronous
    and asynchronous versions of each variant of the bind call are provided. All
    routines take <i>ld</i> as their first parameter, as returned from
    <b>ldap_init</b>(3).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SIMPLE_AUTHENTICATION"><a class="permalink" href="#SIMPLE_AUTHENTICATION">SIMPLE
  AUTHENTICATION</a></h1>
The simplest form of the bind call is <b>ldap_simple_bind_s()</b>. It takes the
  DN to bind as in <i>who</i>, and the userPassword associated with the entry in
  <i>passwd</i>. It returns an LDAP error indication (see <b>ldap_error</b>(3)).
  The <b>ldap_simple_bind()</b> call is asynchronous, taking the same parameters
  but only initiating the bind operation and returning the message id of the
  request it sent. The result of the operation can be obtained by a subsequent
  call to <b>ldap_result</b>(3).
</section>
<section class="Sh">
<h1 class="Sh" id="GENERAL_AUTHENTICATION"><a class="permalink" href="#GENERAL_AUTHENTICATION">GENERAL
  AUTHENTICATION</a></h1>
The <b>ldap_bind()</b> and <b>ldap_bind_s()</b> routines can be used when the
  authentication method to use needs to be selected at runtime. They both take
  an extra <i>method</i> parameter selecting the authentication method to use.
  It should be set to LDAP_AUTH_SIMPLE to select simple authentication.
  <b>ldap_bind()</b> returns the message id of the request it initiates.
  <b>ldap_bind_s()</b> returns an LDAP error indication.
</section>
<section class="Sh">
<h1 class="Sh" id="SASL_AUTHENTICATION"><a class="permalink" href="#SASL_AUTHENTICATION">SASL
  AUTHENTICATION</a></h1>
For SASL binds the server always ignores any provided DN, so the <i>dn</i>
  parameter should always be NULL. <b>ldap_sasl_bind_s</b>() sends a single SASL
  bind request with the given SASL <i>mechanism</i> and credentials in the
  <i>cred</i> parameter. The format of the credentials depends on the particular
  SASL mechanism in use. For mechanisms that provide mutual authentication the
  server's credentials will be returned in the <i>servercredp</i> parameter. The
  routine returns an LDAP error indication (see <b>ldap_error</b>(3)). The
  <b>ldap_sasl_bind</b>() call is asynchronous, taking the same parameters but
  only sending the request and returning the message id of the request it sent.
  The result of the operation can be obtained by a subsequent call to
  <b>ldap_result</b>(3). The result must be additionally parsed by
  <b>ldap_parse_sasl_bind_result</b>() to obtain any server credentials sent
  from the server.
<p class="Pp">Many SASL mechanisms require multiple message exchanges to perform
    a complete authentication. Applications should generally use
    <b>ldap_sasl_interactive_bind_s</b>() rather than calling the basic
    <b>ldap_sasl_bind</b>() functions directly. The <i>mechs</i> parameter
    should contain a space-separated list of candidate mechanisms to use. If
    this parameter is NULL or empty the library will query the
    supportedSASLMechanisms attribute from the server's rootDSE for the list of
    SASL mechanisms the server supports. The <i>flags</i> parameter controls the
    interaction used to retrieve any necessary SASL authentication parameters
    and should be one of:</p>
<dl class="Bl-tag">
  <dt>LDAP_SASL_AUTOMATIC</dt>
  <dd>use defaults if available, prompt otherwise</dd>
  <dt>LDAP_SASL_INTERACTIVE</dt>
  <dd>always prompt</dd>
  <dt>LDAP_SASL_QUIET</dt>
  <dd>never prompt</dd>
</dl>
<p class="Pp">The <i>interact</i> function uses the provided <i>defaults</i> to
    handle requests from the SASL library for particular authentication
    parameters. There is no defined format for the <i>defaults</i> information;
    it is up to the caller to use whatever format is appropriate for the
    supplied <i>interact</i> function. The <i>sasl_interact</i> parameter comes
    from the underlying SASL library. When used with Cyrus SASL this is an array
    of <b>sasl_interact_t</b> structures. The Cyrus SASL library will prompt for
    a variety of inputs, including:</p>
<dl class="Bl-tag">
  <dt>SASL_CB_GETREALM</dt>
  <dd>the realm for the authentication attempt</dd>
  <dt>SASL_CB_AUTHNAME</dt>
  <dd>the username to authenticate</dd>
  <dt>SASL_CB_PASS</dt>
  <dd>the password for the provided username</dd>
  <dt>SASL_CB_USER</dt>
  <dd>the username to use for proxy authorization</dd>
  <dt>SASL_CB_NOECHOPROMPT</dt>
  <dd>generic prompt for input with input echoing disabled</dd>
  <dt>SASL_CB_ECHOPROMPT</dt>
  <dd>generic prompt for input with input echoing enabled</dd>
  <dt>SASL_CB_LIST_END</dt>
  <dd>indicates the end of the array of prompts</dd>
</dl>
<p class="Pp">See the Cyrus SASL documentation for more details.</p>
<p class="Pp">Applications which need to manage connections asynchronously may
    use <b>ldap_sasl_interactive_bind</b>() instead of the synchronous version.
    A valid mechs parameter must be supplied, otherwise the library will be
    forced to query the server for a list of supported mechanisms, and this
    query will be performed synchronously. The other parameters are the same as
    for the synchronous function, with three additional parameters. The actual
    SASL mechanism that was used, and the message ID for use with
    <b>ldap_result</b>() will be returned in rmechp and msgidp, respectively.
    The value in rmechp must not be modified by the caller and must be passed
    back on each subsequent call. The message obtained from <b>ldap_result</b>()
    must be passed in the result parameter. This parameter must be NULL when
    initiating a new Bind. The caller must free the result message after each
    call using <b>ldap_msgfree</b>(). The <b>ldap_sasl_interactive_bind</b>()
    function returns an LDAP result code. If the code is
    LDAP_SASL_BIND_IN_PROGRESS then the Bind is not complete yet, and this
    function must be called again with the next result from the server.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="REBINDING"><a class="permalink" href="#REBINDING">REBINDING</a></h1>
The <b>ldap_set_rebind_proc</b> function() sets the process to use for binding
  when an operation returns a referral. This function is used when an
  application needs to bind to another server in order to follow a referral or
  search continuation reference.
<p class="Pp">The function takes <i>ld</i>, the <i>rebind</i> function, and the
    <i>params</i>, the arbitrary data like state information which the client
    might need to properly rebind. The LDAP_OPT_REFERRALS option in the
    <i>ld</i> must be set to ON for the libraries to use the rebind function.
    Use the <b>ldap_set_option</b> function to set the value.</p>
<p class="Pp">The rebind function parameters are as follows:</p>
<p class="Pp">The <i>ld</i> parameter must be used by the application when
    binding to the referred server if the application wants the libraries to
    follow the referral.</p>
<p class="Pp">The <i>url</i> parameter points to the URL referral string
    received from the LDAP server. The LDAP application can use the
    <b>ldap_url_parse</b>(3) function to parse the string into its
  components.</p>
<p class="Pp">The <i>request</i> parameter specifies the type of request that
    generated the referral.</p>
<p class="Pp">The <i>msgid</i> parameter specifies the message ID of the request
    generating the referral.</p>
<p class="Pp">The <i>params</i> parameter is the same value as passed originally
    to the <b>ldap_set_rebind_proc</b>() function.</p>
<p class="Pp">The LDAP libraries set all the parameters when they call the
    rebind function. The application should not attempt to free either the ld or
    the url structures in the rebind function.</p>
<p class="Pp">The application must supply to the rebind function the required
    authentication information such as, user name, password, and certificates.
    The rebind function must use a synchronous bind method.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="UNBINDING"><a class="permalink" href="#UNBINDING">UNBINDING</a></h1>
The <b>ldap_unbind()</b> call is used to unbind from the directory, terminate
  the current association, and free the resources contained in the <i>ld</i>
  structure. Once it is called, the connection to the LDAP server is closed, and
  the <i>ld</i> structure is invalid. The <b>ldap_unbind_s()</b> call is just
  another name for <b>ldap_unbind()</b>; both of these calls are synchronous in
  nature.
<p class="Pp">The <b>ldap_unbind_ext()</b> and <b>ldap_unbind_ext_s()</b> allows
    the operations to specify controls.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ERRORS"><a class="permalink" href="#ERRORS">ERRORS</a></h1>
Asynchronous routines will return -1 in case of error, setting the
  <i>ld_errno</i> parameter of the <i>ld</i> structure. Synchronous routines
  return whatever <i>ld_errno</i> is set to. See <b>ldap_error</b>(3) for more
  information.
</section>
<section class="Sh">
<h1 class="Sh" id="NOTES"><a class="permalink" href="#NOTES">NOTES</a></h1>
If an anonymous bind is sufficient for the application, the rebind process need
  not be provided. The LDAP libraries with the LDAP_OPT_REFERRALS option set to
  ON (default value) will automatically follow referrals using an anonymous
  bind.
<p class="Pp">If the application needs stronger authentication than an anonymous
    bind, you need to provide a rebind process for that authentication method.
    The bind method must be synchronous.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<b>ldap</b>(3), <b>ldap_error</b>(3), <b>ldap_open</b>(3),
  <b>ldap_set_option</b>(3), <b>ldap_url_parse</b>(3) <b>RFC 4422</b>
  (http://www.rfc-editor.org), <b>Cyrus SASL</b> (http://asg.web.cmu.edu/sasl/)
</section>
<section class="Sh">
<h1 class="Sh" id="ACKNOWLEDGEMENTS"><a class="permalink" href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a></h1>
<b>OpenLDAP Software</b> is developed and maintained by The OpenLDAP Project
  &lt;http://www.openldap.org/&gt;. <b>OpenLDAP Software</b> is derived from
  University of Michigan LDAP 3.3 Release.
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2011/11/24</td>
    <td class="foot-os">OpenLDAP 2.4.28</td>
  </tr>
</table>
</body>
</html>
