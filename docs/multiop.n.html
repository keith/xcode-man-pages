<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   The definitions below are for supplemental macros used in Tcl/Tk
   manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO
  	Start of list of standard options for a Tk widget.  The
  	options follow on successive lines, in four columns separated
  	by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   RCS: @(#) $Id: man.macros,v 1.1 2009/01/30 04:56:47 andreas_kupries Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>fileutil::multi::op(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">fileutil::multi::op(n)</td>
    <td class="head-vol">file utilities</td>
    <td class="head-rtitle">fileutil::multi::op(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>
</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">fileutil::multi::op - Multi-file operation, scatter/gather</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">package require <b>Tcl 8.4</b></p>
<p class="Pp">package require <b>fileutil::multi::op ?0.5.3?</b></p>
<p class="Pp">package require <b>wip ?1.0?</b></p>
<p class="Pp"><b>::fileutil::multi::op</b> ?<i>opName</i>? ?<i>word</i>...?</p>
<p class="Pp"><b>opName</b> <i>option</i> ?<i>arg arg ...</i>?</p>
<p class="Pp"><b>$opName</b> <b>do</b> ?<i>word</i>...?</p>
<p class="Pp"><b>into</b> <i>directory</i></p>
<p class="Pp"><b>in</b> <i>directory</i></p>
<p class="Pp"><b>to</b> <i>directory</i></p>
<p class="Pp"><b>from</b> <i>directory</i></p>
<p class="Pp"><b>not</b> <i>pattern</i></p>
<p class="Pp"><b>for</b> <i>pattern</i></p>
<p class="Pp"><b>exclude</b> <i>pattern</i></p>
<p class="Pp"><b>but</b></p>
<p class="Pp"><b>except</b></p>
<p class="Pp"><b>as</b> <i>name</i></p>
<p class="Pp"><b>recursive</b></p>
<p class="Pp"><b>recursively</b></p>
<p class="Pp"><b>copy</b></p>
<p class="Pp"><b>move</b></p>
<p class="Pp"><b>remove</b></p>
<p class="Pp"><b>expand</b></p>
<p class="Pp"><b>invoke</b> <i>cmdprefix</i></p>
<p class="Pp"><b>reset</b></p>
<p class="Pp"><b>(</b></p>
<p class="Pp"><b>)</b></p>
<p class="Pp"><b>cd</b> <i>directory</i></p>
<p class="Pp"><b>up</b></p>
<p class="Pp"><b>for-windows</b></p>
<p class="Pp"><b>for-win</b></p>
<p class="Pp"><b>for-unix</b></p>
<p class="Pp"><b>the</b> <i>pattern</i></p>
<p class="Pp"><b>the-set</b> <i>varname</i></p>
<p class="Pp"><b>-&gt;</b> <i>varname</i></p>
<p class="Pp"><b>strict</b></p>
<p class="Pp"><b>!strict</b></p>
<p class="Pp"><b>files</b></p>
<p class="Pp"><b>links</b></p>
<p class="Pp"><b>directories</b></p>
<p class="Pp"><b>dirs</b></p>
<p class="Pp"><b>all</b></p>
<p class="Pp"><b>state?</b></p>
<p class="Pp"><b>as?</b></p>
<p class="Pp"><b>excluded?</b></p>
<p class="Pp"><b>from?</b></p>
<p class="Pp"><b>into?</b></p>
<p class="Pp"><b>operation?</b></p>
<p class="Pp"><b>recursive?</b></p>
<p class="Pp"><b>strict?</b></p>
<p class="Pp"><b>type?</b></p>
<p class="Pp"></p>
<pre>
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This package provides objects which are able to perform actions on
    multiple files selected by glob patterns.</p>
<p class="Pp">At the core is a domain specific language allowing the easy
    specification of multi-file copy and/or move and/or deletion operations.
    Alternate names would be scatter/gather processor, or maybe even
  assembler.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CLASS_API"><a class="permalink" href="#CLASS_API">CLASS
  API</a></h1>
<p class="Pp">The main command of the package is:</p>
<dl class="Bl-tag">
  <dt><b>::fileutil::multi::op</b> ?<i>opName</i>? ?<i>word</i>...?</dt>
  <dd>The command creates a new multi-file operation object with an associated
      global Tcl command whose name is <i>opName</i>. This command can be used
      to invoke the various possible file operations. It has the following
      general form:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="opName"><a class="permalink" href="#opName"><b>opName</b>
    <i>option</i> ?<i>arg arg ...</i>?</a></dt>
  <dd><i>Option</i> and the <i>arg</i>s determine the exact behavior of the
      command.</dd>
</dl>
</div>
<p class="Pp">If the string <b>%AUTO%</b> is used as the <i>opName</i> then the
    package will generate a unique name on its own.</p>
<p class="Pp">If one or more <i>word</i>s are specified they are interpreted as
    an initial set of file commands to execute. I.e. the method <b>do</b> of the
    newly constructed object is implicitly invoked using the words as its
    arguments.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OBJECT_API"><a class="permalink" href="#OBJECT_API">OBJECT
  API</a></h1>
<p class="Pp">The following methods are possible for multi-file operation
    objects:</p>
<dl class="Bl-tag">
  <dt><b>$opName</b> <b>do</b> ?<i>word</i>...?</dt>
  <dd>This method interprets the specified words as file commands to execute.
      See the section <b>FILE API</b> for the set of acceptable commands, their
      syntax, and semantics.
    <p class="Pp">The result of the method is the result generated by the last
        file command it executed.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="FILE_API"><a class="permalink" href="#FILE_API">FILE
  API</a></h1>
<p class="Pp">Both object constructor and method <b>do</b> take a list of words
    and interpret them as file commands to execute. The names were chosen to
    allow the construction of operations as sentences in near-natural language.
    Most of the commands influence just the state of the object, i.e. are simply
    providing the configuration used by the command triggering the actual
    action.</p>
<dl class="Bl-tag">
  <dt id="into"><a class="permalink" href="#into"><b>into</b>
    <i>directory</i></a></dt>
  <dd>Specifies the destination directory for operations.</dd>
  <dt id="in"><a class="permalink" href="#in"><b>in</b>
    <i>directory</i></a></dt>
  <dd>Alias for <b>into</b>.</dd>
  <dt id="to"><a class="permalink" href="#to"><b>to</b>
    <i>directory</i></a></dt>
  <dd>Alias for <b>into</b>.</dd>
  <dt id="from"><a class="permalink" href="#from"><b>from</b>
    <i>directory</i></a></dt>
  <dd>Specifies the source directory for operations.</dd>
  <dt id="not"><a class="permalink" href="#not"><b>not</b>
    <i>pattern</i></a></dt>
  <dd>Specifies a glob pattern for paths to be excluded from the operation.</dd>
  <dt id="for"><a class="permalink" href="#for"><b>for</b>
    <i>pattern</i></a></dt>
  <dd>Alias for <b>not</b>.</dd>
  <dt id="exclude"><a class="permalink" href="#exclude"><b>exclude</b>
    <i>pattern</i></a></dt>
  <dd>Alias for <b>not</b>.</dd>
  <dt id="but"><a class="permalink" href="#but"><b>but</b></a></dt>
  <dd>Has no arguments of its own, but looks ahead in the list of words and
      executes all <b>not</b> commands immediately following it. This allows the
      construction of &quot;but not&quot; and &quot;but exclude&quot; clauses
      for a more natural sounding specification of excluded paths.</dd>
  <dt id="except"><a class="permalink" href="#except"><b>except</b></a></dt>
  <dd>A semi-alias for <b>but</b>. Has no arguments of its own, but looks ahead
      in the list of words and executes all <b>for</b> commands immediately
      following it. This allows the construction of &quot;except for&quot;
      clauses for a more natural sounding specification of excluded paths.</dd>
  <dt id="as"><a class="permalink" href="#as"><b>as</b> <i>name</i></a></dt>
  <dd>Specifies a new name for the first file handled by the current operation.
      I.e. for the renaming of a single file during the operation.</dd>
  <dt id="recursive"><a class="permalink" href="#recursive"><b>recursive</b></a></dt>
  <dd>Signals that file expansion should happen in the whole directory hierarchy
      and not just the directory itself.</dd>
  <dt id="recursively"><a class="permalink" href="#recursively"><b>recursively</b></a></dt>
  <dd>An alias for <b>recursive</b>.</dd>
  <dt id="copy"><a class="permalink" href="#copy"><b>copy</b></a></dt>
  <dd>Signals that the operation is the copying of files from source to
      destination directory per the specified inclusion and exclusion
    patterns.</dd>
  <dt id="move"><a class="permalink" href="#move"><b>move</b></a></dt>
  <dd>Signals that the operation is the moving of files from source to
      destination directory per the specified inclusion and exclusion
    patterns.</dd>
  <dt id="remove"><a class="permalink" href="#remove"><b>remove</b></a></dt>
  <dd>Signals that the operation is the removal of files in the destination
      directory per the specified inclusion and exclusion patterns.</dd>
  <dt id="expand"><a class="permalink" href="#expand"><b>expand</b></a></dt>
  <dd>Signals that there is no operation but the calculation of the set of files
      from the include and exclude patterns. This operation is not available if
      <b>the-set</b> is used.</dd>
  <dt id="invoke"><a class="permalink" href="#invoke"><b>invoke</b>
    <i>cmdprefix</i></a></dt>
  <dd>Signals that the user-specified command prefix <i>cmdprefix</i> is the
      operation to perform. The command prefix is executed at the global level
      and given the source directory, destination directory, and set of files
      (as dictionary mapping from source to destination files), in this
    order.</dd>
  <dt id="reset"><a class="permalink" href="#reset"><b>reset</b></a></dt>
  <dd>Forces the object into the ground state where all parts of the
      configuration have default values.</dd>
  <dt><b>(</b></dt>
  <dd>Saves a copy of the current object state on a stack.</dd>
  <dt><b>)</b></dt>
  <dd>Takes the state at the top of the state stack and restores it, i.e. makes
      it the new current object state.</dd>
  <dt id="cd"><a class="permalink" href="#cd"><b>cd</b>
    <i>directory</i></a></dt>
  <dd>Changes the destination directory to the sub-directory <i>directory</i> of
      the current destination.</dd>
  <dt id="up"><a class="permalink" href="#up"><b>up</b></a></dt>
  <dd>Changes the destination directory to the parent directory of the current
      destination.</dd>
  <dt id="for_windows"><a class="permalink" href="#for_windows"><b>for-windows</b></a></dt>
  <dd>Checks that Windows is the current platform. Aborts processing if
    not.</dd>
  <dt id="for_win"><a class="permalink" href="#for_win"><b>for-win</b></a></dt>
  <dd>An alias for <b>for-windows</b>.</dd>
  <dt id="for_unix"><a class="permalink" href="#for_unix"><b>for-unix</b></a></dt>
  <dd>Checks that Unix is the current platform. Aborts processing if not.</dd>
  <dt id="the"><a class="permalink" href="#the"><b>the</b>
    <i>pattern</i></a></dt>
  <dd>This command specifies the files to operate on per a glob pattern, and is
      also the active element, i.e. the command which actually performs the
      specified operation. All the other commands only modified the object state
      to set the operation up, but di nothing else.
    <p class="Pp">To allow for a more natural sounding syntax this command also
        looks ahead in the list of words looks and executes several commands
        immediately following it before performing its own actions. These
        commands are <b>as</b>, <b>but</b>, <b>exclude</b>, <b>except</b>,
        <b>from</b>, and <b>into</b> (and aliases). That way these commands act
        like qualifiers, and still take effect as if they had been written
        before this command.</p>
    <p class="Pp">After the operation has been performed the object state the
        exclude patterns and the alias name, if specified, are reset to their
        default values (i.e. empty), but nothing else.</p>
  </dd>
  <dt id="the_set"><a class="permalink" href="#the_set"><b>the-set</b>
    <i>varname</i></a></dt>
  <dd>Like <b>the</b>, however the set of files to use is not specified
      implicitly per a glob pattern, but contained and loaded from the specified
      variable. The operation <b>expand</b> is not available if this command is
      used.</dd>
  <dt><b>-&gt;</b> <i>varname</i></dt>
  <dd>Saves the set of files from the last expansion into the specified
      variable.</dd>
  <dt id="strict"><a class="permalink" href="#strict"><b>strict</b></a></dt>
  <dd>Make file expansion and definition of destination directory (<b>in</b> and
      aliases) strict, i.e. report errors for missing directories, and empty
      expansion.</dd>
  <dt><b>!strict</b></dt>
  <dd>Complement of <b>strict</b>. A missing destination directory or empty
      expansion are not reported as errors.</dd>
  <dt id="files"><a class="permalink" href="#files"><b>files</b></a></dt>
  <dd>Limit the search to files. Default is to accept every type of path.</dd>
  <dt id="links"><a class="permalink" href="#links"><b>links</b></a></dt>
  <dd>Limit the search to symbolic links. Default is to accept every type of
      path.</dd>
  <dt id="directories"><a class="permalink" href="#directories"><b>directories</b></a></dt>
  <dd>Limit the search to directories. Default is to accept every type of
    path.</dd>
  <dt id="dirs"><a class="permalink" href="#dirs"><b>dirs</b></a></dt>
  <dd>An alias for <b>directories</b>.</dd>
  <dt id="all"><a class="permalink" href="#all"><b>all</b></a></dt>
  <dd>Accept all types of paths (default).</dd>
  <dt id="state?"><a class="permalink" href="#state?"><b>state?</b></a></dt>
  <dd>Returns the current state of the object as dictionary. The dictionary keys
      and their meanings are:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="as~2"><a class="permalink" href="#as~2"><b>as</b></a></dt>
  <dd>Last setting made by <b>as</b>.</dd>
  <dt id="excluded"><a class="permalink" href="#excluded"><b>excluded</b></a></dt>
  <dd>List of currently known exclusion patterns.</dd>
  <dt id="from~2"><a class="permalink" href="#from~2"><b>from</b></a></dt>
  <dd>Current source directory, set by <b>from</b>.</dd>
  <dt id="into~2"><a class="permalink" href="#into~2"><b>into</b></a></dt>
  <dd>Current destination directory, set by <b>into</b> (and aliases).</dd>
  <dt id="operation"><a class="permalink" href="#operation"><b>operation</b></a></dt>
  <dd>Current operation to perform, set by <b>copy</b>, <b>move</b>,
      <b>remove</b>, <b>expand</b>, or <b>invoke</b>.</dd>
  <dt id="recursive~2"><a class="permalink" href="#recursive~2"><b>recursive</b></a></dt>
  <dd>Current recursion status. Set/unset by <b>recursive</b> and
      <b>!recursive</b>.</dd>
  <dt id="strict~2"><a class="permalink" href="#strict~2"><b>strict</b></a></dt>
  <dd>Current strictness. Set/unset by <b>strict</b> and <b>!strict</b>.</dd>
  <dt id="type"><a class="permalink" href="#type"><b>type</b></a></dt>
  <dd>Current path type limiter. Set by either <b>files</b>, <b>directories</b>,
      <b>links</b>, or <b>all</b>.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="as?"><a class="permalink" href="#as?"><b>as?</b></a></dt>
  <dd>Returns the current alias name.</dd>
  <dt id="excluded?"><a class="permalink" href="#excluded?"><b>excluded?</b></a></dt>
  <dd>Returns the current set of exclusion patterns.</dd>
  <dt id="from?"><a class="permalink" href="#from?"><b>from?</b></a></dt>
  <dd>Returns the current source directory.</dd>
  <dt id="into?"><a class="permalink" href="#into?"><b>into?</b></a></dt>
  <dd>Returns the current destination directory.</dd>
  <dt id="operation?"><a class="permalink" href="#operation?"><b>operation?</b></a></dt>
  <dd>Returns the current operation to perform.</dd>
  <dt id="recursive?"><a class="permalink" href="#recursive?"><b>recursive?</b></a></dt>
  <dd>Returns the current recursion status.</dd>
  <dt id="strict?"><a class="permalink" href="#strict?"><b>strict?</b></a></dt>
  <dd>Returns the current strictness.</dd>
  <dt id="type?"><a class="permalink" href="#type?"><b>type?</b></a></dt>
  <dd>Returns the current path type limiter.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">The following examples assume that the variable <b>F</b> contains
    a reference to a multi-file operation object.</p>
<pre>
<br/>
    $F do copy                       \\
	the  *.dll                    \\
	from c:/TDK/PrivateOpenSSL/bin \\
	to   [installdir_of tls]
</pre>
<pre>
<br/>
    $F do move      \\
	the  *       \\
	from /sources \\
	into /scratch  \\
	but not *.html
<br/>
    # Alternatively use 'except for *.html'.
</pre>
<pre>
<br/>
    $F do           \\
	move         \\
	the  index    \\
	from /sources  \\
	into /scratch   \\
	as   pkgIndex.tcl
</pre>
<pre>
<br/>
    $F do         \\
	remove     \\
	the *.txt  \\
	in /scratch
</pre>
<p class="Pp">Note that the fact that most commands just modify the object state
    allows us to use more off forms as specifications instead of just
    nearly-natural language sentences. For example the second example in this
    section can re-arranged into:</p>
<pre>
<br/>
    $F do            \\
	from /sources \\
	into /scratch  \\
	but not *.html \\
	move           \\
	the  *
</pre>
<p class="Pp">and the result is not only still a valid specification, but even
    stays relatively readable.</p>
<p class="Pp">Further note that the information collected by the commands
    <b>but</b>, <b>except</b>, and <b>as</b> is automatically reset after the
    associated <b>the</b> was executed. However no other state is reset in that
    manner, allowing the user to avoid repetitions of unchanging information.
    For example the second and third examples of this section can be merged and
    rewritten into the equivalent:</p>
<pre>
$F do                   \\
<br/>
    move                 \\
<br/>
    the  *                \\
<br/>
    from /sources          \\
<br/>
    into /scratch           \\
<br/>
    but not *.html not index \\
<br/>
    the  index               \\
<br/>
    as   pkgIndex.tcl
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS,_IDEAS,_FEEDBACK"><a class="permalink" href="#BUGS,_IDEAS,_FEEDBACK">BUGS,
  IDEAS, FEEDBACK</a></h1>
<p class="Pp">This document, and the package it describes, will undoubtedly
    contain bugs and other problems. Please report such in the category
    <i>fileutil</i> of the <i>Tcllib SF Trackers</i>
    [http://sourceforge.net/tracker/?group_id=12883]. Please also report any
    ideas for enhancements you may have for either package and/or
  documentation.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
<p class="Pp">copy, file utilities, move, multi-file, remove</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CATEGORY"><a class="permalink" href="#CATEGORY">CATEGORY</a></h1>
<p class="Pp">Programming tools</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">0.5.3</td>
    <td class="foot-os">fileutil</td>
  </tr>
</table>
</body>
</html>
