<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Generated from file '/Library/Caches/com.apple.xbs/Sources/tcl/tcl-129.40.1/tcl_ext/tcllib/tcllib/modules/imap4/imap4.man' by tcllib/doctools with format 'nroff'
  
   The definitions below are for supplemental macros used in Tcl/Tk
   manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO
  	Start of list of standard options for a Tk widget.  The
  	options follow on successive lines, in four columns separated
  	by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   RCS: @(#) $Id: man.macros,v 1.1 2009/01/30 04:56:47 andreas_kupries Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
  	# Start an argument description
  .b
  	# define tabbing values for .AP
  
  	# BS - start boxed text
  	# ^y = starting y location
  	# ^b = 1
  	# BE - end boxed text (draw box now)
  	Draw four-sided box normally, but don't draw top of
  	box if the box started on an earlier page.
  	# VS - start vertical sidebar
  	# ^Y = starting y location
  	# ^v = 1 (for troff;  for nroff this doesn't matter)
  	# VE - end of vertical sidebar
  	# Special macro to handle page bottom:  finish off current
  	# box/sidebar if in box/sidebar mode, then invoked standard
  	# page bottom macro.
  	Draw three-sided box if this is the box's first page,
  	draw two sides but no top otherwise.
  	# DS - begin display
  	# DE - end display
  	# SO - start of list of standard options
  	# SE - end of list of standard options
  	# OP - start of full description for a single option
  	# CS - begin code excerpt
  	# CE - end code excerpt
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>imap4(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">imap4(n)</td>
    <td class="head-vol">imap client</td>
    <td class="head-rtitle">imap4(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>

</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
imap4 - imap client-side tcl implementation of imap protocol
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
package require <b>Tcl 8.5</b>
<p class="Pp">package require <b>imap4 ?0.3?</b></p>
<p class="Pp"><b>::imap4::open</b> <i>hostname</i> ?<i>port</i>?</p>
<p class="Pp"><b>::imap4::login</b> <i>chan</i> <i>user</i> <i>pass</i></p>
<p class="Pp"><b>::imap4::folders</b> <i>chan</i> ?<i>-inline</i>?
    ?<i>mboxref</i>? ?<i>mboxname</i>?</p>
<p class="Pp"><b>::imap4::select</b> <i>chan</i> ?<i>mailbox</i>?</p>
<p class="Pp"><b>::imap4::examine</b> <i>chan</i> ?<i>mailbox</i>?</p>
<p class="Pp"><b>::imap4::fetch</b> <i>chan</i> <i>range</i> ?<i>-inline</i>?
    ?<i>attr ...</i>?</p>
<p class="Pp"><b>::imap4::noop</b> <i>chan</i></p>
<p class="Pp"><b>::imap4::check</b> <i>chan</i></p>
<p class="Pp"><b>::imap4::folderinfo</b> <i>chan</i> ?<i>info</i>?</p>
<p class="Pp"><b>::imap4::msginfo</b> <i>chan</i> <i>msgid</i> ?<i>info</i>?
    ?<i>defval</i>?</p>
<p class="Pp"><b>::imap4::mboxinfo</b> <i>chan</i> ?<i>info</i>?</p>
<p class="Pp"><b>::imap4::isableto</b> <i>chan</i> ?<i>capability</i>?</p>
<p class="Pp"><b>::imap4::create</b> <i>chan</i> <i>mailbox</i></p>
<p class="Pp"><b>::imap4::delete</b> <i>chan</i> <i>mailbox</i></p>
<p class="Pp"><b>::imap4::rename</b> <i>chan</i> <i>oldname</i>
  <i>newname</i></p>
<p class="Pp"><b>::imap4::subscribe</b> <i>chan</i> <i>mailbox</i></p>
<p class="Pp"><b>::imap4::unsubscribe</b> <i>chan</i> <i>mailbox</i></p>
<p class="Pp"><b>::imap4::search</b> <i>chan</i> <i>expr</i> ?<i>...</i>?</p>
<p class="Pp"><b>::imap4::close</b> <i>chan</i></p>
<p class="Pp"><b>::imap4::cleanup</b> <i>chan</i></p>
<p class="Pp"><b>::imap4::debugmode</b> <i>chan</i> ?<i>errormsg</i>?</p>
<p class="Pp"></p>
<pre>

</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>imap4</b> library package provides the client side of the <i>Internet
  Message Access Protocol</i> (IMAP) using standard sockets or secure connection
  via TLS/SSL. The package is fully implemented in Tcl.
<p class="Pp">This document describes the procedures and explains their
  usage.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="PROCEDURES"><a class="permalink" href="#PROCEDURES">PROCEDURES</a></h1>
This package defines the following public procedures:
<dl class="Bl-tag">
  <dt><b>::imap4::open</b> <i>hostname</i> ?<i>port</i>?</dt>
  <dd>
    <p class="Pp">Open a new IMAP connection and initalize the handler, the imap
        communication channel (handler) is returned.</p>
    <p class="Pp"><i>hostname</i> - mail server</p>
    <p class="Pp"><i>port</i> - connection port, defaults to 143</p>
    <p class="Pp">The namespace variable <b>::imap4::use_ssl</b> can be used to
        establish to a secure connection via TSL/SSL if set to true. In this
        case default connection port defaults to 993.</p>
    <p class="Pp"><i>Note:</i> For connecting via SSL the Tcl module <i>tls</i>
        must be already loaded otherwise an error is raised.</p>
    <pre>
    package require tls              ; # must be loaded for TLS/SSL
    set ::imap4::use_ssl 1           ; # request a secure connection
    set chan [::imap4::open $server] ; # default port is now 993
    </pre>
  </dd>
  <dt><b>::imap4::login</b> <i>chan</i> <i>user</i> <i>pass</i></dt>
  <dd>
    <p class="Pp">Login using the IMAP LOGIN command, 0 is returned on
        successful login.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>user</i> - username</p>
    <p class="Pp"><i>pass</i> - password</p>
  </dd>
  <dt><b>::imap4::folders</b> <i>chan</i> ?<i>-inline</i>? ?<i>mboxref</i>?
    ?<i>mboxname</i>?</dt>
  <dd>
    <p class="Pp">Get list of matching folders, 0 is returned on success.</p>
    <p class="Pp">Wildcards '*' as '%' are allowed for <i>mboxref</i> and
        <i>mboxname</i>, command <b>::imap4::folderinfo</b> can be used to
        retrieve folder information.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mboxref</i> - mailbox reference, defaults to
      &quot;&quot;</p>
    <p class="Pp"><i>mboxname</i> - mailbox name, defaults to &quot;*&quot;</p>
    <p class="Pp">If <b>-inline</b> is specified a compact folderlist is
        returned instead of the result code. All flags are converted to
        lowercase and leading special characters are removed.</p>
    <pre>
{{Arc08 noselect} {Arc08/Private {noinferiors unmarked}} {INBOX noinferiors}}
    </pre>
  </dd>
  <dt><b>::imap4::select</b> <i>chan</i> ?<i>mailbox</i>?</dt>
  <dd>
    <p class="Pp">Select a mailbox, 0 is returned on success.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mailbox</i> - Path of the mailbox, defaults to
      <i>INBOX</i></p>
    <p class="Pp">Prior to examine/select an open mailbox must be closed - see:
        <b>::imap4::close</b>.</p>
  </dd>
  <dt><b>::imap4::examine</b> <i>chan</i> ?<i>mailbox</i>?</dt>
  <dd>
    <p class="Pp">&quot;Examines&quot; a mailbox, read-only equivalent of
        <b>::imap4::select</b>.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mailbox</i> - mailbox name or path to mailbox, defaults to
        <i>INBOX</i></p>
    <p class="Pp">Prior to examine/select an open mailbox must be closed - see:
        <b>::imap4::close</b>.</p>
  </dd>
  <dt><b>::imap4::fetch</b> <i>chan</i> <i>range</i> ?<i>-inline</i>? ?<i>attr
    ...</i>?</dt>
  <dd>
    <p class="Pp">Fetch attributes from messages.</p>
    <p class="Pp">The attributes are fetched and stored in the internal state
        which can be retrieved with command <b>::imap4::msginfo</b>, 0 is
        returned on success. If <b>-inline</b> is specified, alle records are
        returned as list in order as defined in the <i>attr</i> argument.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>range</i> - message index in format
      <i>FROM</i>:<i>TO</i></p>
    <p class="Pp"><i>attr</i> - imap attributes to fetch</p>
    <p class="Pp"><i>Note:</i> If <i>FROM</i> is omitted, the 1st message is
        assumed, if <i>TO</i> is ommitted the last message is assumed. All
        message index ranges are 1-based.</p>
  </dd>
  <dt><b>::imap4::noop</b> <i>chan</i></dt>
  <dd>Send NOOP command to server. May get information as untagged data.
    <p class="Pp"><i>chan</i> - imap channel</p>
  </dd>
  <dt><b>::imap4::check</b> <i>chan</i></dt>
  <dd>Send CHECK command to server. Flush to disk.
    <p class="Pp"><i>chan</i> - imap channel</p>
  </dd>
  <dt><b>::imap4::folderinfo</b> <i>chan</i> ?<i>info</i>?</dt>
  <dd>
    <p class="Pp">Get information on the recently selected folderlist. If the
        <i>info</i> argument is omitted or a null string, the full list of
        information available for the mailbox is returned.</p>
    <p class="Pp">If the required information name is suffixed with a ?
        character, the command returns true if the information is available, or
        false if it is not.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>info</i> - folderlist options to retrieve</p>
    <p class="Pp">Currently supported options: <i>delim</i> - hierarchy
        delimiter only, <i>match</i> - ref and mbox search patterns (see
        <b>::imap4::folders</b>), <i>names</i> - list of folder names only,
        <i>flags</i> - list of folder names with flags in format <i>{ {name
        {flags}} ... }</i> (see also compact format in function
        <b>::imap4::folders</b>).</p>
    <pre>
{{Arc08 {{\NoSelect}}} {Arc08/Private {{\NoInferiors} {\UnMarked}}} {INBOX {\NoInferiors}}}
    </pre>
  </dd>
  <dt><b>::imap4::msginfo</b> <i>chan</i> <i>msgid</i> ?<i>info</i>?
    ?<i>defval</i>?</dt>
  <dd>
    <p class="Pp">Get information (from previously collected using fetch) from a
        given <i>msgid</i>. If the 'info' argument is omitted or a null string,
        the list of available information options for the given message is
        returned.</p>
    <p class="Pp">If the required information name is suffixed with a ?
        character, the command returns true if the information is available, or
        false if it is not.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>msgid</i> - message number</p>
    <p class="Pp"><i>info</i> - imap keyword to retrieve</p>
    <p class="Pp"><i>defval</i> - default value, returned if info is empty</p>
    <p class="Pp"><i>Note:</i> All message index ranges are 1-based.</p>
  </dd>
  <dt><b>::imap4::mboxinfo</b> <i>chan</i> ?<i>info</i>?</dt>
  <dd>
    <p class="Pp">Get information on the currently selected mailbox. If the
        <i>info</i> argument is omitted or a null string, the list of available
        information options for the mailbox is returned.</p>
    <p class="Pp">If the required information name is suffixed with a ?
        character, the command returns true if the information is available, or
        false if it is not.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>opt</i> - mailbox option to retrieve</p>
    <p class="Pp">Currently supported options: <i>EXISTS</i> (noof msgs),
        <i>RECENT</i> (noof 'recent' flagged msgs), <i>FLAGS</i></p>
    <p class="Pp">In conjunction with OK: <i>PERMFLAGS</i>, <i>UIDNEXT</i>,
        <i>UIDVAL</i>, <i>UNSEEN</i></p>
    <p class="Pp">Div. states: <i>CURRENT</i>, <i>FOUND</i>, <i>PERM</i>.</p>
    <pre>
    ::imap4::select $chan INBOX
    puts &quot;[::imap4::mboxinfo $chan exists] mails in INBOX&quot;
    </pre>
  </dd>
  <dt><b>::imap4::isableto</b> <i>chan</i> ?<i>capability</i>?</dt>
  <dd>
    <p class="Pp">Test for capability. It returns 1 if requested capability is
        supported, 0 otherwise. If <i>capability</i> is omitted all capability
        imap codes are retured as list.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>info</i> - imap keyword to retrieve</p>
    <p class="Pp"><i>Note:</i> Use the capability command to ask the server if
        not already done by the user.</p>
  </dd>
  <dt><b>::imap4::create</b> <i>chan</i> <i>mailbox</i></dt>
  <dd>
    <p class="Pp">Create a new mailbox.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mailbox</i> - mailbox name</p>
  </dd>
  <dt><b>::imap4::delete</b> <i>chan</i> <i>mailbox</i></dt>
  <dd>
    <p class="Pp">Delete a new mailbox.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mailbox</i> - mailbox name</p>
  </dd>
  <dt><b>::imap4::rename</b> <i>chan</i> <i>oldname</i> <i>newname</i></dt>
  <dd>
    <p class="Pp">Rename a new mailbox.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mailbox</i> - old mailbox name</p>
    <p class="Pp"><i>mailbox</i> - new mailbox name</p>
  </dd>
  <dt><b>::imap4::subscribe</b> <i>chan</i> <i>mailbox</i></dt>
  <dd>
    <p class="Pp">Subscribe a new mailbox.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mailbox</i> - mailbox name</p>
  </dd>
  <dt><b>::imap4::unsubscribe</b> <i>chan</i> <i>mailbox</i></dt>
  <dd>
    <p class="Pp">Unsubscribe a new mailbox.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>mailbox</i> - mailbox name</p>
  </dd>
  <dt><b>::imap4::search</b> <i>chan</i> <i>expr</i> ?<i>...</i>?</dt>
  <dd>
    <p class="Pp">Search for mails matching search criterions, 0 is returned on
        success.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>expr</i> - imap search expression</p>
    <p class="Pp"><i>Notes:</i> Currently the following search expressions are
        handled:</p>
    <p class="Pp"><i>Mail header flags:</i> all mail header entries (ending with
        a colon &quot;:&quot;), like &quot;From:&quot;, &quot;Bcc:&quot;,
      ...</p>
    <p class="Pp"><i>Imap message search flags:</i> ANSWERED, DELETED, DRAFT,
        FLAGGED, RECENT, SEEN, NEW, OLD, UNANSWERED, UNDELETED, UNDRAFT,
        UNFLAGGED, UNSEEN, ALL</p>
    <p class="Pp"><i>Imap header search flags:</i> BODY, CC, FROM, SUBJECT,
        TEXT, KEYWORD, BCC</p>
    <p class="Pp"><i>Imap conditional search flags:</i> SMALLER, LARGER, ON,
        SENTBEFORE, SENTON, SENTSINCE, SINCE, BEFORE (not implemented), UID (not
        implemented)</p>
    <p class="Pp"><i>Logical search conditions:</i> OR, NOT</p>
    <pre>
::imap4::search $chan larger 4000 seen
puts &quot;Found messages: [::imap4::mboxinfo $chan found]&quot;
Found messages: 1 3 6 7 8 9 13 14 15 19 20
    </pre>
  </dd>
  <dt><b>::imap4::close</b> <i>chan</i></dt>
  <dd>
    <p class="Pp">Close the mailbox. Permanently removes \Deleted messages and
        return to the AUTH state.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
  </dd>
  <dt><b>::imap4::cleanup</b> <i>chan</i></dt>
  <dd>
    <p class="Pp">Destroy an IMAP connection and free the used space. Close the
        mailbox. Permanently removes \Deleted messages and return to the AUTH
        state.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
  </dd>
  <dt><b>::imap4::debugmode</b> <i>chan</i> ?<i>errormsg</i>?</dt>
  <dd>Switch client into command line debug mode.
    <p class="Pp">This is a developers mode only that pass the control to the
        programmer. Every line entered is sent verbatim to the server (after the
        addition of the request identifier). The ::imap4::debug variable is
        automatically set to '1' on enter.</p>
    <p class="Pp">It's possible to execute Tcl commands starting the line with a
        slash.</p>
    <p class="Pp"><i>chan</i> - imap channel</p>
    <p class="Pp"><i>errormsg</i> - optional error message to display</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<pre>
    set user myusername
    set pass xtremescrt
    set server imap.test.tld
    set FOLDER INBOX
    # Connect to server
    set imap [::imap4::open $server]
    ::imap4::login $imap $user $pass
    ::imap4::select $imap $FOLDER
    # Output all the information about that mailbox
    foreach info [::imap4::mboxinfo $imap] {
        puts &quot;$info -&gt; [::imap4::mboxinfo $imap $info]&quot;
    }
    # fetch 3 records inline
    set fields {from: to: subject: size}
    foreach rec [::imap4::fetch $imap :3 -inline {*}$fields] {
        puts -nonewline &quot;#[incr idx])&quot;
        for {set j 0} {$j&lt;[llength $fields]} {incr j} {
            puts &quot;\t[lindex $fields $j] [lindex $rec $j]&quot;
        }
    }
    # Show all the information available about the message ID 1
    puts &quot;Available info about message 1: [::imap4::msginfo $imap 1]&quot;
    # Use the capability stuff
    puts &quot;Capabilities: [::imap4::isableto $imap]&quot;
    puts &quot;Is able to imap4rev1? [::imap4::isableto $imap imap4rev1]&quot;
    # Cleanup
    ::imap4::cleanup $imap
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="REFERENCES"><a class="permalink" href="#REFERENCES">REFERENCES</a></h1>
Mark R. Crispin, &quot;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1&quot;,
  RFC 3501, March 2003, <i>http://www.rfc-editor.org/rfc/rfc3501.txt</i>
<p class="Pp">OpenSSL, <i>http://www.openssl.org/</i></p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS,_IDEAS,_FEEDBACK"><a class="permalink" href="#BUGS,_IDEAS,_FEEDBACK">BUGS,
  IDEAS, FEEDBACK</a></h1>
This document, and the package it describes, will undoubtedly contain bugs and
  other problems. Only a small part of rfc3501 implemented.
<p class="Pp">Please report such in the category <i>imap4</i> of the <i>Tcllib
    SF Trackers</i> [http://sourceforge.net/tracker/?group_id=12883]. Please
    also report any ideas for enhancements you may have for either package
    and/or documentation.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
ftp, http, imap, mime, pop3, tls
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
email, imap, internet, mail, net, rfc3501, ssl, tls
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">0.3</td>
    <td class="foot-os">imap4</td>
  </tr>
</table>
</body>
</html>
