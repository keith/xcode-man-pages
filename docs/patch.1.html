<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
  -
   Copyright 1986, Larry Wall
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following condition
   is met:
    1. Redistributions of source code must retain the above copyright
       notice, this condition and the following disclaimer.
  
   THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
   ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
   ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
   FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
   OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
   HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
   LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
   OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
   SUCH DAMAGE.
  
   $OpenBSD: patch.1,v 1.27 2014/04/15 06:26:54 jmc Exp $
   $FreeBSD$
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>PATCH(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PATCH(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">PATCH(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">patch</code> &#x2014; <span class="Nd">apply a
    diff file to an original</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">patch</code></td>
    <td>[<code class="Fl">-bCcEeflNnRstuv</code>]
      [<code class="Fl">-B</code>&#x00A0;<var class="Ar">backup-prefix</var>]
      [<code class="Fl">-D</code>&#x00A0;<var class="Ar">symbol</var>]
      [<code class="Fl">-d</code>&#x00A0;<var class="Ar">directory</var>]
      [<code class="Fl">-g</code>&#x00A0;<var class="Ar">vcs-option</var>]
      [<code class="Fl">-F</code>&#x00A0;<var class="Ar">max-fuzz</var>]
      [<code class="Fl">-i</code>&#x00A0;<var class="Ar">patchfile</var>]
      [<code class="Fl">-o</code>&#x00A0;<var class="Ar">out-file</var>]
      [<code class="Fl">-p</code>&#x00A0;<var class="Ar">strip-count</var>]
      [<code class="Fl">-r</code>&#x00A0;<var class="Ar">rej-name</var>]
      [<code class="Fl">-V</code>&#x00A0;<code class="Cm">t</code>&#x00A0;|&#x00A0;<code class="Cm">nil</code>&#x00A0;|&#x00A0;<code class="Cm">never</code>&#x00A0;|&#x00A0;<code class="Cm">none</code>]
      [<code class="Fl">-x</code>&#x00A0;<var class="Ar">number</var>]
      [<code class="Fl">-Y</code>&#x00A0;<var class="Ar">prefix</var>]
      [<code class="Fl">-z</code>&#x00A0;<var class="Ar">backup-ext</var>]
      [<code class="Fl">--posix</code>]
      [<var class="Ar">origfile</var>&#x00A0;[<var class="Ar">patchfile</var>]]</td>
  </tr>
</table>
<br/>
<table class="Nm">
  <tr>
    <td><code class="Nm">patch</code></td>
    <td>&lt;<var class="Ar">patchfile</var></td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><code class="Nm">patch</code> will take a patch file containing
    any of the four forms of difference listing produced by the
    <a class="Xr">diff(1)</a> program and apply those differences to an original
    file, producing a patched version. If <var class="Ar">patchfile</var> is
    omitted, or is a hyphen, the patch will be read from the standard input.</p>
<p class="Pp"><code class="Nm">patch</code> will attempt to determine the type
    of the diff listing, unless overruled by a <code class="Fl">-c</code>,
    <code class="Fl">-e</code>, <code class="Fl">-n</code>, or
    <code class="Fl">-u</code> option. Context diffs (old-style, new-style, and
    unified) and normal diffs are applied directly by the
    <code class="Nm">patch</code> program itself, whereas ed diffs are simply
    fed to the <a class="Xr">ed(1)</a> editor via a pipe.</p>
<p class="Pp">If the <var class="Ar">patchfile</var> contains more than one
    patch, <code class="Nm">patch</code> will try to apply each of them as if
    they came from separate patch files. This means, among other things, that it
    is assumed that the name of the file to patch must be determined for each
    diff listing, and that the garbage before each diff listing will be examined
    for interesting things such as file names and revision level (see the
    section on <a class="Sx" href="#Filename_Determination">Filename
    Determination</a> below).</p>
<p class="Pp">The options are as follows:</p>
<dl class="Bl-tag">
  <dt id="B"><a class="permalink" href="#B"><code class="Fl">-B</code></a>
    <var class="Ar">backup-prefix</var>, <code class="Fl">--prefix</code>
    <var class="Ar">backup-prefix</var></dt>
  <dd>Causes the next argument to be interpreted as a prefix to the backup file
      name. If this argument is specified, any argument to
      <code class="Fl">-z</code> will be ignored.</dd>
  <dt id="b"><a class="permalink" href="#b"><code class="Fl">-b</code></a>,
    <code class="Fl">--backup</code></dt>
  <dd>Save a backup copy of the file before it is modified. By default the
      original file is saved with a backup extension of &quot;.orig&quot; unless
      the file already has a numbered backup, in which case a numbered backup is
      made. This is equivalent to specifying &quot;<code class="Fl">-V</code>
      <code class="Cm">existing</code>&quot;.</dd>
  <dt id="backup-if-mismatch"><a class="permalink" href="#backup-if-mismatch"><code class="Fl">--backup-if-mismatch</code></a></dt>
  <dd>Save a backup copy of the file before it is modified, but only if a
      mismatch was encountered. Specifically, this will create a backup file if
      a hunk failed to apply, or if fuzz was required to apply one or more
      hunks. As with the <code class="Fl">-b</code> option,
      <code class="Fl">--backup-if-mismatch</code> will use the
      <code class="Cm">existing</code> format that is accepted by the
      <code class="Fl">-V</code> option when a backup is to be created.
    <p class="Pp">If backups were otherwise requested with the
        <code class="Fl">-b</code> option, then this option has no effect.</p>
    <p class="Pp">This option is currently the default, unless
        <code class="Fl">--posix</code> is specified.</p>
  </dd>
  <dt id="no-backup-if-mismatch"><a class="permalink" href="#no-backup-if-mismatch"><code class="Fl">--no-backup-if-mismatch</code></a></dt>
  <dd>This option negates <code class="Fl">--backup-if-mismatch</code>, creating
      backups for every file unless backups have been disabled with
      <code class="Fl">--posix</code> or <code class="Fl">-V</code>
      <code class="Cm">none</code>.</dd>
  <dt id="C"><a class="permalink" href="#C"><code class="Fl">-C</code></a>,
    <code class="Fl">--check</code>, <code class="Fl">--dry-run</code></dt>
  <dd>Checks that the patch would apply cleanly, but does not modify
    anything.</dd>
  <dt id="c"><a class="permalink" href="#c"><code class="Fl">-c</code></a>,
    <code class="Fl">--context</code></dt>
  <dd>Forces <code class="Nm">patch</code> to interpret the patch file as a
      context diff.</dd>
  <dt id="D"><a class="permalink" href="#D"><code class="Fl">-D</code></a>
    <var class="Ar">symbol</var>, <code class="Fl">--ifdef</code>
    <var class="Ar">symbol</var></dt>
  <dd>Causes <code class="Nm">patch</code> to use the
      &quot;#ifdef...#endif&quot; construct to mark changes. The argument
      following will be used as the differentiating symbol. Note that, unlike
      the C compiler, there must be a space between the
      <code class="Fl">-D</code> and the argument.</dd>
  <dt id="d"><a class="permalink" href="#d"><code class="Fl">-d</code></a>
    <var class="Ar">directory</var>, <code class="Fl">--directory</code>
    <var class="Ar">directory</var></dt>
  <dd>Causes <code class="Nm">patch</code> to interpret the next argument as a
      directory, and change the working directory to it before doing anything
      else.</dd>
  <dt id="E"><a class="permalink" href="#E"><code class="Fl">-E</code></a>,
    <code class="Fl">--remove-empty-files</code></dt>
  <dd>Causes <code class="Nm">patch</code> to remove output files that are empty
      after the patches have been applied. This option is useful when applying
      patches that create or remove files.</dd>
  <dt id="e"><a class="permalink" href="#e"><code class="Fl">-e</code></a>,
    <code class="Fl">--ed</code></dt>
  <dd>Forces <code class="Nm">patch</code> to interpret the patch file as an
      <a class="Xr">ed(1)</a> script.</dd>
  <dt id="F"><a class="permalink" href="#F"><code class="Fl">-F</code></a>
    <var class="Ar">max-fuzz</var>, <code class="Fl">--fuzz</code>
    <var class="Ar">max-fuzz</var></dt>
  <dd>Sets the maximum fuzz factor. This option only applies to context diffs,
      and causes <code class="Nm">patch</code> to ignore up to that many lines
      in looking for places to install a hunk. Note that a larger fuzz factor
      increases the odds of a faulty patch. The default fuzz factor is 2, and it
      may not be set to more than the number of lines of context in the context
      diff, ordinarily 3.</dd>
  <dt id="f"><a class="permalink" href="#f"><code class="Fl">-f</code></a>,
    <code class="Fl">--force</code></dt>
  <dd>Forces <code class="Nm">patch</code> to assume that the user knows exactly
      what he or she is doing, and to not ask any questions. It assumes the
      following: skip patches for which a file to patch cannot be found; patch
      files even though they have the wrong version for the &quot;Prereq&quot;:
      line in the patch; and assume that patches are not reversed even if they
      look like they are. This option does not suppress commentary; use
      <code class="Fl">-s</code> for that.</dd>
  <dt id="g"><a class="permalink" href="#g"><code class="Fl">-g</code></a>
    <var class="Ar">vcs-option</var>, <code class="Fl">--get</code>
    <var class="Ar">vcs-option</var></dt>
  <dd>Causes <code class="Nm">patch</code> to consult some version control
      systems for missing or read-only files. This version of
      <code class="Nm">patch</code> has limited, detect-only support for SCCS
      and ClearCase, but full support for RCS and Perforce.
    <p class="Pp">If <var class="Ar">vcs-option</var> is set to 0, then
        <code class="Nm">patch</code> will not consult any version control
        system. This is the default behavior, unless overruled by setting the
        <code class="Ev">PATCH_GET</code> environment variable.</p>
    <p class="Pp">If <var class="Ar">vcs-option</var> is set to a negative
        number, then <code class="Nm">patch</code> will prompt to confirm that
        it's OK to checkout each file that is detected under a supported version
        control system.</p>
    <p class="Pp">If <var class="Ar">vcs-option</var> is set to a positive
        number, then <code class="Nm">patch</code> will not prompt before
        checking out each file that is detected under a supported version
        control system.</p>
    <p class="Pp">Note that one must be in the root directory of the repository
        in order for <code class="Fl">--get</code> to work, unless
        <code class="Nm">patch</code> is operating in a Perforce workspace.</p>
    <p class="Pp">The <code class="Fl">--get</code> option may also influence
        how a filename is chosen. See
        <a class="Sx" href="#Filename_Determination">Filename Determination</a>
        below for details.</p>
  </dd>
  <dt id="help"><a class="permalink" href="#help"><code class="Fl">--help</code></a></dt>
  <dd>Print a help message and exit.</dd>
  <dt id="i"><a class="permalink" href="#i"><code class="Fl">-i</code></a>
    <var class="Ar">patchfile</var>, <code class="Fl">--input</code>
    <var class="Ar">patchfile</var></dt>
  <dd>Causes the next argument to be interpreted as the input file name (i.e., a
      patchfile). This option may be specified multiple times.</dd>
  <dt id="l"><a class="permalink" href="#l"><code class="Fl">-l</code></a>,
    <code class="Fl">--ignore-whitespace</code></dt>
  <dd>Causes the pattern matching to be done loosely, in case the tabs and
      spaces have been munged in your input file. Any sequence of whitespace in
      the pattern line will match any sequence in the input file. Normal
      characters must still match exactly. Each line of the context must still
      match a line in the input file.</dd>
  <dt id="N"><a class="permalink" href="#N"><code class="Fl">-N</code></a>,
    <code class="Fl">--forward</code></dt>
  <dd>Causes <code class="Nm">patch</code> to ignore patches that it thinks are
      reversed or already applied. See also <code class="Fl">-R</code>.</dd>
  <dt id="n"><a class="permalink" href="#n"><code class="Fl">-n</code></a>,
    <code class="Fl">--normal</code></dt>
  <dd>Forces <code class="Nm">patch</code> to interpret the patch file as a
      normal diff.</dd>
  <dt id="o"><a class="permalink" href="#o"><code class="Fl">-o</code></a>
    <var class="Ar">out-file</var>, <code class="Fl">--output</code>
    <var class="Ar">out-file</var></dt>
  <dd>Causes the next argument to be interpreted as the output file name.</dd>
  <dt id="p"><a class="permalink" href="#p"><code class="Fl">-p</code></a>
    <var class="Ar">strip-count</var>, <code class="Fl">--strip</code>
    <var class="Ar">strip-count</var></dt>
  <dd>Sets the pathname strip count, which controls how pathnames found in the
      patch file are treated, in case you keep your files in a different
      directory than the person who sent out the patch. The strip count
      specifies how many slashes are to be stripped from the front of the
      pathname. (Any intervening directory names also go away.) For example,
      supposing the file name in the patch file was
      <span class="Pa">/u/howard/src/blurfl/blurfl.c</span>:
    <p class="Pp">Setting <code class="Fl">-p</code><var class="Ar">0</var>
        gives the entire pathname unmodified.</p>
    <p class="Pp"><code class="Fl">-p</code><var class="Ar">1</var> gives</p>
    <p class="Pp"></p>
    <div class="Bd
      Bd-indent"><span class="Pa">u/howard/src/blurfl/blurfl.c</span></div>
    <p class="Pp">without the leading slash.</p>
    <p class="Pp"><code class="Fl">-p</code><var class="Ar">4</var> gives</p>
    <p class="Pp"></p>
    <div class="Bd Bd-indent"><span class="Pa">blurfl/blurfl.c</span></div>
    <p class="Pp">Not specifying <code class="Fl">-p</code> at all just gives
        you <span class="Pa">blurfl.c</span>, unless all of the directories in
        the leading path (<span class="Pa">u/howard/src/blurfl</span>) exist and
        that path is relative, in which case you get the entire pathname
        unmodified. Whatever you end up with is looked for either in the current
        directory, or the directory specified by the <code class="Fl">-d</code>
        option.</p>
  </dd>
  <dt id="quoting-style"><a class="permalink" href="#quoting-style"><code class="Fl">--quoting-style</code></a>
    <var class="Ar">style</var></dt>
  <dd>Controls how <code class="Nm">patch</code> writes out filenames to the
      console. The valid values for <var class="Ar">style</var> are:
    <div class="Bd-indent">
    <dl class="Bl-tag">
      <dt id="literal"><a class="permalink" href="#literal"><code class="Cm">literal</code></a></dt>
      <dd>Write filenames without any special quoting.</dd>
      <dt id="shell"><a class="permalink" href="#shell"><code class="Cm">shell</code></a></dt>
      <dd>Quote filenames if they contain shell metacharacters, or other
          characters that may be problematic, e.g., spaces.</dd>
      <dt id="shell-always"><a class="permalink" href="#shell-always"><code class="Cm">shell-always</code></a></dt>
      <dd>Always quote filenames as if they contain shell metacharacters or
          other problematic characters.</dd>
      <dt id="c~2"><a class="permalink" href="#c~2"><code class="Cm">c</code></a></dt>
      <dd>Quote filenames as if they are a C style string.</dd>
      <dt id="escape"><a class="permalink" href="#escape"><code class="Cm">escape</code></a></dt>
      <dd>Does the same as <code class="Cm">c</code>, except quotes will be
          omitted.</dd>
    </dl>
    </div>
    <p class="Pp">The default quoting option is <code class="Cm">shell</code>,
        unless <code class="Ev">QUOTING_STYLE</code> is set.</p>
  </dd>
  <dt id="R"><a class="permalink" href="#R"><code class="Fl">-R</code></a>,
    <code class="Fl">--reverse</code></dt>
  <dd>Tells <code class="Nm">patch</code> that this patch was created with the
      old and new files swapped. (Yes, I am afraid that does happen
      occasionally, human nature being what it is.)
      <code class="Nm">patch</code> will attempt to swap each hunk around before
      applying it. Rejects will come out in the swapped format. The
      <code class="Fl">-R</code> option will not work with ed diff scripts
      because there is too little information to reconstruct the reverse
      operation.
    <p class="Pp">If the first hunk of a patch fails,
        <code class="Nm">patch</code> will reverse the hunk to see if it can be
        applied that way. If it can, you will be asked if you want to have the
        <code class="Fl">-R</code> option set. If it cannot, the patch will
        continue to be applied normally. (Note: this method cannot detect a
        reversed patch if it is a normal diff and if the first command is an
        append (i.e., it should have been a delete) since appends always
        succeed, due to the fact that a null context will match anywhere.
        Luckily, most patches add or change lines rather than delete them, so
        most reversed normal diffs will begin with a delete, which will fail,
        triggering the heuristic.)</p>
  </dd>
  <dt id="r"><a class="permalink" href="#r"><code class="Fl">-r</code></a>
    <var class="Ar">rej-name</var>, <code class="Fl">--reject-file</code>
    <var class="Ar">rej-name</var></dt>
  <dd>Causes the next argument to be interpreted as the reject file name.</dd>
  <dt id="s"><a class="permalink" href="#s"><code class="Fl">-s</code></a>,
    <code class="Fl">--quiet</code>, <code class="Fl">--silent</code></dt>
  <dd>Makes <code class="Nm">patch</code> do its work silently, unless an error
      occurs.</dd>
  <dt id="t"><a class="permalink" href="#t"><code class="Fl">-t</code></a>,
    <code class="Fl">--batch</code></dt>
  <dd>Similar to <code class="Fl">-f</code>, in that it suppresses questions,
      but makes some different assumptions: skip patches for which a file to
      patch cannot be found (the same as <code class="Fl">-f</code>); skip
      patches for which the file has the wrong version for the
      &quot;Prereq&quot;: line in the patch; and assume that patches are
      reversed if they look like they are.</dd>
  <dt id="u"><a class="permalink" href="#u"><code class="Fl">-u</code></a>,
    <code class="Fl">--unified</code></dt>
  <dd>Forces <code class="Nm">patch</code> to interpret the patch file as a
      unified context diff (a unidiff).</dd>
  <dt id="V"><a class="permalink" href="#V"><code class="Fl">-V</code></a>
    <code class="Cm">t</code> |
    <a class="permalink" href="#nil"><code class="Cm" id="nil">nil</code></a> |
    <a class="permalink" href="#never"><code class="Cm" id="never">never</code></a>
    |
    <a class="permalink" href="#none"><code class="Cm" id="none">none</code></a>,
    <code class="Fl">--version-control</code> <code class="Cm">t</code> |
    <a class="permalink" href="#nil~2"><code class="Cm" id="nil~2">nil</code></a>
    |
    <a class="permalink" href="#never~2"><code class="Cm" id="never~2">never</code></a>
    |
    <a class="permalink" href="#none~2"><code class="Cm" id="none~2">none</code></a></dt>
  <dd>Causes the next argument to be interpreted as a method for creating backup
      file names. The type of backups made can also be given in the
      <code class="Ev">PATCH_VERSION_CONTROL</code> or
      <code class="Ev">VERSION_CONTROL</code> environment variables, which are
      overridden by this option. The <code class="Fl">-B</code> option overrides
      this option, causing the prefix to always be used for making backup file
      names. The values of the <code class="Ev">PATCH_VERSION_CONTROL</code> and
      <code class="Ev">VERSION_CONTROL</code> environment variables and the
      argument to the <code class="Fl">-V</code> option are like the GNU Emacs
      &#x201C;version-control&#x201D; variable; they also recognize synonyms
      that are more descriptive. The valid values are (unique abbreviations are
      accepted):
    <div class="Bd-indent">
    <dl class="Bl-tag">
      <dt id="t~2"><a class="permalink" href="#t~2"><code class="Cm">t</code></a>,
        <code class="Cm">numbered</code></dt>
      <dd>Always make numbered backups.</dd>
      <dt id="nil~3"><a class="permalink" href="#nil~3"><code class="Cm">nil</code></a>,
        <code class="Cm">existing</code></dt>
      <dd>Make numbered backups of files that already have them, simple backups
          of the others.</dd>
      <dt id="never~3"><a class="permalink" href="#never~3"><code class="Cm">never</code></a>,
        <code class="Cm">simple</code></dt>
      <dd>Always make simple backups.</dd>
      <dt id="none~3"><a class="permalink" href="#none~3"><code class="Cm">none</code></a></dt>
      <dd>Do not make backups.</dd>
    </dl>
    </div>
  </dd>
  <dt id="v"><a class="permalink" href="#v"><code class="Fl">-v</code></a>,
    <code class="Fl">--version</code></dt>
  <dd>Causes <code class="Nm">patch</code> to print out its revision header and
      patch level.</dd>
  <dt id="x"><a class="permalink" href="#x"><code class="Fl">-x</code></a>
    <var class="Ar">number</var>, <code class="Fl">--debug</code>
    <var class="Ar">number</var></dt>
  <dd>Sets internal debugging flags, and is of interest only to
      <code class="Nm">patch</code> patchers.</dd>
  <dt id="Y"><a class="permalink" href="#Y"><code class="Fl">-Y</code></a>
    <var class="Ar">prefix</var>, <code class="Fl">--basename-prefix</code>
    <var class="Ar">prefix</var></dt>
  <dd>Prepend <var class="Ar">prefix</var> to the basename of the file to be
      backed up. For example, specifying &#x201C;-Y 0_&#x201D; when patching a
      file <span class="Pa">/u/howard/src/blurfl/blurfl.c</span> will create the
      backup at
    <span class="Pa">/u/howard/src/blurfl/0_blurfl.c.orig</span>.</dd>
  <dt id="z"><a class="permalink" href="#z"><code class="Fl">-z</code></a>
    <var class="Ar">backup-ext</var>, <code class="Fl">--suffix</code>
    <var class="Ar">backup-ext</var></dt>
  <dd>Causes the next argument to be interpreted as the backup extension, to be
      used in place of &quot;.orig&quot;.</dd>
  <dt id="posix"><a class="permalink" href="#posix"><code class="Fl">--posix</code></a></dt>
  <dd>Enables strict <span class="St">IEEE Std 1003.1-2008
      (&#x201C;POSIX.1&#x201D;)</span> conformance, specifically:
    <ol class="Bl-enum">
      <li>Backup files are not created unless the <code class="Fl">-b</code>
          option is specified.</li>
      <li>If unspecified, the file name used is the first of the old, new and
          index files that exists.</li>
    </ol>
  </dd>
</dl>
<section class="Ss">
<h2 class="Ss" id="Patch_Application"><a class="permalink" href="#Patch_Application">Patch
  Application</a></h2>
<p class="Pp"><code class="Nm">patch</code> will try to skip any leading
    garbage, apply the diff, and then skip any trailing garbage. Thus you could
    feed an article or message containing a diff listing to
    <code class="Nm">patch</code>, and it should work. If the entire diff is
    indented by a consistent amount, this will be taken into account.</p>
<p class="Pp">With context diffs, and to a lesser extent with normal diffs,
    <code class="Nm">patch</code> can detect when the line numbers mentioned in
    the patch are incorrect, and will attempt to find the correct place to apply
    each hunk of the patch. As a first guess, it takes the line number mentioned
    for the hunk, plus or minus any offset used in applying the previous hunk.
    If that is not the correct place, <code class="Nm">patch</code> will scan
    both forwards and backwards for a set of lines matching the context given in
    the hunk. First <code class="Nm">patch</code> looks for a place where all
    lines of the context match. If no such place is found, and it is a context
    diff, and the maximum fuzz factor is set to 1 or more, then another scan
    takes place ignoring the first and last line of context. If that fails, and
    the maximum fuzz factor is set to 2 or more, the first two and last two
    lines of context are ignored, and another scan is made. (The default maximum
    fuzz factor is 2).</p>
<p class="Pp">If <code class="Nm">patch</code> cannot find a place to install
    that hunk of the patch, it will put the hunk out to a reject file, which
    normally is the name of the output file plus &quot;.rej&quot;. (Note that
    the rejected hunk will come out in context diff form whether the input patch
    was a context diff or a normal diff. If the input was a normal diff, many of
    the contexts will simply be null.) The line numbers on the hunks in the
    reject file may be different than in the patch file: they reflect the
    approximate location patch thinks the failed hunks belong in the new file
    rather than the old one.</p>
<p class="Pp">As each hunk is completed, you will be told whether the hunk
    succeeded or failed, and which line (in the new file)
    <code class="Nm">patch</code> thought the hunk should go on. If this is
    different from the line number specified in the diff, you will be told the
    offset. A single large offset MAY be an indication that a hunk was installed
    in the wrong place. You will also be told if a fuzz factor was used to make
    the match, in which case you should also be slightly suspicious.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Filename_Determination"><a class="permalink" href="#Filename_Determination">Filename
  Determination</a></h2>
<p class="Pp">If no original file is specified on the command line,
    <code class="Nm">patch</code> will try to figure out from the leading
    garbage what the name of the file to edit is. When checking a prospective
    file name, pathname components are stripped as specified by the
    <code class="Fl">-p</code> option and the file's existence and writability
    are checked relative to the current working directory (or the directory
    specified by the <code class="Fl">-d</code> option).</p>
<p class="Pp">If the diff is a context or unified diff,
    <code class="Nm">patch</code> is able to determine the old and new file
    names from the diff header. For context diffs, the &#x201C;old&#x201D; file
    is specified in the line beginning with &quot;***&quot; and the
    &#x201C;new&#x201D; file is specified in the line beginning with
    &quot;---&quot;. For a unified diff, the &#x201C;old&#x201D; file is
    specified in the line beginning with &quot;---&quot; and the
    &#x201C;new&#x201D; file is specified in the line beginning with
    &quot;+++&quot;. If there is an &quot;Index&quot;: line in the leading
    garbage (regardless of the diff type), <code class="Nm">patch</code> will
    use the file name from that line as the &#x201C;index&#x201D; file.</p>
<p class="Pp"><code class="Nm">patch</code> will choose the file name by
    performing the following steps, with the first match used:</p>
<ol class="Bl-enum">
  <li>If <code class="Nm">patch</code> is operating in strict
      <span class="St">IEEE Std 1003.1-2008 (&#x201C;POSIX.1&#x201D;)</span>
      mode, the first of the &#x201C;old&#x201D;, &#x201C;new&#x201D; and
      &#x201C;index&#x201D; file names that exist is used.</li>
  <li>If <code class="Nm">patch</code> is not operating in strict
      <span class="St">IEEE Std 1003.1-2008 (&#x201C;POSIX.1&#x201D;)</span>
      mode, and a non-zero <code class="Fl">--get</code> argument has been
      supplied, then <code class="Nm">patch</code> will choose one of the
      &#x201C;index&#x201D;, &#x201C;old&#x201D; or &#x201C;new&#x201D;
      filenames that are detected to exist under a version control system.
      Otherwise, <code class="Nm">patch</code> will examine either the
      &#x201C;old&#x201D; and &#x201C;new&#x201D; file names or, for a
      non-context diff, the &#x201C;index&#x201D; file name, and choose the file
      name with the fewest path components, the shortest basename, and the
      shortest total file name length (in that order).</li>
  <li>If no suitable file was found to patch, the patch file is a context or
      unified diff, and the old file was zero length, the new file name is
      created and used.</li>
  <li>If the file name still cannot be determined, <code class="Nm">patch</code>
      will prompt the user for the file name to use.</li>
</ol>
<p class="Pp">Additionally, if the leading garbage contains a
    &quot;Prereq:&#x00A0;&quot; line, <code class="Nm">patch</code> will take
    the first word from the prerequisites line (normally a version number) and
    check the input file to see if that word can be found. If not,
    <code class="Nm">patch</code> will ask for confirmation before
  proceeding.</p>
<p class="Pp">The upshot of all this is that you should be able to say, while in
    a news interface, the following:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">| patch -d
  /usr/src/local/blurfl</code></div>
<p class="Pp">and patch a file in the blurfl directory directly from the article
    containing the patch.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Backup_Files"><a class="permalink" href="#Backup_Files">Backup
  Files</a></h2>
<p class="Pp">By default, the patched version is put in place of the original,
    with the original file backed up to the same name with the extension
    &quot;.orig&quot;, or as specified by the <code class="Fl">-B</code>,
    <code class="Fl">-V</code>, or <code class="Fl">-z</code> options. The
    extension used for making backup files may also be specified in the
    <code class="Ev">SIMPLE_BACKUP_SUFFIX</code> environment variable, which is
    overridden by the options above.</p>
<p class="Pp">If the backup file is a symbolic or hard link to the original
    file, <code class="Nm">patch</code> creates a new backup file name by
    changing the first lowercase letter in the last component of the file's name
    into uppercase. If there are no more lowercase letters in the name, it
    removes the first character from the name. It repeats this process until it
    comes up with a backup file that does not already exist or is not linked to
    the original file.</p>
<p class="Pp">You may also specify where you want the output to go with the
    <code class="Fl">-o</code> option; if that file already exists, it is backed
    up first.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Notes_For_Patch_Senders"><a class="permalink" href="#Notes_For_Patch_Senders">Notes
  For Patch Senders</a></h2>
<p class="Pp">There are several things you should bear in mind if you are going
    to be sending out patches:</p>
<p class="Pp">First, you can save people a lot of grief by keeping a
    <span class="Pa">patchlevel.h</span> file which is patched to increment the
    patch level as the first diff in the patch file you send out. If you put a
    &quot;Prereq&quot;: line in with the patch, it will not let them apply
    patches out of order without some warning.</p>
<p class="Pp">Second, make sure you have specified the file names right, either
    in a context diff header, or with an &quot;Index&quot;: line. If you are
    patching something in a subdirectory, be sure to tell the patch user to
    specify a <code class="Fl">-p</code> option as needed.</p>
<p class="Pp">Third, you can create a file by sending out a diff that compares a
    null file to the file you want to create. If the file you want to create
    already exists in the target directory when the diff is applied, then
    <code class="Nm">patch</code> will identify the patch as potentially
    reversed and offer to reverse the patch.</p>
<p class="Pp">Fourth, take care not to send out reversed patches, since it makes
    people wonder whether they already applied the patch.</p>
<p class="Pp">Fifth, while you may be able to get away with putting 582 diff
    listings into one file, it is probably wiser to group related patches into
    separate files in case something goes haywire.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<dl class="Bl-tag Bl-compact">
  <dt id="PATCH_GET"><a class="permalink" href="#PATCH_GET"><code class="Ev">PATCH_GET</code></a></dt>
  <dd>Specifies the default version control behavior. See the description of
      <code class="Fl">--get</code> for valid values.</dd>
  <dt id="PATCH_VERBOSE"><a class="permalink" href="#PATCH_VERBOSE"><code class="Ev">PATCH_VERBOSE</code></a></dt>
  <dd>Specifies the default verbosity of <code class="Nm">patch</code>. Setting
      <code class="Ev">PATCH_VERBOSE</code> to a non-zero integer will enable
      verbosity.</dd>
  <dt id="POSIXLY_CORRECT"><a class="permalink" href="#POSIXLY_CORRECT"><code class="Ev">POSIXLY_CORRECT</code></a></dt>
  <dd>When set, <code class="Nm">patch</code> behaves as if the
      <code class="Fl">--posix</code> option has been specified.</dd>
  <dt id="QUOTING_STYLE"><a class="permalink" href="#QUOTING_STYLE"><code class="Ev">QUOTING_STYLE</code></a></dt>
  <dd>Specifies the default quoting style. See the description of
      <code class="Fl">--quoting-style</code> for valid values.</dd>
  <dt id="SIMPLE_BACKUP_SUFFIX"><a class="permalink" href="#SIMPLE_BACKUP_SUFFIX"><code class="Ev">SIMPLE_BACKUP_SUFFIX</code></a></dt>
  <dd>Extension to use for backup file names instead of &quot;.orig&quot;.</dd>
  <dt id="TMPDIR"><a class="permalink" href="#TMPDIR"><code class="Ev">TMPDIR</code></a></dt>
  <dd>Directory to put temporary files in; default is
      <span class="Pa">/tmp</span>.</dd>
  <dt id="PATCH_VERSION_CONTROL"><a class="permalink" href="#PATCH_VERSION_CONTROL"><code class="Ev">PATCH_VERSION_CONTROL</code></a></dt>
  <dd>Selects when numbered backup files are made.</dd>
  <dt id="VERSION_CONTROL"><a class="permalink" href="#VERSION_CONTROL"><code class="Ev">VERSION_CONTROL</code></a></dt>
  <dd>Same as <code class="Ev">PATCH_VERSION_CONTROL</code>.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag Bl-compact">
  <dt><span class="Pa">$TMPDIR/patch*</span></dt>
  <dd><code class="Nm">patch</code> temporary files</dd>
  <dt><span class="Pa">/dev/tty</span></dt>
  <dd>used to read input when <code class="Nm">patch</code> prompts the
    user</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXIT_STATUS"><a class="permalink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<p class="Pp">The <code class="Nm">patch</code> utility exits with one of the
    following values:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>0</dt>
  <dd>Successful completion.</dd>
  <dt>1</dt>
  <dd>One or more lines were written to a reject file.</dd>
  <dt>&gt;1</dt>
  <dd>An error occurred.</dd>
</dl>
</div>
<p class="Pp">When applying a set of patches in a loop it behooves you to check
    this exit status so you do not apply a later patch to a partially patched
    file.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DIAGNOSTICS"><a class="permalink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
<p class="Pp">Too many to list here, but generally indicative that
    <code class="Nm">patch</code> couldn't parse your patch file.</p>
<p class="Pp">The message &quot;Hmm...&quot; indicates that there is unprocessed
    text in the patch file and that <code class="Nm">patch</code> is attempting
    to intuit whether there is a patch in that text and, if so, what kind of
    patch it is.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">diff(1)</a></p>
</section>
<section class="Sh">
<h1 class="Sh" id="STANDARDS"><a class="permalink" href="#STANDARDS">STANDARDS</a></h1>
<p class="Pp">The <code class="Nm">patch</code> utility is compliant with the
    <span class="St">IEEE Std 1003.1-2008 (&#x201C;POSIX.1&#x201D;)</span>
    specification, except as detailed above for the
    <code class="Fl">--posix</code> option.</p>
<p class="Pp">The flags [<code class="Fl">-BCEFfstVvxz</code>] and
    [<code class="Fl">--posix</code>] are extensions to that specification.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp"><span class="An">Larry Wall</span> with many other
  contributors.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<p class="Pp"><code class="Nm">patch</code> cannot tell if the line numbers are
    off in an ed script, and can only detect bad line numbers in a normal diff
    when it finds a &quot;change&quot; or a &quot;delete&quot; command. A
    context diff using fuzz factor 3 may have the same problem. Until a suitable
    interactive interface is added, you should probably do a context diff in
    these cases to see if the changes made sense. Of course, compiling without
    errors is a pretty good indication that the patch worked, but not
  always.</p>
<p class="Pp"><code class="Nm">patch</code> usually produces the correct
    results, even when it has to do a lot of guessing. However, the results are
    guaranteed to be correct only when the patch is applied to exactly the same
    version of the file that the patch was generated from.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">Could be smarter about partial matches, excessively deviant
    offsets and swapped code, but that would take an extra pass.</p>
<p class="Pp">Check patch mode (<code class="Fl">-C</code>) will fail if you try
    to check several patches in succession that build on each other. The entire
    <code class="Nm">patch</code> code would have to be restructured to keep
    temporary files around so that it can handle this situation.</p>
<p class="Pp">If code has been duplicated (for instance with #ifdef OLDCODE ...
    #else ... #endif), <code class="Nm">patch</code> is incapable of patching
    both versions, and, if it works at all, will likely patch the wrong one, and
    tell you that it succeeded to boot.</p>
<p class="Pp">If you apply a patch you have already applied,
    <code class="Nm">patch</code> will think it is a reversed patch, and offer
    to un-apply the patch. This could be construed as a feature.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">April 27, 2022</td>
    <td class="foot-os">Mac OS X 12</td>
  </tr>
</table>
</body>
</html>
