<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>PERLDEBGUTS(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PERLDEBGUTS(1)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">PERLDEBGUTS(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">perldebguts - Guts of Perl debugging</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This is not perldebug, which tells you how to use the debugger.
    This manpage describes low-level details concerning the debugger's
    internals, which range from difficult to impossible to understand for anyone
    who isn't incredibly intimate with Perl's guts. Caveat lector.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Debugger_Internals"><a class="permalink" href="#Debugger_Internals">Debugger
  Internals</a></h1>
<p class="Pp">Perl has special debugging hooks at compile-time and run-time used
    to create debugging environments. These hooks are not to be confused with
    the <i>perl -Dxxx</i> command described in perlrun, which is usable only if
    a special Perl is built per the instructions in the <i>INSTALL</i> podpage
    in the Perl source tree.</p>
<p class="Pp">For example, whenever you call Perl's built-in
    <span class="Li">&quot;caller&quot;</span> function from the package
    <span class="Li">&quot;DB&quot;</span>, the arguments that the corresponding
    stack frame was called with are copied to the
    <span class="Li">@DB::args</span> array. These mechanisms are enabled by
    calling Perl with the <b>-d</b> switch. Specifically, the following
    additional features are enabled (cf. &quot;$^P&quot; in perlvar):</p>
<ul class="Bl-bullet">
  <li>Perl inserts the contents of <span class="Li">$ENV{PERL5DB}</span> (or
      <span class="Li">&quot;BEGIN {require</span>
      <span class="Li">'perl5db.pl'}&quot;</span> if not present) before the
      first line of your program.</li>
  <li>Each array
      <span class="Li">&quot;@{&quot;_&lt;$filename&quot;}&quot;</span> holds
      the lines of <span class="Li">$filename</span> for a file compiled by
      Perl. The same is also true for <span class="Li">&quot;eval&quot;</span>ed
      strings that contain subroutines, or which are currently being executed.
      The <span class="Li">$filename</span> for
      <span class="Li">&quot;eval&quot;</span>ed strings looks like
      <span class="Li">&quot;(eval 34)&quot;</span>.
    <p class="Pp">Values in this array are magical in numeric context: they
        compare equal to zero only if the line is not breakable.</p>
  </li>
  <li>Each hash
      <span class="Li">&quot;%{&quot;_&lt;$filename&quot;}&quot;</span> contains
      breakpoints and actions keyed by line number. Individual entries (as
      opposed to the whole hash) are settable. Perl only cares about Boolean
      true here, although the values used by <i>perl5db.pl</i> have the form
      <span class="Li">&quot;$break_condition\0$action&quot;</span>.
    <p class="Pp">The same holds for evaluated strings that contain subroutines,
        or which are currently being executed. The
        <span class="Li">$filename</span> for
        <span class="Li">&quot;eval&quot;</span>ed strings looks like
        <span class="Li">&quot;(eval 34)&quot;</span>.</p>
  </li>
  <li>Each scalar
      <span class="Li">&quot;${&quot;_&lt;$filename&quot;}&quot;</span> contains
      <span class="Li">&quot;_&lt;$filename&quot;</span>. This is also the case
      for evaluated strings that contain subroutines, or which are currently
      being executed. The <span class="Li">$filename</span> for
      <span class="Li">&quot;eval&quot;</span>ed strings looks like
      <span class="Li">&quot;(eval 34)&quot;</span>.</li>
  <li>After each <span class="Li">&quot;require&quot;</span>d file is compiled,
      but before it is executed,
      <span class="Li">&quot;DB::postponed(*{&quot;_&lt;$filename&quot;})&quot;</span>
      is called if the subroutine
      <span class="Li">&quot;DB::postponed&quot;</span> exists. Here, the
      <span class="Li">$filename</span> is the expanded name of the
      <span class="Li">&quot;require&quot;</span>d file, as found in the values
      of <span class="Li">%INC</span>.</li>
  <li>After each subroutine <span class="Li">&quot;subname&quot;</span> is
      compiled, the existence of <span class="Li">$DB::postponed{subname}</span>
      is checked. If this key exists,
      <span class="Li">&quot;DB::postponed(subname)&quot;</span> is called if
      the <span class="Li">&quot;DB::postponed&quot;</span> subroutine also
      exists.</li>
  <li>A hash <span class="Li">%DB::sub</span> is maintained, whose keys are
      subroutine names and whose values have the form
      <span class="Li">&quot;filename:startline-endline&quot;</span>.
      <span class="Li">&quot;filename&quot;</span> has the form
      <span class="Li">&quot;(eval 34)&quot;</span> for subroutines defined
      inside <span class="Li">&quot;eval&quot;</span>s.</li>
  <li>When the execution of your program reaches a point that can hold a
      breakpoint, the <span class="Li">&quot;DB::DB()&quot;</span> subroutine is
      called if any of the variables <span class="Li">$DB::trace</span>,
      <span class="Li">$DB::single</span>, or
      <span class="Li">$DB::signal</span> is true. These variables are not
      <span class="Li">&quot;local&quot;</span>izable. This feature is disabled
      when executing inside <span class="Li">&quot;DB::DB()&quot;</span>,
      including functions called from it unless <span class="Li">&quot;$^D &amp;
      (1&lt;&lt;30)&quot;</span> is true.</li>
  <li>When execution of the program reaches a subroutine call, a call to
      <span class="Li">&amp;DB::sub</span>(<i>args</i>) is made instead, with
      <span class="Li">$DB::sub</span> set to identify the called subroutine.
      (This doesn't happen if the calling subroutine was compiled in the
      <span class="Li">&quot;DB&quot;</span> package.)
      <span class="Li">$DB::sub</span> normally holds the name of the called
      subroutine, if it has a name by which it can be looked up. Failing that,
      <span class="Li">$DB::sub</span> will hold a reference to the called
      subroutine. Either way, the <span class="Li">&amp;DB::sub</span>
      subroutine can use <span class="Li">$DB::sub</span> as a reference by
      which to call the called subroutine, which it will normally want to do.
    <p class="Pp">If the call is to an lvalue subroutine, and
        <span class="Li">&amp;DB::lsub</span> is defined
        <span class="Li">&amp;DB::lsub</span>(<i>args</i>) is called instead,
        otherwise falling back to
        <span class="Li">&amp;DB::sub</span>(<i>args</i>).</p>
  </li>
  <li>When execution of the program uses
      <span class="Li">&quot;goto&quot;</span> to enter a non-XS subroutine and
      the 0x80 bit is set in <span class="Li">$^P</span>, a call to
      <span class="Li">&amp;DB::goto</span> is made, with
      <span class="Li">$DB::sub</span> set to identify the subroutine being
      entered. The call to <span class="Li">&amp;DB::goto</span> does not
      replace the <span class="Li">&quot;goto&quot;</span>; the requested
      subroutine will still be entered once
      <span class="Li">&amp;DB::goto</span> has returned.
      <span class="Li">$DB::sub</span> normally holds the name of the subroutine
      being entered, if it has one. Failing that,
      <span class="Li">$DB::sub</span> will hold a reference to the subroutine
      being entered. Unlike when <span class="Li">&amp;DB::sub</span> is called,
      it is not guaranteed that <span class="Li">$DB::sub</span> can be used as
      a reference to operate on the subroutine being entered.</li>
</ul>
<p class="Pp">Note that if <span class="Li">&amp;DB::sub</span> needs external
    data for it to work, no subroutine call is possible without it. As an
    example, the standard debugger's <span class="Li">&amp;DB::sub</span>
    depends on the <span class="Li">$DB::deep</span> variable (it defines how
    many levels of recursion deep into the debugger you can go before a
    mandatory break). If <span class="Li">$DB::deep</span> is not defined,
    subroutine calls are not possible, even though
    <span class="Li">&amp;DB::sub</span> exists.</p>
<section class="Ss">
<h2 class="Ss" id="Writing_Your_Own_Debugger"><a class="permalink" href="#Writing_Your_Own_Debugger">Writing
  Your Own Debugger</a></h2>
<p class="Pp"><i>Environment Variables</i></p>
<p class="Pp">The <span class="Li">&quot;PERL5DB&quot;</span> environment
    variable can be used to define a debugger. For example, the minimal
    &quot;working&quot; debugger (it actually doesn't do anything) consists of
    one line:</p>
<p class="Pp"></p>
<pre>  sub DB::DB {}
</pre>
<p class="Pp">It can easily be defined like this:</p>
<p class="Pp"></p>
<pre>  $ PERL5DB=&quot;sub DB::DB {}&quot; perl -d your-script
</pre>
<p class="Pp">Another brief debugger, slightly more useful, can be created with
    only the line:</p>
<p class="Pp"></p>
<pre>  sub DB::DB {print ++$i; scalar &lt;STDIN&gt;}
</pre>
<p class="Pp">This debugger prints a number which increments for each statement
    encountered and waits for you to hit a newline before continuing to the next
    statement.</p>
<p class="Pp">The following debugger is actually useful:</p>
<p class="Pp"></p>
<pre>  {
    package DB;
    sub DB  {}
    sub sub {print ++$i, &quot; $sub\n&quot;; &amp;$sub}
  }
</pre>
<p class="Pp">It prints the sequence number of each subroutine call and the name
    of the called subroutine. Note that <span class="Li">&amp;DB::sub</span> is
    being compiled into the package <span class="Li">&quot;DB&quot;</span>
    through the use of the <span class="Li">&quot;package&quot;</span>
    directive.</p>
<p class="Pp">When it starts, the debugger reads your rc file (<i>./.perldb</i>
    or <i>~/.perldb</i> under Unix), which can set important options. (A
    subroutine (<span class="Li">&amp;afterinit</span>) can be defined here as
    well; it is executed after the debugger completes its own
  initialization.)</p>
<p class="Pp">After the rc file is read, the debugger reads the PERLDB_OPTS
    environment variable and uses it to set debugger options. The contents of
    this variable are treated as if they were the argument of an
    <span class="Li">&quot;o ...&quot;</span> debugger command (q.v. in
    &quot;Configurable Options&quot; in perldebug).</p>
<p class="Pp"><i>Debugger Internal Variables</i></p>
<p class="Pp">In addition to the file and subroutine-related variables mentioned
    above, the debugger also maintains various magical internal variables.</p>
<ul class="Bl-bullet">
  <li><span class="Li">@DB::dbline</span> is an alias for
      <span class="Li">&quot;@{&quot;::_&lt;current_file&quot;}&quot;</span>,
      which holds the lines of the currently-selected file (compiled by Perl),
      either explicitly chosen with the debugger's
      <span class="Li">&quot;f&quot;</span> command, or implicitly by flow of
      execution.
    <p class="Pp">Values in this array are magical in numeric context: they
        compare equal to zero only if the line is not breakable.</p>
  </li>
  <li><span class="Li">%DB::dbline</span> is an alias for
      <span class="Li">&quot;%{&quot;::_&lt;current_file&quot;}&quot;</span>,
      which contains breakpoints and actions keyed by line number in the
      currently-selected file, either explicitly chosen with the debugger's
      <span class="Li">&quot;f&quot;</span> command, or implicitly by flow of
      execution.
    <p class="Pp">As previously noted, individual entries (as opposed to the
        whole hash) are settable. Perl only cares about Boolean true here,
        although the values used by <i>perl5db.pl</i> have the form
        <span class="Li">&quot;$break_condition\0$action&quot;</span>.</p>
  </li>
</ul>
<p class="Pp"><i>Debugger Customization Functions</i></p>
<p class="Pp">Some functions are provided to simplify customization.</p>
<ul class="Bl-bullet">
  <li>See &quot;Configurable Options&quot; in perldebug for a description of
      options parsed by
      <span class="Li">&quot;DB::parse_options(string)&quot;</span>.</li>
  <li><span class="Li">&quot;DB::dump_trace(skip[,count])&quot;</span> skips the
      specified number of frames and returns a list containing information about
      the calling frames (all of them, if
      <span class="Li">&quot;count&quot;</span> is missing). Each entry is
      reference to a hash with keys <span class="Li">&quot;context&quot;</span>
      (either <span class="Li">&quot;.&quot;</span>,
      <span class="Li">&quot;$&quot;</span>, or
      <span class="Li">&quot;@&quot;</span>),
      <span class="Li">&quot;sub&quot;</span> (subroutine name, or info about
      <span class="Li">&quot;eval&quot;</span>),
      <span class="Li">&quot;args&quot;</span>
      (<span class="Li">&quot;undef&quot;</span> or a reference to an array),
      <span class="Li">&quot;file&quot;</span>, and
      <span class="Li">&quot;line&quot;</span>.</li>
  <li><span class="Li">&quot;DB::print_trace(FH, skip[, count[,
      short]])&quot;</span> prints formatted info about caller frames. The last
      two functions may be convenient as arguments to
      <span class="Li">&quot;&lt;&quot;</span>,
      <span class="Li">&quot;&lt;&lt;&quot;</span> commands.</li>
</ul>
<p class="Pp">Note that any variables and functions that are not documented in
    this manpages (or in perldebug) are considered for internal use only, and as
    such are subject to change without notice.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="Frame_Listing_Output_Examples"><a class="permalink" href="#Frame_Listing_Output_Examples">Frame
  Listing Output Examples</a></h1>
<p class="Pp">The <span class="Li">&quot;frame&quot;</span> option can be used
    to control the output of frame information. For example, contrast this
    expression trace:</p>
<p class="Pp"></p>
<pre> $ perl -de 42
 Stack dump during die enabled outside of evals.
 Loading DB routines from perl5db.pl patch level 0.94
 Emacs support available.
 Enter h or 'h h' for help.
 main::(-e:1):   0
   DB&lt;1&gt; sub foo { 14 }
   DB&lt;2&gt; sub bar { 3 }
   DB&lt;3&gt; t print foo() * bar()
 main::((eval 172):3):   print foo() + bar();
 main::foo((eval 168):2):
 main::bar((eval 170):2):
 42
</pre>
<p class="Pp">with this one, once the <span class="Li">&quot;o&quot;</span>ption
    <span class="Li">&quot;frame=2&quot;</span> has been set:</p>
<p class="Pp"></p>
<pre>   DB&lt;4&gt; o f=2
                frame = '2'
   DB&lt;5&gt; t print foo() * bar()
 3:      foo() * bar()
 entering main::foo
  2:     sub foo { 14 };
 exited main::foo
 entering main::bar
  2:     sub bar { 3 };
 exited main::bar
 42
</pre>
<p class="Pp">By way of demonstration, we present below a laborious listing
    resulting from setting your <span class="Li">&quot;PERLDB_OPTS&quot;</span>
    environment variable to the value <span class="Li">&quot;f=n N&quot;</span>,
    and running <i>perl -d -V</i> from the command line. Examples using various
    values of <span class="Li">&quot;n&quot;</span> are shown to give you a feel
    for the difference between settings. Long though it may be, this is not a
    complete listing, but only excerpts.</p>
<dl class="Bl-tag">
  <dt>1.</dt>
  <dd>
    <pre> entering main::BEGIN
  entering Config::BEGIN
   Package lib/Exporter.pm.
   Package lib/Carp.pm.
  Package lib/Config.pm.
  entering Config::TIEHASH
  entering Exporter::import
   entering Exporter::export
 entering Config::myconfig
  entering Config::FETCH
  entering Config::FETCH
  entering Config::FETCH
  entering Config::FETCH
    </pre>
  </dd>
  <dt>2.</dt>
  <dd>
    <pre> entering main::BEGIN
  entering Config::BEGIN
   Package lib/Exporter.pm.
   Package lib/Carp.pm.
  exited Config::BEGIN
  Package lib/Config.pm.
  entering Config::TIEHASH
  exited Config::TIEHASH
  entering Exporter::import
   entering Exporter::export
   exited Exporter::export
  exited Exporter::import
 exited main::BEGIN
 entering Config::myconfig
  entering Config::FETCH
  exited Config::FETCH
  entering Config::FETCH
  exited Config::FETCH
  entering Config::FETCH
    </pre>
  </dd>
  <dt>3.</dt>
  <dd>
    <pre> in  $=main::BEGIN() from /dev/null:0
  in  $=Config::BEGIN() from lib/Config.pm:2
   Package lib/Exporter.pm.
   Package lib/Carp.pm.
  Package lib/Config.pm.
  in  $=Config::TIEHASH('Config') from lib/Config.pm:644
  in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
   in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from li
 in  @=Config::myconfig() from /dev/null:0
  in  $=Config::FETCH(ref(Config), 'package') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'baserev') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'PERL_VERSION') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'PERL_SUBVERSION') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'osname') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'osvers') from lib/Config.pm:574
    </pre>
  </dd>
  <dt>4.</dt>
  <dd>
    <pre> in  $=main::BEGIN() from /dev/null:0
  in  $=Config::BEGIN() from lib/Config.pm:2
   Package lib/Exporter.pm.
   Package lib/Carp.pm.
  out $=Config::BEGIN() from lib/Config.pm:0
  Package lib/Config.pm.
  in  $=Config::TIEHASH('Config') from lib/Config.pm:644
  out $=Config::TIEHASH('Config') from lib/Config.pm:644
  in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
   in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/
   out $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/
  out $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
 out $=main::BEGIN() from /dev/null:0
 in  @=Config::myconfig() from /dev/null:0
  in  $=Config::FETCH(ref(Config), 'package') from lib/Config.pm:574
  out $=Config::FETCH(ref(Config), 'package') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'baserev') from lib/Config.pm:574
  out $=Config::FETCH(ref(Config), 'baserev') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'PERL_VERSION') from lib/Config.pm:574
  out $=Config::FETCH(ref(Config), 'PERL_VERSION') from lib/Config.pm:574
  in  $=Config::FETCH(ref(Config), 'PERL_SUBVERSION') from lib/Config.pm:574
    </pre>
  </dd>
  <dt>5.</dt>
  <dd>
    <pre> in  $=main::BEGIN() from /dev/null:0
  in  $=Config::BEGIN() from lib/Config.pm:2
   Package lib/Exporter.pm.
   Package lib/Carp.pm.
  out $=Config::BEGIN() from lib/Config.pm:0
  Package lib/Config.pm.
  in  $=Config::TIEHASH('Config') from lib/Config.pm:644
  out $=Config::TIEHASH('Config') from lib/Config.pm:644
  in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
   in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/E
   out $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/E
  out $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
 out $=main::BEGIN() from /dev/null:0
 in  @=Config::myconfig() from /dev/null:0
  in  $=Config::FETCH('Config=HASH(0x1aa444)', 'package') from lib/Config.pm:574
  out $=Config::FETCH('Config=HASH(0x1aa444)', 'package') from lib/Config.pm:574
  in  $=Config::FETCH('Config=HASH(0x1aa444)', 'baserev') from lib/Config.pm:574
  out $=Config::FETCH('Config=HASH(0x1aa444)', 'baserev') from lib/Config.pm:574
    </pre>
  </dd>
  <dt>6.</dt>
  <dd>
    <pre> in  $=CODE(0x15eca4)() from /dev/null:0
  in  $=CODE(0x182528)() from lib/Config.pm:2
   Package lib/Exporter.pm.
  out $=CODE(0x182528)() from lib/Config.pm:0
  scalar context return from CODE(0x182528): undef
  Package lib/Config.pm.
  in  $=Config::TIEHASH('Config') from lib/Config.pm:628
  out $=Config::TIEHASH('Config') from lib/Config.pm:628
  scalar context return from Config::TIEHASH:   empty hash
  in  $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
   in  $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/Exporter.pm:171
   out $=Exporter::export('Config', 'main', 'myconfig', 'config_vars') from lib/Exporter.pm:171
   scalar context return from Exporter::export: ''
  out $=Exporter::import('Config', 'myconfig', 'config_vars') from /dev/null:0
  scalar context return from Exporter::import: ''
    </pre>
  </dd>
</dl>
<p class="Pp">In all cases shown above, the line indentation shows the call
    tree. If bit 2 of <span class="Li">&quot;frame&quot;</span> is set, a line
    is printed on exit from a subroutine as well. If bit 4 is set, the arguments
    are printed along with the caller info. If bit 8 is set, the arguments are
    printed even if they are tied or references. If bit 16 is set, the return
    value is printed, too.</p>
<p class="Pp">When a package is compiled, a line like this</p>
<p class="Pp"></p>
<pre>    Package lib/Carp.pm.
</pre>
<p class="Pp">is printed with proper indentation.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Debugging_Regular_Expressions"><a class="permalink" href="#Debugging_Regular_Expressions">Debugging
  Regular Expressions</a></h1>
<p class="Pp">There are two ways to enable debugging output for regular
    expressions.</p>
<p class="Pp">If your perl is compiled with
    <span class="Li">&quot;-DDEBUGGING&quot;</span>, you may use the <b>-Dr</b>
    flag on the command line, and <span class="Li">&quot;-Drv&quot;</span> for
    more verbose information.</p>
<p class="Pp">Otherwise, one can <span class="Li">&quot;use re
    'debug'&quot;</span>, which has effects at both compile time and run time.
    Since Perl 5.9.5, this pragma is lexically scoped.</p>
<section class="Ss">
<h2 class="Ss" id="Compile-time_Output"><a class="permalink" href="#Compile-time_Output">Compile-time
  Output</a></h2>
<p class="Pp">The debugging output at compile time looks like this:</p>
<p class="Pp"></p>
<pre>  Compiling REx '[bc]d(ef*g)+h[ij]k$'
  size 45 Got 364 bytes for offset annotations.
  first at 1
  rarest char g at 0
  rarest char d at 0
     1: ANYOF[bc](12)
    12: EXACT &lt;d&gt;(14)
    14: CURLYX[0] {1,32767}(28)
    16:   OPEN1(18)
    18:     EXACT &lt;e&gt;(20)
    20:     STAR(23)
    21:       EXACT &lt;f&gt;(0)
    23:     EXACT &lt;g&gt;(25)
    25:   CLOSE1(27)
    27:   WHILEM[1/1](0)
    28: NOTHING(29)
    29: EXACT &lt;h&gt;(31)
    31: ANYOF[ij](42)
    42: EXACT &lt;k&gt;(44)
    44: EOL(45)
    45: END(0)
  anchored 'de' at 1 floating 'gh' at 3..2147483647 (checking floating) 
        stclass 'ANYOF[bc]' minlen 7 
  Offsets: [45]
        1[4] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 5[1]
        0[0] 12[1] 0[0] 6[1] 0[0] 7[1] 0[0] 9[1] 8[1] 0[0] 10[1] 0[0]
        11[1] 0[0] 12[0] 12[0] 13[1] 0[0] 14[4] 0[0] 0[0] 0[0] 0[0]
        0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 18[1] 0[0] 19[1] 20[0]  
  Omitting $` $&amp; $' support.
</pre>
<p class="Pp">The first line shows the pre-compiled form of the regex. The
    second shows the size of the compiled form (in arbitrary units, usually
    4-byte words) and the total number of bytes allocated for the offset/length
    table, usually 4+<span class="Li">&quot;size&quot;</span>*8. The next line
    shows the label <i>id</i> of the first node that does a match.</p>
<p class="Pp">The</p>
<p class="Pp"></p>
<pre>  anchored 'de' at 1 floating 'gh' at 3..2147483647 (checking floating) 
        stclass 'ANYOF[bc]' minlen 7
</pre>
<p class="Pp">line (split into two lines above) contains optimizer information.
    In the example shown, the optimizer found that the match should contain a
    substring <span class="Li">&quot;de&quot;</span> at offset 1, plus substring
    <span class="Li">&quot;gh&quot;</span> at some offset between 3 and
    infinity. Moreover, when checking for these substrings (to abandon
    impossible matches quickly), Perl will check for the substring
    <span class="Li">&quot;gh&quot;</span> before checking for the substring
    <span class="Li">&quot;de&quot;</span>. The optimizer may also use the
    knowledge that the match starts (at the
    <span class="Li">&quot;first&quot;</span> <i>id</i>) with a character class,
    and no string shorter than 7 characters can possibly match.</p>
<p class="Pp">The fields of interest which may appear in this line are</p>
<dl class="Bl-tag">
  <dt>&quot;anchored&quot; <i>STRING</i> &quot;at&quot; <i>POS</i></dt>
  <dd></dd>
  <dt>&quot;floating&quot; <i>STRING</i> &quot;at&quot; <i>POS1..POS2</i></dt>
  <dd>See above.</dd>
  <dt>&quot;matching floating/anchored&quot;</dt>
  <dd>Which substring to check first.</dd>
  <dt>&quot;minlen&quot;</dt>
  <dd>The minimal length of the match.</dd>
  <dt>&quot;stclass&quot; <i>TYPE</i></dt>
  <dd>Type of first matching node.</dd>
  <dt>&quot;noscan&quot;</dt>
  <dd>Don't scan for the found substrings.</dd>
  <dt>&quot;isall&quot;</dt>
  <dd>Means that the optimizer information is all that the regular expression
      contains, and thus one does not need to enter the regex engine at
    all.</dd>
  <dt>&quot;GPOS&quot;</dt>
  <dd>Set if the pattern contains <span class="Li">&quot;\G&quot;</span>.</dd>
  <dt>&quot;plus&quot;</dt>
  <dd>Set if the pattern starts with a repeated char (as in
      <span class="Li">&quot;x+y&quot;</span>).</dd>
  <dt>&quot;implicit&quot;</dt>
  <dd>Set if the pattern starts with
    <span class="Li">&quot;.*&quot;</span>.</dd>
  <dt>&quot;with eval&quot;</dt>
  <dd>Set if the pattern contain eval-groups, such as <span class="Li">&quot;(?{
      code })&quot;</span> and <span class="Li">&quot;(??{ code
    })&quot;</span>.</dd>
  <dt>&quot;anchored(TYPE)&quot;</dt>
  <dd>If the pattern may match only at a handful of places, with
      <span class="Li">&quot;TYPE&quot;</span> being
      <span class="Li">&quot;SBOL&quot;</span>,
      <span class="Li">&quot;MBOL&quot;</span>, or
      <span class="Li">&quot;GPOS&quot;</span>. See the table below.</dd>
</dl>
<p class="Pp">If a substring is known to match at end-of-line only, it may be
    followed by <span class="Li">&quot;$&quot;</span>, as in
    <span class="Li">&quot;floating 'k'$&quot;</span>.</p>
<p class="Pp">The optimizer-specific information is used to avoid entering (a
    slow) regex engine on strings that will not definitely match. If the
    <span class="Li">&quot;isall&quot;</span> flag is set, a call to the regex
    engine may be avoided even when the optimizer found an appropriate place for
    the match.</p>
<p class="Pp">Above the optimizer section is the list of <i>nodes</i> of the
    compiled form of the regex. Each line has format</p>
<p class="Pp"><span class="Li">&quot; &quot;</span><i>id</i>: <i>TYPE</i>
    <i>OPTIONAL-INFO</i> (<i>next-id</i>)</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Types_of_Nodes"><a class="permalink" href="#Types_of_Nodes">Types
  of Nodes</a></h2>
<p class="Pp">Here are the current possible types, with short descriptions:</p>
<p class="Pp"></p>
<pre> # TYPE arg-description [num-args] [longjump-len] DESCRIPTION
 # Exit points
 END              no         End of program.
 SUCCEED          no         Return from a subroutine, basically.
 # Line Start Anchors:
 SBOL             no         Match &quot;&quot; at beginning of line: /^/, /\A/
 MBOL             no         Same, assuming multiline: /^/m
 # Line End Anchors:
 SEOL             no         Match &quot;&quot; at end of line: /$/
 MEOL             no         Same, assuming multiline: /$/m
 EOS              no         Match &quot;&quot; at end of string: /\z/
 # Match Start Anchors:
 GPOS             no         Matches where last m//g left off.
 # Word Boundary Opcodes:
 BOUND            no         Like BOUNDA for non-utf8, otherwise match
                             &quot;&quot; between any Unicode \w\W or \W\w
 BOUNDL           no         Like BOUND/BOUNDU, but \w and \W are
                             defined by current locale
 BOUNDU           no         Match &quot;&quot; at any boundary of a given type
                             using /u rules.
 BOUNDA           no         Match &quot;&quot; at any boundary between \w\W or
                             \W\w, where \w is [_a-zA-Z0-9]
 NBOUND           no         Like NBOUNDA for non-utf8, otherwise match
                             &quot;&quot; between any Unicode \w\w or \W\W
 NBOUNDL          no         Like NBOUND/NBOUNDU, but \w and \W are
                             defined by current locale
 NBOUNDU          no         Match &quot;&quot; at any non-boundary of a given
                             type using using /u rules.
 NBOUNDA          no         Match &quot;&quot; betweeen any \w\w or \W\W, where
                             \w is [_a-zA-Z0-9]
 # [Special] alternatives:
 REG_ANY          no         Match any one character (except newline).
 SANY             no         Match any one character.
 ANYOF            sv         Match character in (or not in) this class,
                  charclass  single char match only
 ANYOFD           sv         Like ANYOF, but /d is in effect
                  charclass
 ANYOFL           sv         Like ANYOF, but /l is in effect
                  charclass
 ANYOFPOSIXL      sv         Like ANYOFL, but matches [[:posix:]]
                  charclass_ classes
                  posixl
 ANYOFH           sv 1       Like ANYOF, but only has &quot;High&quot; matches,
                             none in the bitmap; non-zero flags &quot;f&quot;
                             means &quot;f&quot; is the first UTF-8 byte shared in
                             common by all code points matched
 ANYOFM           byte 1     Like ANYOF, but matches an invariant byte
                             as determined by the mask and arg
 NANYOFM          byte 1     complement of ANYOFM
 # POSIX Character Classes:
 POSIXD           none       Some [[:class:]] under /d; the FLAGS field
                             gives which one
 POSIXL           none       Some [[:class:]] under /l; the FLAGS field
                             gives which one
 POSIXU           none       Some [[:class:]] under /u; the FLAGS field
                             gives which one
 POSIXA           none       Some [[:class:]] under /a; the FLAGS field
                             gives which one
 NPOSIXD          none       complement of POSIXD, [[:^class:]]
 NPOSIXL          none       complement of POSIXL, [[:^class:]]
 NPOSIXU          none       complement of POSIXU, [[:^class:]]
 NPOSIXA          none       complement of POSIXA, [[:^class:]]
 CLUMP            no         Match any extended grapheme cluster
                             sequence
 # Alternation
 # BRANCH        The set of branches constituting a single choice are
 #               hooked together with their &quot;next&quot; pointers, since
 #               precedence prevents anything being concatenated to
 #               any individual branch.  The &quot;next&quot; pointer of the last
 #               BRANCH in a choice points to the thing following the
 #               whole choice.  This is also where the final &quot;next&quot;
 #               pointer of each individual branch points; each branch
 #               starts with the operand node of a BRANCH node.
 #
 BRANCH           node       Match this alternative, or the next...
 # Literals
 EXACT            str        Match this string (preceded by length).
 EXACTL           str        Like EXACT, but /l is in effect (used so
                             locale-related warnings can be checked
                             for).
 EXACTF           str        Match this string using /id rules (w/len);
                             (string not UTF-8, not guaranteed to be
                             folded).
 EXACTFL          str        Match this string using /il rules (w/len);
                             (string not guaranteed to be folded).
 EXACTFU          str        Match this string using /iu rules (w/len);
                             (string folded iff in UTF-8; non-UTF8
                             folded length &lt;= unfolded).
 EXACTFAA         str        Match this string using /iaa rules (w/len)
                             (string folded iff in UTF-8; non-UTF8
                             folded length &lt;= unfolded).
 EXACTFUP         str        Match this string using /iu rules (w/len);
                             (string not UTF-8, not guaranteed to be
                             folded; and its Problematic).
 EXACTFLU8        str        Like EXACTFU, but use /il, UTF-8, folded,
                             and everything in it is above 255.
 EXACTFAA_NO_TRIE str        Match this string using /iaa rules (w/len)
                             (string not UTF-8, not guaranteed to be
                             folded, not currently trie-able).
 EXACT_ONLY8      str        Like EXACT, but only UTF-8 encoded targets
                             can match
 EXACTFU_ONLY8    str        Like EXACTFU, but only UTF-8 encoded
                             targets can match
 EXACTFU_S_EDGE   str        /di rules, but nothing in it precludes /ui,
                             except begins and/or ends with [Ss];
                             (string not UTF-8; compile-time only).
 # Do nothing types
 NOTHING          no         Match empty string.
 # A variant of above which delimits a group, thus stops optimizations
 TAIL             no         Match empty string. Can jump here from
                             outside.
 # Loops
 # STAR,PLUS    '?', and complex '*' and '+', are implemented as
 #               circular BRANCH structures.  Simple cases
 #               (one character per match) are implemented with STAR
 #               and PLUS for speed and to minimize recursive plunges.
 #
 STAR             node       Match this (simple) thing 0 or more times.
 PLUS             node       Match this (simple) thing 1 or more times.
 CURLY            sv 2       Match this simple thing {n,m} times.
 CURLYN           no 2       Capture next-after-this simple thing
 CURLYM           no 2       Capture this medium-complex thing {n,m}
                             times.
 CURLYX           sv 2       Match this complex thing {n,m} times.
 # This terminator creates a loop structure for CURLYX
 WHILEM           no         Do curly processing and see if rest
                             matches.
 # Buffer related
 # OPEN,CLOSE,GROUPP     ...are numbered at compile time.
 OPEN             num 1      Mark this point in input as start of #n.
 CLOSE            num 1      Close corresponding OPEN of #n.
 SROPEN           none       Same as OPEN, but for script run
 SRCLOSE          none       Close preceding SROPEN
 REF              num 1      Match some already matched string
 REFF             num 1      Match already matched string, using /di
                             rules.
 REFFL            num 1      Match already matched string, using /li
                             rules.
 REFFU            num 1      Match already matched string, usng /ui.
 REFFA            num 1      Match already matched string, using /aai
                             rules.
 # Named references.  Code in regcomp.c assumes that these all are after
 # the numbered references
 NREF             no-sv 1    Match some already matched string
 NREFF            no-sv 1    Match already matched string, using /di
                             rules.
 NREFFL           no-sv 1    Match already matched string, using /li
                             rules.
 NREFFU           num 1      Match already matched string, using /ui
                             rules.
 NREFFA           num 1      Match already matched string, using /aai
                             rules.
 # Support for long RE
 LONGJMP          off 1 1    Jump far away.
 BRANCHJ          off 1 1    BRANCH with long offset.
 # Special Case Regops
 IFMATCH          off 1 1    Succeeds if the following matches; non-zero
                             flags &quot;f&quot;, next_off &quot;o&quot; means lookbehind
                             assertion starting &quot;f..(f-o)&quot; characters
                             before current
 UNLESSM          off 1 1    Fails if the following matches; non-zero
                             flags &quot;f&quot;, next_off &quot;o&quot; means lookbehind
                             assertion starting &quot;f..(f-o)&quot; characters
                             before current
 SUSPEND          off 1 1    &quot;Independent&quot; sub-RE.
 IFTHEN           off 1 1    Switch, should be preceded by switcher.
 GROUPP           num 1      Whether the group matched.
 # The heavy worker
 EVAL             evl/flags  Execute some Perl code.
                  2L
 # Modifiers
 MINMOD           no         Next operator is not greedy.
 LOGICAL          no         Next opcode should set the flag only.
 # This is not used yet
 RENUM            off 1 1    Group with independently numbered parens.
 # Trie Related
 # Behave the same as A|LIST|OF|WORDS would. The '..C' variants
 # have inline charclass data (ascii only), the 'C' store it in the
 # structure.
 TRIE             trie 1     Match many EXACT(F[ALU]?)? at once.
                             flags==type
 TRIEC            trie       Same as TRIE, but with embedded charclass
                  charclass  data
 AHOCORASICK      trie 1     Aho Corasick stclass. flags==type
 AHOCORASICKC     trie       Same as AHOCORASICK, but with embedded
                  charclass  charclass data
 # Regex Subroutines
 GOSUB            num/ofs 2L recurse to paren arg1 at (signed) ofs arg2
 # Special conditionals
 NGROUPP          no-sv 1    Whether the group matched.
 INSUBP           num 1      Whether we are in a specific recurse.
 DEFINEP          none 1     Never execute directly.
 # Backtracking Verbs
 ENDLIKE          none       Used only for the type field of verbs
 OPFAIL           no-sv 1    Same as (?!), but with verb arg
 ACCEPT           no-sv/num  Accepts the current matched string, with
                  2L         verbar
 # Verbs With Arguments
 VERB             no-sv 1    Used only for the type field of verbs
 PRUNE            no-sv 1    Pattern fails at this startpoint if no-
                             backtracking through this
 MARKPOINT        no-sv 1    Push the current location for rollback by
                             cut.
 SKIP             no-sv 1    On failure skip forward (to the mark)
                             before retrying
 COMMIT           no-sv 1    Pattern fails outright if backtracking
                             through this
 CUTGROUP         no-sv 1    On failure go to the next alternation in
                             the group
 # Control what to keep in $&amp;.
 KEEPS            no         $&amp; begins here.
 # New charclass like patterns
 LNBREAK          none       generic newline pattern
 # SPECIAL  REGOPS
 # This is not really a node, but an optimized away piece of a &quot;long&quot;
 # node.  To simplify debugging output, we mark it as if it were a node
 OPTIMIZED        off        Placeholder for dump.
 # Special opcode with the property that no opcode in a compiled program
 # will ever be of this type. Thus it can be used as a flag value that
 # no other opcode has been seen. END is used similarly, in that an END
 # node cant be optimized. So END implies &quot;unoptimizable&quot; and PSEUDO
 # mean &quot;not seen anything to optimize yet&quot;.
 PSEUDO           off        Pseudo opcode for internal use.
</pre>
<p class="Pp">Following the optimizer information is a dump of the offset/length
    table, here split across several lines:</p>
<p class="Pp"></p>
<pre>  Offsets: [45]
        1[4] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 5[1]
        0[0] 12[1] 0[0] 6[1] 0[0] 7[1] 0[0] 9[1] 8[1] 0[0] 10[1] 0[0]
        11[1] 0[0] 12[0] 12[0] 13[1] 0[0] 14[4] 0[0] 0[0] 0[0] 0[0]
        0[0] 0[0] 0[0] 0[0] 0[0] 0[0] 18[1] 0[0] 19[1] 20[0]
</pre>
<p class="Pp">The first line here indicates that the offset/length table
    contains 45 entries. Each entry is a pair of integers, denoted by
    <span class="Li">&quot;offset[length]&quot;</span>. Entries are numbered
    starting with 1, so entry #1 here is
    <span class="Li">&quot;1[4]&quot;</span> and entry #12 is
    <span class="Li">&quot;5[1]&quot;</span>.
    <span class="Li">&quot;1[4]&quot;</span> indicates that the node labeled
    <span class="Li">&quot;1:&quot;</span> (the <span class="Li">&quot;1:
    ANYOF[bc]&quot;</span>) begins at character position 1 in the pre-compiled
    form of the regex, and has a length of 4 characters.
    <span class="Li">&quot;5[1]&quot;</span> in position 12 indicates that the
    node labeled <span class="Li">&quot;12:&quot;</span> (the
    <span class="Li">&quot;12: EXACT &lt;d&gt;&quot;</span>) begins at character
    position 5 in the pre-compiled form of the regex, and has a length of 1
    character. <span class="Li">&quot;12[1]&quot;</span> in position 14
    indicates that the node labeled <span class="Li">&quot;14:&quot;</span> (the
    <span class="Li">&quot;14: CURLYX[0] {1,32767}&quot;</span>) begins at
    character position 12 in the pre-compiled form of the regex, and has a
    length of 1 character---that is, it corresponds to the
    <span class="Li">&quot;+&quot;</span> symbol in the precompiled regex.</p>
<p class="Pp"><span class="Li">&quot;0[0]&quot;</span> items indicate that there
    is no corresponding node.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Run-time_Output"><a class="permalink" href="#Run-time_Output">Run-time
  Output</a></h2>
<p class="Pp">First of all, when doing a match, one may get no run-time output
    even if debugging is enabled. This means that the regex engine was never
    entered and that all of the job was therefore done by the optimizer.</p>
<p class="Pp">If the regex engine was entered, the output may look like
  this:</p>
<p class="Pp"></p>
<pre>  Matching '[bc]d(ef*g)+h[ij]k$' against 'abcdefg__gh__'
    Setting an EVAL scope, savestack=3
     2 &lt;ab&gt; &lt;cdefg__gh_&gt;    |  1: ANYOF
     3 &lt;abc&gt; &lt;defg__gh_&gt;    | 11: EXACT &lt;d&gt;
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 13: CURLYX {1,32767}
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 26:   WHILEM
                                0 out of 1..32767  cc=effff31c
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 15:     OPEN1
     4 &lt;abcd&gt; &lt;efg__gh_&gt;    | 17:     EXACT &lt;e&gt;
     5 &lt;abcde&gt; &lt;fg__gh_&gt;    | 19:     STAR
                             EXACT &lt;f&gt; can match 1 times out of 32767...
    Setting an EVAL scope, savestack=3
     6 &lt;bcdef&gt; &lt;g__gh__&gt;    | 22:       EXACT &lt;g&gt;
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 24:       CLOSE1
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 26:       WHILEM
                                    1 out of 1..32767  cc=effff31c
    Setting an EVAL scope, savestack=12
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 15:         OPEN1
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 17:         EXACT &lt;e&gt;
       restoring \1 to 4(4)..7
                                    failed, try continuation...
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 27:         NOTHING
     7 &lt;bcdefg&gt; &lt;__gh__&gt;    | 28:         EXACT &lt;h&gt;
                                    failed...
                                failed...
</pre>
<p class="Pp">The most significant information in the output is about the
    particular <i>node</i> of the compiled regex that is currently being tested
    against the target string. The format of these lines is</p>
<p class="Pp"><span class="Li">&quot; &quot;</span><i>STRING-OFFSET</i>
    &lt;<i>PRE-STRING</i>&gt; &lt;<i>POST-STRING</i>&gt; |<i>ID</i>:
  <i>TYPE</i></p>
<p class="Pp">The <i>TYPE</i> info is indented with respect to the backtracking
    level. Other incidental information appears interspersed within.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="Debugging_Perl_Memory_Usage"><a class="permalink" href="#Debugging_Perl_Memory_Usage">Debugging
  Perl Memory Usage</a></h1>
<p class="Pp">Perl is a profligate wastrel when it comes to memory use. There is
    a saying that to estimate memory usage of Perl, assume a reasonable
    algorithm for memory allocation, multiply that estimate by 10, and while you
    still may miss the mark, at least you won't be quite so astonished. This is
    not absolutely true, but may provide a good grasp of what happens.</p>
<p class="Pp">Assume that an integer cannot take less than 20 bytes of memory, a
    float cannot take less than 24 bytes, a string cannot take less than 32
    bytes (all these examples assume 32-bit architectures, the result are quite
    a bit worse on 64-bit architectures). If a variable is accessed in two of
    three different ways (which require an integer, a float, or a string), the
    memory footprint may increase yet another 20 bytes. A sloppy
    <b>malloc</b>(3) implementation can inflate these numbers dramatically.</p>
<p class="Pp">On the opposite end of the scale, a declaration like</p>
<p class="Pp"></p>
<pre>  sub foo;
</pre>
<p class="Pp">may take up to 500 bytes of memory, depending on which release of
    Perl you're running.</p>
<p class="Pp">Anecdotal estimates of source-to-compiled code bloat suggest an
    eightfold increase. This means that the compiled form of reasonable
    (normally commented, properly indented etc.) code will take about eight
    times more space in memory than the code took on disk.</p>
<p class="Pp">The <b>-DL</b> command-line switch is obsolete since circa Perl
    5.6.0 (it was available only if Perl was built with
    <span class="Li">&quot;-DDEBUGGING&quot;</span>). The switch was used to
    track Perl's memory allocations and possible memory leaks. These days the
    use of malloc debugging tools like <i>Purify</i> or <i>valgrind</i> is
    suggested instead. See also &quot;PERL_MEM_LOG&quot; in perlhacktips.</p>
<p class="Pp">One way to find out how much memory is being used by Perl data
    structures is to install the Devel::Size module from CPAN: it gives you the
    minimum number of bytes required to store a particular data structure.
    Please be mindful of the difference between the <b>size()</b> and
    <b>total_size()</b>.</p>
<p class="Pp">If Perl has been compiled using Perl's malloc you can analyze Perl
    memory usage by setting <span class="Li">$ENV</span>{PERL_DEBUG_MSTATS}.</p>
<section class="Ss">
<h2 class="Ss" id="Using_$ENV_PERL_DEBUG_MSTATS_"><a class="permalink" href="#Using_$ENV_PERL_DEBUG_MSTATS_">Using
  $ENV{PERL_DEBUG_MSTATS}</a></h2>
<p class="Pp">If your perl is using Perl's <b>malloc()</b> and was compiled with
    the necessary switches (this is the default), then it will print memory
    usage statistics after compiling your code when
    <span class="Li">&quot;$ENV{PERL_DEBUG_MSTATS}</span> <span class="Li">&gt;
    1&quot;</span>, and before termination of the program when
    <span class="Li">&quot;$ENV{PERL_DEBUG_MSTATS} &gt;= 1&quot;</span>. The
    report format is similar to the following example:</p>
<p class="Pp"></p>
<pre> $ PERL_DEBUG_MSTATS=2 perl -e &quot;require Carp&quot;
 Memory allocation statistics after compilation: (buckets 4(4)..8188(8192)
    14216 free:   130   117    28     7     9   0   2     2   1 0 0
                437    61    36     0     5
    60924 used:   125   137   161    55     7   8   6    16   2 0 1
                 74   109   304    84    20
 Total sbrk(): 77824/21:119. Odd ends: pad+heads+chain+tail: 0+636+0+2048.
 Memory allocation statistics after execution:   (buckets 4(4)..8188(8192)
    30888 free:   245    78    85    13     6   2   1     3   2 0 1
                315   162    39    42    11
   175816 used:   265   176  1112   111    26  22  11    27   2 1 1
                196   178  1066   798    39
 Total sbrk(): 215040/47:145. Odd ends: pad+heads+chain+tail: 0+2192+0+6144.
</pre>
<p class="Pp">It is possible to ask for such a statistic at arbitrary points in
    your execution using the <b>mstat()</b> function out of the standard
    Devel::Peek module.</p>
<p class="Pp">Here is some explanation of that format:</p>
<dl class="Bl-tag">
  <dt>&quot;buckets SMALLEST(APPROX)..GREATEST(APPROX)&quot;</dt>
  <dd>Perl's <b>malloc()</b> uses bucketed allocations. Every request is rounded
      up to the closest bucket size available, and a bucket is taken from the
      pool of buckets of that size.
    <p class="Pp">The line above describes the limits of buckets currently in
        use. Each bucket has two sizes: memory footprint and the maximal size of
        user data that can fit into this bucket. Suppose in the above example
        that the smallest bucket were size 4. The biggest bucket would have
        usable size 8188, and the memory footprint would be 8192.</p>
    <p class="Pp">In a Perl built for debugging, some buckets may have negative
        usable size. This means that these buckets cannot (and will not) be
        used. For larger buckets, the memory footprint may be one page greater
        than a power of 2. If so, the corresponding power of two is printed in
        the <span class="Li">&quot;APPROX&quot;</span> field above.</p>
  </dd>
  <dt id="Free/Used"><a class="permalink" href="#Free/Used">Free/Used</a></dt>
  <dd>The 1 or 2 rows of numbers following that correspond to the number of
      buckets of each size between <span class="Li">&quot;SMALLEST&quot;</span>
      and <span class="Li">&quot;GREATEST&quot;</span>. In the first row, the
      sizes (memory footprints) of buckets are powers of two--or possibly one
      page greater. In the second row, if present, the memory footprints of the
      buckets are between the memory footprints of two buckets
      &quot;above&quot;.
    <p class="Pp">For example, suppose under the previous example, the memory
        footprints were</p>
    <p class="Pp"></p>
    <pre>   free:    8     16    32    64    128  256 512 1024 2048 4096 8192
           4     12    24    48    80
    </pre>
    <p class="Pp">With a non-<span class="Li">&quot;DEBUGGING&quot;</span> perl,
        the buckets starting from <span class="Li">128</span> have a 4-byte
        overhead, and thus an 8192-long bucket may take up to 8188-byte
        allocations.</p>
  </dd>
  <dt>&quot;Total sbrk(): SBRKed/SBRKs:CONTINUOUS&quot;</dt>
  <dd>The first two fields give the total amount of memory perl <b>sbrk</b>(2)ed
      (ess-broken? :-) and number of <b>sbrk</b>(2)s used. The third number is
      what perl thinks about continuity of returned chunks. So long as this
      number is positive, <b>malloc()</b> will assume that it is probable that
      <b>sbrk</b>(2) will provide continuous memory.
    <p class="Pp">Memory allocated by external libraries is not counted.</p>
  </dd>
  <dt>&quot;pad: 0&quot;</dt>
  <dd>The amount of <b>sbrk</b>(2)ed memory needed to keep buckets aligned.</dd>
  <dt>&quot;heads: 2192&quot;</dt>
  <dd>Although memory overhead of bigger buckets is kept inside the bucket, for
      smaller buckets, it is kept in separate areas. This field gives the total
      size of these areas.</dd>
  <dt>&quot;chain: 0&quot;</dt>
  <dd><b>malloc()</b> may want to subdivide a bigger bucket into smaller
      buckets. If only a part of the deceased bucket is left unsubdivided, the
      rest is kept as an element of a linked list. This field gives the total
      size of these chunks.</dd>
  <dt>&quot;tail: 6144&quot;</dt>
  <dd>To minimize the number of <b>sbrk</b>(2)s, <b>malloc()</b> asks for more
      memory. This field gives the size of the yet unused part, which is
      <b>sbrk</b>(2)ed, but never touched.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">perldebug, perlguts, perlrun re, and Devel::DProf.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2019-10-21</td>
    <td class="foot-os">perl v5.30.3</td>
  </tr>
</table>
</body>
</html>
