<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.10 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>ENC2XS(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ENC2XS(1)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">ENC2XS(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
enc2xs -- Perl Encode Module Generator
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
  enc2xs -[options]
  enc2xs -M ModName mapfiles...
  enc2xs -C
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<i>enc2xs</i> builds a Perl extension for use by Encode from either Unicode
  Character Mapping files (.ucm) or Tcl Encoding Files (.enc). Besides being
  used internally during the build process of the Encode module, you can use
  <i>enc2xs</i> to add your own encoding to perl. No knowledge of XS is
  necessary.
</section>
<section class="Sh">
<h1 class="Sh" id="Quick_Guide"><a class="permalink" href="#Quick_Guide">Quick
  Guide</a></h1>
If you want to know as little about Perl as possible but need to add a new
  encoding, just read this chapter and forget the rest.
<dl class="Bl-tag">
  <dt>0.</dt>
  <dd>Have a .ucm file ready. You can get it from somewhere or you can write
      your own from scratch or you can grab one from the Encode distribution and
      customize it. For the UCM format, see the next Chapter. In the example
      below, I'll call my theoretical encoding myascii, defined in
      <i>my.ucm</i>. <span class="Li">&quot;$&quot;</span> is a shell prompt.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  $ ls -F
  my.ucm
    </pre>
  </dd>
  <dt>1.</dt>
  <dd>Issue a command as follows;
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  $ enc2xs -M My my.ucm
  generating Makefile.PL
  generating My.pm
  generating README
  generating Changes
    </pre>
    <p class="Pp">Now take a look at your current directory. It should look like
        this.</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  $ ls -F
  Makefile.PL   My.pm         my.ucm        t/
    </pre>
    <p class="Pp">The following files were created.</p>
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  Makefile.PL - MakeMaker script
  My.pm       - Encode submodule
  t/My.t      - test file
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>1.1.</dt>
  <dd>If you want *.ucm installed together with the modules, do as follows;
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  $ mkdir Encode
  $ mv *.ucm Encode
  $ enc2xs -M My Encode/*ucm
    </pre>
  </dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>2.</dt>
  <dd>Edit the files generated. You don't have to if you have no time AND no
      intention to give it to someone else. But it is a good idea to edit the
      pod and to add more tests.</dd>
  <dt>3.</dt>
  <dd>Now issue a command all Perl Mongers love:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  $ perl Makefile.PL
  Writing Makefile for Encode::My
    </pre>
  </dd>
  <dt>4.</dt>
  <dd>Now all you have to do is make.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  $ make
  cp My.pm blib/lib/Encode/My.pm
  /usr/local/bin/perl /usr/local/bin/enc2xs -Q -O \
    -o encode_t.c -f encode_t.fnm
  Reading myascii (myascii)
  Writing compiled form
  128 bytes in string tables
  384 bytes (75%) saved spotting duplicates
  1 bytes (0.775%) saved using substrings
  ....
  chmod 644 blib/arch/auto/Encode/My/My.bs
  $
    </pre>
    <p class="Pp">The time it takes varies depending on how fast your machine is
        and how large your encoding is. Unless you are working on something big
        like euc-tw, it won't take too long.</p>
  </dd>
  <dt>5.</dt>
  <dd>You can &quot;make install&quot; already but you should test first.
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  $ make test
  PERL_DL_NONLAZY=1 /usr/local/bin/perl -Iblib/arch -Iblib/lib \
    -e 'use Test::Harness  qw(&amp;runtests $verbose); \
    $verbose=0; runtests @ARGV;' t/*.t
  t/My....ok
  All tests successful.
  Files=1, Tests=2,  0 wallclock secs
   ( 0.09 cusr + 0.01 csys = 0.09 CPU)
    </pre>
  </dd>
  <dt>6.</dt>
  <dd>If you are content with the test result, just &quot;make
    install&quot;</dd>
  <dt>7.</dt>
  <dd>If you want to add your encoding to Encode's demand-loading list (so you
      don't have to &quot;use Encode::YourEncoding&quot;), run
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  enc2xs -C
    </pre>
    <p class="Pp">to update Encode::ConfigLocal, a module that controls local
        settings. After that, &quot;use Encode;&quot; is enough to load your
        encodings on demand.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="The_Unicode_Character_Map"><a class="permalink" href="#The_Unicode_Character_Map">The
  Unicode Character Map</a></h1>
Encode uses the Unicode Character Map (UCM) format for source character
  mappings. This format is used by IBM's ICU package and was adopted by Nick
  Ing-Simmons for use with the Encode module. Since UCM is more flexible than
  Tcl's Encoding Map and far more user-friendly, this is the recommended format
  for Encode now.
<p class="Pp">A UCM file looks like this.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  #
  # Comments
  #
  &lt;code_set_name&gt; &quot;US-ascii&quot; # Required
  &lt;code_set_alias&gt; &quot;ascii&quot;   # Optional
  &lt;mb_cur_min&gt; 1             # Required; usually 1
  &lt;mb_cur_max&gt; 1             # Max. # of bytes/char
  &lt;subchar&gt; \x3F             # Substitution char
  #
  CHARMAP
  &lt;U0000&gt; \x00 |0 # &lt;control&gt;
  &lt;U0001&gt; \x01 |0 # &lt;control&gt;
  &lt;U0002&gt; \x02 |0 # &lt;control&gt;
  ....
  &lt;U007C&gt; \x7C |0 # VERTICAL LINE
  &lt;U007D&gt; \x7D |0 # RIGHT CURLY BRACKET
  &lt;U007E&gt; \x7E |0 # TILDE
  &lt;U007F&gt; \x7F |0 # &lt;control&gt;
  END CHARMAP
</pre>
<ul class="Bl-bullet">
  <li>Anything that follows <span class="Li">&quot;#&quot;</span> is treated as
      a comment.</li>
  <li>The header section continues until a line containing the word CHARMAP.
      This section has a form of <i>&lt;keyword&gt; value</i>, one pair per
      line. Strings used as values must be quoted. Barewords are treated as
      numbers. <i>\xXX</i> represents a byte.
    <p class="Pp">Most of the keywords are self-explanatory. <i>subchar</i>
        means substitution character, not subcharacter. When you decode a
        Unicode sequence to this encoding but no matching character is found,
        the byte sequence defined here will be used. For most cases, the value
        here is \x3F; in ASCII, this is a question mark.</p>
  </li>
  <li>CHARMAP starts the character map section. Each line has a form as follows:
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  &lt;UXXXX&gt; \xXX.. |0 # comment
    ^     ^      ^
    |     |      +- Fallback flag
    |     +-------- Encoded byte sequence
    +-------------- Unicode Character ID in hex
    </pre>
    <p class="Pp">The format is roughly the same as a header section except for
        the fallback flag: | followed by 0..3. The meaning of the possible
        values is as follows:</p>
  </li>
</ul>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>|0</dt>
  <dd>Round trip safe. A character decoded to Unicode encodes back to the same
      byte sequence. Most characters have this flag.</dd>
  <dt>|1</dt>
  <dd>Fallback for unicode -&gt; encoding. When seen, enc2xs adds this character
      for the encode map only.</dd>
  <dt>|2</dt>
  <dd>Skip sub-char mapping should there be no code point.</dd>
  <dt>|3</dt>
  <dd>Fallback for encoding -&gt; unicode. When seen, enc2xs adds this character
      for the decode map only.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>And finally, END OF CHARMAP ends the section.</dd>
</dl>
<p class="Pp">When you are manually creating a UCM file, you should copy
    ascii.ucm or an existing encoding which is close to yours, rather than write
    your own from scratch.</p>
<p class="Pp">When you do so, make sure you leave at least <b>U0000</b> to
    <b>U0020</b> as is, unless your environment is EBCDIC.</p>
<p class="Pp"><b>CAVEAT</b>: not all features in UCM are implemented. For
    example, icu:state is not used. Because of that, you need to write a perl
    module if you want to support algorithmical encodings, notably the ISO-2022
    series. Such modules include Encode::JP::2022_JP, Encode::KR::2022_KR, and
    Encode::TW::HZ.</p>
<section class="Ss">
<h2 class="Ss" id="Coping_with_duplicate_mappings"><a class="permalink" href="#Coping_with_duplicate_mappings">Coping
  with duplicate mappings</a></h2>
When you create a map, you SHOULD make your mappings round-trip safe. That is,
  <span class="Li">&quot;encode('your-encoding', decode('your-encoding', $data))
  eq</span> <span class="Li">$data&quot;</span> stands for all characters that
  are marked as <span class="Li">&quot;|0&quot;</span>. Here is how to make
  sure:
<ul class="Bl-bullet">
  <li>Sort your map in Unicode order.</li>
  <li>When you have a duplicate entry, mark either one with '|1' or '|3'.</li>
  <li>And make sure the '|1' or '|3' entry FOLLOWS the '|0' entry.</li>
</ul>
<p class="Pp">Here is an example from big5-eten.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  &lt;U2550&gt; \xF9\xF9 |0
  &lt;U2550&gt; \xA2\xA4 |3
</pre>
<p class="Pp">Internally Encoding -&gt; Unicode and Unicode -&gt; Encoding Map
    looks like this;</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  E to U               U to E
  --------------------------------------
  \xF9\xF9 =&gt; U2550    U2550 =&gt; \xF9\xF9
  \xA2\xA4 =&gt; U2550
</pre>
<p class="Pp">So it is round-trip safe for \xF9\xF9. But if the line above is
    upside down, here is what happens.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  E to U               U to E
  --------------------------------------
  \xA2\xA4 =&gt; U2550    U2550 =&gt; \xF9\xF9
  (\xF9\xF9 =&gt; U2550 is now overwritten!)
</pre>
<p class="Pp">The Encode package comes with <i>ucmlint</i>, a crude but
    sufficient utility to check the integrity of a UCM file. Check under the
    Encode/bin directory for this.</p>
<p class="Pp">When in doubt, you can use <i>ucmsort</i>, yet another utility
    under Encode/bin directory.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="Bookmarks"><a class="permalink" href="#Bookmarks">Bookmarks</a></h1>
<ul class="Bl-bullet">
  <li>ICU Home Page &lt;http://www.icu-project.org/&gt;</li>
  <li>ICU Character Mapping Tables
      &lt;http://site.icu-project.org/charts/charset&gt;</li>
  <li>ICU:Conversion Data
      &lt;http://www.icu-project.org/userguide/conversion-data.html&gt;</li>
</ul>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
Encode, perlmod, perlpod
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-02-09</td>
    <td class="foot-os">perl v5.28.2</td>
  </tr>
</table>
</body>
</html>
