<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Generated from file '/Library/Caches/com.apple.xbs/Sources/tcl/tcl-128/tcl_ext/tcllib/tcllib/modules/ldap/ldapx.man' by tcllib/doctools with format 'nroff'
   Copyright (c) 2006 Pierre David <pdav@users.sourceforge.net>
  
   The definitions below are for supplemental macros used in Tcl/Tk
   manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO
  	Start of list of standard options for a Tk widget.  The
  	options follow on successive lines, in four columns separated
  	by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   RCS: @(#) $Id: man.macros,v 1.1 2009/01/30 04:56:47 andreas_kupries Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
  	# Start an argument description
  .b
  	# define tabbing values for .AP
  
  	# BS - start boxed text
  	# ^y = starting y location
  	# ^b = 1
  	# BE - end boxed text (draw box now)
  	Draw four-sided box normally, but don't draw top of
  	box if the box started on an earlier page.
  	# VS - start vertical sidebar
  	# ^Y = starting y location
  	# ^v = 1 (for troff;  for nroff this doesn't matter)
  	# VE - end of vertical sidebar
  	# Special macro to handle page bottom:  finish off current
  	# box/sidebar if in box/sidebar mode, then invoked standard
  	# page bottom macro.
  	Draw three-sided box if this is the box's first page,
  	draw two sides but no top otherwise.
  	# DS - begin display
  	# DE - end display
  	# SO - start of list of standard options
  	# SE - end of list of standard options
  	# OP - start of full description for a single option
  	# CS - begin code excerpt
  	# CE - end code excerpt
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>ldapx(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ldapx(n)</td>
    <td class="head-vol">LDAP extended object interface</td>
    <td class="head-rtitle">ldapx(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>

</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
ldapx - LDAP extended object interface
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
package require <b>Tcl 8.4</b>
<p class="Pp">package require <b>ldapx ?1.0?</b></p>
<p class="Pp"><i>e</i> <b>reset</b></p>
<p class="Pp"><i>e</i> <b>dn</b> ?<i>newdn</i>?</p>
<p class="Pp"><i>e</i> <b>rdn</b></p>
<p class="Pp"><i>e</i> <b>superior</b></p>
<p class="Pp"><i>e</i> <b>print</b></p>
<p class="Pp"><i>se</i> <b>isempty</b></p>
<p class="Pp"><i>se</i> <b>get</b> <i>attr</i></p>
<p class="Pp"><i>se</i> <b>get1</b> <i>attr</i></p>
<p class="Pp"><i>se</i> <b>set</b> <i>attr</i> <i>values</i></p>
<p class="Pp"><i>se</i> <b>set1</b> <i>attr</i> <i>value</i></p>
<p class="Pp"><i>se</i> <b>add</b> <i>attr</i> <i>values</i></p>
<p class="Pp"><i>se</i> <b>add1</b> <i>attr</i> <i>value</i></p>
<p class="Pp"><i>se</i> <b>del</b> <i>attr</i> ?<i>values</i>?</p>
<p class="Pp"><i>se</i> <b>del1</b> <i>attr</i> <i>value</i></p>
<p class="Pp"><i>se</i> <b>getattr</b></p>
<p class="Pp"><i>se</i> <b>getall</b></p>
<p class="Pp"><i>se</i> <b>setall</b> <i>avpairs</i></p>
<p class="Pp"><i>se</i> <b>backup</b> ?<i>other</i>?</p>
<p class="Pp"><i>se</i> <b>swap</b></p>
<p class="Pp"><i>se</i> <b>restore</b> ?<i>other</i>?</p>
<p class="Pp"><i>se</i> <b>apply</b> <i>centry</i></p>
<p class="Pp"><i>ce</i> <b>change</b> ?<i>new</i>?</p>
<p class="Pp"><i>ce</i> <b>diff</b> <i>new</i> ?<i>old</i>?</p>
<p class="Pp"><i>la</i> <b>error</b> ?<i>newmsg</i>?</p>
<p class="Pp"><i>la</i> <b>connect</b> <i>url</i> ?<i>binddn</i>?
    ?<i>bindpw</i>?</p>
<p class="Pp"><i>la</i> <b>disconnect</b></p>
<p class="Pp"><i>la</i> <b>traverse</b> <i>base</i> <i>filter</i> <i>attrs</i>
    <i>entry</i> <i>body</i></p>
<p class="Pp"><i>la</i> <b>search</b> <i>base</i> <i>filter</i> <i>attrs</i></p>
<p class="Pp"><i>la</i> <b>read</b> <i>base</i> <i>filter</i> <i>entry</i> ...
    <i>entry</i></p>
<p class="Pp"><i>la</i> <b>commit</b> <i>entry</i> ... <i>entry</i></p>
<p class="Pp"><i>li</i> <b>channel</b> <i>chan</i></p>
<p class="Pp"><i>li</i> <b>error</b> ?<i>newmsg</i>?</p>
<p class="Pp"><i>li</i> <b>read</b> <i>entry</i></p>
<p class="Pp"><i>li</i> <b>write</b> <i>entry</i></p>
<p class="Pp"></p>
<pre>

</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <b>ldapx</b> package provides an extended Tcl interface to LDAP directores
  and LDIF files. The <b>ldapx</b> package is built upon the <b>ldap</b> package
  in order to get low level LDAP access.
<p class="Pp">LDAP access is compatible with RFC 2251
    (<i>http://www.rfc-editor.org/rfc/rfc2251.txt</i>). LDIF access is
    compatible with RFC 2849
  (<i>http://www.rfc-editor.org/rfc/rfc2849.txt</i>).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OVERVIEW"><a class="permalink" href="#OVERVIEW">OVERVIEW</a></h1>
The <b>ldapx</b> package provides objects to interact with LDAP directories and
  LDIF files with an easy to use programming interface. It implements three
  <b>snit</b>::type classes.
<p class="Pp">The first class, <b>entry</b>, is used to store individual
    entries. Two different formats are available: the first one is the
    <i>standard</i> format, which represents an entry as read from the
    directory. The second format is the <i>change</i> format, which stores
    differences between two standard entries.</p>
<p class="Pp">With these entries, an application which wants to modify an entry
    in a directory needs to read a (standard) entry from the directory, create a
    fresh copy into a new (standard) entry, modify the new copy, and then
    compute the differences between the two entries into a new (change) entry,
    which may be commited to the directory.</p>
<p class="Pp">Such kinds of modifications are so heavily used that standard
    entries may contain their own copy of the original data. With such a copy,
    the application described above reads a (standard) entry from the directory,
    backs-up the original data, modifies the entry, and computes the differences
    between the entry and its backup. These differences are then commited to the
    directory.</p>
<p class="Pp">Methods are provided to compute differences between two entries,
    to apply differences to an entry in order to get a new entry, and to get or
    set attributes in standard entries.</p>
<p class="Pp">The second class is the <b>ldap</b> class. It provides a method to
    <b>connect</b> and bind to the directory with a uniform access to LDAP and
    LDAPS through an URL (ldap:// or ldaps://). The <b>traverse</b> control
    structure executes a body for each entry found in the directory. The
    <b>commit</b> method applies some changes (represented as <b>entry</b>
    objects) to the directory. Since some attributes are represented as UTF-8
    strings, the option <b>-utf8</b> controls which attributes must be converted
    and which attributes must not be converted.</p>
<p class="Pp">The last class is the <b>ldif</b> class. It provides a method to
    associate a standard Tcl <i>channel</i> to an LDIF object. Then, methods
    <b>read</b> and <b>write</b> read or write entries from or to this channel.
    This class can make use of standard or change entries, according to the type
    of the LDIF file which may contain either standard entries or change entries
    (but not both at the same time). The option <b>-utf8</b> works exactly as
    with the <b>ldap</b> class.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ENTRY_CLASS"><a class="permalink" href="#ENTRY_CLASS">ENTRY
  CLASS</a></h1>
<section class="Ss">
<h2 class="Ss" id="ENTRY_INSTANCE_DATA"><a class="permalink" href="#ENTRY_INSTANCE_DATA">ENTRY
  INSTANCE DATA</a></h2>
An instance of the <b>entry</b> class keeps the following data:
<dl class="Bl-tag">
  <dt>dn</dt>
  <dd>This is the DN of the entry, which includes (in LDAP terminology) the RDN
      (relative DN) and the Superior parts.</dd>
  <dt>format</dt>
  <dd>The format may be <i>uninitialized</i> (entry not yet used),
      <i>standard</i> or <i>change</i>. Most methods check the format of the
      entry, which can be reset with the <b>reset</b> method.</dd>
  <dt>attrvals</dt>
  <dd>In a <i>standard</i> entry, this is where the attributes and associated
      values are stored. Many methods provide access to these informations.
      Attribute names are always converted into lower case.</dd>
  <dt>backup</dt>
  <dd>In a <i>standard</i> entry, the backup may contain a copy of the dn and
      all attributes and values. Methods <b>backup</b> and <b>restore</b>
      manipulate these data, and method <b>diff</b> may use this backup.</dd>
  <dt>change</dt>
  <dd>In a <i>change</i> entry, these data represent the modifications. Such
      modifications are handled by specialized methods such as <b>apply</b> or
      <b>commit</b>. Detailed format should not be used directly by programs.
    <p class="Pp">Internally, modifications are represented as a list of
        elements, each element has one of the following formats (which match the
        corresponding LDAP operations):</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>[1]</dt>
  <dd>{<b>add</b> {attr1 {val1...valn} attr2 {...} ...}}
    <p class="Pp">Addition of a new entry.</p>
  </dd>
  <dt>[2]</dt>
  <dd>{<b>mod</b> {modop {attr1 ?val1...valn?} attr2 ...} {modop ...} ...}
    <p class="Pp">Modification of one or more attributes and/or values, where
        &lt;modop&gt; can be <b>modadd</b>, <b>moddel</b> or <b>modrepl</b> (see
        the LDAP modify operation).</p>
  </dd>
  <dt>[3]</dt>
  <dd>{<b>del</b>}
    <p class="Pp">Deletion of an old entry.</p>
  </dd>
  <dt>[4]</dt>
  <dd>{<b>modrdn</b> newrdn deleteoldrdn ?newsuperior?}
    <p class="Pp">Renaming of an entry.</p>
  </dd>
</dl>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="ENTRY_OPTIONS"><a class="permalink" href="#ENTRY_OPTIONS">ENTRY
  OPTIONS</a></h2>
No option is defined by this class.
</section>
<section class="Ss">
<h2 class="Ss" id="METHODS_FOR_ALL_KINDS_OF_ENTRIES"><a class="permalink" href="#METHODS_FOR_ALL_KINDS_OF_ENTRIES">METHODS
  FOR ALL KINDS OF ENTRIES</a></h2>
<dl class="Bl-tag">
  <dt><i>e</i> <b>reset</b></dt>
  <dd>This method resets the entry to an uninitialized state.</dd>
  <dt><i>e</i> <b>dn</b> ?<i>newdn</i>?</dt>
  <dd>This method returns the current DN of the entry. If the optional
      <i>newdn</i> is specified, it replaces the current DN of the entry.</dd>
  <dt><i>e</i> <b>rdn</b></dt>
  <dd>This method returns the RDN part of the DN of the entry.</dd>
  <dt><i>e</i> <b>superior</b></dt>
  <dd>This method returns the superior part of the DN of the entry.</dd>
  <dt><i>e</i> <b>print</b></dt>
  <dd>This method returns the entry as a string ready to be printed.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="METHODS_FOR_STANDARD_ENTRIES_ONLY"><a class="permalink" href="#METHODS_FOR_STANDARD_ENTRIES_ONLY">METHODS
  FOR STANDARD ENTRIES ONLY</a></h2>
In all methods, attribute names are converted in lower case.
<dl class="Bl-tag">
  <dt><i>se</i> <b>isempty</b></dt>
  <dd>This method returns 1 if the entry is empty (i.e. without any
    attribute).</dd>
  <dt><i>se</i> <b>get</b> <i>attr</i></dt>
  <dd>This method returns all values of the attribute <i>attr</i>, or the empty
      list if the attribute is not fond.</dd>
  <dt><i>se</i> <b>get1</b> <i>attr</i></dt>
  <dd>This method returns the first value of the attribute.</dd>
  <dt><i>se</i> <b>set</b> <i>attr</i> <i>values</i></dt>
  <dd>This method sets the values (list <i>values</i>) of the attribute
      <i>attr</i>. If the list is empty, this method deletes all</dd>
  <dt><i>se</i> <b>set1</b> <i>attr</i> <i>value</i></dt>
  <dd>This method sets the values of the attribute <i>attr</i> to be an unique
      value <i>value</i>. Previous values, if any, are replaced by the new
      value.</dd>
  <dt><i>se</i> <b>add</b> <i>attr</i> <i>values</i></dt>
  <dd>This method adds all elements the list <i>values</i> to the values of the
      attribute <i>attr</i>.</dd>
  <dt><i>se</i> <b>add1</b> <i>attr</i> <i>value</i></dt>
  <dd>This method adds a single value given by the parameter <i>value</i> to the
      attribute <i>attr</i>.</dd>
  <dt><i>se</i> <b>del</b> <i>attr</i> ?<i>values</i>?</dt>
  <dd>If the optional list <i>values</i> is specified, this method deletes all
      specified values from the attribute <i>attr</i>. If the argument
      <i>values</i> is not specified, this method deletes all values.</dd>
  <dt><i>se</i> <b>del1</b> <i>attr</i> <i>value</i></dt>
  <dd>This method deletes a unique <i>value</i> from the attribute
    <i>attr</i>.</dd>
  <dt><i>se</i> <b>getattr</b></dt>
  <dd>This method returns all attributes names.</dd>
  <dt><i>se</i> <b>getall</b></dt>
  <dd>This method returns all attributes and values from the entry, packed in a
      list of pairs &lt;attribute, list of values&gt;.</dd>
  <dt><i>se</i> <b>setall</b> <i>avpairs</i></dt>
  <dd>This method sets at once all attributes and values. The format of the
      <i>avpairs</i> argument is the same as the one returned by method
      <b>getall</b>.</dd>
  <dt><i>se</i> <b>backup</b> ?<i>other</i>?</dt>
  <dd>This method stores in an <i>other</i> standard entry object a copy of the
      current DN and attributes/values. If the optional <i>other</i> argument is
      not specified, copy is done in the current entry (in a specific place, see
      section <b>OVERVIEW</b>).</dd>
  <dt><i>se</i> <b>swap</b></dt>
  <dd>This method swaps the current and backup contexts of the entry.</dd>
  <dt><i>se</i> <b>restore</b> ?<i>other</i>?</dt>
  <dd>If the optional argument <i>other</i> is given, which must then be a
      <i>standard</i> entry, this method restores the current entry into the
      <i>other</i> entry. If the argument <i>other</i> argument is not
      specified, this methods restores the current entry from its internal
      backup (see section <b>OVERVIEW</b>).</dd>
  <dt><i>se</i> <b>apply</b> <i>centry</i></dt>
  <dd>This method applies changes defined in the <i>centry</i> argument, which
      must be a <i>change</i> entry.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="METHODS_FOR_CHANGE_ENTRIES_ONLY"><a class="permalink" href="#METHODS_FOR_CHANGE_ENTRIES_ONLY">METHODS
  FOR CHANGE ENTRIES ONLY</a></h2>
<dl class="Bl-tag">
  <dt><i>ce</i> <b>change</b> ?<i>new</i>?</dt>
  <dd>If the optional argument <i>new</i> is specified, this method modifies the
      change list (see subsection <b>Entry Instance Data</b> for the exact
      format). In both cases, current change list is returned. Warning: values
      returned by this method should only be used by specialized methods such as
      <b>apply</b> or <b>commit</b>.</dd>
  <dt><i>ce</i> <b>diff</b> <i>new</i> ?<i>old</i>?</dt>
  <dd>This method computes the differences between the <i>new</i> and <i>old</i>
      entries under the form of a change list, and stores this list into the
      current <i>change</i> entry. If the optional argument <i>old</i> is not
      specified, difference is computed from the entry and its internal backup
      (see section <b>OVERVIEW</b>). Return value is the computed change
    list.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="ENTRY_EXAMPLE"><a class="permalink" href="#ENTRY_EXAMPLE">ENTRY
  EXAMPLE</a></h2>
<pre>
    package require ldapx
    #
    # Create an entry and fill it as a standard entry with
    # attributes and values
    #
    ::ldapx::entry create e
    e dn &quot;uid=joe,ou=people,o=mycomp&quot;
    e set1 &quot;uid&quot;             &quot;joe&quot;
    e set  &quot;objectClass&quot;     {person anotherObjectClass}
    e set1 &quot;givenName&quot;       &quot;Joe&quot;
    e set1 &quot;sn&quot;              &quot;User&quot;
    e set  &quot;telephoneNumber&quot; {+31415926535 +2182818}
    e set1 &quot;anotherAttr&quot;     &quot;This is a beautiful day, isn't it?&quot;
    puts stdout &quot;e\n[e print]&quot;
    #
    # Create a second entry as a backup of the first, and
    # make some changes on it.
    # Entry is named automatically by snit.
    #
    set b [::ldapx::entry create %AUTO%]
    e backup $b
    puts stdout &quot;$b\n[$b print]&quot;
    $b del  &quot;anotherAttr&quot;
    $b del1 &quot;objectClass&quot; &quot;anotherObjectClass&quot;
    #
    # Create a change entry, a compute differences between first
    # and second entry.
    #
    ::ldapx::entry create c
    c diff e $b
    puts stdout &quot;$c\n[$c print]&quot;
    #
    # Apply changes to first entry. It should be the same as the
    # second entry, now.
    #
    e apply c
    ::ldapx::entry create nc
    nc diff e $b
    puts stdout &quot;nc\n[nc print]&quot;
    #
    # Clean-up
    #
    e destroy
    $b destroy
    c destroy
    nc destroy
</pre>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="LDAP_CLASS"><a class="permalink" href="#LDAP_CLASS">LDAP
  CLASS</a></h1>
<section class="Ss">
<h2 class="Ss" id="LDAP_INSTANCE_DATA"><a class="permalink" href="#LDAP_INSTANCE_DATA">LDAP
  INSTANCE DATA</a></h2>
An instance of the <b>ldap</b> class keeps the following data:
<dl class="Bl-tag">
  <dt>channel</dt>
  <dd>This is the channel used by the <b>ldap</b> package for communication with
      the LDAP server.</dd>
  <dt>lastError</dt>
  <dd>This variable contains the error message which appeared in the last method
      of the <b>ldap</b> class (this string is modified in nearly all methods).
      The <b>error</b> method may be used to fetch this message.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="LDAP_OPTIONS"><a class="permalink" href="#LDAP_OPTIONS">LDAP
  OPTIONS</a></h2>
A first set of options of the <b>ldap</b> class is used during search operations
  (methods <b>traverse</b>, <b>search</b> and <b>read</b>, see below).
<dl class="Bl-tag">
  <dt><b>-scope</b> <b>base</b>|<b>one</b>|<b>sub</b></dt>
  <dd>Specify the scope of the LDAP search to be one of <b>base</b>, <b>one</b>
      or <b>sub</b> to specify a base object, one-level or subtree search.
    <p class="Pp">The default is <b>sub</b>.</p>
  </dd>
  <dt><b>-derefaliases</b>
    <b>never</b>|<b>seach</b>|<b>find</b>|<b>always</b></dt>
  <dd>Specify how aliases dereferencing is handled: <b>never</b> is used to
      specify that aliases are never derefenced, <b>always</b> that aliases are
      always derefenced, <b>search</b> that aliases are dereferenced when
      searching, or <b>find</b> that aliases are dereferenced only when locating
      the base object for the search.
    <p class="Pp">The default is <b>never</b>.</p>
  </dd>
  <dt><b>-sizelimit</b> integer</dt>
  <dd>Specify the maximum number of entries to be retreived during a search. A
      value of <b>0</b> means no limit.
    <p class="Pp">Default is <b>0</b>.</p>
  </dd>
  <dt><b>-timelimit</b> integer</dt>
  <dd>Specify the time limit for a search to complete. A value of <b>0</b> means
      no limit.
    <p class="Pp">Default is <b>0</b>.</p>
  </dd>
  <dt><b>-attrsonly</b> <b>0</b>|<b>1</b></dt>
  <dd>Specify if only attribute names are to be retrieved (value <b>1</b>).
      Normally (value <b>0</b>), attribute values are also retrieved.
    <p class="Pp">Default is <b>0</b>.</p>
  </dd>
</dl>
<p class="Pp">The last option is used when getting entries or committing changes
    in the directory:</p>
<dl class="Bl-tag">
  <dt><b>-utf8</b> pattern-yes pattern-no</dt>
  <dd>Specify which attribute values are encoded in UTF-8. This information is
      specific to the LDAP schema in use by the application, since some
      attributes such as jpegPhoto, for example, are not encoded in UTF-8. This
      option takes the form of a list with two regular expressions suitable for
      the <b>regexp</b> command (anchored by ^ and $). The first specifies which
      attribute names are to be UTF-8 encoded, and the second selects, among
      those, the attribute names which will not be UTF-8 encoded. It is thus
      possible to say: convert all attributes, except jpegPhoto.
    <p class="Pp">Default is {{.*} {}}, meaning: all attributes are converted,
        without exception.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="LDAP_METHODS"><a class="permalink" href="#LDAP_METHODS">LDAP
  METHODS</a></h2>
<dl class="Bl-tag">
  <dt><i>la</i> <b>error</b> ?<i>newmsg</i>?</dt>
  <dd>This method returns the error message that occurred in the last call to a
      <b>ldap</b> class method. If the optional argument <i>newmsg</i> is
      supplied, it becomes the last error message.</dd>
  <dt><i>la</i> <b>connect</b> <i>url</i> ?<i>binddn</i>? ?<i>bindpw</i>?</dt>
  <dd>This method connects to the LDAP server using given URL (which can be of
      the form <i>ldap://host:port</i> or <i>ldaps://host:port</i>). If an
      optional <i>binddn</i> argument is given together with the <i>bindpw</i>
      argument, the <b>connect</b> binds to the LDAP server using the specified
      DN and password.</dd>
  <dt><i>la</i> <b>disconnect</b></dt>
  <dd>This method disconnects (and unbinds, if necessary) from the LDAP
    server.</dd>
  <dt><i>la</i> <b>traverse</b> <i>base</i> <i>filter</i> <i>attrs</i>
    <i>entry</i> <i>body</i></dt>
  <dd>This method is a new control structure. It searches the LDAP directory
      from the specified base DN (given by the <i>base</i> argument) and selects
      entries based on the argument <i>filter</i>. For each entry found, this
      method fetches attributes specified by the <i>attrs</i> argument (or all
      attributes if it is an empty list), stores them in the <i>entry</i>
      instance of class <b>entry</b> and executes the script defined by the
      argument <i>body</i>. Options are used to refine the search.
    <p class="Pp">Caution: when this method is used, the script <i>body</i>
        cannot perform another LDAP search (methods <b>traverse</b>,
        <b>search</b> or <b>read</b>).</p>
  </dd>
  <dt><i>la</i> <b>search</b> <i>base</i> <i>filter</i> <i>attrs</i></dt>
  <dd>This method searches the directory using the same way as method
      <b>traverse</b>. All found entries are stored in newly created instances
      of class <b>entry</b>, which are returned in a list. The newly created
      instances should be destroyed when they are no longer used.</dd>
  <dt><i>la</i> <b>read</b> <i>base</i> <i>filter</i> <i>entry</i> ...
    <i>entry</i></dt>
  <dd>This method reads one or more entries, using the same search criteria as
      methods <b>traverse</b> and <b>search</b>. All attributes are stored in
      the entries. This method provides a quick way to read some entries. It
      returns the number of entries found in the directory (which may be more
      than the number of read entries). If called without any <i>entry</i>
      argument, this method just returns the number of entries found, without
      returning any data.</dd>
  <dt><i>la</i> <b>commit</b> <i>entry</i> ... <i>entry</i></dt>
  <dd>This method commits the changes stored in the <i>entry</i> arguments. Each
      <i>entry</i> may be either a <i>change</i> entry, or a <i>standard</i>
      entry with a backup.
    <p class="Pp">Note: in the future, this method should use the LDAP
        transaction extension provided by OpenLDAP 2.3 and later.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="LDAP_EXAMPLE"><a class="permalink" href="#LDAP_EXAMPLE">LDAP
  EXAMPLE</a></h2>
<pre>
    package require ldapx
    #
    # Connects to the LDAP directory
    #
    ::ldapx::ldap create l
    set url &quot;ldap://server.mycomp.com&quot;
    if {! [l connect $url &quot;cn=admin,o=mycomp&quot; &quot;mypasswd&quot;]} then {
	puts stderr &quot;error: [l error]&quot;
	exit 1
    }
    #
    # Search all entries matching some criterion
    #
    l configure -scope one
    ::ldapx::ldap create e
    set n 0
    l traverse &quot;ou=people,o=mycomp&quot; &quot;(sn=Joe*)&quot; {sn givenName} e {
	puts &quot;dn: [e dn]&quot;
	puts &quot;  sn:        [e get1 sn]&quot;
	puts &quot;  givenName: [e get1 givenName]&quot;
	incr n
    }
    puts &quot;$n entries found&quot;
    e destroy
    #
    # Add a telephone number to some entries
    # Note this modification cannot be done in the &quot;traverse&quot; operation.
    #
    set lent [l search &quot;ou=people,o=mycomp&quot; &quot;(sn=Joe*)&quot; {}]
    ::ldapx::ldap create c
    foreach e $lent {
	$e backup
	$e add1 &quot;telephoneNumber&quot; &quot;+31415926535&quot;
	c diff $e
	if {! [l commit c]} then {
	    puts stderr &quot;error: [l error]&quot;
	    exit 1
	}
	$e destroy
    }
    l disconnect
    l destroy
</pre>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="LDIF_CLASS"><a class="permalink" href="#LDIF_CLASS">LDIF
  CLASS</a></h1>
<section class="Ss">
<h2 class="Ss" id="LDIF_INSTANCE_DATA"><a class="permalink" href="#LDIF_INSTANCE_DATA">LDIF
  INSTANCE DATA</a></h2>
An instance of the <b>ldif</b> class keeps the following data:
<dl class="Bl-tag">
  <dt>channel</dt>
  <dd>This is the Tcl channel used to retrieve or store LDIF file contents. The
      association between an instance and a channel is made by the method
      <b>channel</b>. There is no need to disrupt this association when the LDIF
      file operation has ended.</dd>
  <dt>format</dt>
  <dd>LDIF files may contain <i>standard</i> entries or <i>change</i> entries,
      but not both. This variable contains the detected format of the file (when
      reading) or the format of entries written to the file (when writing).</dd>
  <dt>lastError</dt>
  <dd>This variable contains the error message which appeared in the last method
      of the <b>ldif</b> class (this string is modified in nearly all methods).
      The <b>error</b> method may be used to fetch this message.</dd>
  <dt>version</dt>
  <dd>This is the version of the LDIF file. Only version 1 is supported: the
      method <b>read</b> can only read from version 1 files, and method
      <b>write</b> only creates version 1 files.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="LDIF_OPTIONS"><a class="permalink" href="#LDIF_OPTIONS">LDIF
  OPTIONS</a></h2>
This class defines two options:
<dl class="Bl-tag">
  <dt><b>-ignore</b> list-of-attributes</dt>
  <dd>This option is used to ignore certain attribute names on reading. For
      example, to read OpenLDAP replica files (replog), one must ignore
      <b>replica</b> and <b>time</b> attributes since they do not conform to the
      RFC 2849 standard for LDIF files.
    <p class="Pp">Default is empty list: no attribute is ignored.</p>
  </dd>
  <dt><b>-utf8</b> pattern-yes pattern-no</dt>
  <dd>Specify which attribute values are encoded in UTF-8. This information is
      specific to the LDAP schema in use by the application, since some
      attributes such as jpegPhoto, for example, are not encoded in UTF-8. This
      option takes the form of a list with two regular expressions suitable for
      the <b>regexp</b> command (anchored by ^ and $). The first specifies which
      attribute names are to be UTF-8 encoded, and the second selects, among
      those, the attribute names which will not be UTF-8 encoded. It is thus
      possible to say: convert all attributes, except jpegPhoto.
    <p class="Pp">Default is {{.*} {}}, meaning: all attributes are converted,
        without exception.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="LDIF_METHODS"><a class="permalink" href="#LDIF_METHODS">LDIF
  METHODS</a></h2>
<dl class="Bl-tag">
  <dt><i>li</i> <b>channel</b> <i>chan</i></dt>
  <dd>This method associates the Tcl channel named <i>chan</i> with the LDIF
      instance. It resets the type of LDIF object to <i>uninitialized</i>.</dd>
  <dt><i>li</i> <b>error</b> ?<i>newmsg</i>?</dt>
  <dd>This method returns the error message that occurred in the last call to a
      <b>ldif</b> class method. If the optional argument <i>newmsg</i> is
      supplied, it becomes the last error message.</dd>
  <dt><i>li</i> <b>read</b> <i>entry</i></dt>
  <dd>This method reads the next entry from the LDIF file and stores it in the
      <i>entry</i> object of class <b>entry</b>. The entry may be a
      <i>standard</i> or <i>change</i> entry.</dd>
  <dt><i>li</i> <b>write</b> <i>entry</i></dt>
  <dd>This method writes the entry given in the argument <i>entry</i> to the
      LDIF file.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="LDIF_EXAMPLE"><a class="permalink" href="#LDIF_EXAMPLE">LDIF
  EXAMPLE</a></h2>
<pre>
    package require ldapx
    # This examples reads a LDIF file containing entries,
    # compare them to a LDAP directory, and writes on standard
    # output an LDIF file containing changes to apply to the
    # LDAP directory to match exactly the LDIF file.
    ::ldapx::ldif create liin
    liin channel stdin
    ::ldapx::ldif create liout
    liout channel stdout
    ::ldapx::ldap create la
    if {! [la connect &quot;ldap://server.mycomp.com&quot;]} then {
	puts stderr &quot;error: [la error]&quot;
	exit 1
    }
    la configure -scope one
    # Reads LDIF file
    ::ldapx::entry create e1
    ::ldapx::entry create e2
    ::ldapx::entry create c
    while {[liin read e1] != 0} {
	set base [e1 superior]
	set id [e1 rdn]
	if {[la read $base &quot;($id)&quot; e2] == 0} then {
	    e2 reset
	}
	c diff e1 e2
	if {[llength [c change]] != 0} then {
	    liout write c
	}
    }
    la disconnect
    la destroy
    e1 destroy
    e2 destroy
    c destroy
    liout destroy
    liin destroy
</pre>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="REFERENCES"><a class="permalink" href="#REFERENCES">REFERENCES</a></h1>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS,_IDEAS,_FEEDBACK"><a class="permalink" href="#BUGS,_IDEAS,_FEEDBACK">BUGS,
  IDEAS, FEEDBACK</a></h1>
This document, and the package it describes, will undoubtedly contain bugs and
  other problems. Please report such in the category <i>ldap</i> of the
  <i>Tcllib SF Trackers</i> [http://sourceforge.net/tracker/?group_id=12883].
  Please also report any ideas for enhancements you may have for either package
  and/or documentation.
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
directory access, internet, ldap, ldap client, ldif, protocol, rfc 2251, rfc
  2849
</section>
<section class="Sh">
<h1 class="Sh" id="CATEGORY"><a class="permalink" href="#CATEGORY">CATEGORY</a></h1>
Networking
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<pre>
Copyright (c) 2006 Pierre David &lt;pdav@users.sourceforge.net&gt;
</pre>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">0.2.5</td>
    <td class="foot-os">ldap</td>
  </tr>
</table>
</body>
</html>
