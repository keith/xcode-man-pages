<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   The definitions below are for supplemental macros used in Tcl/Tk
   manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO
  	Start of list of standard options for a Tk widget.  The
  	options follow on successive lines, in four columns separated
  	by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   RCS: @(#) $Id: man.macros,v 1.1 2009/01/30 04:56:47 andreas_kupries Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>ico(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ico(n)</td>
    <td class="head-vol">Windows ICO handling</td>
    <td class="head-rtitle">ico(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>
</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">ico - Reading and writing windows icons</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">package require <b>Tcl 8.4</b></p>
<p class="Pp">package require <b>ico ?1.0.5?</b></p>
<p class="Pp"><b>::ico::icons</b> <i>file</i> ?<i>option</i>
  <i>value</i>...?</p>
<p class="Pp"><b>::ico::iconMembers</b> <i>file</i> <i>name</i> ?<i>option</i>
    <i>value</i>...?</p>
<p class="Pp"><b>::ico::getIcon</b> <i>file</i> <i>name</i> ?<i>option</i>
    <i>value</i>...?</p>
<p class="Pp"><b>::ico::getIconByName</b> <i>file</i> <i>name</i> ?<i>option</i>
    <i>value</i>...?</p>
<p class="Pp"><b>::ico::getFileIcon</b> <i>file</i> ?<i>option</i>
    <i>value</i>...?</p>
<p class="Pp"><b>::ico::writeIcon</b> <i>file</i> <i>name</i> <i>depth</i>
    <i>data</i> ?<i>option</i> <i>value</i>...?</p>
<p class="Pp"><b>::ico::copyIcon</b> <i>file</i> <i>index</i> <i>file2</i>
    <i>index2</i> ?<i>option</i> <i>value</i>...?</p>
<p class="Pp"><b>::ico::EXEtoICO</b> <i>file</i> ?dir?</p>
<p class="Pp"><b>::ico::clearCache</b> ?file?</p>
<p class="Pp"><b>::ico::transparentColor</b> <i>image</i> <i>color</i></p>
<p class="Pp"><b>::ico::Show</b> <i>file</i> ?<i>option</i> <i>value</i>...?</p>
<p class="Pp"></p>
<pre>
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This package provides functions for reading and writing Windows
    icons from ICO, EXE, DLL, ICL, and BMP files. As used in this module an icon
    is a visual representation of an object. An icon consists of one or more
    images usually with varying resolution and color depth. Each icon and image
    has a resource identifier which may be a text string or a positive integer
    value. Most commands use this identifier to specify which icon or image to
    operate on.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="API"><a class="permalink" href="#API">API</a></h1>
<dl class="Bl-tag">
  <dt><b>::ico::icons</b> <i>file</i> ?<i>option</i> <i>value</i>...?</dt>
  <dd>Returns a list of icons found in <i>file</i> where each element is the
      name or numeric ID. Recognizes the following options:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="type"><a class="permalink" href="#type"><b>-type</b>
    fileFormat</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::iconMembers</b> <i>file</i> <i>name</i> ?<i>option</i>
    <i>value</i>...?</dt>
  <dd>Returns a list of images that make up the icon with ID <i>name</i>. Each
      element is itself a sublist in the format {name width height bpp}.
      Recognizes the following options:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="type~2"><a class="permalink" href="#type~2"><b>-type</b>
    fileFormat</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::getIcon</b> <i>file</i> <i>name</i> ?<i>option</i>
    <i>value</i>...?</dt>
  <dd>Extracts the icon with ID <i>name</i> from <i>file</i>. The default
      <b>-format</b> is <b>image</b> which will return the name of a Tk image
      containing the icon. The resolution and color depth are selected with the
      ?-res?, ?-bpp?, and ?-exact? options. If -exact is specified and there is
      no exact match, an error is thrown. Optionally <b>-image</b> may be used
      to specify the name of the Tk image that is created. If <b>-format</b> is
      <b>colors</b> then a list of color names in the #RRGGBB format is
      returned. Each list element is a horizontal row. Each horizontal row
      contains a list of colors for all the pixels in that row from left to
      right. If <b>-format</b> is <b>name</b> then the resource name of the
      image chosen is returned. This is useful for calling writeIcon or
      getIconByName. Recognizes the following <i>option</i>s.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="type~3"><a class="permalink" href="#type~3"><b>-type</b>
    fileFormat</a></dt>
  <dd></dd>
  <dt id="format"><a class="permalink" href="#format"><b>-format</b>
    value</a></dt>
  <dd></dd>
  <dt id="image"><a class="permalink" href="#image"><b>-image</b> value</a></dt>
  <dd></dd>
  <dt id="res"><a class="permalink" href="#res"><b>-res</b> value</a></dt>
  <dd></dd>
  <dt id="bpp"><a class="permalink" href="#bpp"><b>-bpp</b> value</a></dt>
  <dd></dd>
  <dt id="exact"><a class="permalink" href="#exact"><b>-exact</b> value</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::getIconByName</b> <i>file</i> <i>name</i> ?<i>option</i>
    <i>value</i>...?</dt>
  <dd>Extracts the image with ID <i>name</i> from <i>file</i>. This name should
      be the name of a specific image as returned by <b>::ico::iconMembers</b>,
      not an icon name returned from <b>::ico::icons</b>. If there is no
      matching resource ID in <i>file</i> an error is thrown. Recognizes the
      following options:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="type~4"><a class="permalink" href="#type~4"><b>-type</b>
    fileFormat</a></dt>
  <dd></dd>
  <dt id="format~2"><a class="permalink" href="#format~2"><b>-format</b>
    value</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::getFileIcon</b> <i>file</i> ?<i>option</i> <i>value</i>...?</dt>
  <dd>This command is only functional when running under Windows. It reads the
      Windows registry to determine the display icon for <i>file</i> as it would
      appear in Explorer or similar. <i>file</i> does not need to exist and may
      also be specified as a file extension with a leading dot. If <i>file</i>
      is a directory or you specify the special name <b>Folder</b> then the icon
      representing a folder is returned. This command takes the same arguments
      and usage as <b>getIcon</b>:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="format~3"><a class="permalink" href="#format~3"><b>-format</b>
    value</a></dt>
  <dd></dd>
  <dt id="image~2"><a class="permalink" href="#image~2"><b>-image</b>
    value</a></dt>
  <dd></dd>
  <dt id="res~2"><a class="permalink" href="#res~2"><b>-res</b> value</a></dt>
  <dd></dd>
  <dt id="bpp~2"><a class="permalink" href="#bpp~2"><b>-bpp</b> value</a></dt>
  <dd></dd>
  <dt id="exact~2"><a class="permalink" href="#exact~2"><b>-exact</b>
    value</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::writeIcon</b> <i>file</i> <i>name</i> <i>depth</i> <i>data</i>
    ?<i>option</i> <i>value</i>...?</dt>
  <dd>Writes an image to <i>file</i>. <i>name</i> is the resource identifier of
      the image in <i>file</i> to write. When writing to an EXE, DLL, or ICL
      file you may only overwrite existing icons with an icon of the same
      dimensions and color depth. No icons may be added to these file types.
    <p class="Pp">When writing to BMP the name is ignored as this type can
        contain only one image. This means if the file already existed it is
        completely overwritten.</p>
    <p class="Pp">When writing to an ICO or ICODATA file if the name specified
        does not exist then an image is appended and will be named the next in
        sequence (the specified name is ignored). Images in ICO and ICODATA
        files may be overwritten with differing dimensions or color depths. Note
        that you will get strange results when displaying icons if you fail to
        change every image which makes up a given icon.</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="integer"><a class="permalink" href="#integer">integer <i>depth</i>
    (in)</a></dt>
  <dd>This argument must have a value of <b>1</b>, <b>4</b>, <b>8</b>,
      <b>24</b>, or <b>32</b>. If <i>data</i> has more colors than the color
      depth allows an error will be generated.</dd>
  <dt id="options"><a class="permalink" href="#options">options <i>data</i>
    (in)</a></dt>
  <dd>This argument is either a list of colors in the format returned by
      <b>::ico::getIcon -format colors</b> or the name of a Tk image.</dd>
</dl>
</div>
<p class="Pp">Recognizes the following <i>option</i>s.</p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="type~5"><a class="permalink" href="#type~5"><b>-type</b>
    fileFormat</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::copyIcon</b> <i>file</i> <i>index</i> <i>file2</i> <i>index2</i>
    ?<i>option</i> <i>value</i>...?</dt>
  <dd>Copies the icon at <i>index</i> in <i>file</i> to <i>index2</i> in
      <i>file2</i>.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="fromtype"><a class="permalink" href="#fromtype"><b>-fromtype</b>
    fileFormat</a></dt>
  <dd></dd>
  <dt id="totype"><a class="permalink" href="#totype"><b>-totype</b>
    fileFormat</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::EXEtoICO</b> <i>file</i> ?dir?</dt>
  <dd>Extracts all icons from the executable <i>file</i> to ICO files placed in
      <i>dir</i>. ?dir? defaults to the directory <i>file</i> is located in.
      Icon files will be named in the form <i>file</i>-ID.ico where ID is the
      icon resource identifier.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="type~6"><a class="permalink" href="#type~6"><b>-type</b>
    fileFormat</a></dt>
  <dd></dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>::ico::clearCache</b> ?file?</dt>
  <dd>The <b>::ico::getIconList</b> command caches icon offsets inside EXE, DLL,
      ICL, and ICO files in order to speed up extraction. This command clears
      that cache for the specific ?file? or all files.</dd>
  <dt><b>::ico::transparentColor</b> <i>image</i> <i>color</i></dt>
  <dd>If <i>image</i> is a single word it is assumed to be the name of a Tk
      image. All pixels matching <i>color</i> in the <i>image</i> will be set
      transparent. Alternatively, <i>image</i> may be a color list in which case
      a modified list is returned.</dd>
  <dt><b>::ico::Show</b> <i>file</i> ?<i>option</i> <i>value</i>...?</dt>
  <dd>Application level command which displays a window showing all the icons in
      <i>file</i> and their name.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="type~7"><a class="permalink" href="#type~7"><b>-type</b>
    fileFormat</a></dt>
  <dd></dd>
  <dt id="parent"><a class="permalink" href="#parent"><b>-parent</b>
    pathName</a></dt>
  <dd></dd>
</dl>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLE"><a class="permalink" href="#EXAMPLE">EXAMPLE</a></h1>
<pre>
<br/>
    button .explore -image [::ico::getIcon explorer.exe 0 -name explore -res 16 -bpp 8]
<br/>
    set i [lsearch -inline [::ico::iconMembers tclkit.exe 0] {* 32 32 8}]
<br/>
    set colorlist [::ico::getIconByName tclkit.exe [lindex $i 0] -format colors]
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="LIMITATIONS"><a class="permalink" href="#LIMITATIONS">LIMITATIONS</a></h1>
<p class="Pp">Icons may not be added or removed from file types other than ICO.
    Icons in these files may only be replaced with icons of the same dimensions
    and color depth.</p>
<p class="Pp">Icons of 8bpp or lower must include black in the pallete, this
    means if your icon does not have black in it, you will need to leave a color
    free so that it may be included by writeIcon.</p>
<p class="Pp">There is currently no way to read alpha channel information from
    32bpp icons.</p>
<p class="Pp">Tk images do not have an alpha channel so the only way to write a
    true 32bpp icon is from a color list. writing a 32bpp icon from a Tkimage is
    identical to writing a 24bpp icon.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
<p class="Pp">dll, entry, exe, ico, icon</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1.0.5</td>
    <td class="foot-os">ico</td>
  </tr>
</table>
</body>
</html>
