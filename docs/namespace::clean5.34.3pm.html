<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>namespace::clean(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">namespace::clean(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">namespace::clean(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">namespace::clean - Keep imports and functions out of your
    namespace</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>  package Foo;
  use warnings;
  use strict;
  use Carp qw(croak);   # 'croak' will be removed
  sub bar { 23 }        # 'bar' will be removed
  # remove all previously defined functions
  use namespace::clean;
  sub baz { bar() }     # 'baz' still defined, 'bar' still bound
  # begin to collection function names from here again
  no namespace::clean;
  sub quux { baz() }    # 'quux' will be removed
  # remove all functions defined after the 'no' unimport
  use namespace::clean;
  # Will print: 'No', 'No', 'Yes' and 'No'
  print +(__PACKAGE__-&gt;can('croak') ? 'Yes' : 'No'), &quot;\n&quot;;
  print +(__PACKAGE__-&gt;can('bar')   ? 'Yes' : 'No'), &quot;\n&quot;;
  print +(__PACKAGE__-&gt;can('baz')   ? 'Yes' : 'No'), &quot;\n&quot;;
  print +(__PACKAGE__-&gt;can('quux')  ? 'Yes' : 'No'), &quot;\n&quot;;
  1;
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<section class="Ss">
<h2 class="Ss" id="Keeping_packages_clean"><a class="permalink" href="#Keeping_packages_clean">Keeping
  packages clean</a></h2>
<p class="Pp">When you define a function, or import one, into a Perl package, it
    will naturally also be available as a method. This does not per se cause
    problems, but it can complicate subclassing and, for example, plugin classes
    that are included via multiple inheritance by loading them as base
  classes.</p>
<p class="Pp">The <span class="Li">&quot;namespace::clean&quot;</span> pragma
    will remove all previously declared or imported symbols at the end of the
    current package's compile cycle. Functions called in the package itself will
    still be bound by their name, but they won't show up as methods on your
    class or instances.</p>
<p class="Pp">By unimporting via <span class="Li">&quot;no&quot;</span> you can
    tell <span class="Li">&quot;namespace::clean&quot;</span> to start
    collecting functions for the next <span class="Li">&quot;use
    namespace::clean;&quot;</span> specification.</p>
<p class="Pp">You can use the <span class="Li">&quot;-except&quot;</span> flag
    to tell <span class="Li">&quot;namespace::clean&quot;</span> that you don't
    want it to remove a certain function or method. A common use would be a
    module exporting an <span class="Li">&quot;import&quot;</span> method along
    with some functions:</p>
<p class="Pp"></p>
<pre>  use ModuleExportingImport;
  use namespace::clean -except =&gt; [qw( import )];
</pre>
<p class="Pp">If you just want to <span class="Li">&quot;-except&quot;</span> a
    single sub, you can pass it directly. For more than one value you have to
    use an array reference.</p>
<p class="Pp"><i>Late binding caveat</i></p>
<p class="Pp">Note that the technique used by this module relies on perl having
    resolved all names to actual code references during the compilation of a
    scope. While this is almost always what the interpreter does, there are some
    exceptions, notably the sort SUBNAME style of the
    <span class="Li">&quot;sort&quot;</span> built-in invocation. The following
    example will not work, because <span class="Li">&quot;sort&quot;</span> does
    not try to resolve the function name to an actual code reference until
    <b>runtime</b>.</p>
<p class="Pp"></p>
<pre> use MyApp::Utils 'my_sorter';
 use namespace::clean;
 my @sorted = sort my_sorter @list;
</pre>
<p class="Pp">You need to work around this by forcing a compile-time resolution
    like so:</p>
<p class="Pp"></p>
<pre> use MyApp::Utils 'my_sorter';
 use namespace::clean;
 my $my_sorter_cref = \&amp;my_sorter;
 my @sorted = sort $my_sorter_cref @list;
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Explicitly_removing_functions_when_your_scope_is_compiled"><a class="permalink" href="#Explicitly_removing_functions_when_your_scope_is_compiled">Explicitly
  removing functions when your scope is compiled</a></h2>
<p class="Pp">It is also possible to explicitly tell
    <span class="Li">&quot;namespace::clean&quot;</span> what packages to remove
    when the surrounding scope has finished compiling. Here is an example:</p>
<p class="Pp"></p>
<pre>  package Foo;
  use strict;
  # blessed NOT available
  sub my_class {
      use Scalar::Util qw( blessed );
      use namespace::clean qw( blessed );
      # blessed available
      return blessed shift;
  }
  # blessed NOT available
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Moose"><a class="permalink" href="#Moose">Moose</a></h2>
<p class="Pp">When using <span class="Li">&quot;namespace::clean&quot;</span>
    together with Moose you want to keep the installed
    <span class="Li">&quot;meta&quot;</span> method. So your classes should look
    like:</p>
<p class="Pp"></p>
<pre>  package Foo;
  use Moose;
  use namespace::clean -except =&gt; 'meta';
  ...
</pre>
<p class="Pp">Same goes for Moose::Role.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Cleaning_other_packages"><a class="permalink" href="#Cleaning_other_packages">Cleaning
  other packages</a></h2>
<p class="Pp">You can tell <span class="Li">&quot;namespace::clean&quot;</span>
    that you want to clean up another package instead of the one importing. To
    do this you have to pass in the <span class="Li">&quot;-cleanee&quot;</span>
    option like this:</p>
<p class="Pp"></p>
<pre>  package My::MooseX::namespace::clean;
  use strict;
  use namespace::clean (); # no cleanup, just load
  sub import {
      namespace::clean-&gt;import(
        -cleanee =&gt; scalar(caller),
        -except  =&gt; 'meta',
      );
  }
</pre>
<p class="Pp">If you don't care about
    <span class="Li">&quot;namespace::clean&quot;</span>s
    discover-and-<span class="Li">&quot;-except&quot;</span> logic, and just
    want to remove subroutines, try &quot;clean_subroutines&quot;.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="METHODS"><a class="permalink" href="#METHODS">METHODS</a></h1>
<section class="Ss">
<h2 class="Ss" id="clean_subroutines"><a class="permalink" href="#clean_subroutines">clean_subroutines</a></h2>
<p class="Pp">This exposes the actual subroutine-removal logic.</p>
<p class="Pp"></p>
<pre>  namespace::clean-&gt;clean_subroutines($cleanee, qw( subA subB ));
</pre>
<p class="Pp">will remove <span class="Li">&quot;subA&quot;</span> and
    <span class="Li">&quot;subB&quot;</span> from
    <span class="Li">$cleanee</span>. Note that this will remove the subroutines
    <b>immediately</b> and not wait for scope end. If you want to have this
    effect at a specific time (e.g.
    <span class="Li">&quot;namespace::clean&quot;</span> acts on scope compile
    end) it is your responsibility to make sure it runs at that time.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="import"><a class="permalink" href="#import">import</a></h2>
<p class="Pp">Makes a snapshot of the current defined functions and installs a
    B::Hooks::EndOfScope hook in the current scope to invoke the cleanups.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="unimport"><a class="permalink" href="#unimport">unimport</a></h2>
<p class="Pp">This method will be called when you do a</p>
<p class="Pp"></p>
<pre>  no namespace::clean;
</pre>
<p class="Pp">It will start a new section of code that defines functions to
    clean up.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="get_class_store"><a class="permalink" href="#get_class_store">get_class_store</a></h2>
<p class="Pp">This returns a reference to a hash in a passed package containing
    information about function names included and excluded from removal.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="get_functions"><a class="permalink" href="#get_functions">get_functions</a></h2>
<p class="Pp">Takes a class as argument and returns all currently defined
    functions in it as a hash reference with the function name as key and a
    typeglob reference to the symbol as value.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="IMPLEMENTATION_DETAILS"><a class="permalink" href="#IMPLEMENTATION_DETAILS">IMPLEMENTATION
  DETAILS</a></h1>
<p class="Pp">This module works through the effect that a</p>
<p class="Pp"></p>
<pre>  delete $SomePackage::{foo};
</pre>
<p class="Pp">will remove the <span class="Li">&quot;foo&quot;</span> symbol
    from <span class="Li">$SomePackage</span> for run time lookups (e.g., method
    calls) but will leave the entry alive to be called by already resolved names
    in the package itself. <span class="Li">&quot;namespace::clean&quot;</span>
    will restore and therefor in effect keep all glob slots that aren't
    <span class="Li">&quot;CODE&quot;</span>.</p>
<p class="Pp">A test file has been added to the perl core to ensure that this
    behaviour will be stable in future releases.</p>
<p class="Pp">Just for completeness sake, if you want to remove the symbol
    completely, use <span class="Li">&quot;undef&quot;</span> instead.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">B::Hooks::EndOfScope</p>
</section>
<section class="Sh">
<h1 class="Sh" id="THANKS"><a class="permalink" href="#THANKS">THANKS</a></h1>
<p class="Pp">Many thanks to Matt S Trout for the inspiration on the whole
  idea.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<ul class="Bl-bullet">
  <li>Robert 'phaylon' Sedlacek &lt;rs@474.at&gt;</li>
  <li>Florian Ragwitz &lt;rafl@debian.org&gt;</li>
  <li>Jesse Luehrs &lt;doy@tozt.net&gt;</li>
  <li>Peter Rabbitson &lt;ribasushi@cpan.org&gt;</li>
  <li>Father Chrysostomos &lt;sprout@cpan.org&gt;</li>
</ul>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">This software is copyright (c) 2011 by &quot;AUTHORS&quot;</p>
<p class="Pp">This is free software; you can redistribute it and/or modify it
    under the same terms as the Perl 5 programming language system itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2016-05-18</td>
    <td class="foot-os">perl v5.34.0</td>
  </tr>
</table>
</body>
</html>
