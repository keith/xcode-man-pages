<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 1997 Sun Microsystems, Inc.
   Copyright (c) 2001 ActiveState Corporation.
  
   See the file "license.terms" for information on usage and redistribution
   of this file, and for a DISCLAIMER OF ALL WARRANTIES.
  
   RCS: @(#) $Id: dde.n,v 1.24 2008/01/18 15:59:22 dkf Exp $
  
   The -*- nroff -*- definitions below are for supplemental macros used
   in Tcl/Tk manual entries.
  
   .AP type name in/out ?indent?
  	Start paragraph describing an argument to a library procedure.
  	type is type of argument (int, etc.), in/out is either "in", "out",
  	or "in/out" to describe whether procedure reads or modifies arg,
  	and indent is equivalent to second arg of .IP (shouldn't ever be
  	needed;  use .AS below instead)
  
   .AS ?type? ?name?
  	Give maximum sizes of arguments for setting tab stops.  Type and
  	name are examples of largest possible arguments that will be passed
  	to .AP later.  If args are omitted, default tab stops are used.
  
   .BS
  	Start box enclosure.  From here until next .BE, everything will be
  	enclosed in one large box.
  
   .BE
  	End of box enclosure.
  
   .CS
  	Begin code excerpt.
  
   .CE
  	End code excerpt.
  
   .VS ?version? ?br?
  	Begin vertical sidebar, for use in marking newly-changed parts
  	of man pages.  The first argument is ignored and used for recording
  	the version when the .VS was added, so that the sidebars can be
  	found and removed when they reach a certain age.  If another argument
  	is present, then a line break is forced before starting the sidebar.
  
   .VE
  	End of vertical sidebar.
  
   .DS
  	Begin an indented unfilled display.
  
   .DE
  	End of indented unfilled display.
  
   .SO ?manpage?
  	Start of list of standard options for a Tk widget. The manpage
  	argument defines where to look up the standard options; if
  	omitted, defaults to "options". The options follow on successive
  	lines, in three columns separated by tabs.
  
   .SE
  	End of list of standard options for a Tk widget.
  
   .OP cmdName dbName dbClass
  	Start of description of a specific option.  cmdName gives the
  	option's name as specified in the class command, dbName gives
  	the option's name in the option database, and dbClass gives
  	the option's class in the option database.
  
   .UL arg1 arg2
  	Print arg1 underlined, then print arg2 normally.
  
   .QW arg1 ?arg2?
  	Print arg1 in quotes, then arg2 normally (for trailing punctuation).
  
   .PQ arg1 ?arg2?
  	Print an open parenthesis, arg1 in quotes, then arg2 normally
  	(for trailing punctuation) and then a closing parenthesis.
  
   RCS: @(#) $Id: man.macros,v 1.9 2008/01/29 15:32:33 dkf Exp $
  
  	# Set up traps and other miscellaneous stuff for Tcl/Tk man pages.
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>dde(n)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">dde(n)</td>
    <td class="head-vol">Tcl Bundled Packages</td>
    <td class="head-rtitle">dde(n)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<pre>
</pre>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">dde - Execute a Dynamic Data Exchange command</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><b>package require dde 1.3</b></p>
<p class="Pp"><b>dde servername</b> ?<b>-force</b>? ?<b>-handler
    </b><i>proc</i>? ?<b>--</b>? ?<i>topic</i>?</p>
<p class="Pp"><b>dde execute</b> ?<b>-async</b>? <i>service topic data</i></p>
<p class="Pp"><b>dde poke</b> <i>service topic item data</i></p>
<p class="Pp"><b>dde request</b> ?<b>-binary</b>? <i>service topic item</i></p>
<p class="Pp"><b>dde services </b><i>service topic</i></p>
<p class="Pp"><b>dde eval</b> ?<b>-async</b>? <i>topic cmd </i>?<i>arg arg
    ...</i>?</p>
<pre>
</pre>
<p class="Pp"></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This command allows an application to send Dynamic Data Exchange
    (DDE) command when running under Microsoft Windows. Dynamic Data Exchange is
    a mechanism where applications can exchange raw data. Each DDE transaction
    needs a <i>service name</i> and a <i>topic</i>. Both the <i>service name</i>
    and <i>topic</i> are application defined; Tcl uses the service name
    <b>TclEval</b>, while the topic name is the name of the interpreter given by
    <b>dde servername</b>. Other applications have their own <i>service
    names</i> and <i>topics</i>. For instance, Microsoft Excel has the service
    name <b>Excel</b>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DDE_COMMANDS"><a class="permalink" href="#DDE_COMMANDS">DDE
  COMMANDS</a></h1>
<p class="Pp">The following commands are a subset of the full Dynamic Data
    Exchange set of commands.</p>
<dl class="Bl-tag">
  <dt id="dde"><a class="permalink" href="#dde"><b>dde servername
    </b>?<b>-force</b>? ?<b>-handler </b><i>proc</i>? ?<b>--</b>?
    ?<i>topic</i>?</a></dt>
  <dd><b>dde servername</b> registers the interpreter as a DDE server with the
      service name <b>TclEval</b> and the topic name specified by <i>topic</i>.
      If no <i>topic</i> is given, <b>dde servername</b> returns the name of the
      current topic or the empty string if it is not registered as a service. If
      the given <i>topic</i> name is already in use, then a suffix of the form
      &#x201C; #2&#x201D; or &#x201C; #3&#x201D; is appended to the name to make
      it unique. The command's result will be the name actually used. The
      <b>-force</b> option is used to force registration of precisely the given
      <i>topic</i> name.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The <b>-handler</b> option specifies a Tcl procedure that will be
    called to process calls to the dde server. If the package has been loaded
    into a safe interpreter then a <b>-handler</b> procedure must be defined.
    The procedure is called with all the arguments provided by the remote
  call.</p>
</div>
<dl class="Bl-tag">
  <dt id="dde~2"><a class="permalink" href="#dde~2"><b>dde execute</b>
    ?<b>-async</b>? <i>service topic data</i></a></dt>
  <dd><b>dde execute</b> takes the <i>data</i> and sends it to the server
      indicated by <i>service</i> with the topic indicated by <i>topic</i>.
      Typically, <i>service</i> is the name of an application, and <i>topic</i>
      is a file to work on. The <i>data</i> field is given to the remote
      application. Typically, the application treats the <i>data</i> field as a
      script, and the script is run in the application. The <b>-async</b> option
      requests asynchronous invocation. The command returns an error message if
      the script did not run, unless the <b>-async</b> flag was used, in which
      case the command returns immediately with no error.</dd>
  <dt id="dde~3"><a class="permalink" href="#dde~3"><b>dde poke </b><i>service
    topic item data</i></a></dt>
  <dd><b>dde poke</b> passes the <i>data</i> to the server indicated by
      <i>service</i> using the <i>topic</i> and <i>item</i> specified.
      Typically, <i>service</i> is the name of an application. <i>topic</i> is
      application specific but can be a command to the server or the name of a
      file to work on. The <i>item</i> is also application specific and is often
      not used, but it must always be non-null. The <i>data</i> field is given
      to the remote application.</dd>
  <dt id="dde~4"><a class="permalink" href="#dde~4"><b>dde request</b>
    ?<b>-binary</b>? <i>service topic item</i></a></dt>
  <dd><b>dde request</b> is typically used to get the value of something; the
      value of a cell in Microsoft Excel or the text of a selection in Microsoft
      Word. <i>service</i> is typically the name of an application, <i>topic</i>
      is typically the name of the file, and <i>item</i> is
      application-specific. The command returns the value of <i>item</i> as
      defined in the application. Normally this is interpreted to be a string
      with terminating null. If <b>-binary</b> is specified, the result is
      returned as a byte array.</dd>
  <dt id="dde~5"><a class="permalink" href="#dde~5"><b>dde services
    </b><i>service topic</i></a></dt>
  <dd><b>dde services</b> returns a list of service-topic pairs that currently
      exist on the machine. If <i>service</i> and <i>topic</i> are both empty
      strings ({}), then all service-topic pairs currently available on the
      system are returned. If <i>service</i> is empty and <i>topic</i> is not,
      then all services with the specified topic are returned. If <i>service</i>
      is non-empty and <i>topic</i> is, all topics for a given service are
      returned. If both are non-empty, if that service-topic pair currently
      exists, it is returned; otherwise, an empty string is returned.</dd>
  <dt id="dde~6"><a class="permalink" href="#dde~6"><b>dde eval</b>
    ?<b>-async</b>? <i>topic cmd </i>?<i>arg arg ...</i>?</a></dt>
  <dd><b>dde eval</b> evaluates a command and its arguments using the
      interpreter specified by <i>topic</i>. The DDE service must be the
      <b>TclEval</b> service. The <b>-async</b> option requests asynchronous
      invocation. The command returns an error message if the script did not
      run, unless the <b>-async</b> flag was used, in which case the command
      returns immediately with no error. This command can be used to replace
      send on Windows.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="DDE_AND_TCL"><a class="permalink" href="#DDE_AND_TCL">DDE AND
  TCL</a></h1>
<p class="Pp">A Tcl interpreter always has a service name of <b>TclEval</b>.
    Each different interpreter of all running Tcl applications must be given a
    unique name specified by <b>dde servername</b>. Each interp is available as
    a DDE topic only if the <b>dde servername</b> command was used to set the
    name of the topic for each interp. So a <b>dde services TclEval {}</b>
    command will return a list of service-topic pairs, where each of the
    currently running interps will be a topic.</p>
<p class="Pp">When Tcl processes a <b>dde execute</b> command, the data for the
    execute is run as a script in the interp named by the topic of the <b>dde
    execute</b> command.</p>
<p class="Pp">When Tcl processes a <b>dde request</b> command, it returns the
    value of the variable given in the dde command in the context of the interp
    named by the dde topic. Tcl reserves the variable
    <b>$TCLEVAL$EXECUTE$RESULT</b> for internal use, and <b>dde request</b>
    commands for that variable will give unpredictable results.</p>
<p class="Pp">An external application which wishes to run a script in Tcl should
    have that script store its result in a variable, run the <b>dde execute</b>
    command, and the run <b>dde request</b> to get the value of the
  variable.</p>
<p class="Pp">When using DDE, be careful to ensure that the event queue is
    flushed using either <b>update</b> or <b>vwait</b>. This happens by default
    when using <b>wish</b> unless a blocking command is called (such as
    <b>exec</b> without adding the <b>&amp;</b> to place the process in the
    background). If for any reason the event queue is not flushed, DDE commands
    may hang until the event queue is flushed. This can create a deadlock
    situation.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLE"><a class="permalink" href="#EXAMPLE">EXAMPLE</a></h1>
<p class="Pp">This asks Internet Explorer (which must already be running) to go
    to a particularly important website:</p>
<div class="Bd-indent">
<pre>
package require dde
<b>dde execute</b> iexplore WWW_OpenURL http://www.tcl.tk/</pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">tk(n), winfo(n), send(n)</p>
</section>
<section class="Sh">
<h1 class="Sh" id="KEYWORDS"><a class="permalink" href="#KEYWORDS">KEYWORDS</a></h1>
<p class="Pp">application, dde, name, remote execution</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1.3</td>
    <td class="foot-os">dde</td>
  </tr>
</table>
</body>
</html>
