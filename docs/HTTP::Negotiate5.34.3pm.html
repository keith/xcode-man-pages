<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>HTTP::Negotiate(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">HTTP::Negotiate(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">HTTP::Negotiate(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">HTTP::Negotiate - choose a variant to serve</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre> use HTTP::Negotiate qw(choose);
 #  ID       QS     Content-Type   Encoding Char-Set        Lang   Size
 $variants =
  [['var1',  1.000, 'text/html',   undef,   'iso-8859-1',   'en',   3000],
   ['var2',  0.950, 'text/plain',  'gzip',  'us-ascii',     'no',    400],
   ['var3',  0.3,   'image/gif',   undef,   undef,          undef, 43555],
  ];
 @preferred = choose($variants, $request_headers);
 $the_one   = choose($variants);
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This module provides a complete implementation of the HTTP content
    negotiation algorithm specified in <i>draft-ietf-http-v11-spec-00.ps</i>
    chapter 12. Content negotiation allows for the selection of a preferred
    content representation based upon attributes of the negotiable variants and
    the value of the various Accept* header fields in the request.</p>
<p class="Pp">The variants are ordered by preference by calling the function
    <b>choose()</b>.</p>
<p class="Pp">The first parameter is reference to an array of the variants to
    choose among. Each element in this array is an array with the values [$id,
    <span class="Li">$qs</span>, <span class="Li">$content_type</span>,
    <span class="Li">$content_encoding</span>, <span class="Li">$charset</span>,
    <span class="Li">$content_language</span>,
    <span class="Li">$content_length</span>] whose meanings are described below.
    The <span class="Li">$content_encoding</span> and
    <span class="Li">$content_language</span> can be either a single scalar
    value or an array reference if there are several values.</p>
<p class="Pp">The second optional parameter is either a HTTP::Headers or a
    HTTP::Request object which is searched for &quot;Accept*&quot; headers. If
    this parameter is missing, then the accept specification is initialized from
    the CGI environment variables HTTP_ACCEPT, HTTP_ACCEPT_CHARSET,
    HTTP_ACCEPT_ENCODING and HTTP_ACCEPT_LANGUAGE.</p>
<p class="Pp">In an array context, <b>choose()</b> returns a list of [variant
    identifier, calculated quality, size] tuples. The values are sorted by
    quality, highest quality first. If the calculated quality is the same for
    two variants, then they are sorted by size (smallest first).
  <i>E.g.</i>:</p>
<p class="Pp"></p>
<pre>  (['var1', 1, 2000], ['var2', 0.3, 512], ['var3', 0.3, 1024]);
</pre>
<p class="Pp">Note that also zero quality variants are included in the return
    list even if these should never be served to the client.</p>
<p class="Pp">In a scalar context, it returns the identifier of the variant with
    the highest score or <span class="Li">&quot;undef&quot;</span> if none have
    non-zero quality.</p>
<p class="Pp">If the <span class="Li">$HTTP::Negotiate::DEBUG</span> variable is
    set to TRUE, then a lot of noise is generated on STDOUT during evaluation of
    <b>choose()</b>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="VARIANTS"><a class="permalink" href="#VARIANTS">VARIANTS</a></h1>
<p class="Pp">A variant is described by a list of the following values. If the
    attribute does not make sense or is unknown for a variant, then use
    <span class="Li">&quot;undef&quot;</span> instead.</p>
<dl class="Bl-tag">
  <dt id="identifier"><a class="permalink" href="#identifier">identifier</a></dt>
  <dd>This is a string that you use as the name for the variant. This identifier
      for the preferred variants returned by <b>choose()</b>.</dd>
  <dt id="qs"><a class="permalink" href="#qs">qs</a></dt>
  <dd>This is a number between 0.000 and 1.000 that describes the &quot;source
      quality&quot;. This is what <i>draft-ietf-http-v11-spec-00.ps</i> says
      about this value:
    <p class="Pp">Source quality is measured by the content provider as
        representing the amount of degradation from the original source. For
        example, a picture in JPEG form would have a lower qs when translated to
        the XBM format, and much lower qs when translated to an ASCII-art
        representation. Note, however, that this is a function of the source -
        an original piece of ASCII-art may degrade in quality if it is captured
        in JPEG form. The qs values should be assigned to each variant by the
        content provider; if no qs value has been assigned, the default is
        generally &quot;qs=1&quot;.</p>
  </dd>
  <dt id="content-type"><a class="permalink" href="#content-type">content-type</a></dt>
  <dd>This is the media type of the variant. The media type does not include a
      charset attribute, but might contain other parameters. Examples are:
    <p class="Pp"></p>
    <pre>  text/html
  text/html;version=2.0
  text/plain
  image/gif
  image/jpg
    </pre>
  </dd>
  <dt id="content-encoding"><a class="permalink" href="#content-encoding">content-encoding</a></dt>
  <dd>This is one or more content encodings that has been applied to the
      variant. The content encoding is generally used as a modifier to the
      content media type. The most common content encodings are:
    <p class="Pp"></p>
    <pre>  gzip
  compress
    </pre>
  </dd>
  <dt id="content-charset"><a class="permalink" href="#content-charset">content-charset</a></dt>
  <dd>This is the character set used when the variant contains text. The charset
      value should generally be <span class="Li">&quot;undef&quot;</span> or one
      of these:
    <p class="Pp"></p>
    <pre>  us-ascii
  iso-8859-1 ... iso-8859-9
  iso-2022-jp
  iso-2022-jp-2
  iso-2022-kr
  unicode-1-1
  unicode-1-1-utf-7
  unicode-1-1-utf-8
    </pre>
  </dd>
  <dt id="content-language"><a class="permalink" href="#content-language">content-language</a></dt>
  <dd>This describes one or more languages that are used in the variant.
      Language is described like this in <i>draft-ietf-http-v11-spec-00.ps</i>:
      A language is in this context a natural language spoken, written, or
      otherwise conveyed by human beings for communication of information to
      other human beings. Computer languages are explicitly excluded.
    <p class="Pp">The language tags are defined by RFC 3066. Examples are:</p>
    <p class="Pp"></p>
    <pre>  no               Norwegian
  en               International English
  en-US            US English
  en-cockney
    </pre>
  </dd>
  <dt id="content-length"><a class="permalink" href="#content-length">content-length</a></dt>
  <dd>This is the number of bytes used to represent the content.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ACCEPT_HEADERS"><a class="permalink" href="#ACCEPT_HEADERS">ACCEPT
  HEADERS</a></h1>
<p class="Pp">The following Accept* headers can be used for describing content
    preferences in a request (This description is an edited extract from
    <i>draft-ietf-http-v11-spec-00.ps</i>):</p>
<dl class="Bl-tag">
  <dt id="Accept"><a class="permalink" href="#Accept">Accept</a></dt>
  <dd>This header can be used to indicate a list of media ranges which are
      acceptable as a response to the request. The &quot;*&quot; character is
      used to group media types into ranges, with &quot;*/*&quot; indicating all
      media types and &quot;type/*&quot; indicating all subtypes of that type.
    <p class="Pp">The parameter q is used to indicate the quality factor, which
        represents the user's preference for that range of media types. The
        parameter mbx gives the maximum acceptable size of the response content.
        The default values are: q=1 and mbx=infinity. If no Accept header is
        present, then the client accepts all media types with q=1.</p>
    <p class="Pp">For example:</p>
    <p class="Pp"></p>
    <pre>  Accept: audio/*;q=0.2;mbx=200000, audio/basic
    </pre>
    <p class="Pp">would mean: &quot;I prefer audio/basic (of any size), but send
        me any audio type if it is the best available after an 80% mark-down in
        quality and its size is less than 200000 bytes&quot;</p>
  </dd>
  <dt id="Accept-Charset"><a class="permalink" href="#Accept-Charset">Accept-Charset</a></dt>
  <dd>Used to indicate what character sets are acceptable for the response. The
      &quot;us-ascii&quot; character set is assumed to be acceptable for all
      user agents. If no Accept-Charset field is given, the default is that any
      charset is acceptable. Example:
    <p class="Pp"></p>
    <pre>  Accept-Charset: iso-8859-1, unicode-1-1
    </pre>
  </dd>
  <dt id="Accept-Encoding"><a class="permalink" href="#Accept-Encoding">Accept-Encoding</a></dt>
  <dd>Restricts the Content-Encoding values which are acceptable in the
      response. If no Accept-Encoding field is present, the server may assume
      that the client will accept any content encoding. An empty Accept-Encoding
      means that no content encoding is acceptable. Example:
    <p class="Pp"></p>
    <pre>  Accept-Encoding: compress, gzip
    </pre>
  </dd>
  <dt id="Accept-Language"><a class="permalink" href="#Accept-Language">Accept-Language</a></dt>
  <dd>This field is similar to Accept, but restricts the set of natural
      languages that are preferred in a response. Each language may be given an
      associated quality value which represents an estimate of the user's
      comprehension of that language. For example:
    <p class="Pp"></p>
    <pre>  Accept-Language: no, en-gb;q=0.8, de;q=0.55
    </pre>
    <p class="Pp">would mean: &quot;I prefer Norwegian, but will accept British
        English (with 80% comprehension) or German (with 55% comprehension).</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp">Copyright 1996,2001 Gisle Aas.</p>
<p class="Pp">This library is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Gisle Aas &lt;gisle@aas.no&gt;</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2012-02-18</td>
    <td class="foot-os">perl v5.34.0</td>
  </tr>
</table>
</body>
</html>
