<!DOCTYPE html>
<html>
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>CERTTOOL(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">CERTTOOL(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">CERTTOOL(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">certtool - create key pairs, certificates and certificate signing
    requests for use with Keychains</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><b>certtool</b> command [command-args] [options]</p>
<p class="Pp"><b>certtool</b> c [options]</p>
<p class="Pp"><b>certtool</b> r outFileName [options]</p>
<p class="Pp"><b>certtool</b> V infileName [options]</p>
<p class="Pp"><b>certtool</b> C domainName [options]</p>
<p class="Pp"><b>certtool</b> i inFileName [options]</p>
<p class="Pp"><b>certtool</b> d inFileName [options]</p>
<p class="Pp"><b>certtool</b> y [options]</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CERTTOOL_COMMAND_SUMMARY"><a class="permalink" href="#CERTTOOL_COMMAND_SUMMARY">CERTTOOL
  COMMAND SUMMARY</a></h1>
<p class="Pp"><b>c</b> Create keypair and Certificate</p>
<p class="Pp"><b>r</b> Create CSR</p>
<p class="Pp"><b>V</b> Verify CSR</p>
<p class="Pp"><b>C</b> Create a System Identity</p>
<p class="Pp"><b>i</b> Import Certificate</p>
<p class="Pp"><b>d</b> Display Certificate</p>
<p class="Pp"><b>y</b> Display all certs in keychain</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CERTTOOL_OPTION_SUMMARY"><a class="permalink" href="#CERTTOOL_OPTION_SUMMARY">CERTTOOL
  OPTION SUMMARY</a></h1>
<dl class="Bl-tag">
  <dt id="c"><a class="permalink" href="#c"><b>c</b></a></dt>
  <dd>Create the keychain, if one is needed.</dd>
  <dt id="d"><a class="permalink" href="#d"><b>d</b></a></dt>
  <dd>Create a CSR in DER format; default is PEM</dd>
  <dt id="k=keychainName"><a class="permalink" href="#k=keychainName"><b>k=keychainName</b></a></dt>
  <dd>Specify the Keychain to use for the operation. If keychainName starts with
      a '/', an absolute path is assumed; otherwise, the specified filename is
      relative to the user's Library/Keychains directory.</dd>
  <dt id="p=passphrase"><a class="permalink" href="#p=passphrase"><b>p=passphrase</b></a></dt>
  <dd>Specify the keychain passphrase when creating</dd>
  <dt id="r=privateKeyFileName"><a class="permalink" href="#r=privateKeyFileName"><b>r=privateKeyFileName</b></a></dt>
  <dd>Optional private key, for Import Certificate only</dd>
  <dt id="f=_18f_"><a class="permalink" href="#f=_18f_"><b>f=[18f]</b></a></dt>
  <dd>Private Key Format = PKCS1/PKCS8/FIPS186; default is PKCS1 (openssl)</dd>
  <dt id="x=_aSsm_"><a class="permalink" href="#x=_aSsm_"><b>x=[aSsm]</b></a></dt>
  <dd>Extended Key Usage: a=Any; s=SSL Client; S=SSL Server; m=SMIME</dd>
  <dt id="a"><a class="permalink" href="#a"><b>a</b></a></dt>
  <dd>Generate private key with default ACL</dd>
  <dt id="u"><a class="permalink" href="#u"><b>u</b></a></dt>
  <dd>Generate private key with ACL limiting access to current user</dd>
  <dt id="P"><a class="permalink" href="#P"><b>P</b></a></dt>
  <dd>Don't create System Identity if one already exists for specified
    domain</dd>
  <dt id="h"><a class="permalink" href="#h"><b>h</b></a></dt>
  <dd>Print usage message</dd>
  <dt id="v"><a class="permalink" href="#v"><b>v</b></a></dt>
  <dd>Execute in verbose mode.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><b>Certtool</b> is a UNIX command-line program which is used to
    create key pairs, certificates, and certificate signing requests; to import
    externally generated certificates into a Keychain, and to display the
    contents of certificates.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp"><b>Generating a Self-Signed Certificate</b></p>
<p class="Pp">This command generates a key pair and a self-signed (root)
    certificate and places them in a keychain. The root cert is signed by the
    private key generated during this command. The cert generated by this
    command is totally untrustworthy and cannot be used in the &quot;real
    world&quot;; the primary use of this command is to facilitate early
    development of SSL server applications based on SecureTransport. In
    particular, &quot;real world&quot; SSL clients (e.g., web browsers) will
    complain to varying degrees when they attempt to connect to an SSL server
    which presents a cert which is generated by this command. Some broswers,
    after a fair amount of handholding, will allow you to conditionally
    &quot;trust&quot; this cert.</p>
<pre># CertTool c [options]
</pre>
The available options are:
<pre>k=keyChainName 
</pre>
Where &quot;keyChainName&quot; is the name of the keychain into which keys and
  the cert will be added. The specified keychain must exist. If it doesn't exist
  and you want the keychain created for you, specify the 'c' option. If no
  keychain is specified, keys and certs are added to the default keychain.
<pre>c 
</pre>
Specifies that the designated keychain is to be created.
<pre>x=[aSsm]
</pre>
Specifies an optional Extended Key Usage extension. Values are 'a' for
  ExtendedKeyUseAny; 's' for SSL client (ClientAuth); 'S' for SSL server
  (ServerAuth); and 'm' for S/MIME (EmailProtection).
<pre>a
</pre>
Results the the private key being created with a default ACL. If not specified,
  the private key is created with no ACL.
<p class="Pp"></p>
<pre>u
</pre>
Create the private key with an ACL limiting access to the current user.
<p class="Pp">This is an interactive command; you will be prompted for a number
    of different items which are used to generate the keypair and the cert. A
    sample session follows.</p>
<pre># CertTool k=certkc 
Enter key and certificate label: testCert 
Please specify parameters for the key pair you will generate. 
<br/>
    r RSA
<br/>
    d DSA
<br/>
    f FEE
<br/>
    e ECDSA
Select key algorithm by letter: r
Valid key sizes for RSA are 1024..2048; default is 2048
Enter key size in bits or CR for default: 2048
You have selected algorithm RSA, key size 2048 bits.
OK (y/anything)? y 
Enter cert/key usage (s=signing, b=signing AND encrypting): b 
<br/>
 ...Generating key pair... 
</pre>
Note: you will be prompted for the Keychain's passphrase by the Keychain system
  at this point if the specified keychain is not open and you have not specified
  the passphrase via the 'p' option.
<pre>Please specify the algorithm with which your certificate will be signed. 
<br/>
    s  RSA with SHA1
<br/>
    2  RSA with SHA256
<br/>
    3  RSA with SHA384
<br/>
    5  RSA with SHA512
Select signature algorithm by letter: s
You have selected algorithm RSA with SHA1. 
OK (y/anything)? y 
<br/>
 ...creating certificate... 
</pre>
You will now specify the various components of the certificate's Relative
  Distinguished Name (RDN). An RDN has a number of components, all of which are
  optional, but at least one of which must be present.
<p class="Pp">Note that if you are creating a certificate for use in an SSL/TLS
    server, the Common Name component of the RDN must match exactly the host
    name of the server. This must not be an IP address, but the actual domain
    name, e.g. www.apple.com. Entering a CR for a given RDN component results in
    no value for that component.</p>
<pre>Common Name       (e.g. www.apple.com) : 10.0.61.5
Country           (e.g. US) : 
Organization      (e.g. Apple, Inc.) : Apple
Organization Unit (e.g. Apple Software Engineering) :
State/Province    (e.g. California) : California 
Email Address     (e.g. username@apple.com) :
You have specified: 
<br/>
 Common Name	: 10.0.61.5 
<br/>
 Organization	: Apple 
<br/>
 State/Province : California 
Is this OK (y/anything)? y 
<br/>
 ..cert stored in Keychain. 
#
</pre>
The &quot;Common Name&quot; portion of the RDN - in the above case,
  &quot;10.0.61.5&quot; - MUST match the host name of the machine you'll be
  running an SSL/TLS server on. (In this case the test machine doesn't have an
  actual hostname; it's DHCP'd behind a firewall which is why
  &quot;10.0.61.5&quot; was specified for Common Name.) This is part of SSL's
  certificate verification; it prevents an attack using DNS spoofing.
<p class="Pp">A brief note about cert/key usage: the normal configuration of
    SecureTransport is that the server cert specified in SSLSetCertificate() is
    capable of both signing and encryption. If this cert is only capable of
    signing, you must create a second keychain containing a cert which is
    capable of encryption, and pass that to SSLSetEncryptionCertificate().</p>
<p class="Pp"><b>Generating a Certificate Signing Request (CSR)</b></p>
<p class="Pp">A CSR is the standard means by which an administrator of a web
    server provides information to a Certificate Authority (CA) in order to
    obtain a valid certificate which is signed by the CA. This type of cert is
    used in the real world; certs signed by CAs such as Verisign and Thawte are
    recognized by most web browsers when performing SSL transactions.</p>
<p class="Pp">The general procedure for obtaining a &quot;real&quot; cert
  is:</p>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>Generate a key pair</dd>
  <dt>&#x2022;</dt>
  <dd>Generate a CSR</dd>
  <dt>&#x2022;</dt>
  <dd>Provide the CSR and some other information and/or documentation to the
    CA</dd>
  <dt>&#x2022;</dt>
  <dd>CA sends you a certificate which is signed by the CA.</dd>
  <dt>&#x2022;</dt>
  <dd>You import that certificate, obtained from the CA, into your
    keychain.</dd>
</dl>
<p class="Pp">The items in that keychain can now be used in SecureTransport's
    SSLSetCertificate() call.</p>
<p class="Pp">This command performs the first two steps in the above procedure.
    See the section below entitled &quot;Importing a Certificate&quot; for
    information on importing the resulting certificate into your keychain. The
    format of this command is</p>
<pre># CertTool r outFileName [options] 
</pre>
The resulting CSR will be written to &quot;outFileName&quot;. The available
  options are:
<pre>k=keyChainName 
</pre>
Where &quot;KeyChainName&quot; is the name of the keychain into which keys and
  the cert will be added. If no keychain is specified, keys and certs are added
  to the default keychain. The specified keychain must exist unless you specify
  the 'c' option.
<pre>
<br/>
 d 
</pre>
The 'd' option tells CertTool to create the CSR in DER-encoded format. The
  default is PEM-encoded, which is what most CAs expect. PEM encoded data
  consists of printable ASCII text which can, for example, be pasted into an
  email message. DER-encoded data is nonprintable binary data.
<pre>
<br/>
 c 
</pre>
Specifies that the designated keychain is to be created.
<pre>a
</pre>
Results the the private key being created with a default ACL. If not specified,
  the private key is created with no ACL.
<pre>u
</pre>
Create the private key with an ACL limiting access to the current user.
<p class="Pp">This is an interactive command; you will be prompted for a number
    of different items which are used to generate the keypair and the CSR. The
    prompts given, and the format of the data you must supply, are identical to
    the data shown in the sample session in Section 2.</p>
<p class="Pp"><b>Verifying a CSR</b></p>
<p class="Pp">A CSR contains, among other things, the public key which was
    generated in as described above. The CSR is signed with the associated
    private key. Thus the integrity of a CSR can be verified by extracting its
    public key and verifying the signature of the CSR. This command performs
    this integrity check. The format of this command is</p>
<pre># CertTool V inFileName [options]
</pre>
The only available option is the 'd' flag, which as described above in the
  section entitled &quot;Generating a Certificate Signing Request&quot;,
  indiciates that the CSR is in DER format rather than the default PEM format. A
  typical (successful) run of this command is like so:
<pre># CertTool V myCsr.pem
<br/>
 ...CSR verified successfully. 
</pre>
A large number of things can go wrong if the verification fails; suffice it to
  say that if you see anything other than the above success message, you have a
  bad or corrupted CSR.
<p class="Pp"><b>Creating a System Identity</b></p>
<p class="Pp">This creates a key pair and a self-signed (root) certificate in
    the System keychain, and registers the result in the System Identity
    database as being the IDentity associated with the specified domain name.
    The domain name is typically a string of the form
    &quot;com.apple.somedomain...&quot;. You must be running as root to execute
    this command. The format of this command is</p>
<pre># CertTool C domainName [options] 
</pre>
The available options are:
<pre>u
</pre>
Create the private key with an ACL limiting access to the current user. If not
  specified, the private key wil be created with a default ACL.
<pre>P
</pre>
Don't create system identity if one already exists for specified domain.
<p class="Pp"><b>Importing a Certificate from a Certificate Authority</b></p>
<p class="Pp">Once you have negotiated with your CA, and provided them with the
    CSR generated as described above as well as any other information,
    documentation, and payment they require, the CA will provide you with a
    certificate. Use this command to add that certificate to the keychain
    containing the keypair you generated previously.</p>
<p class="Pp">The format of this command is</p>
<pre># CertTool i inFileName [options] 
</pre>
The cert to import is obtained from &quot;inFileName&quot;. The available
  options are:
<pre>k=keyChainName 
</pre>
Where &quot;keyChainName&quot; is the name of the keychain to which the cert
  will be added. If no keychain is specified, the cert is added to the default
  keychain. The specified keychain typically contains the keypair you generated
  previously. (Note you can import a certificate into a keychain which does not
  contain keys you generated but there will be no linkage between the imported
  certificate and a private key if you do this.) If the keychain is not open
  when this command is executed, you will be prompted by the Keychain system for
  its passphrase.
<pre>r=privateKeyFileName
</pre>
Where &quot;privateKeyFileName&quot; is the name of the optional private key
  file to imported along with the certificate. This option is used to import
  cert/key pairs which are generated by other means, such as OpenSSL.
<pre>f=privateKeyFormat
</pre>
Where &quot;privateKeyFormat&quot; is the format of the private key specified
  with the 'r' option. The formats are: '1' for PKCS1 (OpenSSL format), '8'
  (PKCS8), and 'f' (FIPS186, BSAFE format). The default is OpenSSL format for
  both RSA and DSA keys.
<pre>
<br/>
 d 
</pre>
Specifies DER format as described above. The default is PEM format.
<pre>
<br/>
 c 
</pre>
Specifies that the designated keychain is to be created.
<p class="Pp"><b>Displaying a Certificate</b></p>
<p class="Pp">This displays the contents of an existing certificate, obtained
    from a file. The format of this command is</p>
<pre># CertTool d inFileName [options] 
</pre>
The cert to display is obtained from &quot;inFileName&quot;. The only available
  option is the 'd' flag, specifying DER format as described above. The default
  is PEM format. Actually, in the absence of this option, certtool will
  correctly determine the format of the certificate (PEM or DER).
<p class="Pp"><b>Displaying Certificates in a keychain</b></p>
<p class="Pp">This displays the contents of all certificates in a keychain. The
    format of this command is</p>
<pre># CertTool y [options] 
</pre>
The available options are:
<pre>k=keyChainName 
</pre>
Where &quot;KeyChainName&quot; is the name of the keychain to display.
<pre>v
</pre>
Specifies verbose mode.
<p class="Pp"><b>Certificate Authorities and CSRs</b></p>
<p class="Pp">As mentioned above, the general procedure for obtaining a
    &quot;real&quot; cert is:</p>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>Generate a key pair</dd>
  <dt>&#x2022;</dt>
  <dd>Generate a CSR</dd>
  <dt>&#x2022;</dt>
  <dd>Provide the CSR and some other information and/or documentation to the
    CA</dd>
  <dt>&#x2022;</dt>
  <dd>CA sends you a certificate which is signed by the CA.</dd>
  <dt>&#x2022;</dt>
  <dd>You import that certificate, obtained from the CA, into your
    keychain.</dd>
</dl>
<p class="Pp">The items in that keychain can now be used in SecureTransport's
    SSLSetCertificate() call.</p>
<p class="Pp">One CA with an excellent web-based interface for obtaining a cert
    is Verisign (http://www.verisign.com/products/site/index.html). You can get
    a free 14-day trial certificate using nothing but CertTool, Verisign's web
    site, and email. You need to provide some personal information. Paste the
    CSR generated as described in the section entitled &quot;Generating a
    Certificate Signing Request&quot; into a form on the web site. A few minutes
    later Verisign emails you a certificate, which you import into your
    keychain. The whole process takes less than 10 minutes. The free certificate
    obtained in this manner is signed by a temporary root cert which is not
    recognized by any browsers, but Verisign also provides a means of installing
    this temporary root cert into your browser, directly from their web site.
    Typically one would use the free, temporary cert to perform initial
    configuration of a server and to ring out the general SSL infrastructure.
    Once you feel comfortable with the operation of the server, then it's time
    to buy a &quot;real&quot; certificate which will allow your web server to be
    trusted by any browser.</p>
<p class="Pp">Thawte has a similar, very friendly service at
    http://www.thawte.com/. Note that, for early web server development and/or
    testing, you can skip the entire procedure described above and just generate
    your own self-signed root cert as described above. No CA is involved; no CSR
    is generated; no cert needs to be imported - CertTool generates a cert for
    you and immediately adds it to your keychain. Bear in mind that this option
    will require support from various SSL clients you'll be testing with, none
    of which recognize your root cert.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<p class="Pp"><b>/System/Library/Keychains/X509Anchors</b> System root
    certificate database <b>/Library/Keychains/System.keychain</b> System
    Keychain</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>openssl</b>(<b>1</b>)</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">March 19, 2003</td>
    <td class="foot-os">Apple Computer, Inc.</td>
  </tr>
</table>
</body>
</html>
