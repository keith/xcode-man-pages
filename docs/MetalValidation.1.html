<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
  Modified from man(1) of FreeBSD, the NetBSD mdoc.template, and mdoc.samples.
  See Also:
  man mdoc.samples for a complete listing of options
  man mdoc for the short list of editing options
  /usr/share/misc/mdoc.template
   DATE
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>METALVALIDATION(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">METALVALIDATION(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">METALVALIDATION(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">Metal Validation</code> &#x2014;
    <span class="Nd">Metal Runtime Validation</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="Ev">MTL_DEBUG_LAYER</code>
  <br/>
  <code class="Ev">MTL_DEBUG_LAYER_ERROR_MODE</code>
  <br/>
  <code class="Ev">MTL_DEBUG_LAYER_WARNING_MODE</code>
  <br/>
  <code class="Ev">MTL_DEBUG_LAYER_VALIDATE_LOAD_ACTIONS</code>
  <br/>
  <code class="Ev">MTL_DEBUG_LAYER_VALIDATE_STORE_ACTIONS</code>
  <br/>
  <code class="Ev">MTL_DEBUG_LAYER_VALIDATE_UNRETAINED_RESOURCES</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_DEFAULT_STATE</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_ENABLE_PIPELINES</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_DISABLE_PIPELINES</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_DUMP_PIPELINES</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_ENABLE_ERROR_REPORTING</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_DEVICE_MEMORY</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_TEXTURE_USAGE</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_THREADGROUP_MEMORY</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_RESOURCE_USAGE</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_COMPILER_INLINING</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_FAIL_MODE</code>
  <br/>
  <code class="Ev">MTL_SHADER_VALIDATION_REPORT_TO_STDERR</code></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Unless otherwise noted all environment variables listed must be
    set before any Metal device is created in the process. Any changes to these
    values after device creation will not take effect.</p>
<p class="Pp">Metal provides two modes of validation, API and GPU.</p>
<p class="Pp">API validation validates CPU API usage correctness such as calling
    draw without a pipeline set.</p>
<p class="Pp">GPU validation validates GPU API correctness such as accessing
    invalid GPU memory.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<dl class="Bl-tag">
  <dt id="MTL_DEBUG_LAYER"><a class="permalink" href="#MTL_DEBUG_LAYER"><b class="Sy">MTL_DEBUG_LAYER</b></a></dt>
  <dd>
    <br/>
    Defaults to 0.
    <br/>
    All environment variables prefixed with MTL_DEBUG_LAYER only apply when
      MTL_DEBUG_LAYER is non-zero.
    <br/>
    Any value other than 0 will enable API validation.</dd>
  <dt id="MTL_DEBUG_LAYER_ERROR_MODE"><a class="permalink" href="#MTL_DEBUG_LAYER_ERROR_MODE"><b class="Sy">MTL_DEBUG_LAYER_ERROR_MODE</b></a></dt>
  <dd>
    <br/>
    Defaults to &quot;assert&quot;
    <br/>
    Valid values are &quot;assert&quot;, &quot;ignore&quot; and
      &quot;nslog&quot;
    <br/>
    Sets the behavior for when a debug layer error occurs.
    <p class="Pp">Setting &quot;assert&quot; will cause the debug layer to log
        and then assert on error.</p>
    <p class="Pp">Setting &quot;ignore&quot; will cause the debug layer to
        ignore errors, this may cause undefined behavior.</p>
    <p class="Pp">Setting &quot;nslog&quot; will cause the debug layer to log
        errors using NSLog, this may cause undefined behavior.</p>
  </dd>
  <dt id="MTL_DEBUG_LAYER_WARNING_MODE"><a class="permalink" href="#MTL_DEBUG_LAYER_WARNING_MODE"><b class="Sy">MTL_DEBUG_LAYER_WARNING_MODE</b></a></dt>
  <dd>
    <br/>
    Defaults to &quot;ignore&quot;
    <br/>
    Valid values are &quot;assert&quot;, &quot;ignore&quot; and
      &quot;nslog&quot;
    <br/>
    Sets the behavior for when a debug layer warning occurs.
    <p class="Pp">Setting &quot;assert&quot; will cause the debug layer to log
        and then assert on warnings.</p>
    <p class="Pp">Setting &quot;ignore&quot; will cause the debug layer to
        ignore warnings.</p>
    <p class="Pp">Setting &quot;nslog&quot; will cause the debug layer to log
        warnings using NSLog.</p>
  </dd>
  <dt id="MTL_DEBUG_LAYER_VALIDATE_LOAD_ACTIONS"><a class="permalink" href="#MTL_DEBUG_LAYER_VALIDATE_LOAD_ACTIONS"><b class="Sy">MTL_DEBUG_LAYER_VALIDATE_LOAD_ACTIONS</b></a></dt>
  <dd>
    <br/>
    Defaults to 0
    <br/>
    Setting this value to &quot;1&quot; will convert any MTLLoadActionDontCare
      to MTLLoadActionClear of fuchsia. This can be used to debug incorrect load
      action modes or assumptions on DontCare behavior.</dd>
  <dt id="MTL_DEBUG_LAYER_VALIDATE_STORE_ACTIONS"><a class="permalink" href="#MTL_DEBUG_LAYER_VALIDATE_STORE_ACTIONS"><b class="Sy">MTL_DEBUG_LAYER_VALIDATE_STORE_ACTIONS</b></a></dt>
  <dd>
    <br/>
    Defaults to 0
    <br/>
    Setting this value to &quot;1&quot; will write an alternating red and white
      checkerboard into each render target with a store action of
      MTLStoreActionDontCare. This can be used to debug incorrect store action
      modes or assumptions on DontCare behavior.</dd>
  <dt id="MTL_DEBUG_LAYER_VALIDATE_UNRETAINED_RESOURCES"><a class="permalink" href="#MTL_DEBUG_LAYER_VALIDATE_UNRETAINED_RESOURCES"><b class="Sy">MTL_DEBUG_LAYER_VALIDATE_UNRETAINED_RESOURCES</b></a></dt>
  <dd>
    <br/>
    Defaults to 1
    <br/>
    This option takes a bitfield of modes to enable. The bitfield values are:
    <p class="Pp">0x1 : Enabling this flag will cause command buffer to tag any
        objects bound to the command buffer, which are not retained internally.
        If a tagged object is deallocated before the command buffer completes,
        an error is raised.</p>
    <p class="Pp">0x2 : Enabling this flag will cause command buffer to tag
        objects that are internally retained by the command buffer. This should
        usually not be needed, because an object cannot be deallocated while the
        command buffer itself isn't complete.</p>
    <p class="Pp">0x4 : Enabling this flag will cause deallocated tagged objects
        to be considered an error even before committing the command buffer.
        This will lead to more immediate error (ie: in the call stack of the
        dealloc) rather than at commit, which is more debuggable.</p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION"><a class="permalink" href="#MTL_SHADER_VALIDATION"><b class="Sy">MTL_SHADER_VALIDATION</b></a></dt>
  <dd>
    <br/>
    Defaults to 0
    <br/>
    All environment variables prefixed with MTL_SHADER_VALIDATION only apply
      when MTL_SHADER_VALIDATION is non zero.
    <br/>
    Any value other than 0 will enable GPU validation.
    <br/>
    Sets the behavior of API usage errors. Using a value of &quot;4&quot; for
      this setting may result in undefined behavior as otherwise fatal errors
      will be ignored.</dd>
  <dt id="MTL_SHADER_VALIDATION_DEFAULT_STATE"><a class="permalink" href="#MTL_SHADER_VALIDATION_DEFAULT_STATE"><b class="Sy">MTL_SHADER_VALIDATION_DEFAULT_STATE</b></a></dt>
  <dd>
    <br/>
    Defaults to &quot;all&quot;
    <br/>
    Defines the default behavior of Shader Validation for all pipelines.
    <br/>
    If set to &quot;all&quot;, every pipeline will be created with Shader
      Validation by default.
    <br/>
    If set to &quot;none&quot;, no pipeline will be created with Shader
      Validation by default.
    <br/>
    This default behavior can be bypassed with
      <code class="Ev">MTL_SHADER_VALIDATION_ENABLE_PIPELINES</code> and
      <code class="Ev">MTL_SHADER_VALIDATION_DISABLE_PIPELINES</code></dd>
  <dt>MTL_SHADER_VALIDATION_ENABLE_PIPELINES</dt>
  <dd>
    <br/>
    Defaults to an empty string
    <br/>
    List of pipeline labels (or Shader Validation UIDs generated by
      <code class="Ev">MTL_SHADER_VALIDATION_DUMP_PIPELINES)</code> for which
      Shader Validation should be enabled. Only relevant when
      MTL_SHADER_VALIDATION_DEFAULT_STATE is set to &quot;none&quot;.
    <br/>
    The list is comma-separated, and spaces are part of the parsed name.</dd>
  <dt>MTL_SHADER_VALIDATION_DISABLE_PIPELINES</dt>
  <dd>
    <br/>
    Defaults to an empty string
    <br/>
    List of pipeline labels (or Shader Validation UIDs generated by
      <code class="Ev">MTL_SHADER_VALIDATION_DUMP_PIPELINES)</code> for which
      Shader Validation should be disabled. Only relevant when
      MTL_SHADER_VALIDATION_DEFAULT_STATE is set to &quot;all&quot;.
    <br/>
    The list is comma-separated, and spaces are part of the parsed name.</dd>
  <dt>MTL_SHADER_VALIDATION_DUMP_PIPELINES</dt>
  <dd>
    <br/>
    Defaults to 0
    <br/>
    If set to &quot;1&quot;, dumps the list of UIDs referencing the pipelines
      compiled in the program into Console.app
    <br/>
    The UIDs are persistent across multiple runs and can be used as inputs to
      <code class="Ev">MTL_SHADER_VALIDATION_ENABLE_PIPELINES</code> and
      <code class="Ev">MTL_SHADER_VALIDATION_DISABLE_PIPELINES</code>
    <br/>
    UIDs are logged using Unified Logging and can be viewed in Console.app by
      filtering with &quot;Shader Validation UID&quot;</dd>
  <dt id="MTL_SHADER_VALIDATION_ENABLE_ERROR_REPORTING"><a class="permalink" href="#MTL_SHADER_VALIDATION_ENABLE_ERROR_REPORTING"><b class="Sy">MTL_SHADER_VALIDATION_ENABLE_ERROR_REPORTING</b></a></dt>
  <dd>
    <br/>
    Defaults to 1
    <br/>
    Setting this value to &quot;0&quot; will disable shader validation error
      reporting but not instrumentation or detection.</dd>
  <dt id="MTL_SHADER_VALIDATION_GLOBAL_MEMORY"><a class="permalink" href="#MTL_SHADER_VALIDATION_GLOBAL_MEMORY"><b class="Sy">MTL_SHADER_VALIDATION_GLOBAL_MEMORY</b></a></dt>
  <dd>
    <br/>
    Defaults to 1
    <br/>
    Setting this value to &quot;0&quot; will disable instrumentation of device
      &amp; constant memory access. The result of accessing invalid global
      memory on the GPU will be undefined.
    <p class="Pp">If this value is set to any non-zero value, shader validation
        will instrument all global memory accesses and result of accessing
        invalid memory is determined by
        <code class="Ev">MTL_SHADER_VALIDATION_FAIL_MODE</code></p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION_TEXTURE_USAGE"><a class="permalink" href="#MTL_SHADER_VALIDATION_TEXTURE_USAGE"><b class="Sy">MTL_SHADER_VALIDATION_TEXTURE_USAGE</b></a></dt>
  <dd>
    <br/>
    Defaults to 1
    <br/>
    Setting this value to &quot;0&quot; will disable instrumentation of texture
      member functions. The result of accessing nil texture objects on the GPU
      will be undefined.
    <p class="Pp">If this value is set to any non-zero value, shader validation
        will instrument all texture member functions (e.g read, write,
        get_width) and the result of accessing a nil texture object is
        determined by
      <code class="Ev">MTL_SHADER_VALIDATION_FAIL_MODE</code></p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION_THREADGROUP_MEMORY"><a class="permalink" href="#MTL_SHADER_VALIDATION_THREADGROUP_MEMORY"><b class="Sy">MTL_SHADER_VALIDATION_THREADGROUP_MEMORY</b></a></dt>
  <dd>
    <br/>
    Defaults to 1
    <br/>
    Setting this value to &quot;0&quot; will disable instrumentation of
      threadgroup memory access. The result of accessing invalid threadgroup
      memory on the GPU will be undefined.
    <p class="Pp">If this value is set to any non-zero value, shader validation
        will instrument all threadgroup memory accesses and result of accessing
        invalid memory is determined by
        <code class="Ev">MTL_SHADER_VALIDATION_FAIL_MODE</code></p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION_RESOURCE_USAGE"><a class="permalink" href="#MTL_SHADER_VALIDATION_RESOURCE_USAGE"><b class="Sy">MTL_SHADER_VALIDATION_RESOURCE_USAGE</b></a></dt>
  <dd>
    <br/>
    Defaults to 1
    <br/>
    Setting this value to &quot;0&quot; will disable instrumentation of resource
      usage. The result of accessing resources that are not resident on the GPU
      will be undefined.
    <p class="Pp">If this value is set to any non-zero value, shader validation
        will instrument all resource accesses to check resource usage. It will
        detect missing calls to useResource and useHeap on resources used by the
        GPU. The result of accessing invalid memory is determined by
        <code class="Ev">MTL_SHADER_VALIDATION_FAIL_MODE</code></p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION_STACK_OVERFLOW"><a class="permalink" href="#MTL_SHADER_VALIDATION_STACK_OVERFLOW"><b class="Sy">MTL_SHADER_VALIDATION_STACK_OVERFLOW</b></a></dt>
  <dd>
    <br/>
    Defaults to 1
    <br/>
    Setting this value to &quot;0&quot; will disable instrumentation of indirect
      and recursive function calls. The result of exceeding
      &quot;maxCallStackDepth&quot; will be undefined.
    <p class="Pp">If this value is set to any non-zero value, shader validation
        will instrument all indirect calls (calls by function pointer, visible
        functions, intersection functions, dylib calls) and recursive calls. If
        the call stack depth for such functions exeecds the value set for
        &quot;maxCallStackDepth&quot; for that stage, an error will be raised
        and the function call will be skipped.</p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION_COMPILER_INLINING"><a class="permalink" href="#MTL_SHADER_VALIDATION_COMPILER_INLINING"><b class="Sy">MTL_SHADER_VALIDATION_COMPILER_INLINING</b></a></dt>
  <dd>
    <br/>
    Valid options are &quot;default&quot;, &quot;full&quot;.
    <p class="Pp">Determines whether code inlining will occur.
      <br/>
      Setting this value to &quot;full&quot; will force inlining
      <br/>
      Adding inlining may result in improved runtime performance at the cost of
        compile time performance.
      <br/>
      Reducing inlining may result in improved compile time performance at the
        cost of runtime performance.</p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION_FAIL_MODE"><a class="permalink" href="#MTL_SHADER_VALIDATION_FAIL_MODE"><b class="Sy">MTL_SHADER_VALIDATION_FAIL_MODE</b></a></dt>
  <dd>
    <br/>
    Defaults to &quot;zerofill&quot;
    <br/>
    Valid options are &quot;zerofill&quot;, &quot;allow&quot;.
    <p class="Pp">Sets the behavior for how invalid accesses should be handled.
        Setting this value to &quot;zerofill&quot; causes invalid reads to
        return 0. Invalid writes are dropped.</p>
    <p class="Pp">Setting this value to &quot;allow&quot; allows the invalid
        read or write, which may result in command buffer failure depending on
        platform, but has reduced compile &amp; runtime performance impact.</p>
  </dd>
  <dt id="MTL_SHADER_VALIDATION_REPORT_TO_STDERR"><a class="permalink" href="#MTL_SHADER_VALIDATION_REPORT_TO_STDERR"><b class="Sy">MTL_SHADER_VALIDATION_REPORT_TO_STDERR</b></a></dt>
  <dd>
    <br/>
    Defaults to &quot;0&quot;
    <br/>
    Setting this value to any value other than &quot;0&quot; will redirect
      shader validation error messages to stderr. This is useful if there is any
      issue with the OS logging mechanism.</dd>
</dl>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">05/03/20</td>
    <td class="foot-os">Darwin</td>
  </tr>
</table>
</body>
</html>
