<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>LWP::ConnCache(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">LWP::ConnCache(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">LWP::ConnCache(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
LWP::ConnCache - Connection cache manager
</section>
<section class="Sh">
<h1 class="Sh" id="NOTE"><a class="permalink" href="#NOTE">NOTE</a></h1>
This module is experimental. Details of its interface is likely to change in the
  future.
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
 use LWP::ConnCache;
 my $cache = LWP::ConnCache-&gt;new;
 $cache-&gt;deposit($type, $key, $sock);
 $sock = $cache-&gt;withdraw($type, $key);
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The <span class="Li">&quot;LWP::ConnCache&quot;</span> class is the standard
  connection cache manager for LWP::UserAgent.
<p class="Pp">The following basic methods are provided:</p>
<dl class="Bl-tag">
  <dt>$cache = LWP::ConnCache-&gt;new( %options )</dt>
  <dd>This method constructs a new
      <span class="Li">&quot;LWP::ConnCache&quot;</span> object. The only option
      currently accepted is 'total_capacity'. If specified it initialize the
      total_capacity option. It defaults to the value 1.</dd>
  <dt>$cache-&gt;total_capacity( [$num_connections] )</dt>
  <dd>Get/sets the number of connection that will be cached. Connections will
      start to be dropped when this limit is reached. If set to
      <span class="Li">0</span>, then all connections are immediately dropped.
      If set to <span class="Li">&quot;undef&quot;</span>, then there is no
      limit.</dd>
  <dt>$cache-&gt;capacity($type, [$num_connections] )</dt>
  <dd>Get/set a limit for the number of connections of the specified type that
      can be cached. The <span class="Li">$type</span> will typically be a short
      string like &quot;http&quot; or &quot;ftp&quot;.</dd>
  <dt>$cache-&gt;drop( [$checker, [$reason]] )</dt>
  <dd>Drop connections by some criteria. The <span class="Li">$checker</span>
      argument is a subroutine that is called for each connection. If the
      routine returns a TRUE value then the connection is dropped. The routine
      is called with ($conn, <span class="Li">$type</span>,
      <span class="Li">$key</span>, <span class="Li">$deposit_time</span>) as
      arguments.
    <p class="Pp">Shortcuts: If the <span class="Li">$checker</span> argument is
        absent (or <span class="Li">&quot;undef&quot;</span>) all cached
        connections are dropped. If the <span class="Li">$checker</span> is a
        number then all connections untouched that the given number of seconds
        or more are dropped. If <span class="Li">$checker</span> is a string
        then all connections of the given type are dropped.</p>
    <p class="Pp">The <span class="Li">$reason</span> argument is passed on to
        the <i>dropped()</i> method.</p>
  </dd>
  <dt>$cache-&gt;prune</dt>
  <dd>Calling this method will drop all connections that are dead. This is
      tested by calling the <i>ping()</i> method on the connections. If the
      <i>ping()</i> method exists and returns a FALSE value, then the connection
      is dropped.</dd>
  <dt>$cache-&gt;get_types</dt>
  <dd>This returns all the 'type' fields used for the currently cached
      connections.</dd>
  <dt>$cache-&gt;get_connections( [$type] )</dt>
  <dd>This returns all connection objects of the specified type. If no type is
      specified then all connections are returned. In scalar context the number
      of cached connections of the specified type is returned.</dd>
</dl>
<p class="Pp">The following methods are called by low-level protocol modules to
    try to save away connections and to get them back.</p>
<dl class="Bl-tag">
  <dt>$cache-&gt;deposit($type, $key, $conn)</dt>
  <dd>This method adds a new connection to the cache. As a result other already
      cached connections might be dropped. Multiple connections with the same
      <span class="Li">$type</span>/$key might added.</dd>
  <dt>$conn = $cache-&gt;withdraw($type, $key)</dt>
  <dd>This method tries to fetch back a connection that was previously
      deposited. If no cached connection with the specified
      <span class="Li">$type</span>/$key is found, then
      <span class="Li">&quot;undef&quot;</span> is returned. There is not
      guarantee that a deposited connection can be withdrawn, as the cache
      manger is free to drop connections at any time.</dd>
</dl>
<p class="Pp">The following methods are called internally. Subclasses might want
    to override them.</p>
<dl class="Bl-tag">
  <dt>$conn-&gt;enforce_limits([$type])</dt>
  <dd>This method is called with after a new connection is added (deposited) in
      the cache or capacity limits are adjusted. The default implementation
      drops connections until the specified capacity limits are not
    exceeded.</dd>
  <dt>$conn-&gt;dropping($conn_record, $reason)</dt>
  <dd>This method is called when a connection is dropped. The record belonging
      to the dropped connection is passed as the first argument and a string
      describing the reason for the drop is passed as the second argument. The
      default implementation makes some noise if the
      <span class="Li">$LWP::ConnCache::DEBUG</span> variable is set and nothing
      more.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SUBCLASSING"><a class="permalink" href="#SUBCLASSING">SUBCLASSING</a></h1>
For specialized cache policy it makes sense to subclass
  <span class="Li">&quot;LWP::ConnCache&quot;</span> and perhaps override the
  <i>deposit()</i>, <i>enforce_limits()</i> and <i>dropping()</i> methods.
<p class="Pp">The object itself is a hash. Keys prefixed with
    <span class="Li">&quot;cc_&quot;</span> are reserved for the base class.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
LWP::UserAgent
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright 2001 Gisle Aas.
<p class="Pp">This library is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2012-01-13</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
