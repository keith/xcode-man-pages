<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 1987, 1988, 1989, 1990, 1991, 1992, 1994, 1995, 1996, 1997
  	The Regents of the University of California.  All rights reserved.
   All rights reserved.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that: (1) source code distributions
   retain the above copyright notice and this paragraph in its entirety, (2)
   distributions including binary code include the above copyright notice and
   this paragraph in its entirety in the documentation or other materials
   provided with the distribution, and (3) all advertising materials mentioning
   features or use of this software display the following acknowledgement:
   ``This product includes software developed by the University of California,
   Lawrence Berkeley Laboratory and its contributors.'' Neither the name of
   the University nor the names of its contributors may be used to endorse
   or promote products derived from this software without specific prior
   written permission.
   THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED
   WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
   MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
   -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>PCAP-FILTER(7)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PCAP-FILTER(7)</td>
    <td class="head-vol">Miscellaneous Information Manual</td>
    <td class="head-rtitle">PCAP-FILTER(7)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">pcap-filter - packet filter syntax</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><b>pcap_compile</b>() is used to compile a string into a filter
    program. The resulting filter program can then be applied to some stream of
    packets to determine which packets will be supplied to
    <b>pcap_loop</b>(3PCAP), <b>pcap_dispatch</b>(3PCAP),
    <b>pcap_next</b>(3PCAP), or <b>pcap_next_ex</b>(3PCAP).</p>
<p class="Pp">The <i>filter expression</i> consists of one or more
    <i>primitives</i>. Primitives usually consist of an <i>id</i> (name or
    number) preceded by one or more qualifiers. There are three different kinds
    of qualifier:</p>
<dl class="Bl-tag">
  <dt id="type"><a class="permalink" href="#type"><i>type</i></a></dt>
  <dd><i>type</i> qualifiers say what kind of thing the id name or number refers
      to. Possible types are <b>host</b>, <b>net</b>, <b>port</b> and
      <b>portrange</b>. E.g., `<b>host</b> foo', `<b>net</b> 128.3',
      `<b>port</b> 20', `<b>portrange</b> 6000-6008'. If there is no type
      qualifier, <b>host</b> is assumed.</dd>
  <dt id="dir"><a class="permalink" href="#dir"><i>dir</i></a></dt>
  <dd><i>dir</i> qualifiers specify a particular transfer direction to and/or
      from <i>id</i>. Possible directions are <b>src</b>, <b>dst</b>, <b>src or
      dst</b>, <b>src and dst</b>, <b>ra</b>, <b>ta</b>, <b>addr1</b>,
      <b>addr2</b>, <b>addr3</b>, and <b>addr4</b>. E.g., `<b>src</b> foo',
      `<b>dst net</b> 128.3', `<b>src or dst port</b> ftp-data'. If there is no
      dir qualifier, `<b>src or dst</b>' is assumed. The <b>ra</b>, <b>ta</b>,
      <b>addr1</b>, <b>addr2</b>, <b>addr3</b>, and <b>addr4</b> qualifiers are
      only valid for IEEE 802.11 Wireless LAN link layers.</dd>
  <dt id="proto"><a class="permalink" href="#proto"><i>proto</i></a></dt>
  <dd><i>proto</i> qualifiers restrict the match to a particular protocol.
      Possible protos are: <b>ether</b>, <b>fddi</b>, <b>tr</b>, <b>wlan</b>,
      <b>ip</b>, <b>ip6</b>, <b>arp</b>, <b>rarp</b>, <b>decnet</b>, <b>tcp</b>
      and <b>udp</b>. E.g., `<b>ether src</b> foo', `<b>arp net</b> 128.3',
      `<b>tcp port</b> 21', `<b>udp portrange</b> 7000-7009', `<b>wlan addr2</b>
      0:2:3:4:5:6'. If there is no proto qualifier, all protocols consistent
      with the type are assumed. E.g., `<b>src</b> foo' means `<b>(ip or arp or
      rarp) src</b> foo' (except the latter is not legal syntax), `<b>net</b>
      bar' means `<b>(ip or</b> <b>arp or rarp) net</b> bar' and `<b>port</b>
      53' means `<b>(tcp or udp)</b> <b>port</b> 53'.</dd>
</dl>
<p class="Pp">[<b>fddi</b> is actually an alias for <b>ether</b>; the parser
    treats them identically as meaning ``the data link level used on the
    specified network interface''. FDDI headers contain Ethernet-like source and
    destination addresses, and often contain Ethernet-like packet types, so you
    can filter on these FDDI fields just as with the analogous Ethernet fields.
    FDDI headers also contain other fields, but you cannot name them explicitly
    in a filter expression.</p>
<p class="Pp">Similarly, <b>tr</b> and <b>wlan</b> are aliases for <b>ether</b>;
    the previous paragraph's statements about FDDI headers also apply to Token
    Ring and 802.11 wireless LAN headers. For 802.11 headers, the destination
    address is the DA field and the source address is the SA field; the BSSID,
    RA, and TA fields aren't tested.]</p>
<p class="Pp">In addition to the above, there are some special `primitive'
    keywords that don't follow the pattern: <b>gateway</b>, <b>broadcast</b>,
    <b>less</b>, <b>greater</b> and arithmetic expressions. All of these are
    described below.</p>
<p class="Pp">More complex filter expressions are built up by using the words
    <b>and</b>, <b>or</b> and <b>not</b> (or equivalently: `<b>&amp;&amp;</b>',
    `<b>||</b>' and `<b>!</b>' respectively) to combine primitives. E.g.,
    `<b>host</b> foo <b>and not port</b> ftp <b>and not port</b> ftp-data'. To
    save typing, identical qualifier lists can be omitted. E.g., `<b>tcp dst
    port</b> ftp <b>or</b> ftp-data <b>or</b> domain' is exactly the same as
    `<b>tcp dst port</b> ftp <b>or tcp dst port</b> ftp-data <b>or tcp dst
    port</b> domain'.</p>
<p class="Pp">Allowable primitives are:</p>
<dl class="Bl-tag">
  <dt id="dst"><a class="permalink" href="#dst"><b>dst host
    </b><i>host</i></a></dt>
  <dd>True if the IPv4/v6 destination field of the packet is <i>host</i>, which
      may be either an address or a name.</dd>
  <dt id="src"><a class="permalink" href="#src"><b>src host
    </b><i>host</i></a></dt>
  <dd>True if the IPv4/v6 source field of the packet is <i>host</i>.</dd>
  <dt id="host"><a class="permalink" href="#host"><b>host
    </b><i>host</i><b></b></a></dt>
  <dd>True if either the IPv4/v6 source or destination of the packet is
      <i>host</i>.</dd>
  <dt></dt>
  <dd>Any of the above host expressions can be prepended with the keywords,
      <b>ip</b>, <b>arp</b>, <b>rarp</b>, or <b>ip6</b> as in:
    <br/>
    <pre><b>ip host </b><i>host</i></pre>
    <br/>
    which is equivalent to:
    <br/>
    <pre><b>ether proto \ip and host </b><i>host</i></pre>
    <br/>
    If <i>host</i> is a name with multiple IPv4 addresses, each address will be
      checked for a match.</dd>
  <dt id="ether"><a class="permalink" href="#ether"><b>ether dst
    </b><i>ehost</i><b></b></a></dt>
  <dd>True if the Ethernet destination address is <i>ehost</i>. <i>Ehost</i> may
      be either a name from /etc/ethers or a numerical MAC address of the form
      &quot;xx:xx:xx:xx:xx:xx&quot;, &quot;xx.xx.xx.xx.xx.xx&quot;,
      &quot;xx-xx-xx-xx-xx-xx&quot;, &quot;xxxx.xxxx.xxxx&quot;,
      &quot;xxxxxxxxxxxx&quot;, or various mixes of ':', '.', and '-', where
      each &quot;x&quot; is a hex digit (0-9, a-f, or A-F).</dd>
  <dt id="ether~2"><a class="permalink" href="#ether~2"><b>ether src
    </b><i>ehost</i><b></b></a></dt>
  <dd>True if the Ethernet source address is <i>ehost</i>.</dd>
  <dt id="ether~3"><a class="permalink" href="#ether~3"><b>ether host
    </b><i>ehost</i><b></b></a></dt>
  <dd>True if either the Ethernet source or destination address is
    <i>ehost</i>.</dd>
  <dt id="gateway"><a class="permalink" href="#gateway"><b>gateway</b>
    <i>host</i></a></dt>
  <dd>True if the packet used <i>host</i> as a gateway. I.e., the Ethernet
      source or destination address was <i>host</i> but neither the IP source
      nor the IP destination was <i>host</i>. <i>Host</i> must be a name and
      must be found both by the machine's host-name-to-IP-address resolution
      mechanisms (host name file, DNS, NIS, etc.) and by the machine's
      host-name-to-Ethernet-address resolution mechanism (/etc/ethers, etc.).
      (An equivalent expression is
    <br/>
    <pre><b>ether host </b><i>ehost </i><b>and not host </b><i>host</i></pre>
    <br/>
    which can be used with either names or numbers for <i>host / ehost</i>.)
      This syntax does not work in IPv6-enabled configuration at this
    moment.</dd>
  <dt id="dst~2"><a class="permalink" href="#dst~2"><b>dst net
    </b><i>net</i></a></dt>
  <dd>True if the IPv4/v6 destination address of the packet has a network number
      of <i>net</i>. <i>Net</i> may be either a name from the networks database
      (/etc/networks, etc.) or a network number. An IPv4 network number can be
      written as a dotted quad (e.g., 192.168.1.0), dotted triple (e.g.,
      192.168.1), dotted pair (e.g, 172.16), or single number (e.g., 10); the
      netmask is 255.255.255.255 for a dotted quad (which means that it's really
      a host match), 255.255.255.0 for a dotted triple, 255.255.0.0 for a dotted
      pair, or 255.0.0.0 for a single number. An IPv6 network number must be
      written out fully; the netmask is ff:ff:ff:ff:ff:ff:ff:ff, so IPv6
      &quot;network&quot; matches are really always host matches, and a network
      match requires a netmask length.</dd>
  <dt id="src~2"><a class="permalink" href="#src~2"><b>src net
    </b><i>net</i></a></dt>
  <dd>True if the IPv4/v6 source address of the packet has a network number of
      <i>net</i>.</dd>
  <dt id="net"><a class="permalink" href="#net"><b>net </b><i>net</i></a></dt>
  <dd>True if either the IPv4/v6 source or destination address of the packet has
      a network number of <i>net</i>.</dd>
  <dt id="net~2"><a class="permalink" href="#net~2"><b>net </b><i>net</i>
    <b>mask </b><i>netmask</i></a></dt>
  <dd>True if the IPv4 address matches <i>net</i> with the specific
      <i>netmask</i>. May be qualified with <b>src</b> or <b>dst</b>. Note that
      this syntax is not valid for IPv6 <i>net</i>.</dd>
  <dt id="net~3"><a class="permalink" href="#net~3"><b>net
    </b><i>net</i>/<i>len</i></a></dt>
  <dd>True if the IPv4/v6 address matches <i>net</i> with a netmask <i>len</i>
      bits wide. May be qualified with <b>src</b> or <b>dst</b>.</dd>
  <dt id="dst~3"><a class="permalink" href="#dst~3"><b>dst port
    </b><i>port</i></a></dt>
  <dd>True if the packet is IPv4 TCP, IPv4 UDP, IPv6 TCP or IPv6 UDP and has a
      destination port value of <i>port</i>. The <i>port</i> can be a number or
      a name used in /etc/services (see <b>tcp</b>(4P) and <b>udp</b>(4P)). If a
      name is used, both the port number and protocol are checked. If a number
      or ambiguous name is used, only the port number is checked (e.g., `<b>dst
      port</b> 513' will print both tcp/login traffic and udp/who traffic, and
      `<b>port domain</b>' will print both tcp/domain and udp/domain
    traffic).</dd>
  <dt id="src~3"><a class="permalink" href="#src~3"><b>src port
    </b><i>port</i></a></dt>
  <dd>True if the packet has a source port value of <i>port</i>.</dd>
  <dt id="port"><a class="permalink" href="#port"><b>port
    </b><i>port</i></a></dt>
  <dd>True if either the source or destination port of the packet is
      <i>port</i>.</dd>
  <dt id="dst~4"><a class="permalink" href="#dst~4"><b>dst portrange
    </b><i>port1-port2</i></a></dt>
  <dd>True if the packet is IPv4 TCP, IPv4 UDP, IPv6 TCP or IPv6 UDP and has a
      destination port value between <i>port1</i> and <i>port2</i> (both
      inclusive). <i>port1</i> and <i>port2</i> are interpreted in the same
      fashion as the <i>port</i> parameter for <b>port</b>.</dd>
  <dt id="src~4"><a class="permalink" href="#src~4"><b>src portrange
    </b><i>port1-port2</i></a></dt>
  <dd>True if the packet has a source port value between <i>port1</i> and
      <i>port2</i> (both inclusive).</dd>
  <dt id="portrange"><a class="permalink" href="#portrange"><b>portrange
    </b><i>port1-port2</i></a></dt>
  <dd>True if either the source or destination port of the packet is between
      <i>port1</i> and <i>port2</i> (both inclusive).</dd>
  <dt></dt>
  <dd>Any of the above port or port range expressions can be prepended with the
      keywords, <b>tcp</b> or <b>udp</b>, as in:
    <br/>
    <pre><b>tcp src port </b><i>port</i></pre>
    <br/>
    which matches only TCP packets whose source port is <i>port</i>.</dd>
  <dt id="less"><a class="permalink" href="#less"><b>less
    </b><i>length</i></a></dt>
  <dd>True if the packet has a length less than or equal to <i>length</i>. This
      is equivalent to:
    <br/>
    <pre><b>len &lt;= </b><i>length</i><b></b></pre>
    <br/>
  </dd>
  <dt id="greater"><a class="permalink" href="#greater"><b>greater
    </b><i>length</i></a></dt>
  <dd>True if the packet has a length greater than or equal to <i>length</i>.
      This is equivalent to:
    <br/>
    <pre><b>len &gt;= </b><i>length</i><b></b></pre>
    <br/>
  </dd>
  <dt id="ip"><a class="permalink" href="#ip"><b>ip proto
    </b><i>protocol</i></a></dt>
  <dd>True if the packet is an IPv4 packet (see <b>ip</b>(4P)) of protocol type
      <i>protocol</i>. <i>Protocol</i> can be a number or one of the names
      <b>icmp</b>, <b>icmp6</b>, <b>igmp</b>, <b>igrp</b>, <b>pim</b>,
      <b>ah</b>, <b>esp</b>, <b>vrrp</b>, <b>udp</b>, or <b>tcp</b>. Note that
      the identifiers <b>tcp</b>, <b>udp</b>, and <b>icmp</b> are also keywords
      and must be escaped via backslash (\). Note that this primitive does not
      chase the protocol header chain.</dd>
  <dt id="ip6"><a class="permalink" href="#ip6"><b>ip6 proto
    </b><i>protocol</i></a></dt>
  <dd>True if the packet is an IPv6 packet of protocol type <i>protocol</i>.
      Note that this primitive does not chase the protocol header chain.</dd>
  <dt id="proto~2"><a class="permalink" href="#proto~2"><b>proto
    </b><i>protocol</i></a></dt>
  <dd>True if the packet is an IPv4 or IPv6 packet of protocol type
      <i>protocol</i>. Note that this primitive does not chase the protocol
      header chain.</dd>
  <dt id="tcp"><a class="permalink" href="#tcp"><b>tcp</b>, <b>udp</b>,
    <b>icmp</b></a></dt>
  <dd>Abbreviations for:
    <br/>
    <pre><b>proto \</b><i>protocol</i><b></b></pre>
    <br/>
    where <i>protocol</i> is one of the above protocols.</dd>
  <dt id="ip6~2"><a class="permalink" href="#ip6~2"><b>ip6 protochain
    </b><i>protocol</i></a></dt>
  <dd>True if the packet is IPv6 packet, and contains protocol header with type
      <i>protocol</i> in its protocol header chain. For example,
    <br/>
    <pre><b>ip6 protochain</b> 6</pre>
    <br/>
    matches any IPv6 packet with TCP protocol header in the protocol header
      chain. The packet may contain, for example, authentication header, routing
      header, or hop-by-hop option header, between IPv6 header and TCP header.
      The BPF code emitted by this primitive is complex and cannot be optimized
      by the BPF optimizer code, and is not supported by filter engines in the
      kernel, so this can be somewhat slow, and may cause more packets to be
      dropped.</dd>
  <dt id="ip~2"><a class="permalink" href="#ip~2"><b>ip protochain
    </b><i>protocol</i></a></dt>
  <dd>Equivalent to <b>ip6 protochain </b><i>protocol</i>, but this is for
    IPv4.</dd>
  <dt id="protochain"><a class="permalink" href="#protochain"><b>protochain
    </b><i>protocol</i></a></dt>
  <dd>True if the packet is an IPv4 or IPv6 packet of protocol type
      <i>protocol</i>. Note that this primitive chases the protocol header
      chain.</dd>
  <dt id="ether~4"><a class="permalink" href="#ether~4"><b>ether
    broadcast</b></a></dt>
  <dd>True if the packet is an Ethernet broadcast packet. The <b>ether</b>
      keyword is optional.</dd>
  <dt id="ip~3"><a class="permalink" href="#ip~3"><b>ip broadcast</b></a></dt>
  <dd>True if the packet is an IPv4 broadcast packet. It checks for both the
      all-zeroes and all-ones broadcast conventions, and looks up the subnet
      mask on the interface on which the capture is being done.</dd>
  <dt></dt>
  <dd>If the subnet mask of the interface on which the capture is being done is
      not available, either because the interface on which capture is being done
      has no netmask or because the capture is being done on the Linux
      &quot;any&quot; interface, which can capture on more than one interface,
      this check will not work correctly.</dd>
  <dt id="ether~5"><a class="permalink" href="#ether~5"><b>ether
    multicast</b></a></dt>
  <dd>True if the packet is an Ethernet multicast packet. The <b>ether</b>
      keyword is optional. This is shorthand for `<b>ether[</b>0<b>] &amp;
      </b>1<b> != </b>0'.</dd>
  <dt id="ip~4"><a class="permalink" href="#ip~4"><b>ip multicast</b></a></dt>
  <dd>True if the packet is an IPv4 multicast packet.</dd>
  <dt id="ip6~3"><a class="permalink" href="#ip6~3"><b>ip6
    multicast</b></a></dt>
  <dd>True if the packet is an IPv6 multicast packet.</dd>
  <dt id="ether~6"><a class="permalink" href="#ether~6"><b>ether proto
    </b><i>protocol</i></a></dt>
  <dd>True if the packet is of ether type <i>protocol</i>. <i>Protocol</i> can
      be a number or one of the names <b>aarp</b>, <b>arp</b>, <b>atalk</b>,
      <b>decnet</b>, <b>ip</b>, <b>ip6</b>, <b>ipx</b>, <b>iso</b>, <b>lat</b>,
      <b>loopback</b>, <b>mopdl</b>, <b>moprc</b>, <b>netbeui</b>, <b>rarp</b>,
      <b>sca</b> or <b>stp</b>. Note these identifiers (except <b>loopback</b>)
      are also keywords and must be escaped via backslash (\).</dd>
  <dt></dt>
  <dd>[In the case of FDDI (e.g., `<b>fddi proto \arp</b>'), Token Ring (e.g.,
      `<b>tr proto \arp</b>'), and IEEE 802.11 wireless LANs (e.g., `<b>wlan
      proto \arp</b>'), for most of those protocols, the protocol identification
      comes from the 802.2 Logical Link Control (LLC) header, which is usually
      layered on top of the FDDI, Token Ring, or 802.11 header.</dd>
  <dt></dt>
  <dd>When filtering for most protocol identifiers on FDDI, Token Ring, or
      802.11, the filter checks only the protocol ID field of an LLC header in
      so-called SNAP format with an Organizational Unit Identifier (OUI) of
      0x000000, for encapsulated Ethernet; it doesn't check whether the packet
      is in SNAP format with an OUI of 0x000000. The exceptions are:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="iso"><a class="permalink" href="#iso"><b>iso</b></a></dt>
  <dd>the filter checks the DSAP (Destination Service Access Point) and SSAP
      (Source Service Access Point) fields of the LLC header;</dd>
  <dt id="stp"><a class="permalink" href="#stp"><b>stp</b> and
    <b>netbeui</b></a></dt>
  <dd>the filter checks the DSAP of the LLC header;</dd>
  <dt id="atalk"><a class="permalink" href="#atalk"><b>atalk</b></a></dt>
  <dd>the filter checks for a SNAP-format packet with an OUI of 0x080007 and the
      AppleTalk etype.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt></dt>
  <dd>In the case of Ethernet, the filter checks the Ethernet type field for
      most of those protocols. The exceptions are:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="iso~2"><a class="permalink" href="#iso~2"><b>iso</b>, <b>stp</b>, and
    <b>netbeui</b></a></dt>
  <dd>the filter checks for an 802.3 frame and then checks the LLC header as it
      does for FDDI, Token Ring, and 802.11;</dd>
  <dt id="atalk~2"><a class="permalink" href="#atalk~2"><b>atalk</b></a></dt>
  <dd>the filter checks both for the AppleTalk etype in an Ethernet frame and
      for a SNAP-format packet as it does for FDDI, Token Ring, and 802.11;</dd>
  <dt id="aarp"><a class="permalink" href="#aarp"><b>aarp</b></a></dt>
  <dd>the filter checks for the AppleTalk ARP etype in either an Ethernet frame
      or an 802.2 SNAP frame with an OUI of 0x000000;</dd>
  <dt id="ipx"><a class="permalink" href="#ipx"><b>ipx</b></a></dt>
  <dd>the filter checks for the IPX etype in an Ethernet frame, the IPX DSAP in
      the LLC header, the 802.3-with-no-LLC-header encapsulation of IPX, and the
      IPX etype in a SNAP frame.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="ip~5"><a class="permalink" href="#ip~5"><b>ip</b>, <b>ip6</b>,
    <b>arp</b>, <b>rarp</b>, <b>atalk</b>, <b>aarp</b>, <b>decnet</b>,
    <b>iso</b>, <b>stp</b>, <b>ipx</b>, <b>netbeui</b></a></dt>
  <dd>Abbreviations for:
    <br/>
    <pre><b>ether proto \</b><i>protocol</i></pre>
    <br/>
    where <i>protocol</i> is one of the above protocols.</dd>
  <dt id="lat"><a class="permalink" href="#lat"><b>lat</b>, <b>moprc</b>,
    <b>mopdl</b></a></dt>
  <dd>Abbreviations for:
    <br/>
    <pre><b>ether proto \</b><i>protocol</i></pre>
    <br/>
    where <i>protocol</i> is one of the above protocols. Note that not all
      applications using <b>pcap</b>(3PCAP) currently know how to parse these
      protocols.</dd>
  <dt id="decnet"><a class="permalink" href="#decnet"><b>decnet src
    </b><i>host</i></a></dt>
  <dd>True if the DECnet source address is <i>host</i>, which may be an address
      of the form ``10.123'', or a DECnet host name. [DECnet host name support
      is only available on ULTRIX systems that are configured to run
    DECnet.]</dd>
  <dt id="decnet~2"><a class="permalink" href="#decnet~2"><b>decnet dst
    </b><i>host</i></a></dt>
  <dd>True if the DECnet destination address is <i>host</i>.</dd>
  <dt id="decnet~3"><a class="permalink" href="#decnet~3"><b>decnet host
    </b><i>host</i></a></dt>
  <dd>True if either the DECnet source or destination address is
    <i>host</i>.</dd>
  <dt id="llc"><a class="permalink" href="#llc"><b>llc</b></a></dt>
  <dd>True if the packet has an 802.2 LLC header. This includes:</dd>
  <dt></dt>
  <dd>Ethernet packets with a length field rather than a type field that aren't
      raw NetWare-over-802.3 packets;</dd>
  <dt></dt>
  <dd>IEEE 802.11 data packets;</dd>
  <dt></dt>
  <dd>Token Ring packets (no check is done for LLC frames);</dd>
  <dt></dt>
  <dd>FDDI packets (no check is done for LLC frames);</dd>
  <dt></dt>
  <dd>LLC-encapsulated ATM packets, for SunATM on Solaris.</dd>
  <dt id="llc~2"><a class="permalink" href="#llc~2"><b>llc</b>
    <i>type</i></a></dt>
  <dd>True if the packet has an 802.2 LLC header and has the specified
      <i>type</i>. <i>type</i> can be one of:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="i"><a class="permalink" href="#i"><b>i</b></a></dt>
  <dd>Information (I) PDUs</dd>
  <dt id="s"><a class="permalink" href="#s"><b>s</b></a></dt>
  <dd>Supervisory (S) PDUs</dd>
  <dt id="u"><a class="permalink" href="#u"><b>u</b></a></dt>
  <dd>Unnumbered (U) PDUs</dd>
  <dt id="rr"><a class="permalink" href="#rr"><b>rr</b></a></dt>
  <dd>Receiver Ready (RR) S PDUs</dd>
  <dt id="rnr"><a class="permalink" href="#rnr"><b>rnr</b></a></dt>
  <dd>Receiver Not Ready (RNR) S PDUs</dd>
  <dt id="rej"><a class="permalink" href="#rej"><b>rej</b></a></dt>
  <dd>Reject (REJ) S PDUs</dd>
  <dt id="ui"><a class="permalink" href="#ui"><b>ui</b></a></dt>
  <dd>Unnumbered Information (UI) U PDUs</dd>
  <dt id="ua"><a class="permalink" href="#ua"><b>ua</b></a></dt>
  <dd>Unnumbered Acknowledgment (UA) U PDUs</dd>
  <dt id="disc"><a class="permalink" href="#disc"><b>disc</b></a></dt>
  <dd>Disconnect (DISC) U PDUs</dd>
  <dt id="sabme"><a class="permalink" href="#sabme"><b>sabme</b></a></dt>
  <dd>Set Asynchronous Balanced Mode Extended (SABME) U PDUs</dd>
  <dt id="test"><a class="permalink" href="#test"><b>test</b></a></dt>
  <dd>Test (TEST) U PDUs</dd>
  <dt id="xid"><a class="permalink" href="#xid"><b>xid</b></a></dt>
  <dd>Exchange Identification (XID) U PDUs</dd>
  <dt id="frmr"><a class="permalink" href="#frmr"><b>frmr</b></a></dt>
  <dd>Frame Reject (FRMR) U PDUs</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="inbound"><a class="permalink" href="#inbound"><b>inbound</b></a></dt>
  <dd>Packet was received by the host performing the capture rather than being
      sent by that host. This is only supported for certain link-layer types,
      such as SLIP and the ``cooked'' Linux capture mode used for the ``any''
      device and for some other device types.</dd>
  <dt id="outbound"><a class="permalink" href="#outbound"><b>outbound</b></a></dt>
  <dd>Packet was sent by the host performing the capture rather than being
      received by that host. This is only supported for certain link-layer
      types, such as SLIP and the ``cooked'' Linux capture mode used for the
      ``any'' device and for some other device types.</dd>
  <dt id="ifname"><a class="permalink" href="#ifname"><b>ifname
    </b><i>interface</i></a></dt>
  <dd>True if the packet was logged as coming from the specified interface
      (applies only to packets logged by OpenBSD's or FreeBSD's
    <b>pf</b>(4)).</dd>
  <dt id="on"><a class="permalink" href="#on"><b>on
    </b><i>interface</i></a></dt>
  <dd>Synonymous with the <b>ifname</b> modifier.</dd>
  <dt id="rnr~2"><a class="permalink" href="#rnr~2"><b>rnr
    </b><i>num</i></a></dt>
  <dd>True if the packet was logged as matching the specified PF rule number
      (applies only to packets logged by OpenBSD's or FreeBSD's
    <b>pf</b>(4)).</dd>
  <dt id="rulenum"><a class="permalink" href="#rulenum"><b>rulenum
    </b><i>num</i></a></dt>
  <dd>Synonymous with the <b>rnr</b> modifier.</dd>
  <dt id="reason"><a class="permalink" href="#reason"><b>reason
    </b><i>code</i></a></dt>
  <dd>True if the packet was logged with the specified PF reason code. The known
      codes are: <b>match</b>, <b>bad-offset</b>, <b>fragment</b>, <b>short</b>,
      <b>normalize</b>, and <b>memory</b> (applies only to packets logged by
      OpenBSD's or FreeBSD's <b>pf</b>(4)).</dd>
  <dt id="rset"><a class="permalink" href="#rset"><b>rset
    </b><i>name</i></a></dt>
  <dd>True if the packet was logged as matching the specified PF ruleset name of
      an anchored ruleset (applies only to packets logged by OpenBSD's or
      FreeBSD's <b>pf</b>(4)).</dd>
  <dt id="ruleset"><a class="permalink" href="#ruleset"><b>ruleset
    </b><i>name</i></a></dt>
  <dd>Synonymous with the <b>rset</b> modifier.</dd>
  <dt id="srnr"><a class="permalink" href="#srnr"><b>srnr
    </b><i>num</i></a></dt>
  <dd>True if the packet was logged as matching the specified PF rule number of
      an anchored ruleset (applies only to packets logged by OpenBSD's or
      FreeBSD's <b>pf</b>(4)).</dd>
  <dt id="subrulenum"><a class="permalink" href="#subrulenum"><b>subrulenum
    </b><i>num</i></a></dt>
  <dd>Synonymous with the <b>srnr</b> modifier.</dd>
  <dt id="action"><a class="permalink" href="#action"><b>action
    </b><i>act</i></a></dt>
  <dd>True if PF took the specified action when the packet was logged. Known
      actions are: <b>pass</b> and <b>block</b> and, with later versions of
      <b>pf</b>(4), <b>nat</b>, <b>rdr</b>, <b>binat</b> and <b>scrub</b>
      (applies only to packets logged by OpenBSD's or FreeBSD's
    <b>pf</b>(4)).</dd>
  <dt id="wlan"><a class="permalink" href="#wlan"><b>wlan ra
    </b><i>ehost</i></a></dt>
  <dd>True if the IEEE 802.11 RA is <i>ehost</i>. The RA field is used in all
      frames except for management frames.</dd>
  <dt id="wlan~2"><a class="permalink" href="#wlan~2"><b>wlan ta
    </b><i>ehost</i></a></dt>
  <dd>True if the IEEE 802.11 TA is <i>ehost</i>. The TA field is used in all
      frames except for management frames and CTS (Clear To Send) and ACK
      (Acknowledgment) control frames.</dd>
  <dt id="wlan~3"><a class="permalink" href="#wlan~3"><b>wlan addr1
    </b><i>ehost</i></a></dt>
  <dd>True if the first IEEE 802.11 address is <i>ehost</i>.</dd>
  <dt id="wlan~4"><a class="permalink" href="#wlan~4"><b>wlan addr2
    </b><i>ehost</i></a></dt>
  <dd>True if the second IEEE 802.11 address, if present, is <i>ehost</i>. The
      second address field is used in all frames except for CTS (Clear To Send)
      and ACK (Acknowledgment) control frames.</dd>
  <dt id="wlan~5"><a class="permalink" href="#wlan~5"><b>wlan addr3
    </b><i>ehost</i></a></dt>
  <dd>True if the third IEEE 802.11 address, if present, is <i>ehost</i>. The
      third address field is used in management and data frames, but not in
      control frames.</dd>
  <dt id="wlan~6"><a class="permalink" href="#wlan~6"><b>wlan addr4
    </b><i>ehost</i></a></dt>
  <dd>True if the fourth IEEE 802.11 address, if present, is <i>ehost</i>. The
      fourth address field is only used for WDS (Wireless Distribution System)
      frames.</dd>
  <dt id="type~2"><a class="permalink" href="#type~2"><b>type
    </b><i>wlan_type</i></a></dt>
  <dd>True if the IEEE 802.11 frame type matches the specified <i>wlan_type</i>.
      Valid <i>wlan_type</i>s are: <b>mgt</b>, <b>ctl</b> and <b>data</b>.</dd>
  <dt id="type~3"><a class="permalink" href="#type~3"><b>type </b><i>wlan_type
    </i><b>subtype </b><i>wlan_subtype</i></a></dt>
  <dd>True if the IEEE 802.11 frame type matches the specified <i>wlan_type</i>
      and frame subtype matches the specified <i>wlan_subtype</i>.</dd>
  <dt></dt>
  <dd>If the specified <i>wlan_type</i> is <b>mgt</b>, then valid
      <i>wlan_subtype</i>s are: <b>assoc-req</b>, <b>assoc-resp</b>,
      <b>reassoc-req</b>, <b>reassoc-resp</b>, <b>probe-req</b>,
      <b>probe-resp</b>, <b>beacon</b>, <b>atim</b>, <b>disassoc</b>,
      <b>auth</b> and <b>deauth</b>.</dd>
  <dt></dt>
  <dd>If the specified <i>wlan_type</i> is <b>ctl</b>, then valid
      <i>wlan_subtype</i>s are: <b>ps-poll</b>, <b>rts</b>, <b>cts</b>,
      <b>ack</b>, <b>cf-end</b> and <b>cf-end-ack</b>.</dd>
  <dt></dt>
  <dd>If the specified <i>wlan_type</i> is <b>data</b>, then valid
      <i>wlan_subtype</i>s are: <b>data</b>, <b>data-cf-ack</b>,
      <b>data-cf-poll</b>, <b>data-cf-ack-poll</b>, <b>null</b>, <b>cf-ack</b>,
      <b>cf-poll</b>, <b>cf-ack-poll</b>, <b>qos-data</b>,
      <b>qos-data-cf-ack</b>, <b>qos-data-cf-poll</b>,
      <b>qos-data-cf-ack-poll</b>, <b>qos</b>, <b>qos-cf-poll</b> and
      <b>qos-cf-ack-poll</b>.</dd>
  <dt id="subtype"><a class="permalink" href="#subtype"><b>subtype
    </b><i>wlan_subtype</i></a></dt>
  <dd>True if the IEEE 802.11 frame subtype matches the specified
      <i>wlan_subtype</i> and frame has the type to which the specified
      <i>wlan_subtype</i> belongs.</dd>
  <dt id="dir~2"><a class="permalink" href="#dir~2"><b>dir
    </b><i>dir</i></a></dt>
  <dd>True if the IEEE 802.11 frame direction matches the specified <i>dir</i>.
      Valid directions are: <b>nods</b>, <b>tods</b>, <b>fromds</b>,
      <b>dstods</b>, or a numeric value.</dd>
  <dt id="vlan"><a class="permalink" href="#vlan"><b>vlan
    </b><i>[vlan_id]</i></a></dt>
  <dd>True if the packet is an IEEE 802.1Q VLAN packet. If the optional
      <i>vlan_id</i> is specified, only true if the packet has the specified
      <i>vlan_id</i>. Note that the first <b>vlan</b> keyword encountered in an
      expression changes the decoding offsets for the remainder of the
      expression on the assumption that the packet is a VLAN packet. The
      `<b>vlan</b> <b></b><i>[vlan_id]</i>` keyword may be used more than once,
      to filter on VLAN hierarchies. Each use of that keyword increments the
      filter offsets by 4.</dd>
  <dt></dt>
  <dd>For example:
    <br/>
    <pre><b>vlan</b> 100 <b>&amp;&amp; vlan</b> 200</pre>
    <br/>
    filters on VLAN 200 encapsulated within VLAN 100, and
    <br/>
    <pre><b>vlan &amp;&amp; vlan </b>300 <b>&amp;&amp; ip</b></pre>
    <br/>
    filters IPv4 protocol encapsulated in VLAN 300 encapsulated within any
      higher order VLAN.</dd>
  <dt id="mpls"><a class="permalink" href="#mpls"><b>mpls
    </b><i>[label_num]</i></a></dt>
  <dd>True if the packet is an MPLS packet. If the optional <i>label_num</i> is
      specified, only true if the packet has the specified <i>label_num</i>.
      Note that the first <b>mpls</b> keyword encountered in an expression
      changes the decoding offsets for the remainder of the expression on the
      assumption that the packet is a MPLS-encapsulated IP packet. The `<b>mpls
      </b><i>[label_num]</i>` keyword may be used more than once, to filter on
      MPLS hierarchies. Each use of that keyword increments the filter offsets
      by 4.</dd>
  <dt></dt>
  <dd>For example:
    <br/>
    <pre><b>mpls</b> 100000 <b>&amp;&amp; mpls</b> 1024</pre>
    <br/>
    filters packets with an outer label of 100000 and an inner label of 1024,
      and
    <br/>
    <pre><b>mpls &amp;&amp; mpls</b> 1024 <b>&amp;&amp; host</b> 192.9.200.1</pre>
    <br/>
    filters packets to or from 192.9.200.1 with an inner label of 1024 and any
      outer label.</dd>
  <dt id="pppoed"><a class="permalink" href="#pppoed"><b>pppoed</b></a></dt>
  <dd>True if the packet is a PPP-over-Ethernet Discovery packet (Ethernet type
      0x8863).</dd>
  <dt id="pppoes"><a class="permalink" href="#pppoes"><b>pppoes
    </b><i>[session_id]</i></a></dt>
  <dd>True if the packet is a PPP-over-Ethernet Session packet (Ethernet type
      0x8864). If the optional <i>session_id</i> is specified, only true if the
      packet has the specified <i>session_id</i>. Note that the first
      <b>pppoes</b> keyword encountered in an expression changes the decoding
      offsets for the remainder of the expression on the assumption that the
      packet is a PPPoE session packet.</dd>
  <dt></dt>
  <dd>For example:
    <br/>
    <pre><b>pppoes</b> 0x27 <b>&amp;&amp; ip</b></pre>
    <br/>
    filters IPv4 protocol encapsulated in PPPoE session id 0x27.</dd>
  <dt id="geneve"><a class="permalink" href="#geneve"><b>geneve
    </b><i>[vni]</i></a></dt>
  <dd>True if the packet is a Geneve packet (UDP port 6081). If the optional
      <i>vni</i> is specified, only true if the packet has the specified
      <i>vni</i>. Note that when the <b>geneve</b> keyword is encountered in an
      expression, it changes the decoding offsets for the remainder of the
      expression on the assumption that the packet is a Geneve packet.</dd>
  <dt></dt>
  <dd>For example:
    <br/>
    <pre><b>geneve</b> 0xb <b>&amp;&amp; ip</b></pre>
    <br/>
    filters IPv4 protocol encapsulated in Geneve with VNI 0xb. This will match
      both IPv4 directly encapsulated in Geneve as well as IPv4 contained inside
      an Ethernet frame.</dd>
  <dt id="iso~3"><a class="permalink" href="#iso~3"><b>iso proto
    </b><i>protocol</i></a></dt>
  <dd>True if the packet is an OSI packet of protocol type <i>protocol</i>.
      <i>Protocol</i> can be a number or one of the names <b>clnp</b>,
      <b>esis</b>, or <b>isis</b>.</dd>
  <dt id="clnp"><a class="permalink" href="#clnp"><b>clnp</b>, <b>esis</b>,
    <b>isis</b></a></dt>
  <dd>Abbreviations for:
    <br/>
    <pre><b>iso proto \</b><i>protocol</i></pre>
    <br/>
    where <i>protocol</i> is one of the above protocols.</dd>
  <dt id="l1"><a class="permalink" href="#l1"><b>l1</b>, <b>l2</b>, <b>iih</b>,
    <b>lsp</b>, <b>snp</b>, <b>csnp</b>, <b>psnp</b></a></dt>
  <dd>Abbreviations for IS-IS PDU types.</dd>
  <dt id="vpi"><a class="permalink" href="#vpi"><b>vpi</b> <i>n</i></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, with a virtual
      path identifier of <i>n</i>.</dd>
  <dt id="vci"><a class="permalink" href="#vci"><b>vci</b> <i>n</i></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, with a virtual
      channel identifier of <i>n</i>.</dd>
  <dt id="lane"><a class="permalink" href="#lane"><b>lane</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is an ATM
      LANE packet. Note that the first <b>lane</b> keyword encountered in an
      expression changes the tests done in the remainder of the expression on
      the assumption that the packet is either a LANE emulated Ethernet packet
      or a LANE LE Control packet. If <b>lane</b> isn't specified, the tests are
      done under the assumption that the packet is an LLC-encapsulated
    packet.</dd>
  <dt id="oamf4s"><a class="permalink" href="#oamf4s"><b>oamf4s</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is a
      segment OAM F4 flow cell (VPI=0 &amp; VCI=3).</dd>
  <dt id="oamf4e"><a class="permalink" href="#oamf4e"><b>oamf4e</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is an
      end-to-end OAM F4 flow cell (VPI=0 &amp; VCI=4).</dd>
  <dt id="oamf4"><a class="permalink" href="#oamf4"><b>oamf4</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is a
      segment or end-to-end OAM F4 flow cell (VPI=0 &amp; (VCI=3 | VCI=4)).</dd>
  <dt id="oam"><a class="permalink" href="#oam"><b>oam</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is a
      segment or end-to-end OAM F4 flow cell (VPI=0 &amp; (VCI=3 | VCI=4)).</dd>
  <dt id="metac"><a class="permalink" href="#metac"><b>metac</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is on a
      meta signaling circuit (VPI=0 &amp; VCI=1).</dd>
  <dt id="bcc"><a class="permalink" href="#bcc"><b>bcc</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is on a
      broadcast signaling circuit (VPI=0 &amp; VCI=2).</dd>
  <dt id="sc"><a class="permalink" href="#sc"><b>sc</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is on a
      signaling circuit (VPI=0 &amp; VCI=5).</dd>
  <dt id="ilmic"><a class="permalink" href="#ilmic"><b>ilmic</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is on an
      ILMI circuit (VPI=0 &amp; VCI=16).</dd>
  <dt id="connectmsg"><a class="permalink" href="#connectmsg"><b>connectmsg</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is on a
      signaling circuit and is a Q.2931 Setup, Call Proceeding, Connect, Connect
      Ack, Release, or Release Done message.</dd>
  <dt id="metaconnect"><a class="permalink" href="#metaconnect"><b>metaconnect</b></a></dt>
  <dd>True if the packet is an ATM packet, for SunATM on Solaris, and is on a
      meta signaling circuit and is a Q.2931 Setup, Call Proceeding, Connect,
      Release, or Release Done message.</dd>
  <dt id="expr"><a class="permalink" href="#expr"><i>expr relop
    expr</i></a></dt>
  <dd>True if the relation holds, where <i>relop</i> is one of &gt;, &lt;,
      &gt;=, &lt;=, =, !=, and <i>expr</i> is an arithmetic expression composed
      of integer constants (expressed in standard C syntax), the normal binary
      operators [+, -, *, /, %, &amp;, |, ^, &lt;&lt;, &gt;&gt;], a length
      operator, and special packet data accessors. Note that all comparisons are
      unsigned, so that, for example, 0x80000000 and 0xffffffff are &gt; 0.</dd>
  <dt></dt>
  <dd>The % and ^ operators are currently only supported for filtering in the
      kernel on Linux with 3.7 and later kernels; on all other systems, if those
      operators are used, filtering will be done in user mode, which will
      increase the overhead of capturing packets and may cause more packets to
      be dropped.</dd>
  <dt></dt>
  <dd>To access data inside the packet, use the following syntax:
    <br/>
    <pre><i>proto</i><b> [ </b><i>expr</i><b> : </b><i>size</i><b> ]</b></pre>
    <br/>
    <i>Proto</i> is one of <b>ether, fddi, tr, wlan, ppp, slip, link,</b> <b>ip,
      arp, rarp, tcp, udp, icmp, ip6</b> or <b>radio</b>, and indicates the
      protocol layer for the index operation. (<b>ether, fddi, wlan, tr, ppp,
      slip</b> and <b>link</b> all refer to the link layer. <b>radio</b> refers
      to the &quot;radio header&quot; added to some 802.11 captures.) Note that
      <b>tcp</b>, <b>udp</b> and other upper-layer protocol types only apply to
      IPv4, not IPv6 (this will be fixed in the future). The byte offset,
      relative to the indicated protocol layer, is given by <i>expr</i>.
      <i>Size</i> is optional and indicates the number of bytes in the field of
      interest; it can be either one, two, or four, and defaults to one. The
      length operator, indicated by the keyword <b>len</b>, gives the length of
      the packet.
    <p class="Pp">For example, `<b>ether[</b>0<b>] &amp;</b> 1 <b>!=</b> 0'
        catches all multicast traffic. The expression `<b>ip[</b>0<b>] &amp;</b>
        0xf <b>!=</b> 5' catches all IPv4 packets with options. The expression
        `<b>ip[</b>6:2<b>] &amp;</b> 0x1fff <b>=</b> 0' catches only
        unfragmented IPv4 datagrams and frag zero of fragmented IPv4 datagrams.
        This check is implicitly applied to the <b>tcp</b> and <b>udp</b> index
        operations. For instance, <b>tcp[</b>0<b>]</b> always means the first
        byte of the TCP <i>header</i>, and never means the first byte of an
        intervening fragment.</p>
    <p class="Pp">Some offsets and field values may be expressed as names rather
        than as numeric values. The following protocol header field offsets are
        available: <b>icmptype</b> (ICMP type field), <b>icmp6type</b> (ICMPv6
        type field), <b>icmpcode</b> (ICMP code field), <b>icmp6code</b> (ICMPv6
        code field) and <b>tcpflags</b> (TCP flags field).</p>
    <p class="Pp">The following ICMP type field values are available:
        <b>icmp-echoreply</b>, <b>icmp-unreach</b>, <b>icmp-sourcequench</b>,
        <b>icmp-redirect</b>, <b>icmp-echo</b>, <b>icmp-routeradvert</b>,
        <b>icmp-routersolicit</b>, <b>icmp-timxceed</b>, <b>icmp-paramprob</b>,
        <b>icmp-tstamp</b>, <b>icmp-tstampreply</b>, <b>icmp-ireq</b>,
        <b>icmp-ireqreply</b>, <b>icmp-maskreq</b>, <b>icmp-maskreply</b>.</p>
    <p class="Pp">The following ICMPv6 type fields are available:
        <b>icmp6-destinationrunreach</b>, <b>icmp6-packettoobig</b>,
        <b>icmp6-timeexceeded</b>, <b>icmp6-parameterproblem</b>,
        <b>icmp6-echo</b>, <b>icmp6-echoreply</b>,
        <b>icmp6-multicastlistenerquery</b>,
        <b>icmp6-multicastlistenerreportv1</b>,
        <b>icmp6-multicastlistenerdone</b>, <b>icmp6-routersolicit</b>,
        <b>icmp6-routeradvert</b>, <b>icmp6-neighborsolicit</b>,
        <b>icmp6-neighboradvert</b>, <b>icmp6-redirect</b>,
        <b>icmp6-routerrenum</b>, <b>icmp6-nodeinformationquery</b>,
        <b>icmp6-nodeinformationresponse</b>,
        <b>icmp6-ineighbordiscoverysolicit</b>,
        <b>icmp6-ineighbordiscoveryadvert</b>,
        <b>icmp6-multicastlistenerreportv2</b>,
        <b>icmp6-homeagentdiscoveryrequest</b>,
        <b>icmp6-homeagentdiscoveryreply</b>, <b>icmp6-mobileprefixsolicit</b>,
        <b>icmp6-mobileprefixadvert</b>, <b>icmp6-certpathsolicit</b>,
        <b>icmp6-certpathadvert</b>, <b>icmp6-multicastrouteradvert</b>,
        <b>icmp6-multicastroutersolicit</b>,
      <b>icmp6-multicastrouterterm</b>.</p>
    <p class="Pp">The following TCP flags field values are available:
        <b>tcp-fin</b>, <b>tcp-syn</b>, <b>tcp-rst</b>, <b>tcp-push</b>,
        <b>tcp-ack</b>, <b>tcp-urg</b>, <b>tcp-ece</b>, <b>tcp-cwr</b>.</p>
  </dd>
</dl>
<p class="Pp">Primitives may be combined using:</p>
<dl class="Bl-tag">
  <dt></dt>
  <dd>A parenthesized group of primitives and operators.</dd>
  <dt></dt>
  <dd>Negation (`<b>!</b>' or `<b>not</b>').</dd>
  <dt></dt>
  <dd>Concatenation (`<b>&amp;&amp;</b>' or `<b>and</b>').</dd>
  <dt></dt>
  <dd>Alternation (`<b>||</b>' or `<b>or</b>').</dd>
</dl>
<p class="Pp">Negation has the highest precedence. Alternation and concatenation
    have equal precedence and associate left to right. Note that explicit
    <b>and</b> tokens, not juxtaposition, are now required for
  concatenation.</p>
<p class="Pp">If an identifier is given without a keyword, the most recent
    keyword is assumed. For example,
  <br/>
</p>
<pre><b>not host</b> vs <b>and</b> ace</pre>
<br/>
is short for
<br/>
<pre><b>not host</b> vs <b>and host</b> ace</pre>
<br/>
which should not be confused with
<br/>
<pre><b>not (host </b>vs<b> or </b>ace<b>)</b></pre>
<br/>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">To select all packets arriving at or departing from `sundown':</p>
<div class="Bd-indent">
<pre><b>host</b> sundown</pre>
</div>
<p class="Pp">To select traffic between `helios' and either `hot' or `ace':</p>
<div class="Bd-indent">
<pre><b>host</b> helios <b>and (</b>hot <b>or</b> ace<b>)</b></pre>
</div>
<p class="Pp">To select all IPv4 packets between `ace' and any host except
    `helios':</p>
<div class="Bd-indent">
<pre><b>ip host</b> ace <b>and not</b> helios</pre>
</div>
<p class="Pp">To select all traffic between local hosts and hosts at
  Berkeley:</p>
<div class="Bd-indent">
<pre><b>net</b> ucb-ether</pre>
</div>
<p class="Pp">To select all FTP traffic through Internet gateway `snup':</p>
<div class="Bd-indent">
<pre><b>gateway</b> snup <b>and (port</b> ftp <b>or</b> ftp-data<b>)</b></pre>
</div>
<p class="Pp">To select IPv4 traffic neither sourced from nor destined for local
    hosts (if you gateway to one other net, this stuff should never make it onto
    your local net).</p>
<div class="Bd-indent">
<pre><b>ip and not net </b>localnet</pre>
</div>
<p class="Pp">To select the start and end packets (the SYN and FIN packets) of
    each TCP conversation that involves a non-local host.</p>
<div class="Bd-indent">
<pre><b>tcp[tcpflags] &amp; (tcp-syn|tcp-fin) !=</b> 0 <b>and not src and dst net</b> localnet</pre>
</div>
<p class="Pp">To select the TCP packets with flags RST and ACK both set. (i.e.
    select only the RST and ACK flags in the flags field, and if the result is
    &quot;RST and ACK both set&quot;, match)</p>
<div class="Bd-indent">
<pre><b>
tcp[tcpflags] &amp; (tcp-rst|tcp-ack) == (tcp-rst|tcp-ack)</b></pre>
</div>
<p class="Pp">To select all IPv4 HTTP packets to and from port 80, i.e. print
    only packets that contain data, not, for example, SYN and FIN packets and
    ACK-only packets. (IPv6 is left as an exercise for the reader.)</p>
<div class="Bd-indent">
<pre><b>tcp port</b> 80 <b>and (((ip[</b>2:2<b>] - ((ip[</b>0<b>]&amp;</b>0xf<b>)&lt;&lt;</b>2<b>)) - ((tcp[</b>12<b>]&amp;</b>0xf0<b>)&gt;&gt;</b>2<b>)) != </b>0<b>)</b></pre>
</div>
<p class="Pp">To select IPv4 packets longer than 576 bytes sent through gateway
    `snup':</p>
<div class="Bd-indent">
<pre><b>gateway</b> snup <b>and ip[</b>2:2<b>] &gt;</b> 576</pre>
</div>
<p class="Pp">To select IPv4 broadcast or multicast packets that were <i>not</i>
    sent via Ethernet broadcast or multicast:</p>
<div class="Bd-indent">
<pre><b>ether[</b>0<b>] &amp;</b> 1 <b>=</b> 0 <b>and ip[</b>16<b>] &gt;=</b> 224</pre>
</div>
<p class="Pp">To select all ICMP packets that are not echo requests/replies
    (i.e., not ping packets):</p>
<div class="Bd-indent">
<pre><b>
icmp[icmptype] != icmp-echo and icmp[icmptype] != icmp-echoreply</b>
<b>
icmp6[icmp6type] != icmp6-echo and icmp6[icmp6type] != icmp6-echoreply</b></pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>pcap</b>(3PCAP)</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">To report a security issue please send an e-mail to
    security@tcpdump.org.</p>
<p class="Pp">To report bugs and other problems, contribute patches, request a
    feature, provide generic feedback etc please see the file
    <i>CONTRIBUTING.md</i> in the libpcap source tree root.</p>
<p class="Pp">Filter expressions on fields other than those in Token Ring
    headers will not correctly handle source-routed Token Ring packets.</p>
<p class="Pp">Filter expressions on fields other than those in 802.11 headers
    will not correctly handle 802.11 data packets with both To DS and From DS
    set.</p>
<p class="Pp">`<b>ip6 proto</b>' should chase header chain, but at this moment
    it does not. `<b>ip6 protochain</b>' is supplied for this behavior. For
    example, to match IPv6 fragments: `<b>ip6 protochain</b> 44'</p>
<p class="Pp">Arithmetic expression against transport layer headers, like
    <b>tcp[0]</b>, does not work against IPv6 packets. It only looks at IPv4
    packets.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">5 November 2017</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
