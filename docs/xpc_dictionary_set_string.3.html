<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 2011 Apple Inc. All rights reserved.
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>xpc_dictionary_create(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">xpc_dictionary_create(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">xpc_dictionary_create(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">xpc_dictionary_create</code> &#x2014;
    <span class="Nd">creation and management of XPC messages</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="In">#include
    <a class="In">&lt;xpc/xpc.h&gt;</a></code></p>
<p class="Pp"><var class="Ft">xpc_object_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_create</code>(<var class="Fa">const char *
    const *keys</var>, <var class="Fa">const xpc_object_t *values</var>,
    <var class="Fa">size_t count</var>);</p>
<p class="Pp"><var class="Ft">xpc_object_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_create_reply</code>(<var class="Fa">xpc_object_t
    original</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_value</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">xpc_object_t value</var>);</p>
<p class="Pp"><var class="Ft">xpc_object_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_value</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">size_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_count</code>(<var class="Fa">xpc_object_t
    dictionary</var>);</p>
<p class="Pp"><var class="Ft">bool</var>
  <br/>
  <code class="Fn">xpc_dictionary_apply</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">xpc_dictionary_applier_t
  applier</var>);</p>
<p class="Pp"><var class="Ft">xpc_connection_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_remote_connection</code>(<var class="Fa">xpc_object_t
    dictionary</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_bool</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">bool value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_int64</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">int64_t value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_uint64</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">uint64_t value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_double</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">double value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_date</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">int64_t value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_data</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">const void *value</var>, <var class="Fa">size_t
    length</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_string</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">const char *value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_uuid</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">const uuid_t value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_fd</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>, <var class="Fa">int
    value</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">xpc_dictionary_set_connection</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">xpc_connection_t connection</var>);</p>
<p class="Pp"><var class="Ft">bool</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_bool</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">int64_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_int64</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">uint64_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_uint64</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">double</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_double</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">int64_t</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_date</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">const void *</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_data</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>,
    <var class="Fa">size_t *length</var>);</p>
<p class="Pp"><var class="Ft">const uint8_t *</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_uuid</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">const char *</var>
  <br/>
  <code class="Fn">xpc_dictionary_get_string</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">xpc_dictionary_dup_fd</code>(<var class="Fa">xpc_object_t
    dictionary</var>, <var class="Fa">const char *key</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DICTIONARIES"><a class="permalink" href="#DICTIONARIES">DICTIONARIES</a></h1>
<p class="Pp">XPC dictionaries are collections of XPC objects that map keys
    (expressed as C strings) to values.</p>
<p class="Pp">Objects of dictionary collection type are mutable and will
    automatically expand to accommodate new keys and values that are inserted
    into the dictionary.</p>
<section class="Ss">
<h2 class="Ss" id="CREATION"><a class="permalink" href="#CREATION">CREATION</a></h2>
<p class="Pp">The
    <a class="permalink" href="#xpc_dictionary_create"><code class="Fn" id="xpc_dictionary_create">xpc_dictionary_create</code></a>()
    function returns a newly created dictionary. The caller may optionally
    provide corresponding C arrays of <var class="Fa">keys</var> and
    <var class="Fa">values</var> to initialize the dictionary. All
    <var class="Fa">values</var> must be XPC objects and are automatically
    retained by the XPC framework as they are inserted into the dictionary. The
    <var class="Fa">count</var> is used to specify the size of the C arrays.
    Both arrays must be of the same size. The behavior when
    <var class="Fa">count</var> is greater than the number of elements in either
    of the C arrays is undefined. These arguments are optional and NULL may be
    passed to both <var class="Fa">keys</var> and <var class="Fa">values</var>
    with a <var class="Fa">count</var> of zero, resulting in an empty
    dictionary.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="GETTING_AND_SETTING_VALUES"><a class="permalink" href="#GETTING_AND_SETTING_VALUES">GETTING
  AND SETTING VALUES</a></h2>
<p class="Pp">The <code class="Fn">xpc_dictionary_set_value</code>() function
    may be used to insert or replace the <var class="Fa">value</var> of a
    specified <var class="Fa">key</var> in a <var class="Fa">dictionary</var>.
    The XPC framework will retain a reference to the <var class="Fa">value</var>
    while it is present in the <var class="Fa">dictionary</var>, and will
    release the reference when it is removed. The <var class="Fa">value</var>
    provided may be NULL, in which case the <var class="Fa">key</var> will be
    removed from the dictionary.</p>
<p class="Pp" id="xpc_dictionary_get_value">The value of a specific
    <var class="Fa">key</var> in the <var class="Fa">dictionary</var> may be
    retrieved using the
    <a class="permalink" href="#xpc_dictionary_get_value"><code class="Fn">xpc_dictionary_get_value</code></a>()
    function. This function returns the value for the specified
    <var class="Fa">key</var> if it exists or NULL if it does not.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="PRIMITIVE_GET_AND_SET_FUNCTIONS"><a class="permalink" href="#PRIMITIVE_GET_AND_SET_FUNCTIONS">PRIMITIVE
  GET AND SET FUNCTIONS</a></h2>
<p class="Pp">Various functions exist for retrieving primitive C and operating
    system types directly from a dictionary without the need for an intermediate
    boxed object. See <a class="Xr">xpc_object(3)</a> for more information.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="ITERATION"><a class="permalink" href="#ITERATION">ITERATION</a></h2>
<p class="Pp">The <code class="Fn">xpc_dictionary_apply</code>() function may be
    used to iterate the <var class="Fa">key</var> and
    <var class="Fa">value</var> pairs of a <var class="Fa">dictionary</var>
    using an <var class="Fa">applier</var> callback block. The callback block is
    invoked for each pair and must return a <var class="Ft">bool</var>
    indicating whether the iteration should continue (true if it should
    continue, false if it should not).</p>
<p class="Pp" id="xpc_dictionary_apply">The
    <a class="permalink" href="#xpc_dictionary_apply"><code class="Fn">xpc_dictionary_apply</code></a>()
    function returns the boolean value returned by the last invocation of the
    <var class="Fa">applier</var> block. If the applier block returns false for
    any key-value pair (including the last),
    <code class="Fn">xpc_dictionary_apply</code>() will return false. If the
    applier block returns true for all pairs,
    <code class="Fn">xpc_dictionary_apply</code>() will return true. For empty
    dictionaries, the function returns true.</p>
<p class="Pp">Note that the C language does not require an explicit return type
    to be declared for a block when the return expression is unambigous.
    Therefore the formal block declaration</p>
<div class="Bd Pp Bd-indent Li">
<pre>(void)xpc_dictionary_apply(dictionary, ^ bool (const char *key, xpc_object_t value) {
	// Do iteration.
	return true;
});</pre>
</div>
<p class="Pp">may instead be written as follows (omitting the declared return
    type, and explicitly casting the return value to the desired type):</p>
<div class="Bd Pp Bd-indent Li">
<pre>(void)xpc_dictionary_apply(dictionary, ^(const char *key, xpc_object_t value) {
	// Do iteration.
	return (bool)true;
});</pre>
</div>
<p class="Pp" id="xpc_dictionary_set_value"><i class="Em">Important</i>: the
    behavior of modifying the contents of an XPC dictionary during iteration is
    explicitly prohibited and will result in a runtime error. This includes
    calling
    <a class="permalink" href="#xpc_dictionary_set_value"><code class="Fn">xpc_dictionary_set_value</code></a>()
    on the current dictionary during iteration.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DICTIONARIES_AS_MESSAGES"><a class="permalink" href="#DICTIONARIES_AS_MESSAGES">DICTIONARIES
  AS MESSAGES</a></h1>
<p class="Pp">All messages sent and received by XPC connections are
    dictionaries. As a result, several functions are available to assist with
    the use of dictionaries as XPC messages.</p>
<p class="Pp" id="xpc_dictionary_get_remote_connection">The
    <a class="permalink" href="#xpc_dictionary_get_remote_connection"><code class="Fn">xpc_dictionary_get_remote_connection</code></a>()
    function may be used to return the underlying XPC connection through which a
    message was received.</p>
<p class="Pp" id="xpc_dictionary_create_reply">When a client sends a message
    using the <a class="Xr">xpc_connection_send_message_with_reply(3)</a>
    function, a specific reply message must be created with
    <a class="permalink" href="#xpc_dictionary_create_reply"><code class="Fn">xpc_dictionary_create_reply</code></a>().
    This function returns a new dictionary which shares the underlying remote
    connection as the <var class="Fa">original</var> message. A reply dictionary
    may be used the same as any other dictionary, but it must be sent to the
    connection returned by
    <code class="Fn">xpc_dictionary_get_remote_connection</code>(), at which
    point the sender's reply block will be invoked when the reply message is
    received.</p>
<p class="Pp" id="Note"><a class="permalink" href="#Note"><i class="Em">Note</i></a>:
    Message dictionaries have side effects attached to their lifetimes and the
    lifetimes of reply messages created from them, so close attention should be
    paid to the lifetimes of such dictionaries. For details, see
    <a class="Xr">xpc_transaction_begin(3)</a>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DICTIONARIES_AS_ERRORS"><a class="permalink" href="#DICTIONARIES_AS_ERRORS">DICTIONARIES
  AS ERRORS</a></h1>
<p class="Pp">Errors encountered by the XPC framework are delivered to the event
    handler of a connection as a dictionary of type
    <var class="Ft">XPC_TYPE_ERROR</var>. See <a class="Xr">xpc_get_type(3)</a>
    for more information about XPC object types. These error dictionaries may be
    directly compared against the following constants:</p>
<ul class="Bl-bullet Bd-indent Bl-compact">
  <li><var class="Ft">XPC_ERROR_CONNECTION_INTERRUPTED</var></li>
  <li><var class="Ft">XPC_ERROR_CONNECTION_INVALID</var></li>
  <li><var class="Ft">XPC_ERROR_TERMINATION_IMMINENT</var></li>
</ul>
<p class="Pp"><i class="Em">Important</i>: these dictionaries are constant
    singletons and must not be modified.</p>
<p class="Pp" id="xpc_dictionary_get_string">Error dictionaries contain a single
    <var class="Ft">XPC_ERROR_KEY_DESCRIPTION</var> key. The value of this key
    is a string object which encapsulates a human-readable description of the
    error condition. This value is guaranteed to be a string type and it is safe
    to use the
    <a class="permalink" href="#xpc_dictionary_get_string"><code class="Fn">xpc_dictionary_get_string</code></a>()
    function directly to obtain a C string representation of the description.
    The contents of this string is intended for diagnostic use and is subject to
    change in future releases.</p>
<p class="Pp">Additional keys and values may be added to the error dictionaries
    over time.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">xpc_object(3)</a>, <a class="Xr">xpc_objects(3)</a>,
    <a class="Xr">xpc_connection_create(3)</a>,
    <a class="Xr">xpc_array_create(3)</a></p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">1 July, 2011</td>
    <td class="foot-os">Darwin</td>
  </tr>
</table>
</body>
</html>
