<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>Module::AutoInstall(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Module::AutoInstall(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Module::AutoInstall(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Module::AutoInstall - Automatic install of dependencies via CPAN
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
In <i>Makefile.PL</i>, with Module::Install available on the author's system:
<p class="Pp"><span class="Li"></span></p>
<pre>
    use inc::Module::Install;
    
    name        'Joe-Hacker';
    abstract    'Perl Interface to Joe Hacker';
    author      'Joe Hacker &lt;joe@hacker.org&gt;';
    include     'Module::AutoInstall';
    
    requires    'Module0';          # mandatory modules
    
    feature     'Feature1',
        -default    =&gt; 0,
        'Module2'   =&gt; '0.1';
    
    feature     'Feature2',
        -default    =&gt; 0,
        'Module3'   =&gt; '1.0';
    
    auto_install(
        make_args   =&gt; '--hello',   # option(s) for CPAN::Config
        force       =&gt; 1,           # pseudo-option to force install
        do_once     =&gt; 1,           # skip previously failed modules
    );
    
    WriteAll;
</pre>
<p class="Pp">Invoking the resulting <i>Makefile.PL</i>:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    % perl Makefile.PL                  # interactive behaviour
    % perl Makefile.PL --defaultdeps    # accept default value on prompts
    % perl Makefile.PL --checkdeps      # check only, no Makefile produced
    % perl Makefile.PL --skipdeps       # ignores all dependencies
    % perl Makefile.PL --testonly       # don't write installation targets
</pre>
<p class="Pp">Note that the trailing 'deps' of arguments may be omitted,
  too.</p>
<p class="Pp">Using <span class="Li">&quot;--defaultdeps&quot;</span> will make
    <i>Makefile.PL</i> behave similarly to a regular Makefile.PL file with
    <span class="Li">&quot;PREREQ_PM&quot;</span> dependencies.</p>
<p class="Pp">One can use environment variables (see &quot;ENVIRONMENT&quot;)
    below to set a default behavior instead of specifying it in the command line
    for every invocation of <i>Makefile.PL</i>.</p>
<p class="Pp">Using <i>make</i> (or <i>nmake</i>):</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    % make [all|test|install]           # install dependencies first
    % make checkdeps                    # same as the --checkdeps above
    % make installdeps                  # install dependencies only
    % make installdeps_notest           # same without running tests
    % make upgradedeps                  # upgrade all deps, even if installed
    % make upgradedeps_notest           # same without running tests
    % make listdeps                     # print unsatisifed deps, one per line
    % make listalldeps                  # print all deps, one per line
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>Module::AutoInstall</b> lets module writers to specify a more sophisticated
  form of dependency information than the
  <span class="Li">&quot;PREREQ_PM&quot;</span> option offered by
  <b>ExtUtils::MakeMaker</b>.
<p class="Pp">This module works best with the <b>Module::Install</b> framework,
    a drop-in replacement for MakeMaker. However, this module also supports
    <i>Makefile.PL</i> files based on MakeMaker; see &quot;EXAMPLES&quot; for
    instructions.</p>
<p class="Pp">Specifying <span class="Li">&quot;installdeps_target;&quot;</span>
    instead of <span class="Li">&quot;auto_install;&quot;</span> will not try to
    install dependencies when running <span class="Li">&quot;make&quot;</span>,
    but only when running <span class="Li">&quot;make</span>
    <span class="Li">installdeps&quot;</span>.</p>
<section class="Ss">
<h2 class="Ss" id="Prerequisites_and_Features"><a class="permalink" href="#Prerequisites_and_Features">Prerequisites
  and Features</a></h2>
Prerequisites are grouped into <b>features</b>, and the user could choose yes/no
  on each one's dependencies; the module writer may also supply a boolean value
  via <span class="Li">&quot;-default&quot;</span> to specify the default
  choice.
<p class="Pp">The <b>Core Features</b> marked by the name
    <span class="Li">&quot;-core&quot;</span> will double-check with the user,
    if the user chooses not to install the mandatory modules. This differs from
    the pre-0.26 'silent install' behaviour.</p>
<p class="Pp">Starting from version 0.27, if
    <span class="Li">&quot;-core&quot;</span> is set to the string
    <span class="Li">&quot;all&quot;</span> (case-insensitive), every feature
    will be considered mandatory.</p>
<p class="Pp">The dependencies are expressed as pairs of
    <span class="Li">&quot;Module&quot;</span> =&gt;
    <span class="Li">&quot;version&quot;</span> inside an array reference. If
    the order does not matter, and there are no
    <span class="Li">&quot;-default&quot;</span>,
    <span class="Li">&quot;-tests&quot;</span> or
    <span class="Li">&quot;-skiptests&quot;</span> directives for that feature,
    you may also use a hash reference.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="The_Installation_Process"><a class="permalink" href="#The_Installation_Process">The
  Installation Process</a></h2>
Once <b>Module::AutoInstall</b> has determined which module(s) are needed, it
  checks whether it's running under the <b>CPAN</b> shell and should therefore
  let <b>CPAN</b> handle the dependency.
<p class="Pp">Finally, the <span class="Li">&quot;WriteMakefile()&quot;</span>
    is overridden to perform some additional checks, as well as skips tests
    associated with disabled features by the
    <span class="Li">&quot;-tests&quot;</span> option.</p>
<p class="Pp">The actual installation happens at the end of the
    <span class="Li">&quot;make config&quot;</span> target; both
    <span class="Li">&quot;make test&quot;</span> and
    <span class="Li">&quot;make install&quot;</span> will trigger the
    installation of required modules.</p>
<p class="Pp">If it's not running under <b>CPAN</b>, the installer will probe
    for an active connection by trying to resolve the domain
    <span class="Li">&quot;cpan.org&quot;</span>, and check for the user's
    permission to use <b>CPAN</b>. If all went well, a separate
   <b>CPAN</b> instance is created to install the required modules.</p>
<p class="Pp">If you have the <b>CPANPLUS</b> package installed in your system,
    it is preferred by default over <b>CPAN</b>; it also accepts some extra
    options (e.g. <span class="Li">&quot;-target =&gt; 'skiptest', -skiptest
    =&gt; 1&quot;</span> to skip testing).</p>
<p class="Pp">All modules scheduled to be installed will be deleted from
    <span class="Li">%INC</span> first, so <b>ExtUtils::MakeMaker</b> will check
    the newly installed modules.</p>
<p class="Pp">Additionally, you could use the <span class="Li">&quot;make
    installdeps&quot;</span> target to install the modules, and the
    <span class="Li">&quot;make checkdeps&quot;</span> target to check
    dependencies without actually installing them; the
    <span class="Li">&quot;perl Makefile.PL --checkdeps&quot;</span> command has
    an equivalent effect.</p>
<p class="Pp">If the <i>Makefile.PL</i> itself needs to use an independent
    module (e.g. <b>Acme::KillarApp</b>, v1.21 or greater), then use something
    like below:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    BEGIN {
        require Module::AutoInstall;
        # the first argument is an arrayref of the -config flags
        Module::AutoInstall-&gt;install([], 'Acme::KillerApp' =&gt; 1.21);
    }
    use Acme::KillerApp 1.21;

    Module::AutoInstall-&gt;import(
        # ... arguments as usual ...
    );
</pre>
<p class="Pp">Note the version test in the use clause; if you are so close to
    the cutting edge that <b>Acme::KillerApp</b> 1.20 is the latest version on
    CPAN, this will prevent your module from going awry.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="User-Defined_Hooks"><a class="permalink" href="#User-Defined_Hooks">User-Defined
  Hooks</a></h2>
User-defined <i>pre-installation</i> and <i>post-installation</i> hooks are
  available via <span class="Li">&quot;MY::preinstall&quot;</span> and
  <span class="Li">&quot;MY::postinstall&quot;</span> subroutines, as shown
  below:
<p class="Pp"><span class="Li"></span></p>
<pre>
    # pre-install handler; takes $module_name and $version
    sub MY::preinstall  { return 1; } # return false to skip install

    # post-install handler; takes $module_name, $version, $success
    sub MY::postinstall { return; }   # the return value doesn't matter
</pre>
<p class="Pp">Note that since <b>Module::AutoInstall</b> performs installation
    at the time of <span class="Li">&quot;use&quot;</span> (i.e. before perl
    parses the remainder of <i>Makefile.PL</i>), you have to declare those two
    handlers <i>before</i> the <span class="Li">&quot;use&quot;</span> statement
    for them to take effect.</p>
<p class="Pp">If the user did not choose to install a module or it already
    exists on the system, neither of the handlers is invoked. Both handlers are
    invoked exactly once for each module when installation is attempted.</p>
<p class="Pp"><span class="Li">&quot;MY::preinstall&quot;</span> takes two
    arguments, <span class="Li">$module_name</span> and
    <span class="Li">$version</span>; if it returns a false value, installation
    for that module will be skipped, and
    <span class="Li">&quot;MY::postinstall&quot;</span> won't be called at
  all.</p>
<p class="Pp"><span class="Li">&quot;MY::postinstall&quot;</span> takes three
    arguments, <span class="Li">$module_name</span>,
    <span class="Li">$version</span> and <span class="Li">$success</span>. The
    last one denotes whether the installation succeeded or not:
    <span class="Li">1</span> means installation completed successfully,
    <span class="Li">0</span> means failure during install, and
    <span class="Li">&quot;undef&quot;</span> means that the installation was
    not attempted at all, possibly due to connection problems, or that module
    does not exist on CPAN at all.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Customized__MY::postamble_"><a class="permalink" href="#Customized__MY::postamble_">Customized
  &quot;MY::postamble&quot;</a></h2>
Starting from version 0.43, <b>Module::AutoInstall</b> supports modules that
  require a <span class="Li">&quot;MY::postamble&quot;</span> subroutine in
  their <i>Makefile.PL</i>. The user-defined
  <span class="Li">&quot;MY::postamble&quot;</span>, if present, is responsible
  for calling <span class="Li">&quot;Module::AutoInstall::postamble&quot;</span>
  and include the output in its return value.
<p class="Pp">For example, the <b>DBD::*</b> (database driver) modules for the
    Perl DBI are required to include the postamble generated by the function
    <span class="Li">&quot;dbd_postamble&quot;</span>, so their
    <i>Makefile.PL</i> may contain lines like this:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    sub MY::postamble {
        return &amp;Module::AutoInstall::postamble . &amp;dbd_postamble;
    }
</pre>
<p class="Pp">Note that the <b>Module::AutoInstall</b> module does not export
    the <span class="Li">&quot;postamble&quot;</span> function, so the name
    should always be fully qualified.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<b>Module::AutoInstall</b> will add <span class="Li">&quot;UNINST=1&quot;</span>
  to your <b>make install</b> flags if your effective uid is 0 (root), unless
  you explicitly disable it by setting <b>CPAN</b>'s
  <span class="Li">&quot;make_install_arg&quot;</span> configuration option (or
  the <span class="Li">&quot;makeflags&quot;</span> option of <b>CPANPLUS</b>)
  to include <span class="Li">&quot;UNINST=0&quot;</span>. This <i>may</i> cause
  dependency problems if you are using a fine-tuned directory structure for your
  site. Please consult &quot;FAQ&quot; in CPAN for an explanation in detail.
<p class="Pp">If either <b>version</b> or <b>Sort::Versions</b> is available,
    they will be used to compare the required version with the existing module's
    version and the CPAN module's. Otherwise it silently falls back to use
    <i>cmp</i>. This may cause inconsistent behaviours in pathetic
  situations.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<b>Module::AutoInstall</b> uses a single environment variable,
  <span class="Li">&quot;PERL_AUTOINSTALL&quot;</span>. It is taken as the
  command line argument passed to <i>Makefile.PL</i>; you could set it to
  <span class="Li">&quot;--alldeps&quot;</span>,
  <span class="Li">&quot;--defaultdeps&quot;</span> or
  <span class="Li">&quot;--skipdeps&quot;</span> to avoid all interactive
  behaviour.
<p class="Pp"><span class="Li">&quot;--alldeps&quot;</span> will install all
    features, while <span class="Li">&quot;--defaultdeps&quot;</span> will only
    install features for which the default answer is 'y'.</p>
<p class="Pp"><span class="Li">&quot;--skipdeps&quot;</span> will refrain from
    loading CPAN and not install anything, unless you're running under CPAN or
    CPANPLUS, in which case required dependencies will be installed.</p>
<p class="Pp">It is also read from the
    <span class="Li">&quot;PERL_EXTUTILS_AUTOINSTALL&quot;</span> environment
    variable if <span class="Li">&quot;PERL_AUTOINSTALL&quot;</span> is not
    defined.</p>
<p class="Pp">You can also set
    <span class="Li">&quot;PERL_AUTOINSTALL_PREFER_CPAN&quot;</span> to use CPAN
    to install dependencies. By default CPANPLUS is used.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
Module::Install
<p class="Pp">perlmodlib, ExtUtils::MakeMaker, Sort::Versions, CPAN,
  CPANPLUS</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
Audrey Tang &lt;autrijus@autrijus.org&gt;
<p class="Pp">Adam Kennedy &lt;adamk@cpan.org&gt;</p>
<p class="Pp">Matt S Trout &lt;mst@shadowcat.co.u&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="IF_THIS_BREAKS"><a class="permalink" href="#IF_THIS_BREAKS">IF
  THIS BREAKS</a></h1>
Report a ticket to bugs-Module-Install &lt;at&gt; rt.cpan.org and cc Matt - I
  appear to have volunteered as primary maintainer for this stuff so if you run
  into any problems please tell me
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright 2001, 2002, 2003, 2004, 2005, 2006 by Audrey Tang
<p class="Pp">Some parts copyright 2006 Adam Kennedy</p>
<p class="Pp">This program is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
<p class="Pp">See &lt;http://www.perl.com/perl/misc/Artistic.html&gt;</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-04-04</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
