<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>Class::Singleton(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Class::Singleton(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Class::Singleton(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Class::Singleton - Implementation of a &quot;Singleton&quot; class
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    use Class::Singleton;
    
    my $one = Class::Singleton-&gt;instance();   # returns a new instance
    my $two = Class::Singleton-&gt;instance();   # returns same instance
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
This is the <span class="Li">&quot;Class::Singleton&quot;</span> module. A
  Singleton describes an object class that can have only one instance in any
  system. An example of a Singleton might be a print spooler or system registry.
  This module implements a Singleton class from which other classes can be
  derived. By itself, the <span class="Li">&quot;Class::Singleton&quot;</span>
  module does very little other than manage the instantiation of a single
  object. In deriving a class from
  <span class="Li">&quot;Class::Singleton&quot;</span>, your module will inherit
  the Singleton instantiation method and can implement whatever specific
  functionality is required.
<p class="Pp">For a description and discussion of the Singleton class, see
    &quot;Design Patterns&quot;, Gamma et al, Addison-Wesley, 1995, ISBN
    0-201-63361-2.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="PREREQUISITES"><a class="permalink" href="#PREREQUISITES">PREREQUISITES</a></h1>
<span class="Li">&quot;Class::Singleton&quot;</span> requires Perl version 5.004
  or later. If you have an older version of Perl, please upgrade to latest
  version, available from your nearest CPAN site (see INSTALLATION below).
</section>
<section class="Sh">
<h1 class="Sh" id="INSTALLATION"><a class="permalink" href="#INSTALLATION">INSTALLATION</a></h1>
The <span class="Li">&quot;Class::Singleton&quot;</span> module is available
  from CPAN. As the 'perlmod' man page explains:
<p class="Pp"><span class="Li"></span></p>
<pre>
    CPAN stands for the Comprehensive Perl Archive Network.
    This is a globally replicated collection of all known Perl
    materials, including hundreds of unbunded modules.
    
    [...]
    
    For an up-to-date listing of CPAN sites, see
    http://www.perl.com/perl/ or ftp://ftp.perl.com/perl/ .
</pre>
<p class="Pp">The module is available in the following directories:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    /modules/by-module/Class/Class-Singleton-&lt;version&gt;.tar.gz
    /authors/id/ABW/Class-Singleton-&lt;version&gt;.tar.gz
</pre>
<p class="Pp"><span class="Li">&quot;Class::Singleton&quot;</span> is
    distributed as a single gzipped tar archive file:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    Class-Singleton-&lt;version&gt;.tar.gz
</pre>
<p class="Pp">Note that &quot;&lt;version&gt;&quot; represents the current
    version number, of the form &quot;<span class="Li">1.23</span>&quot;. See
    VERSION below to determine the current version number for
    <span class="Li">&quot;Class::Singleton&quot;</span>.</p>
<p class="Pp">Unpack the archive to create an installation directory:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    gunzip Class-Singleton-&lt;version&gt;.tar.gz
    tar xvf Class-Singleton-&lt;version&gt;.tar
</pre>
<p class="Pp">'cd' into that directory, make, test and install the module:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    cd Class-Singleton-&lt;version&gt;
    perl Makefile.PL
    make
    make test
    make install
</pre>
<p class="Pp">The '<span class="Li">&quot;make install&quot;</span>' will
    install the module on your system. You may need root access to perform this
    task. If you install the module in a local directory (for example, by
    executing &quot;<span class="Li">&quot;perl Makefile.PL
    LIB=~/lib&quot;</span>&quot; in the above - see
    <span class="Li">&quot;perldoc MakeMaker&quot;</span> for full details), you
    will need to ensure that the <span class="Li">&quot;PERL5LIB&quot;</span>
    environment variable is set to include the location, or add a line to your
    scripts explicitly naming the library location:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    use lib '/local/path/to/lib';
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="USING_THE_CLASS::SINGLETON_MODULE"><a class="permalink" href="#USING_THE_CLASS::SINGLETON_MODULE">USING
  THE CLASS::SINGLETON MODULE</a></h1>
To import and use the <span class="Li">&quot;Class::Singleton&quot;</span>
  module the following line should appear in your Perl program:
<p class="Pp"><span class="Li"></span></p>
<pre>
    use Class::Singleton;
</pre>
<p class="Pp">The <b>instance()</b> method is used to create a new
    <span class="Li">&quot;Class::Singleton&quot;</span> instance, or return a
    reference to an existing instance. Using this method, it is only possible to
    have a single instance of the class in any system.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $highlander = Class::Singleton-&gt;instance();
</pre>
<p class="Pp">Assuming that no
    <span class="Li">&quot;Class::Singleton&quot;</span> object currently
    exists, this first call to <b>instance()</b> will create a new
    <span class="Li">&quot;Class::Singleton&quot;</span> and return a reference
    to it. Future invocations of <b>instance()</b> will return the same
    reference.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $macleod    = Class::Singleton-&gt;instance();
</pre>
<p class="Pp">In the above example, both <span class="Li">$highlander</span> and
    <span class="Li">$macleod</span> contain the same reference to a
    <span class="Li">&quot;Class::Singleton&quot;</span> instance. There can be
    only one.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DERIVING_SINGLETON_CLASSES"><a class="permalink" href="#DERIVING_SINGLETON_CLASSES">DERIVING
  SINGLETON CLASSES</a></h1>
A module class may be derived from
  <span class="Li">&quot;Class::Singleton&quot;</span> and will inherit the
  <b>instance()</b> method that correctly instantiates only one object.
<p class="Pp"><span class="Li"></span></p>
<pre>
    package PrintSpooler;
    use base 'Class::Singleton';
    
    # derived class specific code
    sub submit_job {
        ...
    }
    
    sub cancel_job {
        ...
    }
</pre>
<p class="Pp">The <span class="Li">&quot;PrintSpooler&quot;</span> class defined
    above could be used as follows:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    use PrintSpooler;
    
    my $spooler = PrintSpooler-&gt;instance();
    
    $spooler-&gt;submit_job(...);
</pre>
<p class="Pp">The <b>instance()</b> method calls the <b>_new_instance()</b>
    constructor method the first and only time a new instance is created. All
    parameters passed to the <b>instance()</b> method are forwarded to
    <b>_new_instance()</b>. In the base class the <b>_new_instance()</b> method
    returns a blessed reference to a hash array containing any arguments passed
    as either a hash reference or list of named parameters.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    package MyConfig;
    use base 'Class::Singleton';
    
    sub foo {
        shift-&gt;{ foo };
    }
    
    sub bar {
        shift-&gt;{ bar };
    }
    
    package main;
    
    # either: hash reference of named parameters
    my $config = MyConfig-&gt;instance({ foo =&gt; 10, bar =&gt; 20 });
    
    # or: list of named parameters
    my $config = MyConfig-&gt;instance( foo =&gt; 10, bar =&gt; 20 );
    
    print $config-&gt;foo();   # 10
    print $config-&gt;bar();   # 20
</pre>
<p class="Pp">Derived classes may redefine the <b>_new_instance()</b> method to
    provide more specific object initialisation or change the underlying object
    type (to a list reference, for example).</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    package MyApp::Database;
    use base 'Class::Singleton';
    use DBI;
    
    # this only gets called the first time instance() is called
    sub _new_instance {
        my $class = shift;
        my $self  = bless { }, $class;
        my $db    = shift || &quot;myappdb&quot;;    
        my $host  = shift || &quot;localhost&quot;;
        
        $self-&gt;{ DB } = DBI-&gt;connect(&quot;DBI:mSQL:$db:$host&quot;)
            || die &quot;Cannot connect to database: $DBI::errstr&quot;;
        
        # any other initialisation...
        
        return $self;
    }
</pre>
<p class="Pp">The above example might be used as follows:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    use MyApp::Database;
    
    # first use - database gets initialised
    my $database = MyApp::Database-&gt;instance();
</pre>
<p class="Pp">Some time later on in a module far, far away...</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    package MyApp::FooBar
    use MyApp::Database;
    
    # this FooBar object needs access to the database; the Singleton
    # approach gives a nice wrapper around global variables.
    
    sub new {
        my $class = shift;
        bless {
            database =&gt; MyApp::Database-&gt;instance(),
        }, $class;
    }
</pre>
<p class="Pp">The <span class="Li">&quot;Class::Singleton&quot;</span>
    <b>instance()</b> method uses a private hash to store a reference to any
    existing instance of the object, keyed against the derived class package
    name.</p>
<p class="Pp">This allows different classes to be derived from
    <span class="Li">&quot;Class::Singleton&quot;</span> that can co-exist in
    the same system, while still allowing only one instance of any one class to
    exist. For example, it would be possible to derive both
    '<span class="Li">&quot;PrintSpooler&quot;</span>' and
    '<span class="Li">&quot;MyApp::Database&quot;</span>' from
    <span class="Li">&quot;Class::Singleton&quot;</span> and have a single
    instance of <i>each</i> in a system, rather than a single instance of
    <i>either</i>.</p>
<p class="Pp">You can use the <b>has_instance()</b> method to find out if a
    particular class already has an instance defined. A reference to the
    instance is returned or <span class="Li">&quot;undef&quot;</span> if none is
    currently defined.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $instance = MyApp::Database-&gt;has_instance()
        || warn &quot;No instance is defined yet&quot;;
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="METHODS"><a class="permalink" href="#METHODS">METHODS</a></h1>
<section class="Ss">
<h2 class="Ss" id="_fBinstance()_fP"><a class="permalink" href="#_fBinstance()_fP"><b>instance()</b></a></h2>
This method is called to return a current object instance or create a new one by
  calling <b>_new_instance()</b>.
</section>
<section class="Ss">
<h2 class="Ss" id="_fBhas_instance()_fP"><a class="permalink" href="#_fBhas_instance()_fP"><b>has_instance()</b></a></h2>
This method returns a reference to any existing instance or
  <span class="Li">&quot;undef&quot;</span> if none is defined.
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $testing = MySingleton1-&gt;has_instance()
        || warn &quot;No instance defined for MySingleton1&quot;;
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="_fB_new_instance()_fP"><a class="permalink" href="#_fB_new_instance()_fP"><b>_new_instance()</b></a></h2>
This &quot;private&quot; method is called by <b>instance()</b> to create a new
  object instance if one doesn't already exist. It is not intended to be called
  directly (although there's nothing to stop you from calling it if you're
  really determined to do so).
<p class="Pp">It creates a blessed hash reference containing any arguments
    passed to the method as either a hash reference or list of named
  parameters.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    # either: hash reference of named parameters
    my $example1 = MySingleton1-&gt;new({ pi =&gt; 3.14, e =&gt; 2.718 });

    # or: list of named parameters
    my $example2 = MySingleton2-&gt;new( pi =&gt; 3.14, e =&gt; 2.718 );
</pre>
<p class="Pp">It is important to remember that the <b>instance()</b> method will
    <i>only</i> call the <i></i><b><i>_new_instance()</i></b><i></i> method
    once, so any arguments you pass may be silently ignored if an instance
    already exists. You can use the <b>has_instance()</b> method to determine if
    an instance is already defined.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
Andy Wardley &lt;abw@wardley.org&gt; &lt;http://wardley.org/&gt;
<p class="Pp">Thanks to Andreas Koenig for providing some significant speedup
    patches and other ideas.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="VERSION"><a class="permalink" href="#VERSION">VERSION</a></h1>
This is version 1.5, released November 2014
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
Copyright Andy Wardley 1998-2007. All Rights Reserved.
<p class="Pp">This module is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2014-11-07</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
