<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 2000-2010 Apple Inc. All rights reserved.
  
   @APPLE_OSREFERENCE_LICENSE_HEADER_START@
  
   This file contains Original Code and/or Modifications of Original Code
   as defined in and that are subject to the Apple Public Source License
   Version 2.0 (the 'License'). You may not use this file except in
   compliance with the License. The rights granted to you under the License
   may not be used to create, or enable the creation or redistribution of,
   unlawful or unlicensed copies of an Apple operating system, or to
   circumvent, violate, or enable the circumvention or violation of, any
   terms of an Apple operating system software license agreement.
  
   Please obtain a copy of the License at
   http://www.opensource.apple.com/apsl/ and read it before using this file.
  
   The Original Code and all software distributed under the License are
   distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
   EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
   INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
   FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
   Please see the License for the specific language governing rights and
   limitations under the License.
  
   @APPLE_OSREFERENCE_LICENSE_HEADER_END@
  
       @(#)posix_spawn_file_actions_addclose.3
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>POSIX_SPAWN_FILE_ACTIONS_ADDCLOSE(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">POSIX_SPAWN_FILE_ACTIONS_ADDCLOSE(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">POSIX_SPAWN_FILE_ACTIONS_ADDCLOSE(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">posix_spawn_file_actions_addclose</code>
    <code class="Nm">posix_spawn_file_actions_addopen</code> &#x2014;
    <span class="Nd">add open or close actions to a
    <a class="permalink" href="#posix_spawn_file_actions_t"><i class="Em" id="posix_spawn_file_actions_t">posix_spawn_file_actions_t</i></a></span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="In">#include
  <a class="In">&lt;spawn.h&gt;</a></code></p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">posix_spawn_file_actions_addclose</code>(<var class="Fa">posix_spawn_file_actions_t
    *file_actions</var>, <var class="Fa">int filedes</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">posix_spawn_file_actions_addopen</code>(<var class="Fa">posix_spawn_file_actions_t
    *restrict file_actions</var>, <var class="Fa">int filedes</var>,
    <var class="Fa">const char *restrict path</var>, <var class="Fa">int
    oflag</var>, <var class="Fa">mode_t mode</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">posix_spawn_file_actions_adddup2</code>(<var class="Fa">posix_spawn_file_actions_t
    *file_actions</var>, <var class="Fa">int filedes</var>, <var class="Fa">int
    newfiledes</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">posix_spawn_file_actions_addinherit_np</code>(<var class="Fa">posix_spawn_file_actions_t
    *file_actions</var>, <var class="Fa">int filedes</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">posix_spawn_file_actions_addchdir</code>(<var class="Fa">posix_spawn_file_actions_t
    *file_actions</var>, <var class="Fa">const char *restrict path</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">posix_spawn_file_actions_addfchdir</code>(<var class="Fa">posix_spawn_file_actions_t
    *file_actions</var>, <var class="Fa">int filedes</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The
    <a class="permalink" href="#posix_spawn_file_actions_addclose"><code class="Fn" id="posix_spawn_file_actions_addclose">posix_spawn_file_actions_addclose</code></a>()
    function adds a close operation to the list of operations associated with
    the object referenced by <i class="Em">file_actions</i>, for subsequent use
    in a call to <a class="Xr">posix_spawn(2)</a> or
    <a class="Xr">posix_spawnp(2)</a>. The descriptor referred to by
    <i class="Em">filedes</i> is closed as if
    <a class="permalink" href="#close"><code class="Fn" id="close">close</code></a>()
    had been called on it prior to the new child process starting execution.</p>
<p class="Pp" id="posix_spawn_file_actions_addopen">The
    <a class="permalink" href="#posix_spawn_file_actions_addopen"><code class="Fn">posix_spawn_file_actions_addopen</code></a>()
    function adds an open operation to the list of operations associated with
    the object referenced by <i class="Em">file_actions</i>, for subsequent use
    in a call to <a class="Xr">posix_spawn(2)</a> or
    <a class="Xr">posix_spawnp(2)</a>. The descriptor referred to by
    <i class="Em">filedes</i> is opened using the <i class="Em">path</i>,
    <a class="permalink" href="#oflag"><i class="Em" id="oflag">oflag</i></a>,
    and <a class="permalink" href="#mode"><i class="Em" id="mode">mode</i></a>
    arguments as if
    <a class="permalink" href="#open"><code class="Fn" id="open">open</code></a>()
    had been called on it prior to the new child process starting execution. The
    string <i class="Em">path</i> is copied by the
    <code class="Fn">posix_spawn_file_actions_addopen</code>() function during
    this process, so storage need not be persistent in the caller.</p>
<p class="Pp" id="posix_spawn_file_actions_adddup2">The
    <a class="permalink" href="#posix_spawn_file_actions_adddup2"><code class="Fn">posix_spawn_file_actions_adddup2</code></a>()
    function adds a dup2 operation to the list of operations associated with the
    object referenced by <i class="Em">file_actions</i>, for subsequent use in a
    call to <a class="Xr">posix_spawn(2)</a> or
    <a class="Xr">posix_spawnp(2)</a>. The descriptor referred to by
    <a class="permalink" href="#newfiledes"><i class="Em" id="newfiledes">newfiledes</i></a>
    is created as if
    <a class="permalink" href="#dup2"><code class="Fn" id="dup2">dup2</code></a>()
    had been called on <i class="Em">filedes</i> prior to the new child process
    starting execution.</p>
<p class="Pp" id="posix_spawn_file_actions_addinherit_np">The
    <a class="permalink" href="#posix_spawn_file_actions_addinherit_np"><code class="Fn">posix_spawn_file_actions_addinherit_np</code></a>()
    function adds an abstract inheritance operation to the list of operations
    associated with the object referenced by <i class="Em">file_actions</i>, for
    subsequent use in a call to <a class="Xr">posix_spawn(2)</a> or
    <a class="Xr">posix_spawnp(2)</a>. The pre-existing descriptor referred to
    by <i class="Em">filedes</i> is marked for inheritance into the new process
    image, and the
    <a class="permalink" href="#FD_CLOEXEC"><i class="Em" id="FD_CLOEXEC">FD_CLOEXEC</i></a>
    flag is cleared from the file descriptor in the new process image.</p>
<p class="Pp" id="posix_spawn_file_actions_addinherit_np~2">Normally, for
    <a class="Xr">posix_spawn(2)</a> and <a class="Xr">posix_spawnp(2)</a>, all
    file descriptors are inherited from the parent process into the spawned
    process, except for those explicitly marked as close-on-exec. However if the
    flag <i class="Em">POSIX_SPAWN_CLOEXEC_DEFAULT</i> is set, then during the
    spawn operation, all pre-existing file descriptors in the parent process are
    treated as if they had been marked close-on-exec i.e. none of them are
    automatically inherited. See <a class="Xr">posix_spawnattr_setflags(3)</a>.
    Only file descriptors explicitly manipulated via
    <i class="Em">file_actions</i> are made available in the spawned process. In
    that case,
    <a class="permalink" href="#posix_spawn_file_actions_addinherit_np~2"><code class="Fn">posix_spawn_file_actions_addinherit_np</code></a>()
    can be used to make specific pre-existing file descriptors from the parent
    process be available in the spawned process.</p>
<p class="Pp" id="posix_spawn_file_actions_addchdir">The
    <a class="permalink" href="#posix_spawn_file_actions_addchdir"><code class="Fn">posix_spawn_file_actions_addchdir</code></a>()
    function adds an chdir operation to the list of operations associated with
    the object referenced by <i class="Em">file_actions</i>, for subsequent use
    in a call to <a class="Xr">posix_spawn(2)</a> or
    <a class="Xr">posix_spawnp(2)</a>. The current working directory will be set
    as if
    <a class="permalink" href="#chdir"><code class="Fn" id="chdir">chdir</code></a>()
    had been called with <i class="Em">path</i> prior to the new child process
    starting execution.</p>
<p class="Pp" id="posix_spawn_file_actions_addfchdir">The
    <a class="permalink" href="#posix_spawn_file_actions_addfchdir"><code class="Fn">posix_spawn_file_actions_addfchdir</code></a>()
    function adds a fchdir operation to the list of operations associated with
    the object referenced by <i class="Em">file_actions</i>, for subsequent use
    in a call to <a class="Xr">posix_spawn(2)</a> or
    <a class="Xr">posix_spawnp(2)</a>. The current working directory will be set
    as if
    <a class="permalink" href="#fchdir"><code class="Fn" id="fchdir">fchdir</code></a>()
    had been called with <i class="Em">filedes</i> prior to the new child
    process starting execution. When
    <i class="Em">POSIX_SPAWN_CLOEXEC_DEFAULT</i> is set, the file descriptor
    <i class="Em">filedes</i> will not be automatically inherited unless an
    explicit <code class="Fn">posix_spawn_file_actions_addinherit_np</code>()
    action for <i class="Em">filedes</i> has been added.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUES"><a class="permalink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
<p class="Pp">On success, these functions return 0; on failure they return an
    error number from
  <code class="In">&lt;<a class="In">errno.h</a>&gt;</code>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ERRORS"><a class="permalink" href="#ERRORS">ERRORS</a></h1>
<p class="Pp">These functions may fail if:</p>
<dl class="Bl-tag">
  <dt id="EBADF">[<a class="permalink" href="#EBADF"><code class="Er">EBADF</code></a>]</dt>
  <dd>The value specified by <var class="Fa">filedes</var> is negative or would
      cause the process to exceed the maximum number of open files it is
      allowed.</dd>
  <dt id="EINVAL">[<a class="permalink" href="#EINVAL"><code class="Er">EINVAL</code></a>]</dt>
  <dd>The value of <var class="Fa">file_actions</var> is invalid.</dd>
  <dt id="ENAMETOOLONG">[<a class="permalink" href="#ENAMETOOLONG"><code class="Er">ENAMETOOLONG</code></a>]</dt>
  <dd>The length of the value specified by <var class="Fa">path</var> exceeds
      <code class="Dv">PATH_MAX.</code></dd>
  <dt id="ENOMEM">[<a class="permalink" href="#ENOMEM"><code class="Er">ENOMEM</code></a>]</dt>
  <dd>Insufficient memory was available to add the new action to
      <var class="Fa">file_actions</var>.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">posix_spawn(2)</a>,
    <a class="Xr">posix_spawnp(2)</a>,
    <a class="Xr">posix_spawn_file_actions_init(3)</a>,
    <a class="Xr">posix_spawn_file_actions_destroy(3)</a>,
    <a class="Xr">posix_spawnattr_setflags(3)</a>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="STANDARDS"><a class="permalink" href="#STANDARDS">STANDARDS</a></h1>
<p class="Pp"><span class="St">Version&#x00A0;3 of the Single UNIX Specification
    (&#x201C;SUSv3&#x201D;)</span> [SPN]</p>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
<p class="Pp">The <code class="Fn">posix_spawn_file_actions_init</code>() and
    <code class="Fn">posix_spawn_file_actions_destroy</code>() function calls
    appeared in <span class="St">Version&#x00A0;3 of the Single UNIX
    Specification (&#x201C;SUSv3&#x201D;)</span> [SPN].</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">November 2, 2010</td>
    <td class="foot-os">Mac OS X</td>
  </tr>
</table>
</body>
</html>
