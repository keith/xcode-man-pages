<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 1999-2014 Apple Inc. All rights reserved.
  
   @APPLE_LICENSE_HEADER_START@
  
   This file contains Original Code and/or Modifications of Original Code
   as defined in and that are subject to the Apple Public Source License
   Version 2.0 (the 'License'). You may not use this file except in
   compliance with the License. Please obtain a copy of the License at
   http://www.opensource.apple.com/apsl/ and read it before using this
   file.
  
   The Original Code and all software distributed under the License are
   distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
   EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
   INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
   FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
   Please see the License for the specific language governing rights and
   limitations under the License.
  
   @APPLE_LICENSE_HEADER_END@
   -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>BOOTPD(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">BOOTPD(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">BOOTPD(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">bootpd</code> &#x2014;
<div class="Nd">DHCP/BOOTP/NetBoot server</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<table class="Nm">
  <tr>
    <td><code class="Nm">bootpd</code></td>
    <td><i>[options]</i></td>
  </tr>
</table>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<code class="Nm">bootpd</code> implements a DHCP/BOOTP server as defined in
  RFC951, RFC1542, RFC2131, and RFC2132, as well as a BOOTP/DHCP relay agent. It
  is also a NetBoot server implementing Apple-proprietary NetBoot 1.0
  (BOOTP-based) and NetBoot 2.0 BSDP (Boot Server Discovery Protocol). BSDP
  works along with regular DHCP, using DHCP-format packets with a special
  vendor-class identifier and vendor-specific options.
<p class="Pp"><code class="Nm">bootpd</code> understands and handles requests
    that arrive via a DHCP/BOOTP relay agent, allowing the server to be
    centrally located, and serve many remote subnets.</p>
<p class="Pp">The server is normally invoked by <a class="Xr">xinetd(8)</a> when
    a request arrives, but can also be invoked manually. If it is invoked by
    <a class="Xr">xinetd(8)</a>, <code class="Nm">bootpd</code> continues to
    service requests until it is idle for a period of 5 minutes, after which it
    exits to conserve system resources. If invoked manually,
    <code class="Nm">bootpd</code> continues to run indefinitely.</p>
<p class="Pp">If <code class="Nm">bootpd</code> receives a SIGHUP (-1) signal,
    it will re-read its configuration and client binding files.</p>
<p class="Pp">When a request from a client arrives, the server logs an entry to
    <i>/var/log/system.log</i> indicating which client made the request, and
    logs another entry once a reply is sent. This feature can be turned off
    using the <code class="Fl">-q</code> option described below.</p>
<p class="Pp"><code class="Nm">bootpd</code> reads its configuration settings
    from <i>/etc/bootpd.plist</i>. There are also a number of command-line
    options to change its behavior on the fly. Note in particular that options
    <b>DmNrS</b> can also be controlled via service-control properties. See
    <a class="Xr">Service Controls and Filters</a> below.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt><a class="permalink" href="#B"><code class="Fl" id="B">-B</code></a></dt>
  <dd>Disable BOOTP service. BOOTP is now disabled by default, so specifying
      this option has no effect.</dd>
  <dt><a class="permalink" href="#b"><code class="Fl" id="b">-b</code></a></dt>
  <dd>Only respond if the client's bootfile exists: for BOOTP clients only.</dd>
  <dt><a class="permalink" href="#D"><code class="Fl" id="D">-D</code></a></dt>
  <dd>Enable DHCP service. By default, DHCP service is disabled.</dd>
  <dt><a class="permalink" href="#d"><code class="Fl" id="d">-d</code></a></dt>
  <dd>Remain in the foreground and produce extra debugging output to
    stderr.</dd>
  <dt><a class="permalink" href="#I"><code class="Fl" id="I">-I</code></a></dt>
  <dd>Disable re-initialization on IP address changes. By default, changes to
      the server's configured IP addresses cause it to re-initialize.</dd>
  <dt><a class="permalink" href="#i"><code class="Fl" id="i">-i</code></a>
    <var class="Ar">interface</var></dt>
  <dd>Enable service on the specified interface. This flag may appear multiple
      times to enable multiple interfaces. For example,
    <pre>
    bootpd -i en0 -i en1
    </pre>
    forces <code class="Nm">bootpd</code> to respond only to requests received
      on ethernet ports en0 and en1. By default, all interfaces are
    enabled.</dd>
  <dt><a class="permalink" href="#m"><code class="Fl" id="m">-m</code></a></dt>
  <dd>Enable NetBoot 1.0 (BOOTP-based) service.</dd>
  <dt><a class="permalink" href="#N"><code class="Fl" id="N">-N</code></a></dt>
  <dd>Enable NetBoot 2.0 (BSDP/DHCP-based) service.</dd>
  <dt><a class="permalink" href="#o"><code class="Fl" id="o">-o</code></a>
    <var class="Ar">hop_count</var></dt>
  <dd>For relay agent operation, the maximum hop count, default is 4 hops.</dd>
  <dt><a class="permalink" href="#q"><code class="Fl" id="q">-q</code></a></dt>
  <dd>Be quiet as possible. Only report serious errors to</dd>
  <dt><a class="permalink" href="#r"><code class="Fl" id="r">-r</code></a>
    <var class="Ar">server_ip</var></dt>
  <dd>Relay packets to the specified server_ip, not exceeding the hop count.
      This option can be specified multiple times, one for each server to relay
      to.</dd>
  <dt><a class="permalink" href="#S"><code class="Fl" id="S">-S</code></a></dt>
  <dd>Enable BOOTP service.</dd>
  <dt><a class="permalink" href="#v"><code class="Fl" id="v">-v</code></a></dt>
  <dd>Be more verbose in messages logged to <i>/var/log/system.log</i>.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="CONFIGURING_BOOTPD"><a class="permalink" href="#CONFIGURING_BOOTPD">CONFIGURING
  BOOTPD</a></h1>
<code class="Nm">bootpd</code> reads its configuration from
  <i>/etc/bootpd.plist</i>, an XML property list. The root of the property list
  is a dictionary. The property list has three main areas:
<dl class="Bl-tag">
  <dt>Root dictionary</dt>
  <dd>Service Controls and Filters</dd>
  <dt>Subnets</dt>
  <dd>Subnet Entries</dd>
  <dt>NetBoot</dt>
  <dd>NetBoot Server Controls</dd>
</dl>
<section class="Ss">
<h2 class="Ss" id="Service_Controls_and_Filters"><a class="permalink" href="#Service_Controls_and_Filters">Service
  Controls and Filters</a></h2>
The root dictionary in <i>/etc/bootpd.plist</i> contains properties to control
  whether <code class="Nm">bootpd</code> will respond to a particular request,
  There are MAC address filters, DHCP controls, as well as controls to enable
  services.
<p class="Pp">The MAC address filter properties are:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">allow</b></dt>
  <dd>(Array of String) Enables servicing a list of MAC addresses.</dd>
  <dt><b class="Sy">deny</b></dt>
  <dd>(Array of String) Disables servicing a list of MAC addresses.</dd>
</dl>
<p class="Pp">When a packet arrives, <code class="Nm">bootpd</code> checks
    whether the client's MAC address is in the <b>deny</b> list. If it is, the
    packet is dropped. Otherwise, if the client's MAC address is in the
    <b>allow</b> list, the packet continues to be processed, otherwise it is
    dropped. If neither the <b>allow</b> nor the <b>deny</b> property is
    specified, the packet continues to be processed.</p>
<p class="Pp">Allow/deny filtering can be disabled using the
    <b>ignore_allow_deny</b> property:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">ignore_allow_deny</b></dt>
  <dd>(Array of String) Disable allow/deny processing on the specified list of
      interfaces. When a packet arrives on an interface in this list, processing
      continues without consulting the allow/deny filters.</dd>
</dl>
<p class="Pp">The service-control properties are:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">bootp_enabled</b></dt>
  <dd>Enables BOOTP on the specified list of interfaces.</dd>
  <dt><b class="Sy">dhcp_enabled</b></dt>
  <dd>Enables DHCP on the specified list of interfaces.</dd>
  <dt><b class="Sy">netboot_enabled</b></dt>
  <dd>Enables NetBoot 2.0 (BSDP/DHCP-based) NetBoot on the specified list of
      interfaces.</dd>
  <dt><b class="Sy">old_netboot_enabled</b></dt>
  <dd>Enables NetBoot 1.0 (BOOTP-based) NetBoot on the specified list of
      interfaces.</dd>
  <dt><b class="Sy">relay_enabled</b></dt>
  <dd>Enables the relay agent on the specified list of interfaces. Note that
      this option also requires the <b>relay_ip_list</b> property to be
      specified.</dd>
</dl>
<p class="Pp">For each of the properties dhcp_enabled, bootp_enabled,
    old_netboot_enabled, netboot_enabled, and relay_enabled, the corresponding
    service can be enabled or disabled for all interfaces, or enabled for just a
    specific set of interfaces. To enable or disable globally, use a
    <i>boolean</i> value <i>true</i> or <i>false</i> respectively. To enable
    just for a specific set of interfaces, use either a string, for a single
    interface, or an array of strings, one element for each interface.</p>
<p class="Pp">For example, to enable DHCP on interfaces en0 and en1, disable
    BOOTP on all interfaces, enable NetBoot on en1, and enable relay agent on
    interface en1, <i>/etc/bootpd.plist</i> could contain:</p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;
        &lt;key&gt;bootp_enabled&lt;/key&gt;
        &lt;false/&gt;
        &lt;key&gt;dhcp_enabled&lt;/key&gt;
        &lt;array&gt;
                &lt;string&gt;en0&lt;/string&gt;
                &lt;string&gt;en1&lt;/string&gt;
        &lt;/array&gt;
        &lt;key&gt;netboot_enabled&lt;/key&gt;
        &lt;string&gt;en1&lt;/string&gt;
        &lt;key&gt;relay_enabled&lt;/key&gt;
        &lt;array&gt;
                &lt;string&gt;en1&lt;/string&gt;
        &lt;/array&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</pre>
<p class="Pp">Some additional properties are:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">relay_ip_list</b></dt>
  <dd>(Array of String) If relay agent functionality is enabled (see
      <b>relay_enabled</b> above), this property contains the list of IP
      addresses to relay the packet to.</dd>
  <dt><b class="Sy">detect_other_dhcp_server</b></dt>
  <dd>(Boolean, Array of String) Enables detecting another DHCP server either
      globally (Boolean), or only on the specified list of interfaces (Array of
      String). When another DHCP server is detected on an interface, DHCP
      service is disabled on that interface until the next time
      <code class="Nm">bootpd</code> receives a SIGHUP, or exits.</dd>
  <dt><b class="Sy">reply_threshold_seconds</b></dt>
  <dd>(Integer) <code class="Nm">bootpd</code> won't respond to the request
      until the bp_secs field is at least <i>reply_theshold_seconds</i>. The
      default value is 0 (zero).</dd>
  <dt><b class="Sy">use_open_directory</b></dt>
  <dd>(Boolean) If this property is set to true, <code class="Nm">bootpd</code>
      will look for static IP address to ethernet address bindings in <b>Open
      Directory</b>. The default value is true.</dd>
  <dt><b class="Sy">dhcp_ignore_client_identifier</b></dt>
  <dd>(Boolean) If this property is set to true, the DHCP server tries to ignore
      the DHCP client identifier option (code 61) in the client's DHCP packet.
      Instead, the DHCP server tries to use the hardware address fields
      (bp_htype, bp_hlen, bp_chaddr) of the DHCP packet to identify the client.
      The default value of this property is false.</dd>
  <dt><b class="Sy">use_server_config_for_dhcp_options</b></dt>
  <dd>(Boolean) If this property is set to true, the DHCP server tries to use
      its own configuration to supply the subnet mask, router, DNS server
      addresses, DNS domain, and DNS domain search options, if those options are
      missing from the subnet description. If the property is false, the server
      only uses the information in the subnet description to supply these DHCP
      options. The default value of this property is true.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Subnet_Entries"><a class="permalink" href="#Subnet_Entries">Subnet
  Entries</a></h2>
The &quot;Subnets&quot; property in <i>/etc/bootpd.plist</i> contains an array
  of dictionaries, each dictionary corresponds to a single subnet entry.
<p class="Pp">A subnet entry describes a range of IP addresses, and associated
    information, such as the subnet mask, router, DNS servers, and other option
    data. A subnet entry also indicates whether the range is an address pool
    from which to allocate vs. simply an informational range in order to fulfill
    requests for option information. The informational range is used when the
    client's IP address binding is static, or the client knows its own IP
    address and simply wants relevant option information.</p>
<p class="Pp">A subnet entry is required to supply the DHCP service with pool(s)
    of IP address(es), and to inform the server of subnet-specific options and
    parameters. A subnet entry can also be used to convey network topology
    information via the <b>supernet</b> property described below.</p>
<p class="Pp">Subnet entries may not overlap in the IP ranges the describe, nor
    specify values that are inconsistent. Specifically, applying the
    <b>net_mask</b> value to each of the values in the <b>net_range</b> must
    yield the <b>net_address</b> value.</p>
<p class="Pp">Errors in configuration are logged to <i>/var/log/system.log</i>.
    There may be multiple entries for a given subnet, allowing different
    configuration values to be specified for a given sub-range of IP addresses
    within the subnet. For example, part of the range might be used for
    statically bound clients, and another for a dynamic address pool.</p>
<p class="Pp">Each subnet entry is encoded as a dictionary with the following
    properties:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">name</b></dt>
  <dd>(String) A descriptive name for the subnet, e.g.
    &quot;17.202.40/22&quot;.</dd>
  <dt><b class="Sy">net_mask</b></dt>
  <dd>(String) The network mask, e.g. &quot;255.255.252.0&quot;. This property
      is required.</dd>
  <dt><b class="Sy">net_address</b></dt>
  <dd>(String) The network address, e.g. &quot;17.202.40.0&quot;. This property
      is required.</dd>
  <dt><b class="Sy">net_range</b></dt>
  <dd>(Array of String) The network address range stored as two values: the
      first IP address and the last IP address. For example:
    <pre>
	&lt;array&gt;
		&lt;string&gt;17.202.40.2&lt;/string&gt;
		&lt;string&gt;17.202.43.254&lt;/string&gt;
	&lt;/array&gt;
    </pre>
    This property is required.</dd>
  <dt><b class="Sy">allocate</b></dt>
  <dd>(Boolean) Indicates whether the DHCP service should allocate IP addresses
      from the range specified by <b>net_range</b>. A <i>true</i> value means
      allocate IP addresses, otherwise, the subnet entry is informational
    only.</dd>
  <dt><b class="Sy">lease_min</b></dt>
  <dd>(Integer) The minimum allowable lease time (in seconds). This property is
      ignored unless <b>allocate</b> specifies <i>true</i>. Default value is
      3600 (one hour).</dd>
  <dt><b class="Sy">lease_max</b></dt>
  <dd>(Integer) The maximum allowable lease time (in seconds). This property is
      ignored unless <b>allocate</b> specifies <i>true</i>. Default value is
      3600 (one hour).</dd>
  <dt><b class="Sy">supernet</b></dt>
  <dd>(String) This property indicates that the subnet is on the same physical
      broadcast domain as other subnets with the same supernet value.</dd>
</dl>
<p class="Pp">The server can also supply clients with the following DHCP option
    information:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">dhcp_router</b></dt>
  <dd>The IP address of the default router (DHCP option code 3). If this
      property is not present, the server will attempt to provide its own
      default route for this option, if it is applicable.</dd>
  <dt><b class="Sy">dhcp_domain_name_server</b></dt>
  <dd>The IP address(es) of the DNS server(s) (option code 6). If this property
      is not present, the server will supply its own DNS server configuration
      (if available).</dd>
  <dt><b class="Sy">dhcp_domain_name</b></dt>
  <dd>The default DNS domain name (option code 15). If this property is not
      present, the server will supply its own default domain name (if
      available).</dd>
  <dt><b class="Sy">dhcp_domain_search</b></dt>
  <dd>The domain search list (option code 119). If this property is not present,
      the server will supply its domain search list (if available).</dd>
  <dt><b class="Sy">dhcp_classless_static_route</b></dt>
  <dd>The classless static route (option code 121). The list of static routes is
      specified using an array of strings. The array is interpreted as an array
      of string pairs, the first element of the pair describes the destination
      network using the notation
      &quot;<i>&lt;destination_ip&gt;</i>/<i>&lt;prefix_length&gt;</i>&quot;,
      and the second element gives the gateway as
      &quot;<i>&lt;gateway_ip</i>&quot;. If
      &quot;<i>&lt;gateway_ip&gt;</i>&quot; is &quot;0.0.0.0&quot;, the
      destination is the interface itself.
    <p class="Pp">For example:</p>
    <pre>
	&lt;key&gt;dhcp_classless_static_route&lt;/key&gt;
	&lt;array&gt;
		&lt;string&gt;192.168.100.0/22&lt;/string&gt;
		&lt;string&gt;0.0.0.0&lt;/string&gt;
		&lt;string&gt;44.100.100.100/22&lt;/string&gt;
		&lt;string&gt;192.168.100.1&lt;/string&gt;
		&lt;string&gt;129.210.177.132/25&lt;/string&gt;
		&lt;string&gt;1.1.1.1&lt;/string&gt;
	&lt;/array&gt;
    </pre>
    <p class="Pp">The first route has destination 192.168.100.0/22 and gateway
        0.0.0.0 which means 192.168.100.0/22 is directly reachable on the link.
        The second route has destination 44.100.100.100/22 and gateway
        192.168.100.1. The third route has destination 129.210.177.132/25 and
        gateway 1.1.1.1.</p>
  </dd>
  <dt><b class="Sy">dhcp_ldap_url</b></dt>
  <dd>The default LDAP URL (option code 95).</dd>
  <dt><b class="Sy">dhcp_netinfo_server_address</b></dt>
  <dd>The NetInfo parent server IP address(es) (option code 112).</dd>
  <dt><b class="Sy">dhcp_netinfo_server_tag</b></dt>
  <dd>The NetInfo parent domain tag (option code 113).</dd>
  <dt><b class="Sy">dhcp_url</b></dt>
  <dd>The default URL to present in a web browser (option code 114).</dd>
  <dt><b class="Sy">dhcp_time_offset</b></dt>
  <dd>The time offset from GMT in seconds (option code 2).</dd>
  <dt><b class="Sy">dhcp_network_time_protocol_servers</b></dt>
  <dd>The network time protocol (NTP) server IP address(es) (option code
    42).</dd>
  <dt><b class="Sy">dhcp_nb_over_tcpip_name_server</b></dt>
  <dd>The NetBIOS over TCP/IP name server IP address(es) (option code 44).</dd>
  <dt><b class="Sy">dhcp_nb_over_tcpip_dgram_dist_server</b></dt>
  <dd>The NetBIOS over TCP/IP datagram distribution server IP address(es)
      (option code 45).</dd>
  <dt><b class="Sy">dhcp_nb_over_tcpip_node_type</b></dt>
  <dd>The NetBIOS over TCP/IP node type (option code 46).</dd>
  <dt><b class="Sy">dhcp_nb_over_tcpip_scope</b></dt>
  <dd>The NetBIOS over TCP/IP scope string (option code 47).</dd>
  <dt><b class="Sy">dhcp_smtp_server</b></dt>
  <dd>The Simple Mail Transport Protocol (SMTP) server IP address(es) (option
      code 69).</dd>
  <dt><b class="Sy">dhcp_pop3_server</b></dt>
  <dd>The Post Office Protocol (POP3) server IP address(es) (option code
    70).</dd>
  <dt><b class="Sy">dhcp_nntp_server</b></dt>
  <dd>The Network News Transport Protocol (NNTP) server IP address(es) (option
      code 71).</dd>
  <dt><b class="Sy">dhcp_proxy_auto_discovery_url</b></dt>
  <dd>The default Web Proxy Auto Discovery URL (option code 252).</dd>
</dl>
<p class="Pp">DHCP options may also be specified using the naming
  convention:</p>
<pre>
	dhcp_option_<i>option_code</i>
</pre>
replacing <i>option_code</i> with a numeric value in the range of 1 through 254.
  For example, to specify option code 128, specify a property named
  <b>dhcp_option_128</b>.
<p class="Pp"><code class="Nm">bootpd</code> has a built-in type conversion
    table for many more options, mostly those specified in RFC 2132, and will
    try to convert from whatever type the option appears in the property list to
    the binary, packet format. For example, if <code class="Nm">bootpd</code>
    knows that the type of the option is an IP address or list of IP addresses,
    it converts from the string form of the IP address to the binary, network
    byte order numeric value.</p>
<p class="Pp">If the type of the option is a numeric value, it converts from
    string, integer, or boolean, to the proper sized, network byte-order numeric
    value.</p>
<p class="Pp">Regardless of whether <code class="Nm">bootpd</code> knows the
    type of the option or not, you can always specify the DHCP option using the
    <i>data</i> property list type e.g.:</p>
<pre>
	&lt;key&gt;dhcp_option_128&lt;/key&gt;
	&lt;data&gt;
	AAqV1Tzo
	&lt;/data&gt;
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="NetBoot_Server_Controls"><a class="permalink" href="#NetBoot_Server_Controls">NetBoot
  Server Controls</a></h2>
The &quot;NetBoot&quot; property in <i>/etc/bootpd.plist</i> is encoded as a
  dictionary, and may contain a number of properties that alter the NetBoot
  server's default behavior. The properties are:
<dl class="Bl-tag">
  <dt><b class="Sy">afp_uid_start</b></dt>
  <dd>(Integer) The starting uid used when creating AFP machine users. The
      default is uid 100.</dd>
  <dt><b class="Sy">afp_users_max</b></dt>
  <dd>(Integer) The number of AFP machine users to automaticaly create. The
      default is 50. Note: the server will never remove a user once it is
      created, so decreasing this value once the server has read it will have no
      effect.</dd>
  <dt><b class="Sy">age_time_seconds</b></dt>
  <dd>(Integer) The number of seconds since the client last netbooted before
      before the client is considered &quot;aged&quot;. A client that has aged
      becomes
    <br/>
     available for resource reclamation. The server will only reclaim aged
      client bindings when it runs out of free resources.</dd>
  <dt><b class="Sy">machine_name_format</b></dt>
  <dd>(String) This property is used to generate a unique name to each NetBoot
      client. The default value is &quot;NetBoot%03d&quot; (without the double
      quotes). The format string must be a <a class="Xr">printf(3)</a>
      compatible format string that takes a single integer value as an argument.
      The server ensures that the string is valid by testing the string before
      using it. The only conversion specifiers that should be used are
      <b>diouxX</b>.</dd>
  <dt><b class="Sy">shadow_size_meg</b></dt>
  <dd>(Integer) The size (in megabytes) to allocate for the client shadow file.
      The default is 48 (megabytes). See <a class="Xr">Diskless Resources</a>
      below.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="BOOTP/DHCP_STATIC_BINDINGS"><a class="permalink" href="#BOOTP/DHCP_STATIC_BINDINGS">BOOTP/DHCP
  STATIC BINDINGS</a></h1>
Static IP address to ethernet address bindings are stored in the
  <i>/etc/bootptab</i> file and in <b>Open Directory</b>. Bindings specified in
  the <i>/etc/bootptab</i> file take precedence over those in <b>Open
  Directory</b>.
<p class="Pp">See <a class="Xr">bootptab(5)</a> for more information about the
    <i>/etc/bootptab</i> file.</p>
<p class="Pp">For <b>Open Directory</b>, <code class="Nm">bootpd</code> looks at
    the /Computers records for the following properties:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">ENetAddress</b></dt>
  <dd>(String) The ethernet MAC address(es) of the computer. Each address must
      be of the form xx:xx:xx:xx:xx:xx using only the characters
      0123456789abcdef. Leading zeros must be specified.</dd>
  <dt><b class="Sy">IPAddress</b></dt>
  <dd>(String) The IP address(es) of the computer.</dd>
  <dt><b class="Sy">IPAddressAndENetAddress</b></dt>
  <dd>(String) Pairs of IP and Ethernet MAC addresses of the computer. Each
      address pair consists of an single IP and MAC address separated by a slash
      character, e.g. &quot;192.168.1.1/01:23:45:67:89:ab&quot;. This attribute
      should be provided when multiple addresses are provided because not all
      directories return attribute values in a guaranteed order.</dd>
  <dt><b class="Sy">BootFile</b></dt>
  <dd>(String) The bootfile to use for this computer.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="DHCP_SERVICE"><a class="permalink" href="#DHCP_SERVICE">DHCP
  SERVICE</a></h1>
If DHCP service is enabled for a client, the server processes the client's
  packet. The packet may be a request for an IP address and option information
  (DHCP Discover, DHCP Request) or for just option information (DHCP Inform).
  The packet might also tell the server that the address is in use by some other
  host (DHCP Decline), or that the client is done with the IP address (DHCP
  Release).
<p class="Pp">The server uses the DHCP client identifier (option 61) if it is
    present as the unique client identifier, otherwise it uses the
    htype/hlen/chaddr fields in the DHCP packet.</p>
<section class="Ss">
<h2 class="Ss" id="IP_Allocation"><a class="permalink" href="#IP_Allocation">IP
  Allocation</a></h2>
The DHCP server first tries to find a static binding for the client (see section
  <a class="Xr">BOOTP/DHCP STATIC BINDINGS</a> above). If one exists, it uses
  it. If not, it tries to find an existing dynamic binding from its lease
  database, stored in /var/db/dhcpd_leases. If one exists and it is applicable
  to the subnet, the server uses it, otherwise, it tries to allocate an address
  from one of its address pools. If an address is available, the server uses it,
  otherwise the packet is discarded.
<p class="Pp">After a suitable IP address is found for the client, the server
    attempts to insert as many of the requested DHCP options from the client's
    request as it can into the reply.</p>
<p class="Pp">When the server allocates an address dynamically, it automatically
    excludes addresses that appear in static host entries. For example, if the
    address range goes from 10.0.0.2 through 10.0.0.10, but there is a static
    entry that specifies 10.0.0.3, that address is automatically excluded from
    the pool.</p>
<p class="Pp">The server tries to give the same address back to a client by
    remembering the binding even after it has expired. The server removes an
    expired lease entry only when it runs out of addresses, and needs to reclaim
    an address in order to fulfill a new request.</p>
<p class="Pp">When the server receives a DHCP Release packet, it sets the
    expiration for that lease to now, so that it can immediately reclaim the
    address if needed.</p>
<p class="Pp">When the server receives a DHCP Decline packet, it removes the
    client binding from the IP address, and sets the expiration on the
    &quot;unbound&quot; lease to 10 minutes from now. That allows the address to
    return to the address pool again without manual intervention and avoids
    handing out the same in-use IP address over and over.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="NETBOOT_SERVICE"><a class="permalink" href="#NETBOOT_SERVICE">NETBOOT
  SERVICE</a></h1>
The NetBoot server enables a client to perform a network boot, that is, access
  its operating system image over the network instead of from its local drive.
<p class="Pp">The sequence of events that occur when a NetBoot client is powered
    are:</p>
<dl class="Bl-tag">
  <dt>1.</dt>
  <dd>firmware gets IP address and image information (using BOOTP, or
    BSDP/DHCP)</dd>
  <dt>2.</dt>
  <dd>firmware saves relevant packet(s) in memory to be used by client operating
      system (see step 4 below)</dd>
  <dt>3.</dt>
  <dd>firmware TFTP's the bootfile image, and begins executing it</dd>
  <dt>3.1.</dt>
  <dd>(Mac OS X only) secondary loader TFTP's kernel and drivers, and begins
      executing the kernel</dd>
  <dt>4.</dt>
  <dd>client operating system initializes its network stack and accesses its
      &quot;root&quot; disk using information in packets saved at step 2, uses
      AFP, NFS, or HTTP to access the image</dd>
</dl>
<p class="Pp">Apple NetBoot uses a technique called &quot;shadowing&quot;,
    whereby an otherwise read-only disk image appears to the client as a
    read/write image by &quot;mapping&quot; writes to the original image file to
    an auxilliary &quot;shadow&quot; file. Subsequent reads from portions that
    have been written also come from the &quot;shadow&quot; file. The disk image
    driver in the client operating system manages the shadow mapping and
    provides the illusion of a writable disk.</p>
<p class="Pp">The term diskless NetBoot implies that the client receives all of
    its necessary booting resources from the network, so that a local disk drive
    is not required, though may still be present.</p>
<p class="Pp">The NetBoot server supplies a NetBoot client with the resources
    and information it needs to boot. Two versions of NetBoot are supported:
    NetBoot 1.0 (BOOTP-based) and NetBoot 2.0 (BSDP/DHCP-based). Service for
    these two types of NetBoot are controlled individually using command-line
    options <b>m</b> and <b>N</b>, or using the service configuration properties
    <b>old_netboot_enabled</b> and <b>netboot_enabled</b> (described above).</p>
<p class="Pp">The NetBoot 1.0 server supplies the client with its IP address in
    addition to its boot resources. The server must be able to find a static
    binding for the client (see <a class="Xr">BOOTP/DHCP STATIC BINDINGS</a>
    above), or the server must have an applicable dynamic pool of IP addresses,
    just as with DHCP. If the server does not also have DHCP service enabled,
    the pools are only used for NetBoot 1.0 clients. In this case, the server
    also acts as a DHCP server but only services those clients for which it has
    an existing binding.</p>
<p class="Pp">There can only be one NetBoot 1.0 server per subnet because the
    protocol uses BOOTP, and BOOTP does not support multiple servers. However,
    the NetBoot 1.0 server will co-exist with an existing DHCP server, assuming
    it only serves DHCP.</p>
<p class="Pp">The NetBoot 2.0 server only supplies the client with boot
    resources. Unlike NetBoot 1.0, there is no limit on the number of NetBoot
    servers per subnet.</p>
<p class="Pp">The NetBoot server stores a list of NetBoot client records in the
    file /var/db/bsdpd_clients. Each client record contains the client name and
    number assigned by the server, the boot image ID selected by the client, and
    the client's last boot time.</p>
<section class="Ss">
<h2 class="Ss" id="NetBoot_Image_Location"><a class="permalink" href="#NetBoot_Image_Location">NetBoot
  Image Location</a></h2>
When the NetBoot server initializes, it looks for NetBoot images at well-known
  locations in the file system. A &quot;NetBoot image&quot; is a directory that
  ends in the .nbi extension, and contains a valid set of files (described
  below). If no images are found, NetBoot is temporarily disabled. If it
  receives a SIGHUP signal, the server again attempts to initialize itself.
<p class="Pp">The NetBoot server looks for a symbolic link named:</p>
<p class="Pp"></p>
<pre>
    Library/NetBoot/.sharepoint
</pre>
<p class="Pp">at the root of each local volume. If the symlink is valid, and
    points to a directory, it assumes that the directory contains NetBoot images
    and that the contents are accessible via TFTP, AFP, NFS, and HTTP. By
    convention, the directory is named:</p>
<p class="Pp"></p>
<pre>
    Library/NetBoot/NetBootSPx
</pre>
<p class="Pp">where x is a unique number starting at zero (0).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="NetBoot_Image_(.nbi)"><a class="permalink" href="#NetBoot_Image_(.nbi)">NetBoot
  Image (.nbi)</a></h2>
A NetBoot Image is stored in a directory whose name ends with .nbi, and contains
  a set of files. The directory must contain an NBImageInfo.plist file, one or
  more bootfiles, and may contain one or more image files. The NBImageInfo.plist
  file is encoded as an XML property list, and contains information about the
  image.
<p class="Pp">The properties defined in the NBImageInfo.plist file and their
    meanings are:</p>
<dl class="Bl-tag">
  <dt><b class="Sy">Name</b></dt>
  <dd>(String) The name of the image that appears in the Startup Disk UI.</dd>
  <dt><b class="Sy">BootFile</b></dt>
  <dd>(String) The path of the first bootfile, relative to either the .nbi
      directory (for architecture &quot;ppc&quot; only), or a sub-directory of
      the .nbi directory. The sub-directory names correspond to the
      <b>Architectures</b> that the NetBoot Image supports. See also the
      <b>Architectures</b> property below.</dd>
  <dt><b class="Sy">IsEnabled</b></dt>
  <dd>(Boolean) A flag to mark the image as enabled or not. An image that is
      disabled will not be offered as a selection by the NetBoot server.
      Optional, default value is true.</dd>
  <dt><b class="Sy">IsDefault</b></dt>
  <dd>(Boolean) A flag to mark the image as a default image. Setting this key to
      true for more than one image can be useful if the
      <b class="Sy">EnabledSystemIdentifiers</b> property is also defined (see
      below). Optional, default value is false.</dd>
  <dt><b class="Sy">IsInstall</b></dt>
  <dd>(Boolean) A flag to indicate that the image describes an installation
      image. Optional, default value is false.</dd>
  <dt><b class="Sy">Type</b></dt>
  <dd>(String) The expected image contents and the mechanism used to supply
      images to the client. The defined values are:
    <dl class="Bl-tag">
      <dt>Classic</dt>
      <dd>After downloading the boot file via TFTP, the client OS accesses its
          images via AFP. The <b>SharedImage</b> and <b>PrivateImage</b>
          properties (defined below) specify the images to use.</dd>
      <dt>NFS</dt>
      <dd>After downloading the boot files via TFTP, the client OS accesses its
          &quot;root&quot; filesystem via NFS. The <b>RootPath</b> property
          (detailed below) specifies the path.</dd>
      <dt>HTTP</dt>
      <dd>After downloading the boot files via TFTP, the client accesses its
          &quot;root&quot; filesystem via HTTP. The <b>RootPath</b> property
          (detailed below) specifies the path.</dd>
      <dt>BootFileOnly</dt>
      <dd>The client downloads the boot file(s), and does not require any
          additional boot image information.</dd>
    </dl>
  </dd>
  <dt><b class="Sy">Kind</b></dt>
  <dd>(Integer) The defined image kind values are:
    <dl class="Bl-tag Bl-compact">
      <dt>0 =</dt>
      <dd>Mac OS 9</dd>
      <dt>1 =</dt>
      <dd>Mac OS X</dd>
      <dt>2 =</dt>
      <dd>Mac OS X Server</dd>
      <dt>3 =</dt>
      <dd>Hardware Diagnostics</dd>
    </dl>
    <p class="Pp">The default <b>Kind</b> is determined from the
      <b>Type</b>:</p>
    <p class="Pp"></p>
    <dl class="Bl-tag Bl-compact">
      <dt><b>Type</b></dt>
      <dd><b>Default Kind</b></dd>
      <dt>Classic</dt>
      <dd>0 - Mac OS 9</dd>
      <dt>NFS</dt>
      <dd>1 - Mac OS X</dd>
      <dt>HTTP</dt>
      <dd>1 - Mac OS X</dd>
      <dt>BootFileOnly</dt>
      <dd>none</dd>
    </dl>
    <p class="Pp">The <b>Kind</b> must be specified if the <b>Type</b> is
        <b>BootFileOnly</b>.</p>
  </dd>
  <dt><b class="Sy">Index</b></dt>
  <dd>(Integer) The index of the image. This is a 16-bit value used to
      differentiate between multiple NetBoot images supplied by a server. There
      are two value ranges:
    <dl class="Bl-tag Bl-compact">
      <dt>1 .. 4095</dt>
      <dd>Image is local to this server.</dd>
      <dt>4096 .. 65535</dt>
      <dd>Image is global and may appear on multiple servers, used for
          load-balancing.</dd>
    </dl>
    <p class="Pp">The <b>Index</b> forms the lower 16-bits of the unique 32-bit
        Image ID. <b>IsInstall</b> and <b>Kind</b> make up the remaining bits
        (with 8 bits reserved).</p>
  </dd>
  <dt><b class="Sy">RootPath</b></dt>
  <dd>(String) If Type is &quot;NFS&quot;, this is the path of the
      &quot;root&quot; disk image relative to the .nbi directory. The NetBoot
      server assumes that the path up to and including the NetBootSPx directory
      is exported via NFS. Indirect NFS paths are also supported using the
      syntax:
    <p class="Pp"></p>
    <pre>
    &lt;path&gt; = &lt;host&gt;:&lt;mount_path&gt;[:&lt;image_path&gt;]
    &lt;host&gt; = &lt;IP address&gt; | &lt;host_name&gt;
    </pre>
    <p class="Pp">For example, in the path:</p>
    <p class="Pp"></p>
    <pre>
    myserver:/NetBoot:Images/Jaguar.dmg
    </pre>
    <p class="Pp">the image is on a server named &quot;myserver&quot; with NFS
        export &quot;/NetBoot&quot; and the image file appears relative to the
        mount point as &quot;Images/Jaguar.dmg&quot;.</p>
    <p class="Pp">If Type is &quot;HTTP&quot;, this is the path of the
        &quot;root&quot; disk image relative to the .nbi directory. The NetBoot
        server assumes that the .nbi directory under NetBootSPx is exported via
        HTTP using the convention:</p>
    <p class="Pp"></p>
    <pre>
    http://&lt;server_ip&gt;/NetBoot/NetBootSPx/&lt;image_dir&gt;.nbi
    </pre>
    <p class="Pp">Indirect HTTP paths are also supported using the HTTP URL
        syntax:</p>
    <p class="Pp"></p>
    <pre>
    &lt;path&gt; = http://[&lt;user&gt;@]&lt;host&gt;[:&lt;port&gt;]/&lt;image_path&gt;
    &lt;user&gt; = &lt;user_name&gt;:&lt;password&gt;
    &lt;host&gt; = &lt;IP address&gt; | &lt;host_name&gt;
    </pre>
    <p class="Pp">Examples:</p>
    <p class="Pp"></p>
    <pre>
    http://myserver:8080/Images/Jaguar.dmg
    http://joe:secret@someserver/Jaguar/Jaguar.dmg
    </pre>
  </dd>
  <dt><b class="Sy">SharedImage</b></dt>
  <dd>(String) If Type is &quot;Classic&quot;, this is the path of the
      read/write system disk image used for Mac OS 9.</dd>
  <dt><b class="Sy">PrivateImage</b></dt>
  <dd>(String) If Type is &quot;Classic&quot;, this is the path of the read-only
      private disk image used to store additional applications for Mac OS 9.
      Optional.</dd>
  <dt><b class="Sy">SupportsDiskless</b></dt>
  <dd>(Boolean) A flag that indicates that the image supports diskless clients,
      and tells the server to allocate resources. If the Type is
      &quot;Classic&quot;, the value of this property is ignored since the
      server always allocates resources required for diskless clients. See
      Diskless Resources below.</dd>
  <dt><b class="Sy">EnabledSystemIdentifiers</b></dt>
  <dd>(Array of String) The list of system identifiers that are enabled for this
      image. The system identifier for Apple hardware is the model property from
      the Open Firmware device-tree. Some example model properties are
      &quot;PowerMac3,3&quot; and &quot;PowerBook3,1&quot;.
    <p class="Pp">If this property is not specified, or the list is empty, the
        image is enabled for all clients (the default).</p>
    <p class="Pp">If the server has no images that apply to the client, it will
        not respond.</p>
    <p class="Pp">Due to limitations in the NetBoot 1.0 protocol, there is no
        way for the NetBoot server to differentiate between older clients such
        as the original bondi-blue iMac or B&amp;W G3 (Yosemite). To enable an
        image for all NetBoot 1.0 clients, include the pseudo system identifier
        &quot;/NetBoot1&quot;.</p>
  </dd>
  <dt><b class="Sy">Architectures</b></dt>
  <dd>(Array of String) The list of architectures that this image supports.
      Optional, implicit value is an array with a single value &quot;ppc&quot;.
    <p class="Pp">The NetBoot server uses the following logic in conjunction
        with the (explicit or implicit) value of the <b>Architectures</b>
        property and the <b>BootFile</b> property:</p>
    <p class="Pp"></p>
    <pre>
bootfile = plist.BootFile.string
for i = 0; i &lt; plist.Architectures.array.count; i++
    arch = plist.Architectures.array.value[i].string
    if $arch/$bootfile exists
        use $arch/$bootfile
    else if $arch == &quot;ppc&quot; and $bootfile exists
        use $bootfile
    else
        reject this image
    </pre>
    <p class="Pp">That is, for each <i>architecture</i> in the
        <b>Architectures</b> list look for a sub-directory of the .nbi directory
        named <i>architecture</i>. If the <b>BootFile</b> exists within that
        directory, continue with the next <i>architecture</i>. Otherwise, if the
        <i>architecture</i> is &quot;ppc&quot;, and the <b>BootFile</b> exists
        directly within the .nbi directory, continue with the next
        <i>architecture</i>. Otherwise, reject the image. If all
        <b>Architectures</b> have a valid <b>BootFile</b>, accept the image.</p>
    <p class="Pp">This logic allows a single-architecture, &quot;ppc&quot;-only
        NetBoot Image to work as before. The directory structure ensures that a
        NetBoot Image that only supports non-&quot;ppc&quot; architectures will
        be rejected by a NetBoot server that doesn't understand the
        <b>Architectures</b> property. This is important because older NetBoot
        servers only serve &quot;ppc&quot; images, and they must not mistakenly
        serve a non-&quot;ppc&quot; image to a &quot;ppc&quot; client.</p>
  </dd>
  <dt><b class="Sy">EnabledMACAddresses</b></dt>
  <dd>(Array of String) The exclusive list of MAC addresses for which this image
      is enabled. A client whose MAC address is on this list may be offered this
      image, subject to any other filtering that might be in effect, e.g. the
      <b>Architectures</b> and <b>EnabledSystemIdentifiers</b> properties. If
      this property is not specified, image MAC address filtering is subject
      only to the <b>DisabledMACAddresses</b> property, if specified. If this
      property is defined but the array is empty, the image is disabled.</dd>
  <dt><b class="Sy">DisabledMACAddresses</b></dt>
  <dd>(Array of String) The list of MAC addresses for which this image is
      disabled. A client whose MAC address is on this list will not be offered
      this image. Defining both this property and the <b>EnabledMACAddresses</b>
      property at the same time is not generally useful, but this property takes
      precedence. That is, if a client's MAC address appears in both lists, it
      is disabled.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="NetBoot_Image_Example:_Mac_OS_9"><a class="permalink" href="#NetBoot_Image_Example:_Mac_OS_9">NetBoot
  Image Example: Mac OS 9</a></h2>
The path to the image directory in this example is:
<pre>
    /Library/NetBoot/NetBootSP0/Mac OS 9.nbi
</pre>
<p class="Pp">This directory contains the following files:</p>
<pre>
    NBImageInfo.plist
    Mac OS ROM
    NetBoot HD.img
    Applications HD.img
</pre>
<p class="Pp">The NBImageInfo.plist contains:</p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist SYSTEM &quot;file://localhost/System/Library/DTDs/PropertyList.dtd&quot;&gt;
&lt;plist version=&quot;0.9&quot;&gt;
&lt;dict&gt;
        &lt;key&gt;BootFile&lt;/key&gt;
        &lt;string&gt;Mac OS ROM&lt;/string&gt;
        &lt;key&gt;IsEnabled&lt;/key&gt;
        &lt;true/&gt;
        &lt;key&gt;Index&lt;/key&gt;
        &lt;integer&gt;4&lt;/integer&gt;
        &lt;key&gt;IsInstall&lt;/key&gt;
        &lt;false/&gt;
        &lt;key&gt;Name&lt;/key&gt;
        &lt;string&gt;Mac OS 9.2&lt;/string&gt;
        &lt;key&gt;SharedImage&lt;/key&gt;
        &lt;string&gt;NetBoot HD.img&lt;/string&gt;
        &lt;key&gt;PrivateImage&lt;/key&gt;
        &lt;string&gt;Applications HD.img&lt;/string&gt;
        &lt;key&gt;Type&lt;/key&gt;
        &lt;string&gt;Classic&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</pre>
<p class="Pp">The Type is Classic, which means this is a Mac OS 9 NetBoot image,
    so the implied Kind value is 0 (Mac OS 9). The BootFile property points to
    &quot;Mac OS ROM&quot;. The system image is &quot;NetBoot HD.img&quot;. The
    read-only applications image is &quot;Applications HD.img&quot;. The Name of
    the image is &quot;Mac OS 9.2&quot;. IsEnabled is supplied and set to true,
    so the image is active. The Index is 4, which means the image is local to
    this server, and will always appear as a unique choice in the client image
    selection UI.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="NetBoot_Image_Example:_Mac_OS_X"><a class="permalink" href="#NetBoot_Image_Example:_Mac_OS_X">NetBoot
  Image Example: Mac OS X</a></h2>
The path to this example is:
<pre>
    /Library/NetBoot/NetBootSP0/Jaguar.nbi
</pre>
<p class="Pp">This directory contains:</p>
<pre>
    NBImageInfo.plist
    booter
    mach.macosx
    mach.macosx.mkext
    Jaguar.dmg
</pre>
<p class="Pp">The NBImageInfo.plist contains:</p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist SYSTEM &quot;file://localhost/System/Library/DTDs/PropertyList.dtd&quot;&gt;
&lt;plist version=&quot;0.9&quot;&gt;
&lt;dict&gt;
        &lt;key&gt;BootFile&lt;/key&gt;
        &lt;string&gt;booter&lt;/string&gt;
        &lt;key&gt;IsEnabled&lt;/key&gt;
        &lt;true/&gt;
        &lt;key&gt;Index&lt;/key&gt;
        &lt;integer&gt;4096&lt;/integer&gt;
        &lt;key&gt;IsInstall&lt;/key&gt;
        &lt;false/&gt;
        &lt;key&gt;Name&lt;/key&gt;
        &lt;string&gt;Mac OS X (Jaguar)&lt;/string&gt;
        &lt;key&gt;RootPath&lt;/key&gt;
        &lt;string&gt;Jaguar.dmg&lt;/string&gt;
        &lt;key&gt;Type&lt;/key&gt;
        &lt;string&gt;NFS&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</pre>
<p class="Pp">The Type is NFS, and no Kind is specified, so the server assumes
    this is a Mac OS X image with Kind 1. The BootFile property points to
    &quot;booter&quot;. Mac OS X uses three separate bootfiles, so the remaining
    files which must exist, but are not currently verified to exist by the
    server, are &quot;mach.macosx&quot; and &quot;mach.macosx.mkext&quot;. Those
    names are non-negotiable, since the booter hard-codes those names. The
    RootPath property indicates that the image file is &quot;Jaguar.dmg&quot;.
    The Index is 4096, so this is a global image, that may appear on multiple
    NetBoot servers. If another server serves an image of the same Kind,
    IsInstall, and Index, this image may appear as a single choice in client
    image selection UI.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="NetBoot_Image_Example:_Mac_OS_X_with_Multiple_Architectures"><a class="permalink" href="#NetBoot_Image_Example:_Mac_OS_X_with_Multiple_Architectures">NetBoot
  Image Example: Mac OS X with Multiple Architectures</a></h2>
The path to this example is:
<pre>
    /Library/NetBoot/NetBootSP0/Tiger.nbi
</pre>
<p class="Pp">This directory contains:</p>
<pre>
    NBImageInfo.plist
    booter
    mach.macosx
    mach.macosx.mkext
    i386/
        booter
        mach.macosx
        mach.macosx.mkext
    Tiger.dmg
</pre>
<p class="Pp">The NBImageInfo.plist contains:</p>
<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist SYSTEM &quot;file://localhost/System/Library/DTDs/PropertyList.dtd&quot;&gt;
&lt;plist version=&quot;0.9&quot;&gt;
&lt;dict&gt;
        &lt;key&gt;Architectures&lt;/key&gt;
        &lt;array&gt;
                &lt;string&gt;i386&lt;/string&gt;
                &lt;string&gt;ppc&lt;/string&gt;
        &lt;/array&gt;
        &lt;key&gt;BootFile&lt;/key&gt;
        &lt;string&gt;booter&lt;/string&gt;
        &lt;key&gt;IsInstall&lt;/key&gt;
        &lt;true/&gt;
        &lt;key&gt;IsEnabled&lt;/key&gt;
        &lt;true/&gt;
        &lt;key&gt;Index&lt;/key&gt;
        &lt;integer&gt;5000&lt;/integer&gt;
        &lt;key&gt;Name&lt;/key&gt;
        &lt;string&gt;Mac OS X (Tiger)&lt;/string&gt;
        &lt;key&gt;RootPath&lt;/key&gt;
        &lt;string&gt;Tiger.dmg&lt;/string&gt;
        &lt;key&gt;Type&lt;/key&gt;
        &lt;string&gt;NFS&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</pre>
<p class="Pp">This example shows how a NetBoot Image that supports multiple
    architectures is configured. The bootfiles for &quot;ppc&quot; reside
    directly within the .nbi directory, whereas the bootfiles for
    &quot;i386&quot; reside within a sub-directory of the .nbi directory named
    &quot;i386&quot;. This image is a Mac OS X installation image that is served
    over NFS.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Diskless_Resources"><a class="permalink" href="#Diskless_Resources">Diskless
  Resources</a></h2>
The NetBoot server creates and manages per-client AFP user logins as well as
  per-client directories to give each client its own protected resources. The
  AFP users are created on the local system with the attribute <i>_creator</i>
  set to <i>bsdpd</i>.
<p class="Pp">When the server initializes, it ensures there are at least
    <b>afp_users_max</b> users with this property. If there are not, it
    allocates new user entries to make up the difference.</p>
<p class="Pp">Along with the per-client AFP login, the server creates per-client
    directories to store the &quot;shadow&quot; files. The server creates these
    directories on each local volume that contains a symbolic link named:</p>
<p class="Pp"></p>
<pre>
    Library/NetBoot/.clients
</pre>
<p class="Pp">at the root of the volume. If the symlink is valid, and points to
    a directory, it assumes that the directory should be used for client files.
    It also assumes that the directory is a valid AFP sharepoint of the same
    name. By convention, the directory is named:</p>
<p class="Pp"></p>
<pre>
    Library/NetBoot/NetBootClientsY
</pre>
<p class="Pp">where Y is a unique number starting at zero (0).</p>
<p class="Pp">The server &quot;round-robins&quot; client files across each such
    directory to distribute load amongst multiple disk drives to improve overall
    performance.</p>
<p class="Pp">When the server responds to the client's NetBoot request, it
    ensures that the &quot;shadow&quot; file is preallocated to
    <b>shadow_size_meg</b> megabytes. Setting that property high enough avoids
    having every client fail if the server runs out of disk space. The only
    clients that fail if the server runs out of disk space are those that run of
    of space in their own pre-allocated &quot;shadow&quot; files.</p>
<p class="Pp">Note: the server allocates shadow files for Mac OS 9 NetBoot
    clients only on local HFS volumes.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr">bootptab(5)</a>, <a class="Xr">xinetd(8)</a>,
  <a class="Xr">tftpd(8)</a>, <a class="Xr">exports(5)</a>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">April 8, 2014</td>
    <td class="foot-os">Mac OS X</td>
  </tr>
</table>
</body>
</html>
