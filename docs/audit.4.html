<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 2006 Robert N. M. Watson
   Copyright (c) 2009 Apple, Inc.
   All rights reserved.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
  
   THIS SOFTWARE IS PROVIDED BY THE AUTHORS AND CONTRIBUTORS ``AS IS'' AND
   ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
   ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHORS OR CONTRIBUTORS BE LIABLE
   FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
   OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
   HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
   LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
   OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
   SUCH DAMAGE.
  
   $FreeBSD: src/share/man/man4/audit.4,v 1.10 2006/12/14 16:40:57 mpp Exp $
   -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>AUDIT(4)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AUDIT(4)</td>
    <td class="head-vol">Device Drivers Manual</td>
    <td class="head-rtitle">AUDIT(4)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">audit</code> &#x2014; <span class="Nd">Security
    Event Audit</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="In">#include
    <a class="In">&lt;bsm/audit.h&gt;</a></code>
  <br/>
  <code class="In">#include
    <a class="In">&lt;bsm/audit_internal.h&gt;</a></code>
  <br/>
  <code class="In">#include
  <a class="In">&lt;bsm/audit_kevents.h&gt;</a></code></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Security Event Audit is a facility to provide fine-grained,
    configurable logging of security-relevant events, and is intended to meet
    the requirements of the Common Criteria (CC) Common Access Protection
    Profile (CAPP) evaluation. The <span class="Ux">FreeBSD</span> and Mac OS X
    <code class="Nm">audit</code> facility implements the de facto industry
    standard BSM API, file formats, and command line interface, first found in
    the Solaris operating system. Information on the user space implementation
    can be found in <a class="Xr">libbsm(3)</a>.</p>
<p class="Pp">Audit support is enabled at boot, if present in the kernel, using
    an <a class="Xr">rc.conf(5)</a> flag or, on Mac OS X, by editing the
    <span class="Pa">/System/Library/LaunchDaemons/com.apple.auditd.plist</span>
    launchd plist file and removing the disabled key or changing its value to
    false. The audit daemon, <a class="Xr">auditd(8)</a>, is responsible for
    configuring the kernel to perform <code class="Nm">audit</code>, pushing
    configuration data from the various audit configuration files into the
    kernel.</p>
<section class="Ss">
<h2 class="Ss" id="Audit_Special_Device"><a class="permalink" href="#Audit_Special_Device">Audit
  Special Device</a></h2>
<p class="Pp">The <span class="Ux">FreeBSD</span> kernel
    <code class="Nm">audit</code> facility provides a special device,
    <span class="Pa">/dev/audit</span>, which is used by
    <a class="Xr">auditd(8)</a> to monitor for <code class="Nm">audit</code>
    events, such as requests to cycle the log, low disk space conditions, and
    requests to terminate auditing. This device is not intended for use by
    applications. Mac OS X provides this same functionality using Mach IPC and a
    host special port.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Audit_Pipe_Special_Devices"><a class="permalink" href="#Audit_Pipe_Special_Devices">Audit
  Pipe Special Devices</a></h2>
<p class="Pp">Audit pipe special devices, discussed in
    <a class="Xr">auditpipe(4)</a>, provide a configurable live tracking
    mechanism to allow applications to tee the audit trail, as well as to
    configure custom preselection parameters to track users and events in a
    fine-grained manner.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr">auditreduce(1)</a>, <a class="Xr">praudit(1)</a>,
    <a class="Xr">audit(2)</a>, <a class="Xr">auditctl(2)</a>,
    <a class="Xr">auditon(2)</a>, <a class="Xr">getaudit(2)</a>,
    <a class="Xr">getauid(2)</a>, <a class="Xr">poll(2)</a>,
    <a class="Xr">select(2)</a>, <a class="Xr">setaudit(2)</a>,
    <a class="Xr">setauid(2)</a>, <a class="Xr">libbsm(3)</a>,
    <a class="Xr">auditpipe(4)</a>, <a class="Xr">audit_class(5)</a>,
    <a class="Xr">audit_control(5)</a>, <a class="Xr">audit_event(5)</a>,
    <a class="Xr">audit.log(5)</a>, <a class="Xr">audit_user(5)</a>,
    <a class="Xr">audit_warn(5)</a>, <a class="Xr">launchd.plist(5)</a>,
    <a class="Xr">rc.conf(5)</a>, <a class="Xr">audit(8)</a>,
    <a class="Xr">auditd(8)</a></p>
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
<p class="Pp">The OpenBSM implementation was created by McAfee Research, the
    security division of McAfee Inc., under contract to Apple Computer Inc. in
    2004. It was subsequently adopted by the TrustedBSD Project as the
    foundation for the OpenBSM distribution.</p>
<p class="Pp">Support for kernel <code class="Nm">audit</code> first appeared in
    Mac OS X 10.3 and <span class="Ux">FreeBSD 6.2</span>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp">This software was created by McAfee Research, the security
    research division of McAfee, Inc., under contract to Apple Computer Inc.
    Additional authors include <span class="An">Wayne Salamon</span>,
    <span class="An">Stacey Son</span>, <span class="An">Robert Watson</span>,
    and SPARTA Inc.</p>
<p class="Pp">The Basic Security Module (BSM) interface to audit records and
    audit event stream format were defined by Sun Microsystems.</p>
<p class="Pp">This manual page was written by <span class="An">Robert
    Watson</span> &#x27E8;rwatson@FreeBSD.org&#x27E9;.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">The <code class="Nm">audit</code> facility in
    <span class="Ux">FreeBSD</span> is considered experimental, and production
    deployment should occur only after careful consideration of the risks of
    deploying experimental software.</p>
<p class="Pp">The Mac OS X and <span class="Ux">FreeBSD</span> kernel do not
    fully validate that audit records submitted by user applications are
    syntactically valid BSM; as submission of records is limited to privileged
    processes, this is not a critical bug.</p>
<p class="Pp">Instrumentation of auditable events in the kernel is not complete,
    as some system calls do not generate audit records, or generate audit
    records with incomplete argument information.</p>
<p class="Pp">Mandatory Access Control (MAC) labels, as provided by the
    <a class="Xr">mac(4)</a> facility, are not audited as part of records
    involving MAC decisions.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">March 23, 2009</td>
    <td class="foot-os">Mac OS X 12</td>
  </tr>
</table>
</body>
</html>
