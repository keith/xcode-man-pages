<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 2008-2012 Apple Inc. All rights reserved.
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>dispatch_group_create(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">dispatch_group_create(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">dispatch_group_create(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">dispatch_group_create</code>,
  <code class="Nm">dispatch_group_async</code>,
  <code class="Nm">dispatch_group_wait</code>,
  <code class="Nm">dispatch_group_notify</code> &#x2014;
<div class="Nd">group blocks submitted to queues</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<code class="In">#include <a class="In">&lt;dispatch/dispatch.h&gt;</a></code>
<p class="Pp"><var class="Ft">dispatch_group_t</var>
  <br/>
  <code class="Fn">dispatch_group_create</code>(<var class="Fa">void</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">dispatch_group_enter</code>(<var class="Fa">dispatch_group_t
    group</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">dispatch_group_leave</code>(<var class="Fa">dispatch_group_t
    group</var>);</p>
<p class="Pp"><var class="Ft">long</var>
  <br/>
  <code class="Fn">dispatch_group_wait</code>(<var class="Fa">dispatch_group_t
    group</var>, <var class="Fa">dispatch_time_t timeout</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">dispatch_group_notify</code>(<var class="Fa">dispatch_group_t
    group</var>, <var class="Fa">dispatch_queue_t queue</var>,
    <var class="Fa">void (^block)(void)</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">dispatch_group_notify_f</code>(<var class="Fa">dispatch_group_t
    group</var>, <var class="Fa">dispatch_queue_t queue</var>,
    <var class="Fa">void *context</var>, <var class="Fa">void (*function)(void
    *)</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">dispatch_group_async</code>(<var class="Fa">dispatch_group_t
    group</var>, <var class="Fa">dispatch_queue_t queue</var>,
    <var class="Fa">void (^block)(void)</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">dispatch_group_async_f</code>(<var class="Fa">dispatch_group_t
    group</var>, <var class="Fa">dispatch_queue_t queue</var>,
    <var class="Fa">void *context</var>, <var class="Fa">void (*function)(void
    *)</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
A dispatch group is an association of one or more blocks submitted to dispatch
  queues for asynchronous invocation. Applications may use dispatch groups to
  wait for the completion of blocks associated with the group.
<p class="Pp">The <code class="Fn">dispatch_group_create</code>() function
    returns a new and empty dispatch group.</p>
<p class="Pp">The <code class="Fn">dispatch_group_enter</code>() and
    <code class="Fn">dispatch_group_leave</code>() functions update the number
    of blocks running within a group.</p>
<p class="Pp">The <code class="Fn">dispatch_group_wait</code>() function waits
    until all blocks associated with the <var class="Fa">group</var> have
    completed, or until the specified <var class="Fa">timeout</var> has elapsed.
    If the <var class="Fa">group</var> becomes empty within the specified amount
    of time, the function will return zero indicating success. Otherwise, a
    non-zero return code will be returned. When
    <var class="Va">DISPATCH_TIME_FOREVER</var> is passed as the
    <var class="Fa">timeout</var>, calls to this function will wait an unlimited
    amount of time until the group becomes empty and the return value is always
    zero.</p>
<p class="Pp">The <code class="Fn">dispatch_group_notify</code>() function
    provides asynchronous notification of the completion of the blocks
    associated with the <var class="Fa">group</var> by submitting the
    <var class="Fa">block</var> to the specified <var class="Fa">queue</var>
    once all blocks associated with the <var class="Fa">group</var> have
    completed. The system holds a reference to the dispatch group while an
    asynchronous notification is pending, therefore it is valid to release the
    <var class="Fa">group</var> after setting a notification block. The group
    will be empty at the time the notification block is submitted to the target
    queue. The group may either be released with
    <code class="Fn">dispatch_release</code>() or reused for additional
    operations.</p>
<p class="Pp">The <code class="Fn">dispatch_group_async</code>() convenience
    function behaves like so:</p>
<div class="Bd Pp">
<pre>
void
dispatch_group_async(dispatch_group_t group, dispatch_queue_t queue, dispatch_block_t block)
{
	dispatch_retain(group);
	dispatch_group_enter(group);
	dispatch_async(queue, ^{
		block();
		dispatch_group_leave(group);
		dispatch_release(group);
	});
}
</pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUE"><a class="permalink" href="#RETURN_VALUE">RETURN
  VALUE</a></h1>
The <code class="Fn">dispatch_group_create</code>() function returns NULL on
  failure and non-NULL on success.
<p class="Pp">The <code class="Fn">dispatch_group_wait</code>() function returns
    zero upon success and non-zero after the timeout expires. If the timeout is
    <var class="Va">DISPATCH_TIME_FOREVER</var>, then
    <code class="Fn">dispatch_group_wait</code>() waits forever and always
    returns zero.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="MEMORY_MODEL"><a class="permalink" href="#MEMORY_MODEL">MEMORY
  MODEL</a></h1>
Dispatch groups are retained and released via calls to
  <code class="Fn">dispatch_retain</code>() and
  <code class="Fn">dispatch_release</code>().
</section>
<section class="Sh">
<h1 class="Sh" id="FUNDAMENTALS"><a class="permalink" href="#FUNDAMENTALS">FUNDAMENTALS</a></h1>
The <code class="Fn">dispatch_group_async</code>() and
  <code class="Fn">dispatch_group_notify</code>() functions are wrappers around
  <code class="Fn">dispatch_group_async_f</code>() and
  <code class="Fn">dispatch_group_notify_f</code>() respectively.
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr">dispatch(3)</a>, <a class="Xr">dispatch_async(3)</a>,
  <a class="Xr">dispatch_object(3)</a>,
  <a class="Xr">dispatch_queue_create(3)</a>,
  <a class="Xr">dispatch_semaphore_create(3)</a>,
  <a class="Xr">dispatch_time(3)</a>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
In order to ensure deterministic behavior, it is recommended to call
  <code class="Fn">dispatch_group_wait</code>() only once all blocks have been
  submitted to the group. If it is later determined that new blocks should be
  run, it is recommended not to reuse an already-running group, but to create a
  new group.
<p class="Pp"><code class="Fn">dispatch_group_wait</code>() returns as soon as
    there are exactly zero <i class="Em">enqueued or running</i> blocks
    associated with a group (more precisely, as soon as every
    <code class="Fn">dispatch_group_enter</code>() call has been balanced by a
    <code class="Fn">dispatch_group_leave</code>() call). If one thread waits
    for a group while another thread submits new blocks to the group, then the
    count of associated blocks might momentarily reach zero before all blocks
    have been submitted. If this happens,
    <code class="Fn">dispatch_group_wait</code>() will return too early: some
    blocks associated with the group have finished, but some have not yet been
    submitted or run.</p>
<p class="Pp">However, as a special case, a block associated with a group may
    submit new blocks associated with its own group. In this case, the behavior
    is deterministic: a waiting thread will <i class="Em">not</i> wake up until
    the newly submitted blocks have also finished.</p>
<p class="Pp">All of the foregoing also applies to
    <code class="Fn">dispath_group_notify</code>() as well, with &quot;block to
    be submitted&quot; substituted for &quot;waiting thread&quot;.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">May 1, 2009</td>
    <td class="foot-os">Darwin</td>
  </tr>
</table>
</body>
</html>
