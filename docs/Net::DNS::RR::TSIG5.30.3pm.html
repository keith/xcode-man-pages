<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>Net::DNS::RR::TSIG(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Net::DNS::RR::TSIG(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Net::DNS::RR::TSIG(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">Net::DNS::RR::TSIG - DNS TSIG resource record</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>    use Net::DNS;
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Class for DNS Transaction Signature (TSIG) resource records.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="METHODS"><a class="permalink" href="#METHODS">METHODS</a></h1>
<p class="Pp">The available methods are those inherited from the base class
    augmented by the type-specific methods defined in this package.</p>
<p class="Pp">Use of undocumented package features or direct access to internal
    data structures is discouraged and could result in program termination or
    other unpredictable behaviour.</p>
<section class="Ss">
<h2 class="Ss" id="algorithm"><a class="permalink" href="#algorithm">algorithm</a></h2>
<pre>    $algorithm = $rr-&gt;algorithm;
    $rr-&gt;algorithm( $algorithm );
</pre>
<p class="Pp">A domain name which specifies the name of the algorithm.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="key"><a class="permalink" href="#key">key</a></h2>
<pre>    $rr-&gt;key( $key );
</pre>
<p class="Pp">Base64 representation of the key material.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="keybin"><a class="permalink" href="#keybin">keybin</a></h2>
<pre>    $rr-&gt;keybin( $keybin );
</pre>
<p class="Pp">Binary representation of the key material.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="time_signed"><a class="permalink" href="#time_signed">time_signed</a></h2>
<pre>    $time_signed = $rr-&gt;time_signed;
    $rr-&gt;time_signed( $time_signed );
</pre>
<p class="Pp">Signing time as the number of seconds since 1 Jan 1970 00:00:00
    UTC. The default signing time is the current time.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="fudge"><a class="permalink" href="#fudge">fudge</a></h2>
<pre>    $fudge = $rr-&gt;fudge;
    $rr-&gt;fudge( $fudge );
</pre>
<p class="Pp">&quot;fudge&quot; represents the permitted error in the signing
    time. The default fudge is 300 seconds.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="mac"><a class="permalink" href="#mac">mac</a></h2>
<pre>    $mac = $rr-&gt;mac;
</pre>
<p class="Pp">Returns the message authentication code (MAC) as a string of hex
    characters. The programmer must call the Net::DNS::Packet <b>data()</b>
    object method before this will return anything meaningful.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="macbin"><a class="permalink" href="#macbin">macbin</a></h2>
<pre>    $macbin = $rr-&gt;macbin;
    $rr-&gt;macbin( $macbin );
</pre>
<p class="Pp">Binary message authentication code (MAC).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="request_mac"><a class="permalink" href="#request_mac">request_mac</a></h2>
<pre>    $request_mac = $rr-&gt;request_mac;
    $rr-&gt;request_mac( $request_mac );
</pre>
<p class="Pp">Request message authentication code (MAC).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="request_macbin"><a class="permalink" href="#request_macbin">request_macbin</a></h2>
<pre>    $request_macbin = $rr-&gt;request_macbin;
    $rr-&gt;request_macbin( $request_macbin );
</pre>
<p class="Pp">Binary request message authentication code.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="continuation"><a class="permalink" href="#continuation">continuation</a></h2>
<pre>     $tsig-&gt;continuation(1);
</pre>
<p class="Pp">Flag which indicates continuation of a multi-message response.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="original_id"><a class="permalink" href="#original_id">original_id</a></h2>
<pre>    $original_id = $rr-&gt;original_id;
    $rr-&gt;original_id( $original_id );
</pre>
<p class="Pp">The message ID from the header of the original packet.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="error"><a class="permalink" href="#error">error</a></h2>
<pre>     $rcode = $tsig-&gt;error;
</pre>
<p class="Pp">Returns the RCODE covering TSIG processing. Common values are
    NOERROR, BADSIG, BADKEY, and BADTIME. See RFC 2845 for details.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="other"><a class="permalink" href="#other">other</a></h2>
<pre>    $other = $rr-&gt;other;
    $rr-&gt;other( $other );
</pre>
<p class="Pp">This field should be empty unless the error is BADTIME, in which
    case it will contain the server time as the number of seconds since 1 Jan
    1970 00:00:00 UTC.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="sig_function"><a class="permalink" href="#sig_function">sig_function</a></h2>
<pre>    sub signing_function {
        my ( $keybin, $data ) = @_;
        my $hmac = new Digest::HMAC( $keybin, 'Digest::MD5' );
        $hmac-&gt;add( $data );
        return $hmac-&gt;digest;
    }
    $tsig-&gt;sig_function( \&amp;signing_function );
</pre>
<p class="Pp">This sets the signing function to be used for this TSIG record.
    The default signing function is HMAC-MD5.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="sig_data"><a class="permalink" href="#sig_data">sig_data</a></h2>
<pre>     $sigdata = $tsig-&gt;sig_data($packet);
</pre>
<p class="Pp">Returns the packet packed according to RFC2845 in a form for
    signing. This is only needed if you want to supply an external signing
    function, such as is needed for TSIG-GSS.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="create"><a class="permalink" href="#create">create</a></h2>
<pre>    $tsig = create Net::DNS::RR::TSIG( $keyfile );
    $tsig = create Net::DNS::RR::TSIG( $keyfile,
                                        fudge =&gt; 300
                                        );
    $tsig = create Net::DNS::RR::TSIG( $keyname, $key );
</pre>
<p class="Pp">Returns a TSIG RR constructed using the parameters in the
    specified key file, which is assumed to have been generated by
    dnssec-keygen.</p>
<p class="Pp">The two argument form is supported for backward compatibility.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="verify"><a class="permalink" href="#verify">verify</a></h2>
<pre>    $verify = $tsig-&gt;verify( $data );
    $verify = $tsig-&gt;verify( $packet );
    $verify = $tsig-&gt;verify( $reply, $query );
</pre>
<p class="Pp">The boolean verify method will return true if the hash over the
    packet data conforms to the data in the TSIG itself</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="TSIG_Keys"><a class="permalink" href="#TSIG_Keys">TSIG
  Keys</a></h1>
<p class="Pp">TSIG keys are symmetric keys generated using dnssec-keygen:</p>
<p class="Pp"></p>
<pre>        $ dnssec-keygen -a HMAC-MD5 -b 160 -n HOST &lt;keyname&gt;
        The key will be stored as a private and public keyfile pair
        K&lt;keyname&gt;+157+&lt;keyid&gt;.private and K&lt;keyname&gt;+157+&lt;keyid&gt;.key
    where
        &lt;keyname&gt; is the DNS name of the key.
        &lt;keyid&gt; is the (generated) numerical identifier used to
        distinguish this key.
</pre>
<p class="Pp">Other algorithms may be substituted for HMAC-MD5 in the above
    example.</p>
<p class="Pp">It is recommended that the keyname be globally unique and
    incorporate the fully qualified domain names of the resolver and nameserver
    in that order. It should be possible for more than one key to be in use
    simultaneously between any such pair of hosts.</p>
<p class="Pp">Although the formats differ, the private and public keys are
    identical and both should be stored and handled as secret data.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Configuring_BIND_Nameserver"><a class="permalink" href="#Configuring_BIND_Nameserver">Configuring
  BIND Nameserver</a></h1>
<p class="Pp">The following lines must be added to the /etc/named.conf file:</p>
<p class="Pp"></p>
<pre>    key &lt;keyname&gt; {
        algorithm HMAC-MD5;
        secret &quot;&lt;keydata&gt;&quot;;
    };
</pre>
<p class="Pp">&lt;keyname&gt; is the name of the key chosen when the key was
    generated.</p>
<p class="Pp">&lt;keydata&gt; is the key string extracted from the generated key
    file.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ACKNOWLEDGMENT"><a class="permalink" href="#ACKNOWLEDGMENT">ACKNOWLEDGMENT</a></h1>
<p class="Pp">Most of the code in the Net::DNS::RR::TSIG module was contributed
    by Chris Turbeville.</p>
<p class="Pp">Support for external signing functions was added by Andrew
    Tridgell.</p>
<p class="Pp">TSIG verification, BIND keyfile handling and support for
    HMAC-SHA1, HMAC-SHA224, HMAC-SHA256, HMAC-SHA384 and HMAC-SHA512 functions
    was added by Dick Franks.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">A 32-bit representation of time is used, contrary to RFC2845 which
    demands 48 bits. This design decision will need to be reviewed before the
    code stops working on 7 February 2106.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp">Copyright (c)2002 Michael Fuhr.</p>
<p class="Pp">Portions Copyright (c)2002-2004 Chris Reinhardt.</p>
<p class="Pp">Portions Copyright (c)2013 Dick Franks.</p>
<p class="Pp">All rights reserved.</p>
<p class="Pp">This program is free software; you may redistribute it and/or
    modify it under the same terms as Perl itself.</p>
<p class="Pp">Package template (c)2009,2012 O.M.Kolkman and R.W.Franks.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">perl, Net::DNS, Net::DNS::RR, RFC2845, RFC4635</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2014-01-16</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
