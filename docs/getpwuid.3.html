<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 1988, 1991, 1993
  	The Regents of the University of California.  All rights reserved.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
   4. Neither the name of the University nor the names of its contributors
      may be used to endorse or promote products derived from this software
      without specific prior written permission.
  
   THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
   ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
   ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
   FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
   OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
   HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
   LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
   OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
   SUCH DAMAGE.
  
       From: @(#)getpwent.3	8.2 (Berkeley) 12/11/93
   $FreeBSD: src/lib/libc/gen/getpwent.3,v 1.30 2007/01/09 00:27:54 imp Exp $
  
   @APPLE_LICENSE_HEADER_START@
  
   Portions Copyright (c) 2003-2013 Apple Inc.  All Rights Reserved.
  
   This file contains Original Code and/or Modifications of Original Code
   as defined in and that are subject to the Apple Public Source License
   Version 2.0 (the 'License'). You may not use this file except in
   compliance with the License. Please obtain a copy of the License at
   http://www.opensource.apple.com/apsl/ and read it before using this
   file.
  
   The Original Code and all software distributed under the License are
   distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
   EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
   INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
   FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
   Please see the License for the specific language governing rights and
   limitations under the License.
  
   @APPLE_LICENSE_HEADER_END@
   -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>GETPWENT(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">GETPWENT(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">GETPWENT(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<code class="Nm">getpwent</code>, <code class="Nm">getpwnam</code>,
  <code class="Nm">getpwnam_r</code>, <code class="Nm">getpwuid</code>,
  <code class="Nm">getpwuid_r</code>, <code class="Nm">getpwuuid</code>,
  <code class="Nm">getpwuuid_r</code>, <code class="Nm">setpassent</code>,
  <code class="Nm">setpwent</code>, <code class="Nm">endpwent</code> &#x2014;
<div class="Nd">password database operations</div>
</section>
<section class="Sh">
<h1 class="Sh" id="LIBRARY"><a class="permalink" href="#LIBRARY">LIBRARY</a></h1>
<span class="Lb">Standard C&#x00A0;Library (libc, -lc)</span>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<code class="In">#include &lt;<a class="In">sys/types.h</a>&gt;</code>
<br/>
<code class="In">#include &lt;<a class="In">pwd.h</a>&gt;</code>
<br/>
<code class="In">#include &lt;<a class="In">uuid/uuid.h</a>&gt;</code>
<p class="Pp"><var class="Ft">struct passwd *</var>
  <br/>
  <code class="Fn">getpwent</code>(<var class="Fa" style="white-space: nowrap;">void</var>);</p>
<p class="Pp"><var class="Ft">struct passwd *</var>
  <br/>
  <code class="Fn">getpwnam</code>(<var class="Fa" style="white-space: nowrap;">const
    char *login</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">getpwnam_r</code>(<var class="Fa" style="white-space: nowrap;">const
    char *name</var>, <var class="Fa" style="white-space: nowrap;">struct passwd
    *pwd</var>, <var class="Fa" style="white-space: nowrap;">char *buffer</var>,
    <var class="Fa" style="white-space: nowrap;">size_t bufsize</var>,
    <var class="Fa" style="white-space: nowrap;">struct passwd
  **result</var>);</p>
<p class="Pp"><var class="Ft">struct passwd *</var>
  <br/>
  <code class="Fn">getpwuid</code>(<var class="Fa" style="white-space: nowrap;">uid_t
    uid</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">getpwuid_r</code>(<var class="Fa" style="white-space: nowrap;">uid_t
    uid</var>, <var class="Fa" style="white-space: nowrap;">struct passwd
    *pwd</var>, <var class="Fa" style="white-space: nowrap;">char *buffer</var>,
    <var class="Fa" style="white-space: nowrap;">size_t bufsize</var>,
    <var class="Fa" style="white-space: nowrap;">struct passwd
  **result</var>);</p>
<p class="Pp"><var class="Ft">struct passwd *</var>
  <br/>
  <code class="Fn">getpwuuid</code>(<var class="Fa" style="white-space: nowrap;">uuid_t
    uuid</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">getpwuuid_r</code>(<var class="Fa" style="white-space: nowrap;">uuid_t
    uuid</var>, <var class="Fa" style="white-space: nowrap;">struct passwd
    *pwd</var>, <var class="Fa" style="white-space: nowrap;">char *buffer</var>,
    <var class="Fa" style="white-space: nowrap;">size_t bufsize</var>,
    <var class="Fa" style="white-space: nowrap;">struct passwd
  **result</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">setpassent</code>(<var class="Fa" style="white-space: nowrap;">int
    stayopen</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">setpwent</code>(<var class="Fa" style="white-space: nowrap;">void</var>);</p>
<p class="Pp"><var class="Ft">void</var>
  <br/>
  <code class="Fn">endpwent</code>(<var class="Fa" style="white-space: nowrap;">void</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
These functions obtain information from <a class="Xr">opendirectoryd(8)</a>,
  including records in <span class="Pa">/etc/master.passwd</span> which is
  described in <a class="Xr">master.passwd(5)</a>. Each entry in the database is
  defined by the structure <var class="Vt">passwd</var> found in the include
  file <code class="In">&lt;<a class="In">pwd.h</a>&gt;</code>:
<div class="Bd Pp Bd-indent">
<pre>
struct passwd {
	char	*pw_name;	/* user name */
	char	*pw_passwd;	/* encrypted password */
	uid_t	pw_uid;		/* user uid */
	gid_t	pw_gid;		/* user gid */
	time_t	pw_change;	/* password change time */
	char	*pw_class;	/* user access class */
	char	*pw_gecos;	/* Honeywell login info */
	char	*pw_dir;	/* home directory */
	char	*pw_shell;	/* default shell */
	time_t	pw_expire;	/* account expiration */
	int	pw_fields;	/* internal: fields filled in */
};
</pre>
</div>
<p class="Pp">The functions <code class="Fn">getpwnam</code>(),
    <code class="Fn">getpwuid</code>(), and <code class="Fn">getpwuuid</code>()
    search the password database for the given login name, user uid, or user
    uuid respectively, always returning the first one encountered.</p>
<p class="Pp">Note that the password file
    <span class="Pa">/etc/master.passwd</span> does not contain user UUIDs. The
    UUID for a user may be found using
    <code class="Fn">mbr_uid_to_uuid</code>().</p>
<p class="Pp">On OS X, these routines are thread-safe and return a pointer to a
    thread-specific data structure. The contents of this data structure are
    automatically released by subsequent calls to any of these routines on the
    same thread, or when the thread exits. These routines are therefore
    unsuitable for use in libraries or frameworks, from where they may overwrite
    the per-thread data that the calling application expects to find as a result
    of its own calls to these routines. Library and framework code should use
    the alternative reentrant variants detailed below.</p>
<p class="Pp">The <code class="Fn">getpwent</code>() function searches all
    available directory services on its first invocation. It caches the returned
    entries in a list and returns user account entries one at a time.</p>
<p class="Pp"><i class="Em">NOTE</i> that <code class="Fn">getpwent</code>() may
    cause a very lengthy search for user account records by
    <code class="Nm">opendirectoryd</code> and may result in a large number of
    user account records being cached by the calling process. Use of this
    function is not advised.</p>
<p class="Pp">The functions <code class="Fn">getpwnam_r</code>(),
    <code class="Fn">getpwuid_r</code>(), and
    <code class="Fn">getpwuuid_r</code>() are alternative versions of
    <code class="Fn">getpwnam</code>(), <code class="Fn">getpwuid</code>(), and
    <code class="Fn">getpwuuid</code>() respectively. They store the results of
    their search in the caller-provided <var class="Fa">pwd</var> structure,
    which additionally contains pointers to strings that are stored in the
    caller-provided <var class="Fa">buffer</var> of size
    <var class="Fa">bufsize</var>. (The maximum required
    <var class="Fa">bufsize</var> can be obtained by passing the
    _SC_GETPW_R_SIZE_MAX constant to the <a class="Xr">sysconf(3)</a> call. See
    example code below.) When these functions are successful, the
    <var class="Fa">pwd</var> argument will be filled in, and a pointer to that
    argument will be stored in the caller-provided <var class="Fa">result</var>.
    If an entry is not found or an error occurs, <var class="Fa">result</var>
    will be set to <code class="Dv">NULL</code>.</p>
<p class="Pp">The <code class="Fn">setpassent</code>() function causes
    <code class="Fn">getpwent</code>() to ``rewind'' to the beginning of the
    list of entries cached by a previous <code class="Fn">getpwent</code>()
    call. The cache is not cleared. The <var class="Fa">stayopen</var> parameter
    value is unused on OS X.</p>
<p class="Pp">The <code class="Fn">setpwent</code>() and
    <code class="Fn">endpwent</code>() functions clear the cached results from a
    previous <code class="Fn">getpwent</code>() call.</p>
<p class="Pp">These routines have been written to
    &#x2018;<code class="Li">shadow</code>&#x2019; the password of user records
    created on Mac OS X 10.3 or later, by returning a structure whose password
    field points to the string &#x2018;<code class="Li">********</code>&#x2019;.
    Legacy crypt passwords are still returned for user records created on
    earlier versions of Mac OS X whose <a class="Xr">opendirectoryd(8)</a>
    attribute contains the value
    &#x2018;<code class="Li">;basic;</code>&#x2019;.</p>
<p class="Pp">Note that <a class="Xr">opendirectoryd(8)</a> allows user records
    from some sources which may not include all the component fields present in
    a passwd structure. Only the name, uid, and gid of a user record are
    required. Default values will be supplied as follows:</p>
<div class="Bd Pp Bd-indent">
<pre>
pw_passwd = &quot;*&quot;
pw_change = 0
pw_class = &quot;&quot;
pw_gecos = &quot;&quot;
pw_dir = &quot;/var/empty&quot;
pw_shell = &quot;/usr/bin/false&quot;
pw_expire = 0
</pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUES"><a class="permalink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
The functions <code class="Fn">getpwent</code>(),
  <code class="Fn">getpwnam</code>(), <code class="Fn">getpwuid</code>(), and
  <code class="Fn">getpwuuid</code>() return a valid pointer to a passwd
  structure on success or <code class="Dv">NULL</code> if the entry is not found
  or if an error occurs. If an error does occur, <var class="Va">errno</var>
  will be set. Note that programs must explicitly set
  <var class="Va">errno</var> to zero before calling any of these functions if
  they need to distinguish between a non-existent entry and an error. The
  functions <code class="Fn">getpwnam_r</code>(),
  <code class="Fn">getpwuid_r</code>(), and
  <code class="Fn">getpwuuid_r</code>() return 0 if no error occurred, or an
  error number to indicate failure. It is not an error if a matching entry is
  not found. (Thus, if <var class="Fa">result</var> is
  <code class="Dv">NULL</code> and the return value is 0, no matching entry
  exists.)
<p class="Pp">The <code class="Fn">setpassent</code>() function returns 0 on
    failure and 1 on success. The <code class="Fn">endpwent</code>() and
    <code class="Fn">setpwent</code>() functions have no return value.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
To print the current user's home directory without depending on per-thread
  storage:
<div class="Bd Pp Bd-indent">
<pre>
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;pwd.h&gt;

int bufsize;

if ((bufsize = sysconf(_SC_GETPW_R_SIZE_MAX)) == -1)
    abort();

char buffer[bufsize];
struct passwd pwd, *result = NULL;
if (getpwuid_r(getuid(), &amp;pwd, buffer, bufsize, &amp;result) != 0 || !result)
    abort();

printf(&quot;%s\n&quot;, pwd.pw_dir);
</pre>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
The secure password database file
<dl class="Bl-tag Bl-compact">
  <dt><span class="Pa">/etc/master.passwd</span></dt>
  <dd>The current password file</dd>
  <dt><span class="Pa">/etc/passwd</span></dt>
  <dd>A Version 7 format password file</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ERRORS"><a class="permalink" href="#ERRORS">ERRORS</a></h1>
These routines may fail for any of the errors specified in
  <a class="Xr">open(2)</a>, <a class="Xr">dbopen(3)</a>,
  <a class="Xr">socket(2)</a>, and <a class="Xr">connect(2)</a>, in addition to
  the following:
<dl class="Bl-tag">
  <dt>[<a class="permalink" href="#ERANGE"><code class="Er" id="ERANGE">ERANGE</code></a>]</dt>
  <dd>The buffer specified by the <var class="Fa">buffer</var> and
      <var class="Fa">bufsize</var> arguments was insufficiently sized to store
      the result. The caller should retry with a larger buffer.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<a class="Xr">getlogin(2)</a>, <a class="Xr">getgrent(3)</a>,
  <a class="Xr">passwd(5)</a>, <a class="Xr">mbr_uid_to_uuid(3,)</a>
  <a class="Xr">opendirectoryd(8)</a>, <a class="Xr">yp(8)</a>
</section>
<section class="Sh">
<h1 class="Sh" id="STANDARDS"><a class="permalink" href="#STANDARDS">STANDARDS</a></h1>
The <code class="Fn">getpwent</code>(), <code class="Fn">getpwnam</code>(),
  <code class="Fn">getpwnam_r</code>(), <code class="Fn">getpwuid</code>(),
  <code class="Fn">getpwuid_r</code>(), <code class="Fn">setpwent</code>(), and
  <code class="Fn">endpwent</code>() functions conform to
  <span class="St">ISO/IEC 9945-1:1996 (&#x201C;POSIX.1&#x201D;)</span>.
</section>
<section class="Sh">
<h1 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h1>
The <code class="Fn">getpwent</code>(), <code class="Fn">getpwnam</code>(),
  <code class="Fn">getpwuid</code>(), <code class="Fn">setpwent</code>(), and
  <code class="Fn">endpwent</code>() functions appeared in
  <span class="Ux">Version&#x00A0;7 AT&amp;T UNIX</span>. The
  <code class="Fn">setpassent</code>() function appeared in
  <span class="Ux">4.3BSD-Reno</span>. The <code class="Fn">getpwnam_r</code>()
  and <code class="Fn">getpwuid_r</code>() functions appeared in
  <span class="Ux">FreeBSD 5.1</span>. The functions
  <code class="Fn">getpwuuid</code>() and <code class="Fn">getpwuuid_r</code>()
  appeared in Mac OS X 10.8.
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
The functions <code class="Fn">getpwent</code>(),
  <code class="Fn">getpwnam</code>(), <code class="Fn">getpwuid</code>(), and
  <code class="Fn">getpwuuid</code>(), leave their results in an internal
  thread-specific memory and return a pointer to that object. Subsequent calls
  to the same function will modify the same object.
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">October 26, 2011</td>
    <td class="foot-os">Mac OS X 10.15</td>
  </tr>
</table>
</body>
</html>
