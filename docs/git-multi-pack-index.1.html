<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   t
       Title: git-multi-pack-index
      Author: [FIXME: author] [see http://www.docbook.org/tdg5/en/html/author]
   Generator: DocBook XSL Stylesheets v1.79.2 <http://docbook.sf.net/>
        Date: 2025-07-22
      Manual: Git Manual
      Source: Git 2.50.1.428.g0e8243a355
    Language: English
   -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>GIT-MULTI-PACK-INDEX(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">GIT-MULTI-PACK-INDEX(1)</td>
    <td class="head-vol">Git Manual</td>
    <td class="head-rtitle">GIT-MULTI-PACK-INDEX(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">git-multi-pack-index - Write and verify multi-pack-indexes</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre><i>git multi-pack-index</i> [--object-dir=&lt;dir&gt;] [--[no-]bitmap] &lt;sub-command&gt;</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Write or verify a multi-pack-index (MIDX) file.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<p class="Pp">--object-dir=&lt;dir&gt;</p>
<div class="Bd-indent">Use given directory for the location of Git objects. We
  check <i>&lt;dir&gt;</i><b>/packs/multi-pack-index</b> for the current MIDX
  file, and <i>&lt;dir&gt;</i><b>/packs</b> for the pack-files to index.
<p class="Pp"><i>&lt;dir&gt;</i> must be an alternate of the current
  repository.</p>
</div>
<p class="Pp">--[no-]progress</p>
<div class="Bd-indent">Turn progress on/off explicitly. If neither is specified,
  progress is shown if standard error is connected to a terminal. Supported by
  sub-commands <b>write</b>, <b>verify</b>, <b>expire</b>, and `repack.</div>
<p class="Pp">The following subcommands are available:</p>
<p class="Pp">write</p>
<div class="Bd-indent">Write a new MIDX file. The following options are
  available for the <b>write</b> sub-command:
<p class="Pp">--preferred-pack=&lt;pack&gt;</p>
<div class="Bd-indent">When specified, break ties in favor of this pack when
  there are additional copies of its objects in other packs. Ties for objects
  not found in the preferred pack are always resolved in favor of the copy in
  the pack with the highest mtime. If unspecified, the pack with the lowest
  mtime is used by default. The preferred pack must have at least one
  object.</div>
<p class="Pp">--[no-]bitmap</p>
<div class="Bd-indent">Control whether or not a multi-pack bitmap is
  written.</div>
<p class="Pp">--stdin-packs</p>
<div class="Bd-indent">Write a multi-pack index containing only the set of
  line-delimited pack index basenames provided over stdin.</div>
<p class="Pp">--refs-snapshot=&lt;path&gt;</p>
<div class="Bd-indent">With <b>--bitmap</b>, optionally specify a file which
  contains a &quot;refs snapshot&quot; taken prior to repacking.
<p class="Pp">A reference snapshot is composed of line-delimited OIDs
    corresponding to the reference tips, usually taken by <b>git</b>
    <b>repack</b> prior to generating a new pack. A line may optionally start
    with a <b>+</b> character to indicate that the reference which corresponds
    to that OID is &quot;preferred&quot; (see <b>git-config</b>(1)'s
    <b>pack.preferBitmapTips</b>.)</p>
<p class="Pp">The file given at <i>&lt;path&gt;</i> is expected to be readable,
    and can contain duplicates. (If a given OID is given more than once, it is
    marked as preferred if at least one instance of it begins with the special
    <b>+</b> marker).</p>
</div>
<p class="Pp">--incremental</p>
<div class="Bd-indent">Write an incremental MIDX file containing only objects
  and packs not present in an existing MIDX layer. Migrates non-incremental
  MIDXs to incremental ones when necessary. Incompatible with
  <b>--bitmap</b>.</div>
</div>
<p class="Pp">verify</p>
<div class="Bd-indent">Verify the contents of the MIDX file.</div>
<p class="Pp">expire</p>
<div class="Bd-indent">Delete the pack-files that are tracked by the MIDX file,
  but have no objects referenced by the MIDX (with the exception of .<b>keep</b>
  packs and cruft packs). Rewrite the MIDX file afterward to remove all
  references to these pack-files.
<p class="Pp"></p>
<div class="Bd-indent">
<br/>
<b>Note</b>
<br/>
this mode is incompatible with incremental MIDX files.
<p class="Pp"></p>
</div>
</div>
<p class="Pp">repack</p>
<div class="Bd-indent">Create a new pack-file containing objects in small
  pack-files referenced by the multi-pack-index. If the size given by the
  <b>--batch-size=</b><i>&lt;size&gt;</i> argument is zero, then create a pack
  containing all objects referenced by the multi-pack-index. For a non-zero
  batch size, Select the pack-files by examining packs from oldest-to-newest,
  computing the &quot;expected size&quot; by counting the number of objects in
  the pack referenced by the multi-pack-index, then divide by the total number
  of objects in the pack and multiply by the pack size. We select packs with
  expected size below the batch size until the set of packs have total expected
  size at least the batch size, or all pack-files are considered. If only one
  pack-file is selected, then do nothing. If a new pack-file is created, rewrite
  the multi-pack-index to reference the new pack-file. A later run of <i>git
  multi-pack-index expire</i> will delete the pack-files that were part of this
  batch.
<p class="Pp">If <b>repack.packKeptObjects</b> is <b>false</b>, then any
    pack-files with an associated .<b>keep</b> file will not be selected for the
    batch to repack.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<br/>
<b>Note</b>
<br/>
this mode is incompatible with incremental MIDX files.
<p class="Pp"></p>
</div>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<div class="Bd-indent">&#x2022;Write a MIDX file for the packfiles in the
  current .<b>git</b> directory.
<p class="Pp"></p>
<div class="Bd-indent">
<pre>$ git multi-pack-index write</pre>
</div>
</div>
<p class="Pp"></p>
<div class="Bd-indent">&#x2022;Write a MIDX file for the packfiles in the
  current .<b>git</b> directory with a corresponding bitmap.
<p class="Pp"></p>
<div class="Bd-indent">
<pre>$ git multi-pack-index write --preferred-pack=&lt;pack&gt; --bitmap</pre>
</div>
</div>
<p class="Pp"></p>
<div class="Bd-indent">&#x2022;Write a MIDX file for the packfiles in an
  alternate object store.
<p class="Pp"></p>
<div class="Bd-indent">
<pre>$ git multi-pack-index --object-dir &lt;alt&gt; write</pre>
</div>
</div>
<p class="Pp"></p>
<div class="Bd-indent">&#x2022;Verify the MIDX file for the packfiles in the
  current .<b>git</b> directory.
<p class="Pp"></p>
<div class="Bd-indent">
<pre>$ git multi-pack-index verify</pre>
</div>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">See <b>The Multi-Pack-Index Design Document</b>[1] and
    <b>gitformat-pack</b>(5) for more information on the multi-pack-index
    feature and its file format.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="GIT"><a class="permalink" href="#GIT">GIT</a></h1>
<p class="Pp">Part of the <b>git</b>(1) suite</p>
</section>
<section class="Sh">
<h1 class="Sh" id="NOTES"><a class="permalink" href="#NOTES">NOTES</a></h1>
<dl class="Bl-tag">
  <dt> 1.</dt>
  <dd>The Multi-Pack-Index Design Document</dd>
</dl>
<div class="Bd-indent">git-htmldocs/technical/multi-pack-index.html</div>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">12/12/2022</td>
    <td class="foot-os">Git 2.39.0</td>
  </tr>
</table>
</body>
</html>
