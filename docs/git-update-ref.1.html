<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   t
       Title: git-update-ref
      Author: [FIXME: author] [see http://www.docbook.org/tdg5/en/html/author]
   Generator: DocBook XSL Stylesheets v1.79.2 <http://docbook.sf.net/>
        Date: 2025-07-22
      Manual: Git Manual
      Source: Git 2.50.1.428.g0e8243a355
    Language: English
   -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>GIT-UPDATE-REF(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">GIT-UPDATE-REF(1)</td>
    <td class="head-vol">Git Manual</td>
    <td class="head-rtitle">GIT-UPDATE-REF(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">git-update-ref - Update the object name stored in a ref safely</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre><b>git</b> <b>update-ref</b> [<b>-m</b> <i>&lt;reason&gt;</i>] [<b>--no-deref</b>] <b>-d</b> <i>&lt;ref&gt;</i> [<i>&lt;old-oid&gt;</i>]
<b>git</b> <b>update-ref</b> [<b>-m</b> <i>&lt;reason&gt;</i>] [<b>--no-deref</b>] [<b>--create-reflog</b>] <i>&lt;ref&gt;</i> <i>&lt;new-oid&gt;</i> [<i>&lt;old-oid&gt;</i>]
<b>git</b> <b>update-ref</b> [<b>-m</b> <i>&lt;reason&gt;</i>] [<b>--no-deref</b>] <b>--stdin</b> [<b>-z</b>] [<b>--batch-updates</b>]</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Given two arguments, stores the &lt;new-oid&gt; in the
    &lt;ref&gt;, possibly dereferencing the symbolic refs. E.g. <b>git</b>
    <b>update-ref</b> <b>HEAD</b> <i>&lt;new-oid&gt;</i> updates the current
    branch head to the new object.</p>
<p class="Pp">Given three arguments, stores the &lt;new-oid&gt; in the
    &lt;ref&gt;, possibly dereferencing the symbolic refs, after verifying that
    the current value of the &lt;ref&gt; matches &lt;old-oid&gt;. E.g.
    <b>git</b> <b>update-ref</b> <b>refs/heads/master</b> <i>&lt;new-oid&gt;</i>
    <i>&lt;old-oid&gt;</i> updates the master branch head to &lt;new-oid&gt;
    only if its current value is &lt;old-oid&gt;. You can specify 40
    &quot;0&quot; or an empty string as &lt;old-oid&gt; to make sure that the
    ref you are creating does not exist.</p>
<p class="Pp">The final arguments are object names; this command without any
    options does not support updating a symbolic ref to point to another ref
    (see <b>git-symbolic-ref</b>(1)). But <b>git</b> <b>update-ref</b>
    <b>--stdin</b> does have the <b>symref-*</b> commands so that regular refs
    and symbolic refs can be committed in the same transaction.</p>
<p class="Pp">If --no-deref is given, &lt;ref&gt; itself is overwritten, rather
    than the result of following the symbolic pointers.</p>
<p class="Pp">With <b>-d</b>, it deletes the named &lt;ref&gt; after verifying
    that it still contains &lt;old-oid&gt;.</p>
<p class="Pp">With <b>--stdin</b>, update-ref reads instructions from standard
    input and performs all modifications together. Specify commands of the
  form:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre>update SP &lt;ref&gt; SP &lt;new-oid&gt; [SP &lt;old-oid&gt;] LF
create SP &lt;ref&gt; SP &lt;new-oid&gt; LF
delete SP &lt;ref&gt; [SP &lt;old-oid&gt;] LF
verify SP &lt;ref&gt; [SP &lt;old-oid&gt;] LF
symref-update SP &lt;ref&gt; SP &lt;new-target&gt; [SP (ref SP &lt;old-target&gt; | oid SP &lt;old-oid&gt;)] LF
symref-create SP &lt;ref&gt; SP &lt;new-target&gt; LF
symref-delete SP &lt;ref&gt; [SP &lt;old-target&gt;] LF
symref-verify SP &lt;ref&gt; [SP &lt;old-target&gt;] LF
option SP &lt;opt&gt; LF
start LF
prepare LF
commit LF
abort LF</pre>
</div>
<p class="Pp">With <b>--create-reflog</b>, update-ref will create a reflog for
    each ref even if one would not ordinarily be created.</p>
<p class="Pp">With <b>--batch-updates</b>, update-ref executes the updates in a
    batch but allows individual updates to fail due to invalid or incorrect user
    input, applying only the successful updates. However, system-related
    errors&#x2014;such as I/O failures or memory issues&#x2014;will result in a
    full failure of all batched updates. Any failed updates will be reported in
    the following format:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre>rejected SP (&lt;old-oid&gt; | &lt;old-target&gt;) SP (&lt;new-oid&gt; | &lt;new-target&gt;) SP &lt;rejection-reason&gt; LF</pre>
</div>
<p class="Pp">Quote fields containing whitespace as if they were strings in C
    source code; i.e., surrounded by double-quotes and with backslash escapes.
    Use 40 &quot;0&quot; characters or the empty string to specify a zero value.
    To specify a missing value, omit the value and its preceding SP
  entirely.</p>
<p class="Pp">Alternatively, use <b>-z</b> to specify in NUL-terminated format,
    without quoting:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre>update SP &lt;ref&gt; NUL &lt;new-oid&gt; NUL [&lt;old-oid&gt;] NUL
create SP &lt;ref&gt; NUL &lt;new-oid&gt; NUL
delete SP &lt;ref&gt; NUL [&lt;old-oid&gt;] NUL
verify SP &lt;ref&gt; NUL [&lt;old-oid&gt;] NUL
symref-update SP &lt;ref&gt; NUL &lt;new-target&gt; [NUL (ref NUL &lt;old-target&gt; | oid NUL &lt;old-oid&gt;)] NUL
symref-create SP &lt;ref&gt; NUL &lt;new-target&gt; NUL
symref-delete SP &lt;ref&gt; [NUL &lt;old-target&gt;] NUL
symref-verify SP &lt;ref&gt; [NUL &lt;old-target&gt;] NUL
option SP &lt;opt&gt; NUL
start NUL
prepare NUL
commit NUL
abort NUL</pre>
</div>
<p class="Pp">In this format, use 40 &quot;0&quot; to specify a zero value, and
    use the empty string to specify a missing value.</p>
<p class="Pp">In either format, values can be specified in any form that Git
    recognizes as an object name. Commands in any other format or a repeated
    &lt;ref&gt; produce an error. Command meanings are:</p>
<p class="Pp">update</p>
<div class="Bd-indent">Set &lt;ref&gt; to &lt;new-oid&gt; after verifying
  &lt;old-oid&gt;, if given. Specify a zero &lt;new-oid&gt; to ensure the ref
  does not exist after the update and/or a zero &lt;old-oid&gt; to make sure the
  ref does not exist before the update.</div>
<p class="Pp">create</p>
<div class="Bd-indent">Create &lt;ref&gt; with &lt;new-oid&gt; after verifying
  that it does not exist. The given &lt;new-oid&gt; may not be zero.</div>
<p class="Pp">delete</p>
<div class="Bd-indent">Delete &lt;ref&gt; after verifying that it exists with
  &lt;old-oid&gt;, if given. If given, &lt;old-oid&gt; may not be zero.</div>
<p class="Pp">symref-update</p>
<div class="Bd-indent">Set &lt;ref&gt; to &lt;new-target&gt; after verifying
  &lt;old-target&gt; or &lt;old-oid&gt;, if given. Specify a zero
  &lt;old-oid&gt; to ensure that the ref does not exist before the update.</div>
<p class="Pp">verify</p>
<div class="Bd-indent">Verify &lt;ref&gt; against &lt;old-oid&gt; but do not
  change it. If &lt;old-oid&gt; is zero or missing, the ref must not
  exist.</div>
<p class="Pp">symref-create: Create symbolic ref &lt;ref&gt; with
    &lt;new-target&gt; after verifying that it does not exist.</p>
<p class="Pp">symref-delete</p>
<div class="Bd-indent">Delete &lt;ref&gt; after verifying that it exists with
  &lt;old-target&gt;, if given.</div>
<p class="Pp">symref-verify</p>
<div class="Bd-indent">Verify symbolic &lt;ref&gt; against &lt;old-target&gt;
  but do not change it. If &lt;old-target&gt; is missing, the ref must not
  exist. Can only be used in <b>no-deref</b> mode.</div>
<p class="Pp">option</p>
<div class="Bd-indent">Modify the behavior of the next command naming a
  &lt;ref&gt;. The only valid option is <b>no-deref</b> to avoid dereferencing a
  symbolic ref.</div>
<p class="Pp">start</p>
<div class="Bd-indent">Start a transaction. In contrast to a non-transactional
  session, a transaction will automatically abort if the session ends without an
  explicit commit. This command may create a new empty transaction when the
  current one has been committed or aborted already.</div>
<p class="Pp">prepare</p>
<div class="Bd-indent">Prepare to commit the transaction. This will create lock
  files for all queued reference updates. If one reference could not be locked,
  the transaction will be aborted.</div>
<p class="Pp">commit</p>
<div class="Bd-indent">Commit all reference updates queued for the transaction,
  ending the transaction.</div>
<p class="Pp">abort</p>
<div class="Bd-indent">Abort the transaction, releasing all locks if the
  transaction is in prepared state.</div>
<p class="Pp">If all &lt;ref&gt;s can be locked with matching &lt;old-oid&gt;s
    simultaneously, all modifications are performed. Otherwise, no modifications
    are performed. Note that while each individual &lt;ref&gt; is updated or
    deleted atomically, a concurrent reader may still see a subset of the
    modifications.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="LOGGING_UPDATES"><a class="permalink" href="#LOGGING_UPDATES">LOGGING
  UPDATES</a></h1>
<p class="Pp">If config parameter &quot;core.logAllRefUpdates&quot; is true and
    the ref is one under &quot;refs/heads/&quot;, &quot;refs/remotes/&quot;,
    &quot;refs/notes/&quot;, or a pseudoref like HEAD or ORIG_HEAD; or the file
    &quot;$GIT_DIR/logs/&lt;ref&gt;&quot; exists then <b>git</b>
    <b>update-ref</b> will append a line to the log file
    &quot;$GIT_DIR/logs/&lt;ref&gt;&quot; (dereferencing all symbolic refs
    before creating the log name) describing the change in ref value. Log lines
    are formatted as:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre>oldsha1 SP newsha1 SP committer LF</pre>
</div>
<p class="Pp">Where &quot;oldsha1&quot; is the 40 character hexadecimal value
    previously stored in &lt;ref&gt;, &quot;newsha1&quot; is the 40 character
    hexadecimal value of &lt;new-oid&gt; and &quot;committer&quot; is the
    committer&#x2019;s name, email address and date in the standard Git
    committer ident format.</p>
<p class="Pp">Optionally with -m:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre>oldsha1 SP newsha1 SP committer TAB message LF</pre>
</div>
<p class="Pp">Where all fields are as described above and &quot;message&quot; is
    the value supplied to the -m option.</p>
<p class="Pp">An update will fail (without changing &lt;ref&gt;) if the current
    user is unable to create a new log file, append to the existing log file or
    does not have committer information available.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="NOTES"><a class="permalink" href="#NOTES">NOTES</a></h1>
<p class="Pp">Symbolic refs were initially implemented using symbolic links.
    This is now deprecated since not all filesystems support symbolic links.</p>
<p class="Pp">This command follows <b>real</b> symlinks only if they start with
    &quot;refs/&quot;: otherwise it will just try to read them and update them
    as a regular file (i.e. it will allow the filesystem to follow them, but
    will overwrite such a symlink to somewhere else with a regular
  filename).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>git-symbolic-ref</b>(1)</p>
</section>
<section class="Sh">
<h1 class="Sh" id="GIT"><a class="permalink" href="#GIT">GIT</a></h1>
<p class="Pp">Part of the <b>git</b>(1) suite</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2025-07-22</td>
    <td class="foot-os">Git 2.50.1.428.g0e8243</td>
  </tr>
</table>
</body>
</html>
