<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>
  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>Mail::SPF::Request(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Mail::SPF::Request(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Mail::SPF::Request(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
Mail::SPF::Request - SPF request class
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<span class="Li"></span>
<pre>
    use Mail::SPF;

    my $request = Mail::SPF::Request-&gt;new(
        versions    =&gt; [1, 2],              # optional
        scope       =&gt; 'mfrom',             # or 'helo', 'pra'
        identity    =&gt; 'fred@example.com',
        ip_address  =&gt; '192.168.0.1',
        helo_identity                       # optional,
                    =&gt; 'mta.example.com'    #   for %{h} macro expansion
    );

    my @versions    = $request-&gt;versions;
    my $scope       = $request-&gt;scope;
    my $authority_domain
                    = $request-&gt;authority_domain;
    my $identity    = $request-&gt;identity;   # 'localpart@domain' or 'domain'
    my $domain      = $request-&gt;domain;
    my $localpart   = $request-&gt;localpart;
    my $ip_address  = $request-&gt;ip_address;     # IPv4 or IPv6 address
    my $ip_address_v6                           # native IPv6 address or
                    = $request-&gt;ip_address_v6;  #   IPv4-mapped IPv6 address
    my $helo_identity                           # additional HELO identity
                    = $request-&gt;helo_identity;  #   for non-HELO scopes

    my $record      = $request-&gt;record;
        # the record selected during processing of the request, may be undef

    $request-&gt;state(field =&gt; 'value');
    my $value = $request-&gt;state('field');
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
An object of class <b>Mail::SPF::Request</b> represents an SPF request.
<section class="Ss">
<h2 class="Ss" id="Constructors"><a class="permalink" href="#Constructors">Constructors</a></h2>
The following constructors are provided:
<dl class="Bl-tag">
  <dt><b>new(%options)</b>: returns <i>Mail::SPF::Request</i></dt>
  <dd>Creates a new SPF request object. The request is considered the
      <i>root-request</i> for any subsequent sub-requests (see the
      &quot;new_sub_request&quot; constructor).
    <p class="Pp"><span class="Li">%options</span> is a list of key/value pairs
        representing any of the following options:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>versions</b></dt>
  <dd>A reference to an <i>array</i> of <i>integer</i>s listing the versions of
      SPF records that may be used for the SPF check. Only those record versions
      that cover the desired scope will actually be used. At least one
      applicable version must be specified. For a single record version, a
      simple scalar may be specified instead of an array-ref. Defaults to all
      versions that cover the desired scope (see below); defaults to <b>[1,
      2]</b> for the default scope of <b>'mfrom'</b>.
    <p class="Pp">The following versions are supported:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>1</b></dt>
  <dd>Use <span class="Li">&quot;v=spf1&quot;</span> records.</dd>
  <dt><b>2</b></dt>
  <dd>Use <span class="Li">&quot;spf2.0&quot;</span> records.</dd>
</dl>
</div>
<div class="Bd-indent">
<p class="Pp"><i>Example</i>: A value of <b>1</b> (or <b>[1]</b>) means that
    only <span class="Li">&quot;v=spf1&quot;</span> records should be used for
    the SPF check. If at the same time a scope of <b>'pra'</b> is specified, a
    <i>Mail::SPF::EInvalidScope</i> exception will be thrown as
    <span class="Li">&quot;v=spf1&quot;</span> records do not cover the PRA
    scope.</p>
</div>
<dl class="Bl-tag">
  <dt><b>scope</b></dt>
  <dd>A string denoting the authorization scope of the identity that should be
      checked. Defaults to <b>'mfrom'</b>. The following scope values are
      supported:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>'helo'</b></dt>
  <dd>The given identity is the <span class="Li">&quot;HELO&quot;</span>
      parameter of an SMTP transaction (RFC 2821) and should be checked against
      SPF records that cover the <span class="Li">&quot;helo&quot;</span> scope
      (<span class="Li">&quot;v=spf1&quot;</span>). See the SPFv1 specification
      (RFC 4408) for the formal definition of the
      <span class="Li">&quot;HELO&quot;</span> scope.</dd>
  <dt><b>'mfrom'</b></dt>
  <dd>The given identity is the <span class="Li">&quot;MAIL FROM&quot;</span>
      parameter of an SMTP transaction (RFC 2821), and should be checked against
      SPF records that cover the <span class="Li">&quot;mfrom&quot;</span> scope
      (<span class="Li">&quot;v=spf1&quot;</span> and
      <span class="Li">&quot;spf2.0/mfrom&quot;</span>). See the SPFv1
      specification (RFC 4408) for the formal definition of the
      <span class="Li">&quot;MAIL FROM&quot;</span> scope.
    <p class="Pp"><i>Note</i>: In the case of an empty
        <span class="Li">&quot;MAIL FROM&quot;</span> SMTP transaction parameter
        (<span class="Li">&quot;MAIL FROM:&lt;&gt;&quot;</span>), you should
        perform a check with the <span class="Li">&quot;helo&quot;</span> scope
        instead.</p>
  </dd>
  <dt><b>'pra'</b></dt>
  <dd>The given identity is the &quot;Purported Responsible Address&quot; of an
      internet message (RFC 2822) and should be checked against SPF records that
      cover the <span class="Li">&quot;pra&quot;</span> scope
      (<span class="Li">&quot;spf2.0/pra&quot;</span>). See the PRA
      specification (RFC 4407) for the formal definition of the PRA scope.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt><b>authority_domain</b></dt>
  <dd>A string denoting the domain name that should be queried for sender policy
      records. Defaults to the domain of the
      <span class="Li">&quot;identity&quot;</span> option. There is usually no
      need to specify the <span class="Li">&quot;authority_domain&quot;</span>
      option.</dd>
  <dt><b>identity</b></dt>
  <dd><i>Required</i>. A string denoting the sender identity whose authorization
      should be checked. This is a domain name for the
      <span class="Li">&quot;helo&quot;</span> scope, and an e-mail address for
      the <span class="Li">&quot;mfrom&quot;</span> and
      <span class="Li">&quot;pra&quot;</span> scopes.
    <p class="Pp"><i>Note</i>: An empty identity must not be passed. In the case
        of an empty <span class="Li">&quot;MAIL</span>
        <span class="Li">FROM&quot;</span> SMTP transaction parameter, you
        should perform a check with the <span class="Li">&quot;helo&quot;</span>
        scope instead.</p>
  </dd>
  <dt><b>ip_address</b></dt>
  <dd><i>Required</i> for checks with the
      <span class="Li">&quot;helo&quot;</span>,
      <span class="Li">&quot;mfrom&quot;</span>, and
      <span class="Li">&quot;pra&quot;</span> scopes. Either a string or a
      <i>NetAddr::IP</i> object denoting the IP address of the host claiming the
      identity that is being checked. Can be either an IPv4 or an IPv6 address.
      An IPv4-mapped IPv6 address (e.g. '::ffff:192.168.0.1') is treated as an
      IPv4 address.</dd>
  <dt><b>helo_identity</b></dt>
  <dd>A string denoting the <span class="Li">&quot;HELO&quot;</span> SMTP
      transaction parameter in the case that the main identity is of a scope
      other than <span class="Li">&quot;helo&quot;</span>. This identity is then
      used merely for the expansion of <span class="Li">&quot;%{h}&quot;</span>
      macros during the policy evaluation of the main identity. Defaults to
      <b>undef</b>, which will be expanded to <b>'unknown'</b>. If the main
      identity is of the <span class="Li">&quot;helo&quot;</span> scope, this
      option is unused.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt><b>new_sub_request(%options)</b>: returns <i>Mail::SPF::Request</i></dt>
  <dd>Must be invoked on an existing request object. Creates a new sub-request
      object by cloning the invoked request, which is then considered the new
      request's <i>super-request</i>. Any specified options (see the
      &quot;new&quot; constructor) override the parameters of the super-request.
      There is usually no need to specify any options <i>besides</i> the
      <span class="Li">&quot;authority_domain&quot;</span> option.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Instance_methods"><a class="permalink" href="#Instance_methods">Instance
  methods</a></h2>
The following instance methods are provided:
<dl class="Bl-tag">
  <dt><b>root_request</b>: returns <i>Mail::SPF::Request</i></dt>
  <dd>Returns the root of the request's chain of super-requests. Specifically,
      returns the request itself if it has no super-requests.</dd>
  <dt><b>super_request</b>: returns <i>Mail::SPF::Request</i></dt>
  <dd>Returns the super-request of the request, or <b>undef</b> if there is
      none.</dd>
  <dt><b>versions</b>: returns <i>list</i> of <i>string</i></dt>
  <dd>Returns a list of the SPF record versions that are used for request. See
      the description of the &quot;new&quot; constructor's
      <span class="Li">&quot;versions&quot;</span> option.</dd>
  <dt><b>scope</b>: returns <i>string</i></dt>
  <dd>Returns the scope of the request. See the description of the
      &quot;new&quot; constructor's <span class="Li">&quot;scope&quot;</span>
      option.</dd>
  <dt><b>authority_domain</b>: returns <i>string</i></dt>
  <dd>Returns the authority domain of the request. See the description of the
      &quot;new&quot; constructor's
      <span class="Li">&quot;authority_domain&quot;</span> option.</dd>
  <dt><b>identity</b>: returns <i>string</i></dt>
  <dd>Returns the identity of the request. See the description of the
      &quot;new&quot; constructor's <span class="Li">&quot;identity&quot;</span>
      option.</dd>
  <dt><b>domain</b>: returns <i>string</i></dt>
  <dd>Returns the identity domain of the request. See the description of the
      &quot;new&quot; constructor's <span class="Li">&quot;identity&quot;</span>
      option.</dd>
  <dt><b>localpart</b>: returns <i>string</i></dt>
  <dd>Returns the identity localpart of the request. See the description of the
      &quot;new&quot; constructor's <span class="Li">&quot;identity&quot;</span>
      option.</dd>
  <dt><b>ip_address</b>: returns <i>NetAddr::IP</i></dt>
  <dd>Returns the IP address of the request as a <i>NetAddr::IP</i> object. See
      the description of the &quot;new&quot; constructor's
      <span class="Li">&quot;ip_address&quot;</span> option.</dd>
  <dt><b>ip_address_v6</b>: returns <i>NetAddr::IP</i></dt>
  <dd>Like the <span class="Li">&quot;ip_address&quot;</span> method, however,
      an IPv4 address is returned as an IPv4-mapped IPv6 address (e.g.
      '::ffff:192.168.0.1') to facilitate uniform processing.</dd>
  <dt><b>helo_identity</b>: returns <i>string</i></dt>
  <dd>Returns the <span class="Li">&quot;HELO&quot;</span> SMTP transaction
      parameter of the request. See the description of the &quot;new&quot;
      constructor's <span class="Li">&quot;helo_identity&quot;</span>
    option.</dd>
  <dt><b>record</b>: returns <i>Mail::SPF::Record</i></dt>
  <dd>Returns the SPF record selected during the processing of the request, or
      <b>undef</b> if there is none.</dd>
  <dt><b>state($field)</b>: returns anything</dt>
  <dd></dd>
  <dt><b>state($field, </b><b>$value</b><b>)</b>: returns anything</dt>
  <dd>Provides an interface for storing temporary state information with the
      request object. This is primarily meant to be used internally by
      <i>Mail::SPF::Server</i> and other Mail::SPF classes.
    <p class="Pp">If <span class="Li">$value</span> is specified, stores it in a
        state field named <span class="Li">$field</span>. Returns the current
        (new) value of the state field named <span class="Li">$field</span>.
        This method may be used as an lvalue.</p>
  </dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
Mail::SPF, Mail::SPF::Server
<p class="Pp">&lt;http://tools.ietf.org/html/rfc4408&gt;</p>
<p class="Pp">For availability, support, and license information, see the README
    file included with Mail::SPF.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
Julian Mehnle &lt;julian@mehnle.net&gt;, Shevek &lt;cpan@anarres.org&gt;
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2019-08-23</td>
    <td class="foot-os">perl v5.18.2</td>
  </tr>
</table>
</body>
</html>
