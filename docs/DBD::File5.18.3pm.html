<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
   Begin verbatim text
   End verbatim text
   Set up some character translations and predefined strings.  \*(-- will
   give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
   double quote, and \*(R" will give a right double quote.  \*(C+ will
   give a nicer C++.  Capital omega is used to do unbreakable dashes and
   therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
   nothing in troff, for use with C<>.
   diablo 10 pitch
    diablo 12 pitch
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    div.Pp { margin: 1ex 0ex; }
    div.Nd, div.Bf, div.Op { display: inline; }
    span.Pa, span.Ad { font-style: italic; }
    span.Ms { font-weight: bold; }
    dl.Bl-diag > dt { font-weight: bold; }
    code.Nm, code.Fl, code.Cm, code.Ic, code.In, code.Fd, code.Fn,
    code.Cd { font-weight: bold; font-family: inherit; }
  </style>
  <title>DBD::File(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DBD::File(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">DBD::File(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
DBD::File - Base class for writing file based DBI drivers
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
This module is a base class for writing other DBDs. It is not intended to
  function as a DBD itself (though it is possible). If you want to access flat
  files, use DBD::AnyData, or DBD::CSV (both of which are subclasses of
  DBD::File).
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
The DBD::File module is not a true DBI driver, but an abstract base class for
  deriving concrete DBI drivers from it. The implication is, that these drivers
  work with plain files, for example CSV files or INI files. The module is based
  on the SQL::Statement module, a simple SQL engine.
<p class="Pp">See DBI for details on DBI, SQL::Statement for details on
    SQL::Statement and DBD::CSV, DBD::DBM or DBD::AnyData for example
  drivers.</p>
<section class="Ss">
<h2 class="Ss" id="Metadata"><a class="permalink" href="#Metadata">Metadata</a></h2>
The following attributes are handled by DBI itself and not by DBD::File, thus
  they all work as expected:
<p class="Pp"><span class="Li"></span></p>
<pre>
    Active
    ActiveKids
    CachedKids
    CompatMode             (Not used)
    InactiveDestroy
    AutoInactiveDestroy
    Kids
    PrintError
    RaiseError
    Warn                   (Not used)
</pre>
<p class="Pp"><i>The following DBI attributes are handled by DBD::File:</i></p>
<p class="Pp">AutoCommit</p>
<p class="Pp">Always on.</p>
<p class="Pp">ChopBlanks</p>
<p class="Pp">Works.</p>
<p class="Pp">NUM_OF_FIELDS</p>
<p class="Pp">Valid after
  <span class="Li">&quot;$sth-&gt;execute&quot;</span>.</p>
<p class="Pp">NUM_OF_PARAMS</p>
<p class="Pp">Valid after
  <span class="Li">&quot;$sth-&gt;prepare&quot;</span>.</p>
<p class="Pp">NAME</p>
<p class="Pp">Valid after <span class="Li">&quot;$sth-&gt;execute&quot;</span>;
    undef for Non-Select statements.</p>
<p class="Pp">NULLABLE</p>
<p class="Pp">Not really working, always returns an array ref of ones, except
    the affected table has been created in this session. Valid after
    <span class="Li">&quot;$sth-&gt;execute&quot;</span>; undef for non-select
    statements.</p>
<p class="Pp"><i>Unsupported DBI attributes and methods</i></p>
<p class="Pp">bind_param_inout</p>
<p class="Pp">CursorName</p>
<p class="Pp">LongReadLen</p>
<p class="Pp">LongTruncOk</p>
<p class="Pp"><i>DBD::File specific attributes</i></p>
<p class="Pp">In addition to the DBI attributes, you can use the following dbh
    attributes:</p>
<p class="Pp">f_dir</p>
<p class="Pp">This attribute is used for setting the directory where the files
    are opened and it defaults to the current directory (<i>.</i>). Usually you
    set it on the dbh but it may be overridden per table (see f_meta).</p>
<p class="Pp">When the value for <span class="Li">&quot;f_dir&quot;</span> is a
    relative path, it is converted into the appropriate absolute path name
    (based on the current working directory) when the dbh attribute is set.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  f_dir =&gt; &quot;/data/foo/csv&quot;,
</pre>
<p class="Pp">See &quot;KNOWN BUGS AND LIMITATIONS&quot;.</p>
<p class="Pp">f_dir_search</p>
<p class="Pp">This optional attribute can be set to pass a list of folders to
    also find existing tables. It will <b>not</b> be used to create new
  files.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  f_dir_search =&gt; [ &quot;/data/bar/csv&quot;, &quot;/dump/blargh/data&quot; ],
</pre>
<p class="Pp">f_ext</p>
<p class="Pp">This attribute is used for setting the file extension. The format
    is:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  extension{/flag}
</pre>
<p class="Pp">where the /flag is optional and the extension is case-insensitive.
    <span class="Li">&quot;f_ext&quot;</span> allows you to specify an extension
    which:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  f_ext =&gt; &quot;.csv/r&quot;,
</pre>
<ul class="Bl-bullet">
  <li>makes DBD::File prefer <i>table.extension</i> over <i>table</i>.</li>
  <li>makes the table name the filename minus the extension.</li>
</ul>
<p class="Pp"><span class="Li"></span></p>
<pre>
    DBI:CSV:f_dir=data;f_ext=.csv
</pre>
<p class="Pp">In the above example and when
    <span class="Li">&quot;f_dir&quot;</span> contains both <i>table.csv</i> and
    <i>table</i>, DBD::File will open <i>table.csv</i> and the table will be
    named &quot;table&quot;. If <i>table.csv</i> does not exist but <i>table</i>
    does that file is opened and the table is also called &quot;table&quot;.</p>
<p class="Pp">If <span class="Li">&quot;f_ext&quot;</span> is not specified and
    <i>table.csv</i> exists it will be opened and the table will be called
    &quot;table.csv&quot; which is probably not what you want.</p>
<p class="Pp">NOTE: even though extensions are case-insensitive, table names are
    not.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    DBI:CSV:f_dir=data;f_ext=.csv/r
</pre>
<p class="Pp">The <span class="Li">&quot;r&quot;</span> flag means the file
    extension is required and any filename that does not match the extension is
    ignored.</p>
<p class="Pp">Usually you set it on the dbh but it may be overridden per table
    (see f_meta).</p>
<p class="Pp">f_schema</p>
<p class="Pp">This will set the schema name and defaults to the owner of the
    directory in which the table file resides. You can set
    <span class="Li">&quot;f_schema&quot;</span> to
    <span class="Li">&quot;undef&quot;</span>.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $dbh = DBI-&gt;connect (&quot;dbi:CSV:&quot;, &quot;&quot;, &quot;&quot;, {
        f_schema =&gt; undef,
        f_dir    =&gt; &quot;data&quot;,
        f_ext    =&gt; &quot;.csv/r&quot;,
        }) or die $DBI::errstr;
</pre>
<p class="Pp">By setting the schema you affect the results from the tables
  call:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my @tables = $dbh-&gt;tables ();

    # no f_schema
    &quot;merijn&quot;.foo
    &quot;merijn&quot;.bar

    # f_schema =&gt; &quot;dbi&quot;
    &quot;dbi&quot;.foo
    &quot;dbi&quot;.bar

    # f_schema =&gt; undef
    foo
    bar
</pre>
<p class="Pp">Defining <span class="Li">&quot;f_schema&quot;</span> to the empty
    string is equal to setting it to <span class="Li">&quot;undef&quot;</span>
    so the DSN can be
    <span class="Li">&quot;dbi:CSV:f_schema=;f_dir=.&quot;</span>.</p>
<p class="Pp">f_lock</p>
<p class="Pp">The <span class="Li">&quot;f_lock&quot;</span> attribute is used
    to set the locking mode on the opened table files. Note that not all
    platforms support locking. By default, tables are opened with a shared lock
    for reading, and with an exclusive lock for writing. The supported modes
    are:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  0: No locking at all.

  1: Shared locks will be used.

  2: Exclusive locks will be used.
</pre>
<p class="Pp">But see KNOWN BUGS below.</p>
<p class="Pp">f_lockfile</p>
<p class="Pp">If you wish to use a lockfile extension other than
    <span class="Li">&quot;.lck&quot;</span>, simply specify the
    <span class="Li">&quot;f_lockfile&quot;</span> attribute:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  $dbh = DBI-&gt;connect (&quot;dbi:DBM:f_lockfile=.foo&quot;);
  $dbh-&gt;{f_lockfile} = &quot;.foo&quot;;
  $dbh-&gt;{dbm_tables}{qux}{f_lockfile} = &quot;.foo&quot;;
</pre>
<p class="Pp">If you wish to disable locking, set the
    <span class="Li">&quot;f_lockfile&quot;</span> to
  <span class="Li">0</span>.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  $dbh = DBI-&gt;connect (&quot;dbi:DBM:f_lockfile=0&quot;);
  $dbh-&gt;{f_lockfile} = 0;
  $dbh-&gt;{dbm_tables}{qux}{f_lockfile} = 0;
</pre>
<p class="Pp">f_encoding</p>
<p class="Pp">With this attribute, you can set the encoding in which the file is
    opened. This is implemented using <span class="Li">&quot;binmode $fh,
    &quot;:encoding(&lt;f_encoding&gt;)&quot;&quot;</span>.</p>
<p class="Pp">f_meta</p>
<p class="Pp">Private data area aliasing &quot;sql_meta&quot; in
    DBI::DBD::SqlEngine which contains information about the tables this module
    handles. Table meta data might not be available until the table has been
    accessed for the first time e.g., by issuing a select on it however it is
    possible to pre-initialize attributes for each table you use.</p>
<p class="Pp">DBD::File recognizes the (public) attributes
    <span class="Li">&quot;f_ext&quot;</span>,
    <span class="Li">&quot;f_dir&quot;</span>,
    <span class="Li">&quot;f_file&quot;</span>,
    <span class="Li">&quot;f_encoding&quot;</span>,
    <span class="Li">&quot;f_lock&quot;</span>,
    <span class="Li">&quot;f_lockfile&quot;</span>,
    <span class="Li">&quot;f_schema&quot;</span>, in addition to the attributes
    &quot;sql_meta&quot; in DBI::DBD::SqlEngine already supports. Be very
    careful when modifying attributes you do not know, the consequence might be
    a destroyed or corrupted table.</p>
<p class="Pp"><span class="Li">&quot;f_file&quot;</span> is an attribute
    applicable to table meta data only and you will not find a corresponding
    attribute in the dbh. Whilst it may be reasonable to have several tables
    with the same column names, it is not for the same file name. If you need
    access to the same file using different table names, use
    <span class="Li">&quot;SQL::Statement&quot;</span> as the SQL engine and the
    <span class="Li">&quot;AS&quot;</span> keyword:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    SELECT * FROM tbl AS t1, tbl AS t2 WHERE t1.id = t2.id
</pre>
<p class="Pp"><span class="Li">&quot;f_file&quot;</span> can be an absolute path
    name or a relative path name but if it is relative, it is interpreted as
    being relative to the <span class="Li">&quot;f_dir&quot;</span> attribute of
    the table meta data. When <span class="Li">&quot;f_file&quot;</span> is set
    DBD::File will use <span class="Li">&quot;f_file&quot;</span> as specified
    and will not attempt to work out an alternative for
    <span class="Li">&quot;f_file&quot;</span> using the
    <span class="Li">&quot;table name&quot;</span> and
    <span class="Li">&quot;f_ext&quot;</span> attribute.</p>
<p class="Pp">While <span class="Li">&quot;f_meta&quot;</span> is a private and
    readonly attribute (which means, you cannot modify it's values), derived
    drivers might provide restricted write access through another attribute.
    Well known accessors are <span class="Li">&quot;csv_tables&quot;</span> for
    DBD::CSV, <span class="Li">&quot;ad_tables&quot;</span> for DBD::AnyData and
    <span class="Li">&quot;dbm_tables&quot;</span> for DBD::DBM.</p>
<p class="Pp"><i>New opportunities for attributes from
  DBI::DBD::SqlEngine</i></p>
<p class="Pp">sql_table_source</p>
<p class="Pp"><span class="Li">&quot;$dbh-&gt;{sql_table_source}&quot;</span>
    can be set to <i>DBD::File::TableSource::FileSystem</i> (and is the default
    setting of DBD::File). This provides usual behaviour of previous DBD::File
    releases on</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  @ary = DBI-&gt;data_sources ($driver);
  @ary = DBI-&gt;data_sources ($driver, \%attr);
  
  @ary = $dbh-&gt;data_sources ();
  @ary = $dbh-&gt;data_sources (\%attr);

  @names = $dbh-&gt;tables ($catalog, $schema, $table, $type);
  
  $sth = $dbh-&gt;table_info ($catalog, $schema, $table, $type);
  $sth = $dbh-&gt;table_info ($catalog, $schema, $table, $type, \%attr);

  $dbh-&gt;func (&quot;list_tables&quot;);
</pre>
<p class="Pp">sql_data_source</p>
<p class="Pp"><span class="Li">&quot;$dbh-&gt;{sql_data_source}&quot;</span> can
    be set to either <i>DBD::File::DataSource::File</i>, which is default and
    provides the well known behavior of DBD::File releases prior to 0.41, or
    <i>DBD::File::DataSource::Stream</i>, which reuses already opened
    file-handle for operations.</p>
<p class="Pp"><i>Internally private attributes to deal with SQL backends</i></p>
<p class="Pp">Do not modify any of these private attributes unless you
    understand the implications of doing so. The behavior of DBD::File and
    derived DBDs might be unpredictable when one or more of those attributes are
    modified.</p>
<p class="Pp">sql_nano_version</p>
<p class="Pp">Contains the version of loaded DBI::SQL::Nano.</p>
<p class="Pp">sql_statement_version</p>
<p class="Pp">Contains the version of loaded SQL::Statement.</p>
<p class="Pp">sql_handler</p>
<p class="Pp">Contains either the text 'SQL::Statement' or 'DBI::SQL::Nano'.</p>
<p class="Pp">sql_ram_tables</p>
<p class="Pp">Contains optionally temporary tables.</p>
<p class="Pp">sql_flags</p>
<p class="Pp">Contains optional flags to instantiate the SQL::Parser parsing
    engine when SQL::Statement is used as SQL engine. See SQL::Parser for valid
    flags.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Driver_private_methods"><a class="permalink" href="#Driver_private_methods">Driver
  private methods</a></h2>
<i>Default DBI methods</i>
<p class="Pp">data_sources</p>
<p class="Pp">The <span class="Li">&quot;data_sources&quot;</span> method
    returns a list of subdirectories of the current directory in the form
    &quot;dbi:CSV:f_dir=$dirname&quot;.</p>
<p class="Pp">If you want to read the subdirectories of another directory,
  use</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my ($drh)  = DBI-&gt;install_driver (&quot;CSV&quot;);
    my (@list) = $drh-&gt;data_sources (f_dir =&gt; &quot;/usr/local/csv_data&quot;);
</pre>
<p class="Pp"><i>Additional methods</i></p>
<p class="Pp">The following methods are only available via their documented name
    when DBD::File is used directly. Because this is only reasonable for testing
    purposes, the real names must be used instead. Those names can be computed
    by replacing the <span class="Li">&quot;f_&quot;</span> in the method name
    with the driver prefix.</p>
<p class="Pp">f_versions</p>
<p class="Pp">Signature:</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
  sub f_versions (;$)
  {
    my ($table_name) = @_;
    $table_name ||= &quot;.&quot;;
    ...
    }
</pre>
<p class="Pp">Returns the versions of the driver, including the DBI version, the
    Perl version, DBI::PurePerl version (if DBI::PurePerl is active) and the
    version of the SQL engine in use.</p>
<p class="Pp"><span class="Li"></span></p>
<pre>
    my $dbh = DBI-&gt;connect (&quot;dbi:File:&quot;);
    my $f_versions = $dbh-&gt;func (&quot;f_versions&quot;);
    print &quot;$f_versions\n&quot;;
    __END__
    # DBD::File              0.41 using IO::File (1.16)
    #   DBI::DBD::SqlEngine  0.05 using SQL::Statement 1.406
    # DBI                    1.623
    # OS                     darwin (12.2.1)
    # Perl                   5.017006 (darwin-thread-multi-ld-2level)
</pre>
<p class="Pp">Called in list context, f_versions will return an array containing
    each line as single entry.</p>
<p class="Pp">Some drivers might use the optional (table name) argument and
    modify version information related to the table (e.g. DBD::DBM provides
    storage backend information for the requested table, when it has a table
    name).</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="KNOWN_BUGS_AND_LIMITATIONS"><a class="permalink" href="#KNOWN_BUGS_AND_LIMITATIONS">KNOWN
  BUGS AND LIMITATIONS</a></h1>
<ul class="Bl-bullet">
  <li>This module uses flock () internally but flock is not available on all
      platforms. On MacOS and Windows 95 there is no locking at all (perhaps not
      so important on MacOS and Windows 95, as there is only a single
    user).</li>
  <li>The module stores details about the handled tables in a private area of
      the driver handle (<span class="Li">$drh</span>). This data area is not
      shared between different driver instances, so several
      <span class="Li">&quot;DBI-&gt;connect ()&quot;</span> calls will cause
      different table instances and private data areas.
    <p class="Pp">This data area is filled for the first time when a table is
        accessed, either via an SQL statement or via
        <span class="Li">&quot;table_info&quot;</span> and is not destroyed
        until the table is dropped or the driver handle is released. Manual
        destruction is possible via f_clear_meta.</p>
    <p class="Pp">The following attributes are preserved in the data area and
        will evaluated instead of driver globals:</p>
  </li>
</ul>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>f_ext</dt>
  <dd></dd>
  <dt>f_dir</dt>
  <dd></dd>
  <dt>f_dir_search</dt>
  <dd></dd>
  <dt>f_lock</dt>
  <dd></dd>
  <dt>f_lockfile</dt>
  <dd></dd>
  <dt>f_encoding</dt>
  <dd></dd>
  <dt>f_schema</dt>
  <dd></dd>
  <dt>col_names</dt>
  <dd></dd>
  <dt>sql_identifier_case</dt>
  <dd></dd>
</dl>
</div>
<div class="Bd-indent">
<p class="Pp">The following attributes are preserved in the data area only and
    cannot be set globally.</p>
<dl class="Bl-tag">
  <dt>f_file</dt>
  <dd></dd>
</dl>
</div>
<div class="Bd-indent">
<p class="Pp">The following attributes are preserved in the data area only and
    are computed when initializing the data area:</p>
<dl class="Bl-tag">
  <dt>f_fqfn</dt>
  <dd></dd>
  <dt>f_fqbn</dt>
  <dd></dd>
  <dt>f_fqln</dt>
  <dd></dd>
  <dt>table_name</dt>
  <dd></dd>
</dl>
</div>
<div class="Bd-indent">
<p class="Pp">For DBD::CSV tables this means, once opened &quot;foo.csv&quot; as
    table named &quot;foo&quot;, another table named &quot;foo&quot; accessing
    the file &quot;foo.txt&quot; cannot be opened. Accessing &quot;foo&quot;
    will always access the file &quot;foo.csv&quot; in memorized
    <span class="Li">&quot;f_dir&quot;</span>, locking
    <span class="Li">&quot;f_lockfile&quot;</span> via memorized
    <span class="Li">&quot;f_lock&quot;</span>.</p>
<p class="Pp">You can use f_clear_meta or the
    <span class="Li">&quot;f_file&quot;</span> attribute for a specific table to
    work around this.</p>
</div>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>When used with SQL::Statement and temporary tables e.g.,
    <p class="Pp"><span class="Li"></span></p>
    <pre>
  CREATE TEMP TABLE ...
    </pre>
    <p class="Pp">the table data processing bypasses DBD::File::Table. No file
        system calls will be made and there are no clashes with existing (file
        based) tables with the same name. Temporary tables are chosen over file
        tables, but they will not covered by
        <span class="Li">&quot;table_info&quot;</span>.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
This module is currently maintained by
<p class="Pp">H.Merijn Brand &lt; h.m.brand at xs4all.nl &gt; and Jens Rehsack
    &lt; rehsack at googlemail.com &gt;</p>
<p class="Pp">The original author is Jochen Wiedmann.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<span class="Li"></span>
<pre>
 Copyright (C) 2009-2013 by H.Merijn Brand &amp; Jens Rehsack
 Copyright (C) 2004-2009 by Jeff Zucker
 Copyright (C) 1998-2004 by Jochen Wiedmann
</pre>
<p class="Pp">All rights reserved.</p>
<p class="Pp">You may freely distribute and/or modify this module under the
    terms of either the GNU General Public License (GPL) or the Artistic
    License, as specified in the Perl README file.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
DBI, DBD::DBM, DBD::CSV, Text::CSV, Text::CSV_XS, SQL::Statement, and
  DBI::SQL::Nano
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-07-22</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
