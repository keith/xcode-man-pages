<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated from the sudoers.mdoc.in file.  Do not edit.
  
   SPDX-License-Identifier: ISC
  
   Copyright (c) 1994-1996, 1998-2005, 2007-2025
  	Todd C. Miller <Todd.Miller@sudo.ws>
  
   Permission to use, copy, modify, and distribute this software for any
   purpose with or without fee is hereby granted, provided that the above
   copyright notice and this permission notice appear in all copies.
  
   THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
   WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
   MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
   ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
   WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
   ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
   OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
  
   Sponsored in part by the Defense Advanced Research Projects
   Agency (DARPA) and Air Force Research Laboratory, Air Force
   Materiel Command, USAF, under agreement number F39502-99-1-0512.
   -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>SUDOERS(5)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SUDOERS(5)</td>
    <td class="head-vol">File Formats Manual</td>
    <td class="head-rtitle">SUDOERS(5)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><b>sudoers</b> - default sudo security policy plugin</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The <b>sudoers</b> policy plugin determines a user's <b>sudo</b>
    privileges. It is the default <b>sudo</b> policy plugin. The policy is
    driven by the <i>/private/etc/sudoers</i> file or, optionally, in LDAP. The
    policy format is described in detail in the <i>SUDOERS FILE FORMAT</i>
    section. For information on storing <b>sudoers</b> policy information in
    LDAP, see sudoers.ldap(5).</p>
<section class="Ss">
<h2 class="Ss" id="Configuring_sudo.conf_for_sudoers"><a class="permalink" href="#Configuring_sudo.conf_for_sudoers">Configuring
  sudo.conf for sudoers</a></h2>
<p class="Pp"><b>sudo</b> consults the sudo.conf(5) file to determine which
    plugins to load. If no sudo.conf(5) file is present, or if it contains no
    <i>Plugin</i> lines, <b>sudoers</b> will be used for auditing, policy
    decisions and I/O logging. To explicitly configure sudo.conf(5) to use the
    <b>sudoers</b> plugin, the following configuration can be used.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Plugin sudoers_audit sudoers.so
Plugin sudoers_policy sudoers.so
Plugin sudoers_io sudoers.so</pre>
</div>
<pre></pre>
<p class="Pp">Starting with <b>sudo</b> 1.8.5, it is possible to specify
    optional arguments to the <b>sudoers</b> plugin in the sudo.conf(5) file.
    Plugin arguments, if any, should be listed after the path to the plugin
    (i.e., after <i>sudoers.so</i>). The arguments are only effective for the
    plugin that opens (and parses) the <i>sudoers</i> file.</p>
<p class="Pp">For <b>sudo</b> version 1.9.1 and higher, this is the
    <i>sudoers_audit</i> plugin. For older versions, it is the
    <i>sudoers_policy</i> plugin. Multiple arguments may be specified, separated
    by white space. For example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Plugin sudoers_audit sudoers.so sudoers_mode=0400 error_recovery=false</pre>
</div>
<pre></pre>
<p class="Pp">The following plugin arguments are supported:</p>
<dl class="Bl-tag">
  <dt id="error_recovery=bool"><a class="permalink" href="#error_recovery=bool">error_recovery=bool</a></dt>
  <dd>The <i>error_recovery</i> argument can be used to control whether
      <b>sudoers</b> should attempt to recover from syntax errors in the
      <i>sudoers</i> file. If set to <i>true</i> (the default), <b>sudoers</b>
      will try to recover from a syntax error by discarding the portion of the
      line that contains the error until the end of the line. A value of
      <i>false</i> will disable error recovery. Prior to version 1.9.3, no error
      recovery was performed.</dd>
  <dt id="ignore_perms=bool"><a class="permalink" href="#ignore_perms=bool">ignore_perms=bool</a></dt>
  <dd>The <i>ignore_perms</i> argument can be used to disable security checks
      when loading the <i>sudoers</i> file. If enabled, the <i>sudoers</i> file
      will be loaded regardless of the owner or file mode. This argument is
      intended to be used for testing purposes and should not be enabled on
      production systems.</dd>
  <dt id="ldap_conf=pathname"><a class="permalink" href="#ldap_conf=pathname">ldap_conf=pathname</a></dt>
  <dd>The <i>ldap_conf</i> argument can be used to override the default path to
      the <i>ldap.conf</i> file.</dd>
  <dt id="ldap_secret=pathname"><a class="permalink" href="#ldap_secret=pathname">ldap_secret=pathname</a></dt>
  <dd>The <i>ldap_secret</i> argument can be used to override the default path
      to the <i>ldap.secret</i> file.</dd>
  <dt id="sudoers_file=pathname"><a class="permalink" href="#sudoers_file=pathname">sudoers_file=pathname</a></dt>
  <dd>The <i>sudoers_file</i> argument can be used to override the default path
      to the <i>sudoers</i> file.</dd>
  <dt id="sudoers_uid=user_ID"><a class="permalink" href="#sudoers_uid=user_ID">sudoers_uid=user-ID</a></dt>
  <dd>The <i>sudoers_uid</i> argument can be used to override the default owner
      of the sudoers file. It should be specified as a numeric user-ID.</dd>
  <dt id="sudoers_gid=group_ID"><a class="permalink" href="#sudoers_gid=group_ID">sudoers_gid=group-ID</a></dt>
  <dd>The <i>sudoers_gid</i> argument can be used to override the default group
      of the sudoers file. It must be specified as a numeric group-ID (not a
      group name).</dd>
  <dt id="sudoers_mode=mode"><a class="permalink" href="#sudoers_mode=mode">sudoers_mode=mode</a></dt>
  <dd>The <i>sudoers_mode</i> argument can be used to override the default file
      mode for the sudoers file. It should be specified as an octal value.</dd>
</dl>
<p class="Pp">For more information on configuring sudo.conf(5), refer to its
    manual.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="User_Authentication"><a class="permalink" href="#User_Authentication">User
  Authentication</a></h2>
<p class="Pp">The <b>sudoers</b> security policy requires that most users
    authenticate themselves before they can use <b>sudo</b>. A password is not
    required if the invoking user is <b>root</b>, if the target user is the same
    as the invoking user, or if the policy has disabled authentication for the
    user or command. Unlike su(1), when <b>sudoers</b> requires authentication,
    it validates the invoking user's credentials, not the target user's (or
    <b>root</b>'s) credentials. This can be changed via the <i>rootpw</i>,
    <i>targetpw</i> and <i>runaspw</i> flags, described later.</p>
<p class="Pp">If a user who is not listed in the policy tries to run a command
    via <b>sudo</b>, mail is sent to the proper authorities. The address used
    for such mail is configurable via the <i>mailto</i> Defaults entry
    (described later) and defaults to <i>root</i>.</p>
<p class="Pp">No mail will be sent if an unauthorized user tries to run
    <b>sudo</b> with the <b>-l</b> or <b>-v</b> option unless there is an
    authentication error and either the <i>mail_always</i> or
    <i>mail_badpass</i> flags are enabled. This allows users to determine for
    themselves whether or not they are allowed to use <b>sudo</b>. By default,
    all attempts to run <b>sudo</b> (successful or not) are logged, regardless
    of whether or not mail is sent.</p>
<p class="Pp">If <b>sudo</b> is run by <b>root</b> and the SUDO_USER environment
    variable is set, the <b>sudoers</b> policy will use this value to determine
    who the actual user is. This can be used by a user to log commands through
    sudo even when a <b>root</b> shell has been invoked. It also allows the
    <b>-e</b> option to remain useful even when invoked via a sudo-run script or
    program. Note, however, that the <i>sudoers</i> file lookup is still done
    for <b>root</b>, not the user specified by SUDO_USER.</p>
<p class="Pp"><b>sudoers</b> uses per-user time stamp files for credential
    caching. Once a user has been authenticated, a record is written containing
    the user-ID that was used to authenticate, the terminal session ID, the
    start time of the session leader (or parent process) and a time stamp (using
    a monotonic clock if one is available). The user may then use <b>sudo</b>
    without a password for a short period of time (5 minutes unless overridden
    by the <i>timestamp_timeout</i> option). By default, <b>sudoers</b> uses a
    separate record for each terminal, which means that a user's login sessions
    are authenticated separately. The <i>timestamp_type</i> option can be used
    to select the type of time stamp record <b>sudoers</b> will use.</p>
<p class="Pp">The <b>tsdump</b> utility, included with the sudo source
    distribution, can be used to display the contents of a time stamp file. See
    sudoers_timestamp(5) for details of the time stamp file format.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Logging"><a class="permalink" href="#Logging">Logging</a></h2>
<p class="Pp">By default, <b>sudoers</b> logs both successful and unsuccessful
    attempts (as well as errors). The <i>log_allowed</i> and <i>log_denied</i>
    flags can be used to control this behavior. Messages can be logged to
    syslog(3), a log file, or both. The default is to log to syslog(3) but this
    is configurable via the <i>syslog</i> and <i>logfile</i> settings. See
    <i>EVENT LOGGING</i> for a description of the log file format.</p>
<p class="Pp"><b>sudoers</b> is also capable of running a command in a
    pseudo-terminal and logging input and/or output. The standard input,
    standard output, and standard error can be logged even when not associated
    with a terminal. For more information about I/O logging, see the <i>I/O
    LOGGING</i> section.</p>
<p class="Pp">Starting with version 1.9, the <i>log_servers</i> setting may be
    used to send event and I/O log data to a remote server running
    <b>sudo_logsrvd</b> or another service that implements the protocol
    described by sudo_logsrv.proto(5).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Command_environment"><a class="permalink" href="#Command_environment">Command
  environment</a></h2>
<p class="Pp">Since environment variables can influence program behavior,
    <b>sudoers</b> provides a means to restrict which variables from the user's
    environment are inherited by the command to be run. There are two distinct
    ways <b>sudoers</b> can deal with environment variables.</p>
<p class="Pp">By default, the <i>env_reset</i> flag is enabled. This causes
    commands to be executed with a new, minimal environment. On AIX (and Linux
    systems without PAM), the environment is initialized with the contents of
    the <i>/etc/environment</i> file. The HOME, MAIL, SHELL, LOGNAME and USER
    environment variables are initialized based on the target user and the
    SUDO_* variables are set based on the invoking user. Additional variables,
    such as DISPLAY, PATH and TERM, are preserved from the invoking user's
    environment if permitted by the <i>env_check</i>, or <i>env_keep</i>
    options. A few environment variables are treated specially. If the PATH and
    TERM variables are not preserved from the user's environment, they will be
    set to default values. The LOGNAME and USER are handled as a single entity.
    If one of them is preserved (or removed) from the user's environment, the
    other will be as well. If LOGNAME and USER are to be preserved but only one
    of them is present in the user's environment, the other will be set to the
    same value. This avoids an inconsistent environment where one of the
    variables describing the user name is set to the invoking user and one is
    set to the target user. Environment variables with a value beginning with
    &#x2018;()&#x2019; are removed unless both the name and value parts are
    matched by <i>env_keep</i> or <i>env_check</i>, as they may be interpreted
    as functions by the <b>bash</b> shell. Prior to version 1.8.11, such
    variables were always removed.</p>
<p class="Pp">If, however, the <i>env_reset</i> flag is disabled, any variables
    not explicitly denied by the <i>env_check</i> and <i>env_delete</i> options
    are allowed and their values are inherited from the invoking process. Prior
    to version 1.8.21, environment variables with a value beginning with
    &#x2018;()&#x2019; were always removed. Beginning with version 1.8.21, a
    pattern in <i>env_delete</i> is used to match <b>bash</b> shell functions
    instead. Since it is not possible to block all potentially dangerous
    environment variables, use of the default <i>env_reset</i> behavior is
    encouraged.</p>
<p class="Pp">Environment variables specified by <i>env_check</i>,
    <i>env_delete</i>, or <i>env_keep</i> may include one or more
    &#x2018;*&#x2019; characters which will match zero or more characters. No
    other wildcard characters are supported.</p>
<p class="Pp">By default, environment variables are matched by name. However, if
    the pattern includes an equal sign (&#x2018;=&#x2019;), both the variables
    name and value must match. For example, a <b>bash</b> shell function could
    be matched as follows:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>env_keep += &quot;BASH_FUNC_my_func%%=()*&quot;</pre>
</div>
<pre></pre>
<p class="Pp">Without the &#x2018;=()*&#x2019; suffix, this would not match, as
    <b>bash</b> shell functions are not preserved by default.</p>
<p class="Pp">The complete list of environment variables that are preserved or
    removed, as modified by global Defaults parameters in <i>sudoers</i>, is
    displayed when <b>sudo</b> is run by <b>root</b> with the <b>-V</b> option.
    The list of environment variables to remove varies based on the operating
    system <b>sudo</b> is running on.</p>
<p class="Pp">Other settings may influence the command environment:</p>
<dl class="Bl-tag">
  <dt><b>&#x2022;</b></dt>
  <dd><b>sudoers</b> options such as <i>always_set_home</i>, <i>secure_path</i>,
      <i>set_logname</i>, <i>set_home</i>, and <i>setenv</i>.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>Command tags, such as SETENV and NOSETENV. Note that SETENV is implied if
      the command matched is <b>ALL</b>.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd><b>sudo</b> options, such as <b>-E</b> and <b>-i</b>.</dd>
</dl>
<p class="Pp">On systems that support PAM where the <b>pam_env</b> module is
    enabled for <b>sudo</b>, variables in the PAM environment may be merged in
    to the environment. If a variable in the PAM environment is already present
    in the user's environment, the value will only be overridden if the variable
    was not preserved by <b>sudoers</b>. When <i>env_reset</i> is enabled,
    variables preserved from the invoking user's environment by the
    <i>env_keep</i> list take precedence over those in the PAM environment. When
    <i>env_reset</i> is disabled, variables present the invoking user's
    environment take precedence over those in the PAM environment unless they
    match a pattern in the <i>env_delete</i> list.</p>
<p class="Pp">The dynamic linker on most operating systems will remove variables
    that can control dynamic linking from the environment of set-user-ID
    executables, including <b>sudo</b>. Depending on the operating system this
    may include _RLD*, DYLD_*, LD_*, LDR_*, LIBPATH, SHLIB_PATH, and others.
    These type of variables are removed from the environment before <b>sudo</b>
    even begins execution and, as such, it is not possible for <b>sudo</b> to
    preserve them.</p>
<p class="Pp">As a special case, if the <b>-i</b> option (initial login) is
    specified, <b>sudoers</b> will initialize the environment regardless of the
    value of <i>env_reset</i>. The DISPLAY, PATH and TERM variables remain
    unchanged; HOME, MAIL, SHELL, USER, and LOGNAME are set based on the target
    user. On AIX (and Linux systems without PAM), the contents of
    <i>/etc/environment</i> are also included. All other environment variables
    are removed unless permitted by <i>env_keep</i> or <i>env_check</i>,
    described above.</p>
<p class="Pp">Finally, the <i>restricted_env_file</i> and <i>env_file</i> files
    are applied, if present. The variables in <i>restricted_env_file</i> are
    applied first and are subject to the same restrictions as the invoking
    user's environment, as detailed above. The variables in <i>env_file</i> are
    applied last and are not subject to these restrictions. In both cases,
    variables present in the files will only be set to their specified values if
    they would not conflict with an existing environment variable.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SUDOERS_FILE_FORMAT"><a class="permalink" href="#SUDOERS_FILE_FORMAT">SUDOERS
  FILE FORMAT</a></h1>
<p class="Pp">The <i>sudoers</i> file is composed of two types of entries:
    aliases (basically variables) and user specifications (which specify who may
    run what).</p>
<p class="Pp">When multiple entries match for a user, they are applied in order.
    Where there are multiple matches, the last match is used (which is not
    necessarily the most specific match).</p>
<p class="Pp">The <i>sudoers</i> file grammar will be described below in
    Extended Backus-Naur Form (EBNF). Don't despair if you are unfamiliar with
    EBNF; it is fairly simple, and the definitions below are annotated.</p>
<section class="Ss">
<h2 class="Ss" id="Resource_limits"><a class="permalink" href="#Resource_limits">Resource
  limits</a></h2>
<p class="Pp">By default, <b>sudoers</b> uses the operating system's native
    method of setting resource limits for the target user. On Linux systems,
    resource limits are usually set by the <i>pam_limits.so</i> PAM module. On
    some BSD systems, the <i>/etc/login.conf</i> file specifies resource limits
    for the user. On AIX systems, resource limits are configured in the
    <i>/etc/security/limits</i> file. If there is no system mechanism to set
    per-user resource limits, the command will run with the same limits as the
    invoking user. The one exception to this is the core dump file size, which
    is set by <b>sudoers</b> to 0 by default. Disabling core dumps by default
    makes it possible to avoid potential security problems where the core file
    is treated as trusted input.</p>
<p class="Pp">Resource limits may also be set in the <i>sudoers</i> file itself,
    in which case they override those set by the system. See the
    <i>rlimit_as</i>, <i>rlimit_core</i>, <i>rlimit_cpu</i>, <i>rlimit_data</i>,
    <i>rlimit_fsize</i>, <i>rlimit_locks</i>, <i>rlimit_memlock</i>,
    <i>rlimit_nofile</i>, <i>rlimit_nproc</i>, <i>rlimit_rss</i>,
    <i>rlimit_stack</i> options described below. Resource limits in
    <b>sudoers</b> may be specified in one of the following formats:</p>
<dl class="Bl-tag">
  <dt>&#x201C;value&#x201D;</dt>
  <dd>Both the soft and hard resource limits are set to the same value. The
      special value &#x201C;infinity&#x201D; can be used to indicate that the
      value is unlimited.</dd>
  <dt>&#x201C;soft,hard&#x201D;</dt>
  <dd>Two comma-separated values. The soft limit is set to the first value and
      the hard limit is set to the second. Both values must either be enclosed
      in a set of double quotes, or the comma must be escaped with a backslash
      (&#x2018;\&#x2019;). The special value &#x201C;infinity&#x201D; may be
      used in place of either value.</dd>
  <dt>&#x201C;default&#x201D;</dt>
  <dd>The default resource limit for the user will be used. This may be a
      user-specific value (see above) or the value of the resource limit when
      <b>sudo</b> was invoked for systems that don't support per-user
    limits.</dd>
  <dt>&#x201C;user&#x201D;</dt>
  <dd>The invoking user's resource limits will be preserved when running the
      command.</dd>
</dl>
<p class="Pp">For example, to restore the historic core dump file size behavior,
    a line like the following may be used.</p>
<p class="Pp"></p>
<div class="Bd-indent">Defaults rlimit_core=default</div>
<p class="Pp">Resource limits in <b>sudoers</b> are only supported by version
    1.8.7 or higher.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Quick_guide_to_EBNF"><a class="permalink" href="#Quick_guide_to_EBNF">Quick
  guide to EBNF</a></h2>
<p class="Pp">EBNF is a concise and exact way of describing the grammar of a
    language. Each EBNF definition is made up of <i>production rules</i>. For
    example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>symbol ::= definition | alternate1 | alternate2 ...</pre>
</div>
<pre></pre>
<p class="Pp">Each <i>production rule</i> references others and thus makes up a
    grammar for the language. EBNF also contains the following operators, which
    many readers will recognize from regular expressions. Do not, however,
    confuse them with &#x201C;wildcard&#x201D; characters, which have different
    meanings.</p>
<dl class="Bl-tag">
  <dt>?</dt>
  <dd>Means that the preceding symbol (or group of symbols) is optional. That
      is, it may appear once or not at all.</dd>
  <dt>*</dt>
  <dd>Means that the preceding symbol (or group of symbols) may appear zero or
      more times.</dd>
  <dt>+</dt>
  <dd>Means that the preceding symbol (or group of symbols) may appear one or
      more times.</dd>
</dl>
<p class="Pp">Parentheses may be used to group symbols together. For clarity, we
    will use single quotes ('') to designate what is a verbatim character string
    (as opposed to a symbol name).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Aliases"><a class="permalink" href="#Aliases">Aliases</a></h2>
<p class="Pp">There are four kinds of aliases: <i>User_Alias</i>,
    <i>Runas_Alias</i>, <i>Host_Alias</i> and <i>Cmnd_Alias</i>. Beginning with
    <b>sudo</b> 1.9.0, <i>Cmd_Alias</i> may be used in place of
    <i>Cmnd_Alias</i> if desired.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Alias ::= 'User_Alias'  User_Alias_Spec (':' User_Alias_Spec)* |
<br/>
          'Runas_Alias' Runas_Alias_Spec (':' Runas_Alias_Spec)* |
<br/>
          'Host_Alias'  Host_Alias_Spec (':' Host_Alias_Spec)* |
<br/>
          'Cmnd_Alias'  Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)* |
<br/>
          'Cmd_Alias'   Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)*
User_Alias ::= NAME
User_Alias_Spec ::= User_Alias '=' User_List
Runas_Alias ::= NAME
Runas_Alias_Spec ::= Runas_Alias '=' Runas_List
Host_Alias ::= NAME
Host_Alias_Spec ::= Host_Alias '=' Host_List
Cmnd_Alias ::= NAME
Cmnd_Alias_Spec ::= Cmnd_Alias '=' Cmnd_List
NAME ::= [A&#x2013;Z]([A&#x2013;Z][0&#x2013;9]_)*</pre>
</div>
<pre></pre>
<p class="Pp">Each <i>alias</i> definition is of the form</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Alias_Type NAME = item1, item2, ...</pre>
</div>
<pre></pre>
<p class="Pp">where <i>Alias_Type</i> is one of <i>User_Alias</i>,
    <i>Runas_Alias</i>, <i>Host_Alias</i>, or <i>Cmnd_Alias</i>. A NAME is a
    string of uppercase letters, numbers, and underscore characters
    (&#x2018;_&#x2019;). A NAME <b>must</b> start with an uppercase letter. It
    is possible to put several alias definitions of the same type on a single
    line, joined by a colon (&#x2018;:&#x2019;). For example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Alias_Type NAME = item1, item2, item3 : NAME = item4, item5</pre>
</div>
<pre></pre>
<p class="Pp">It is a syntax error to redefine an existing <i>alias</i>. It is
    possible to use the same name for <i>aliases</i> of different types, but
    this is not recommended.</p>
<p class="Pp">The definitions of what constitutes a valid <i>alias</i> member
    follow.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>User_List ::= User |
<br/>
              User ',' User_List
User ::= '!'* user name |
<br/>
         '!'* #user-ID |
<br/>
         '!'* %group |
<br/>
         '!'* %#group-ID |
<br/>
         '!'* +netgroup |
<br/>
         '!'* %:nonunix_group |
<br/>
         '!'* %:#nonunix_gid |
<br/>
         '!'* User_Alias</pre>
</div>
<pre></pre>
<p class="Pp">A <i>User_List</i> is made up of one or more user names, user-IDs
    (prefixed with &#x2018;#&#x2019;), system group names and IDs (prefixed with
    &#x2018;%&#x2019; and &#x2018;%#&#x2019; respectively), netgroups (prefixed
    with &#x2018;+&#x2019;), non-Unix group names and IDs (prefixed with
    &#x2018;%:&#x2019; and &#x2018;%:#&#x2019; respectively), and
    <i>User_Alias</i>es. Each list item may be prefixed with zero or more
    &#x2018;!&#x2019; operators. An odd number of &#x2018;!&#x2019; operators
    negate the value of the item; an even number just cancel each other out.
    User netgroups are matched using the user and domain members only; the host
    member is not used when matching.</p>
<p class="Pp">A <i>user name</i>, <i>user-ID</i>, <i>group</i>, <i>group-ID</i>,
    <i>netgroup</i>, <i>nonunix_group</i> or <i>nonunix_gid</i> may be enclosed
    in double quotes to avoid the need for escaping special characters.
    Alternately, special characters may be specified in escaped hex mode, e.g.,
    \x20 for space. When using double quotes, any prefix characters must be
    included inside the quotes.</p>
<p class="Pp">The actual <i>nonunix_group</i> and <i>nonunix_gid</i> syntax
    depends on the underlying group provider plugin. For instance, the QAS AD
    plugin supports the following formats:</p>
<dl class="Bl-tag">
  <dt><b>&#x2022;</b></dt>
  <dd>Group in the same domain: &quot;%:Group Name&quot;</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>Group in any domain: &quot;%:Group Name@FULLY.QUALIFIED.DOMAIN&quot;</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>Group SID:
    &quot;%:S-1-2-34-5678901234-5678901234-5678901234-567&quot;</dd>
</dl>
<p class="Pp">See <i>GROUP PROVIDER PLUGINS</i> for more information.</p>
<p class="Pp">Quotes around group names are optional. Unquoted strings must use
    a backslash (&#x2018;\&#x2019;) to escape spaces and special characters. See
    <i>Other special characters and reserved words</i> for a list of characters
    that need to be escaped.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Runas_List ::= Runas_Member |
<br/>
               Runas_Member ',' Runas_List
Runas_Member ::= '!'* user name |
<br/>
                 '!'* #user-ID |
<br/>
                 '!'* %group |
<br/>
                 '!'* %#group-ID |
<br/>
                 '!'* %:nonunix_group |
<br/>
                 '!'* %:#nonunix_gid |
<br/>
                 '!'* +netgroup |
<br/>
                 '!'* Runas_Alias |
<br/>
                 '!'* ALL</pre>
</div>
<pre></pre>
<p class="Pp">A <i>Runas_List</i> is similar to a <i>User_List</i> except that
    instead of <i>User_Alias</i>es it can contain <i>Runas_Alias</i>es. User
    names and groups are matched as strings. In other words, two users (groups)
    with the same user (group) ID are considered to be distinct. If you wish to
    match all user names with the same user-ID (e.g., <b>root</b> and
    <b>toor</b>), you can use a user-ID instead of a name (#0 in the example
    given). The user-ID or group-ID specified in a <i>Runas_Member</i> need not
    be listed in the password or group database.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Host_List ::= Host |
<br/>
              Host ',' Host_List
Host ::= '!'* host name |
<br/>
         '!'* ip_addr |
<br/>
         '!'* network(/netmask)? |
<br/>
         '!'* +netgroup |
<br/>
         '!'* Host_Alias |
<br/>
         '!'* ALL</pre>
</div>
<pre></pre>
<p class="Pp">A <i>Host_List</i> is made up of one or more host names, IP
    addresses, network numbers, netgroups (prefixed with &#x2018;+&#x2019;), and
    other aliases. Again, the value of an item may be negated with the
    &#x2018;!&#x2019; operator. Host netgroups are matched using the host (both
    qualified and unqualified) and domain members only; the user member is not
    used when matching. If you specify a network number without a netmask,
    <b>sudo</b> will query each of the local host's network interfaces and, if
    the network number corresponds to one of the hosts's network interfaces,
    will use the netmask of that interface. The netmask may be specified either
    in standard IP address notation (e.g., 255.255.255.0 or
    ffff:ffff:ffff:ffff::), or CIDR notation (number of bits, e.g., 24 or 64). A
    host name may include shell-style wildcards (see the <i>Wildcards</i>
    section below), but unless the <i>hostname</i> command on your machine
    returns the fully qualified host name, you'll need to use the <i>fqdn</i>
    flag for wildcards to be useful. <b>sudo</b> only inspects actual network
    interfaces; this means that IP address 127.0.0.1 (localhost) will never
    match. Also, the host name &#x201C;localhost&#x201D; will only match if that
    is the actual host name, which is usually only the case for non-networked
    systems.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>digest ::= [A&#x2013;Fa&#x2013;f0&#x2013;9]+ |
<br/>
           [A&#x2013;Za&#x2013;z0&#x2013;9\+/=]+
Digest_Spec ::= &quot;sha224&quot; ':' digest |
<br/>
                &quot;sha256&quot; ':' digest |
<br/>
                &quot;sha384&quot; ':' digest |
<br/>
                &quot;sha512&quot; ':' digest
Digest_List ::= Digest_Spec |
<br/>
                Digest_Spec ',' Digest_List
Cmnd_List ::= Cmnd |
<br/>
              Cmnd ',' Cmnd_List
command name ::= regex |
<br/>
                 file name
command ::= command name |
<br/>
            command name args |
<br/>
            command name regex |
<br/>
            command name '&quot;&quot;' |
<br/>
            ALL
Edit_Spec ::= &quot;sudoedit&quot; file name+ |
<br/>
              &quot;sudoedit&quot; regex |
<br/>
              &quot;sudoedit&quot;
List_Spec ::= &quot;list&quot;
Cmnd ::= Digest_List? '!'* command |
<br/>
         '!'* directory |
<br/>
         '!'* Edit_Spec |
<br/>
         '!'* List_Spec |
<br/>
         '!'* Cmnd_Alias</pre>
</div>
<pre></pre>
<p class="Pp">A <i>Cmnd_List</i> is a list of one or more commands, directories,
    or aliases. A command is a fully qualified file name, which may include
    shell-style wildcards (see the <i>Wildcards</i> section below), or a regular
    expression that starts with &#x2018;^&#x2019; and ends with
    &#x2018;$&#x2019; (see the <i>Regular expressions</i> section below). A
    directory is a fully qualified path name ending in a &#x2018;/&#x2019;. When
    you specify a directory in a <i>Cmnd_List</i>, the user will be able to run
    any file within that directory (but not in any sub-directories therein). If
    no command line arguments are specified, the user may run the command with
    any arguments they choose. Command line arguments can include wildcards or
    be a regular expression that starts with &#x2018;^&#x2019; and ends with
    &#x2018;$&#x2019;. If the command line arguments consist of
    &#x2018;&quot;&quot;&#x2019;, the command may only be run with <i>no</i>
    arguments.</p>
<p class="Pp">If a <i>Cmnd</i> has associated command line arguments, the
    arguments in the <i>Cmnd</i> must match those given by the user on the
    command line. If the arguments in a <i>Cmnd</i> begin with the
    &#x2018;^&#x2019; character, they will be interpreted as a regular
    expression and matched accordingly. Otherwise, shell-style wildcards are
    used when matching. Unless a regular expression is specified, the following
    characters must be escaped with a &#x2018;\&#x2019; if they are used in
    command arguments: &#x2018;,&#x2019;, &#x2018;:&#x2019;, &#x2018;=&#x2019;,
    &#x2018;\&#x2019;. To prevent arguments in a <i>Cmnd</i> that begin with a
    &#x2018;^&#x2019; character from being interpreted as a regular expression,
    the &#x2018;^&#x2019; must be escaped with a &#x2018;\&#x2019;.</p>
<p class="Pp">There are two commands built into <b>sudo</b> itself:
    &#x201C;list&#x201D; and &#x201C;sudoedit&#x201D;. Unlike other commands,
    these two must be specified in the <i>sudoers</i> file <i>without</i> a
    leading path.</p>
<p class="Pp">The &#x201C;list&#x201D; built-in can be used to permit a user to
    list another user's privileges with <b>sudo</b>'s <b>-U</b> option. For
    example, &#x201C;sudo -l -U otheruser&#x201D;. A user with the
    &#x201C;list&#x201D; privilege is able to list another user's privileges
    even if they don't have permission to run commands as that user. By default,
    only root or a user with the ability to run any command as either root or
    the specified <i>user</i> on the current host may use the <b>-U</b> option.
    No command line arguments may be specified with the &#x201C;list&#x201D;
    built-in.</p>
<p class="Pp">The &#x201C;sudoedit&#x201D; built-in is used to permit a user to
    run <b>sudo</b> with the <b>-e</b> option (or as <b>sudoedit</b>). It may
    take command line arguments just as a normal command does. Unlike other
    commands, &#x201C;sudoedit&#x201D; is built into <b>sudo</b> itself and must
    be specified in the <i>sudoers</i> file <i>without</i> a leading path. If a
    leading path is present, for example <i>/usr/bin/sudoedit</i>, the path name
    will be silently converted to &#x201C;sudoedit&#x201D;. A fully-qualified
    path for <b>sudoedit</b> is treated as an error by <b>visudo</b>.</p>
<p class="Pp">A <i>command</i> may be preceded by a <i>Digest_List</i>, a
    comma-separated list of one or more <i>Digest_Spec</i> entries. If a
    <i>Digest_List</i> is present, the command will only match successfully if
    it can be verified using one of the SHA-2 digests in the list. Starting with
    version 1.9.0, the <b>ALL</b> reserved word can be used in conjunction with
    a <i>Digest_List</i>. The following digest formats are supported: sha224,
    sha256, sha384, and sha512. The string may be specified in either hex or
    base64 format (base64 is more compact). There are several utilities capable
    of generating SHA-2 digests in hex format such as openssl, shasum,
    sha224sum, sha256sum, sha384sum, sha512sum.</p>
<p class="Pp">For example, using openssl:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ openssl dgst -sha224 /bin/ls
SHA224(/bin/ls)= 118187da8364d490b4a7debbf483004e8f3e053ec954309de2c41a25</pre>
</div>
<pre></pre>
<p class="Pp">It is also possible to use openssl to generate base64 output:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ openssl dgst -binary -sha224 /bin/ls | openssl base64
EYGH2oNk1JC0p9679IMATo8+BT7JVDCd4sQaJQ==</pre>
</div>
<pre></pre>
<p class="Pp">Warning, if the user has write access to the command itself
    (directly or via a <b>sudo</b> command), it may be possible for the user to
    replace the command after the digest check has been performed but before the
    command is executed. A similar race condition exists on systems that lack
    the fexecve(2) system call when the directory in which the command is
    located is writable by the user. See the description of the <i>fdexec</i>
    setting for more information on how <b>sudo</b> executes commands that have
    an associated digest.</p>
<p class="Pp">Command digests are only supported by version 1.8.7 or higher.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Defaults"><a class="permalink" href="#Defaults">Defaults</a></h2>
<p class="Pp">Certain configuration options may be changed from their default
    values at run-time via one or more <i>Default_Entry</i> lines. These may
    affect all users on any host (&#x2018;Defaults&#x2019;), all users on a
    specific host (&#x2018;Defaults@host&#x2019;), a specific user
    (&#x2018;Defaults:user&#x2019;), a specific command
    (&#x2018;Defaults!cmnd&#x2019;), or commands being run as a specific user
    (&#x2018;Defaults&gt;runasuser&#x2019;).</p>
<p class="Pp">White space is not permitted between &#x2018;Defaults&#x2019; and
    the &#x2018;@&#x2019;, &#x2018;:&#x2019;, &#x2018;!&#x2019;, or
    &#x2018;&gt;&#x2019; characters. While a comma-separated list may be used in
    place of a single value after the &#x2018;@&#x2019;, &#x2018;:&#x2019;,
    &#x2018;!&#x2019;, or &#x2018;&gt;&#x2019; character, using an alias instead
    of a list is often improve readability. Per-command entries may not include
    command line arguments. If you need to specify arguments, define a
    <i>Cmnd_Alias</i> and reference that instead.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Default_Type ::= 'Defaults' |
<br/>
                 'Defaults@' Host_List |
<br/>
                 'Defaults:' User_List |
<br/>
                 'Defaults!' Cmnd_List |
<br/>
                 'Defaults&gt;' Runas_List
Default_Entry ::= Default_Type Parameter_List
Parameter_List ::= Parameter |
<br/>
                   Parameter ',' Parameter_List
Parameter ::= Parameter '=' Value |
<br/>
              Parameter '+=' Value |
<br/>
              Parameter '-=' Value |
<br/>
              '!'* Parameter</pre>
</div>
<pre></pre>
<p class="Pp">Parameters may be <b>flags</b>, <b>integer</b> values,
    <b>strings</b>, or <b>lists</b>. Flags are implicitly boolean and can be
    turned off via the &#x2018;!&#x2019; operator. Some integer, string and list
    parameters may also be used in a boolean context to disable them. Values may
    be enclosed in double quotes (&quot;&quot;) when they contain multiple
    words. Special characters may be escaped with a backslash
    (&#x2018;\&#x2019;).</p>
<p class="Pp">To include a literal backslash character in a command line
    argument you must escape the backslash twice. For example, to match
    &#x2018;\n&#x2019; as part of a command line argument, you must use
    &#x2018;\\\\n&#x2019; in the <i>sudoers</i> file. This is due to there being
    two levels of escaping, one in the <i>sudoers</i> parser itself and another
    when command line arguments are matched by the fnmatch(3) or regexec(3)
    function.</p>
<p class="Pp">Lists have two additional assignment operators, &#x2018;+=&#x2019;
    and &#x2018;-=&#x2019;. These operators are used to add to and delete from a
    list respectively. It is not an error to use the &#x2018;-=&#x2019; operator
    to remove an element that does not exist in a list.</p>
<p class="Pp">In general Defaults settings are applied in order, later entries
    will override earlier ones. However, command-specific Defaults settings are
    applied later, once the command's path is known. In addition, the following
    Defaults settings must be applied before all others since they may affect
    subsequent entries: <i>fqdn</i>, <i>group_plugin</i>,
    <i>ignore_unknown_defaults</i>, <i>match_group_by_gid</i>,
    <i>runas_default</i>, <i>sudoers_locale</i>.</p>
<p class="Pp">See <i>SUDOERS OPTIONS</i> for a list of supported Defaults
    parameters.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="User_specification"><a class="permalink" href="#User_specification">User
  specification</a></h2>
<div class="Bd-indent">
<pre>User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
<br/>
              (':' Host_List '=' Cmnd_Spec_List)*
Cmnd_Spec_List ::= Cmnd_Spec |
<br/>
                   Cmnd_Spec ',' Cmnd_Spec_List
Cmnd_Spec ::= Runas_Spec? Option_Spec* (Tag_Spec ':')* Cmnd
Runas_Spec ::= '(' Runas_List? (':' Runas_List)? ')'
Option_Spec ::= (Date_Spec | Timeout_Spec | Chdir_Spec | Chroot_Spec)
Date_Spec ::= ('NOTBEFORE=timestamp' | 'NOTAFTER=timestamp')
Timeout_Spec ::= 'TIMEOUT=timeout'
Chdir_Spec ::= 'CWD=directory'
Chroot_Spec ::= 'CHROOT=directory'
Tag_Spec ::= ('EXEC' | 'NOEXEC' | 'FOLLOW' | 'NOFOLLOW' |
<br/>
              'LOG_INPUT' | 'NOLOG_INPUT' | 'LOG_OUTPUT' |
<br/>
              'NOLOG_OUTPUT' | 'MAIL' | 'NOMAIL' | 'INTERCEPT' |
<br/>
              'NOINTERCEPT' | 'PASSWD' | 'NOPASSWD' | 'SETENV' |
<br/>
              'NOSETENV')</pre>
</div>
<pre></pre>
<p class="Pp">A <b>user specification</b> determines which commands a user may
    run (and as what user) on specified hosts. By default, commands are run as
    <b>root</b> (unless <i>runas_default</i> has been set to a different value)
    but this can also be changed on a per-command basis.</p>
<p class="Pp">The basic structure of a user specification is &#x201C;who where =
    (as_whom) what&#x201D;. Let's break that down into its constituent
  parts:</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Runas_Spec"><a class="permalink" href="#Runas_Spec">Runas_Spec</a></h2>
<p class="Pp">A <i>Runas_Spec</i> determines the user and/or the group that a
    command may be run as. A fully-specified <i>Runas_Spec</i> consists of two
    <i>Runas_List</i>s (as defined above) separated by a colon
    (&#x2018;:&#x2019;) and enclosed in a set of parentheses. The first
    <i>Runas_List</i> indicates which users the command may be run as via the
    <b>-u</b> option. The second defines a list of groups that may be specified
    via the <b>-g</b> option (in addition to any of the target user's groups).
    If both <i>Runas_List</i>s are specified, the command may be run with any
    combination of users and groups listed in their respective
    <i>Runas_List</i>s. If only the first is specified, the command may be run
    as any user in the list and, optionally, with any group the target user
    belongs to. If the first <i>Runas_List</i> is empty but the second is
    specified, the command may be run as the invoking user with the group set to
    any listed in the <i>Runas_List</i>. If both <i>Runas_List</i>s are empty,
    the command may only be run as the invoking user and the group, if
    specified, must be one that the invoking user is a member of. If no
    <i>Runas_Spec</i> is specified, the command may only be run as the
    <i>runas_default</i> user (<b>root</b> by default) and the group, if
    specified, must be one that the <i>runas_default</i> user is a member
  of.</p>
<p class="Pp">A <i>Runas_Spec</i> sets the default for the commands that follow
    it. What this means is that for the entry:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>dgb	boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>dgb</b> may run <i>/bin/ls</i>, <i>/bin/kill</i>, and
    <i>/usr/bin/lprm</i> on the host boulder&#x2014;but only as <b>operator</b>.
    For example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sudo -u operator /bin/ls</pre>
</div>
<pre></pre>
<p class="Pp">It is also possible to override a <i>Runas_Spec</i> later on in an
    entry. If we modify the entry like so:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>dgb	boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm</pre>
</div>
<pre></pre>
<p class="Pp">Then user <b>dgb</b> is now allowed to run <i>/bin/ls</i> as
    <b>operator</b>, but <i>/bin/kill</i> and <i>/usr/bin/lprm</i> as
    <b>root</b>.</p>
<p class="Pp">We can extend this to allow <b>dgb</b> to run <i>/bin/ls</i> with
    either the user or group set to <b>operator</b>:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>dgb	boulder = (operator : operator) /bin/ls, (root) /bin/kill,\
	/usr/bin/lprm</pre>
</div>
<pre></pre>
<p class="Pp">While the group portion of the <i>Runas_Spec</i> permits the user
    to run as command with that group, it does not force the user to do so. If
    no group is specified on the command line, the command will run with the
    group listed in the target user's password database entry. The following
    would all be permitted by the sudoers entry above:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sudo -u operator /bin/ls
$ sudo -u operator -g operator /bin/ls
$ sudo -g operator /bin/ls</pre>
</div>
<pre></pre>
<p class="Pp">In the following example, user <b>tcm</b> may run commands that
    access a modem device file with the dialer group.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>tcm	boulder = (:dialer) /usr/bin/tip, /usr/bin/cu,\
	/usr/local/bin/minicom</pre>
</div>
<pre></pre>
<p class="Pp">In this example only the group will be set, the command still runs
    as user <b>tcm</b>. For example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sudo -g dialer /usr/bin/cu</pre>
</div>
<pre></pre>
<p class="Pp">Multiple users and groups may be present in a <i>Runas_Spec</i>,
    in which case the user may select any combination of users and groups via
    the <b>-u</b> and <b>-g</b> options. In this example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>alan	ALL = (root, bin : operator, system) ALL</pre>
</div>
<pre></pre>
<p class="Pp">user <b>alan</b> may run any command as either user <b>root</b> or
    <b>bin</b>, optionally setting the group to operator or system.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Option_Spec"><a class="permalink" href="#Option_Spec">Option_Spec</a></h2>
<p class="Pp">A <i>Cmnd</i> may have zero or more options associated with it.
    Options may consist of start and/or end dates and command timeouts. Once an
    option is set for a <i>Cmnd</i>, subsequent <i>Cmnd</i>s in the
    <i>Cmnd_Spec_List</i>, inherit that option unless it is overridden by
    another option. Option names are reserved words in <i>sudoers</i>. This
    means that none of the valid option names (see below) can be used when
    declaring an alias.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Date_Spec"><a class="permalink" href="#Date_Spec">Date_Spec</a></h2>
<p class="Pp"><b>sudoers</b> rules can be specified with a start and end date
    via the NOTBEFORE and NOTAFTER settings. The time stamp must be specified in
    &#x201C;Generalized Time&#x201D; as defined by RFC 4517. The format is
    effectively &#x2018;yyyymmddHHMMSSZ&#x2019; where the minutes and seconds
    are optional. The &#x2018;Z&#x2019; suffix indicates that the time stamp is
    in Coordinated Universal Time (UTC). It is also possible to specify a
    timezone offset from UTC in hours and minutes instead of a
    &#x2018;Z&#x2019;. For example, &#x2018;-0500&#x2019; would correspond to
    Eastern Standard time in the US. As an extension, if no &#x2018;Z&#x2019; or
    timezone offset is specified, local time will be used.</p>
<p class="Pp">The following are all valid time stamps:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>20170214083000Z
2017021408Z
20160315220000-0500
20151201235900</pre>
</div>
<pre></pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Timeout_Spec"><a class="permalink" href="#Timeout_Spec">Timeout_Spec</a></h2>
<p class="Pp">A command may have a timeout associated with it. If the timeout
    expires before the command has exited, the command will be terminated. The
    timeout may be specified in combinations of days, hours, minutes, and
    seconds with a single-letter case-insensitive suffix that indicates the unit
    of time. For example, a timeout of 7 days, 8 hours, 30 minutes, and 10
    seconds would be written as &#x2018;7d8h30m10s&#x2019;. If a number is
    specified without a unit, seconds are assumed. Any of the days, minutes,
    hours, or seconds may be omitted. The order must be from largest to smallest
    unit and a unit may not be specified more than once.</p>
<p class="Pp">The following are all <i>valid</i> timeout values:
    &#x2018;7d8h30m10s&#x2019;, &#x2018;14d&#x2019;, &#x2018;8h30m&#x2019;,
    &#x2018;600s&#x2019;, &#x2018;3600&#x2019;. The following are <i>invalid</i>
    timeout values: &#x2018;12m2w1d&#x2019;, &#x2018;30s10m4h&#x2019;,
    &#x2018;1d2d3h&#x2019;.</p>
<p class="Pp">This setting is only supported by version 1.8.20 or higher.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Chdir_Spec"><a class="permalink" href="#Chdir_Spec">Chdir_Spec</a></h2>
<p class="Pp">The working directory that the command will be run in can be
    specified using the CWD setting. The <i>directory</i> must be a
    fully-qualified path name beginning with a &#x2018;/&#x2019; or
    &#x2018;~&#x2019; character, or the special value &#x201C;*&#x201D;. A value
    of &#x201C;*&#x201D; indicates that the user may specify the working
    directory by running <b>sudo</b> with the <b>-D</b> option. By default,
    commands are run from the invoking user's current working directory, unless
    the <b>-i</b> option is given. Path names of the form <i>~user/path/name</i>
    are interpreted as being relative to the named user's home directory. If the
    user name is omitted, the path will be relative to the runas user's home
    directory.</p>
<p class="Pp">This setting is only supported by version 1.9.3 or higher.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Chroot_Spec"><a class="permalink" href="#Chroot_Spec">Chroot_Spec</a></h2>
<p class="Pp">Support for setting the root directory is deprecated and will be
    removed in a future version of <b>sudo</b>.</p>
<p class="Pp">The root directory that the command will be run in can be
    specified using the CHROOT setting. The <i>directory</i> must be a
    fully-qualified path name beginning with a &#x2018;/&#x2019; or
    &#x2018;~&#x2019; character, or the special value &#x201C;*&#x201D;. A value
    of &#x201C;*&#x201D; indicates that the user may specify the root directory
    by running <b>sudo</b> with the <b>-R</b> option. This setting can be used
    to run the command in a chroot(2) &#x201C;sandbox&#x201D; similar to the
    chroot(8) utility. Path names of the form <i>~user/path/name</i> are
    interpreted as being relative to the named user's home directory. If the
    user name is omitted, the path will be relative to the runas user's home
    directory.</p>
<p class="Pp">This setting is only supported by version 1.9.3 or higher.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Tag_Spec"><a class="permalink" href="#Tag_Spec">Tag_Spec</a></h2>
<p class="Pp">A command may have zero or more tags associated with it. The
    following tag values are supported: EXEC, NOEXEC, FOLLOW, NOFOLLOW,
    LOG_INPUT, NOLOG_INPUT, LOG_OUTPUT, NOLOG_OUTPUT, MAIL, NOMAIL, INTERCEPT,
    NOINTERCEPT, PASSWD, NOPASSWD, SETENV, and NOSETENV. Once a tag is set on a
    <i>Cmnd</i>, subsequent <i>Cmnd</i>s in the <i>Cmnd_Spec_List</i>, inherit
    the tag unless it is overridden by the opposite tag (in other words, PASSWD
    overrides NOPASSWD and NOEXEC overrides EXEC).</p>
<dl class="Bl-tag">
  <dt id="EXEC"><a class="permalink" href="#EXEC">EXEC and NOEXEC</a></dt>
  <dd>
    <p class="Pp">If <b>sudo</b> has been compiled with <i>noexec</i> support
        and the underlying operating system supports it, the NOEXEC tag can be
        used to prevent a dynamically-linked executable from running further
        commands itself.</p>
    <p class="Pp">In the following example, user <b>aaron</b> may run
        <i>/usr/bin/more</i> and <i>/usr/bin/vi</i> on the host shanty, but
        shell escapes will be disabled.</p>
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>aaron	shanty = NOEXEC: /usr/bin/more, /usr/bin/vi</pre>
</div>
<pre></pre>
<div class="Bd-indent">
<p class="Pp">See the <i>Preventing shell escapes</i> section below for more
    details on how NOEXEC works and whether or not it will work on your
  system.</p>
</div>
<dl class="Bl-tag">
  <dt id="FOLLOW"><a class="permalink" href="#FOLLOW">FOLLOW and
    NOFOLLOW</a></dt>
  <dd>
    <p class="Pp">Starting with version 1.8.15, <b>sudoedit</b> will not open a
        file that is a symbolic link unless the <i>sudoedit_follow</i> flag is
        enabled. The FOLLOW and NOFOLLOW tags override the value of
        <i>sudoedit_follow</i> and can be used to permit (or deny) the editing
        of symbolic links on a per-command basis. These tags are only effective
        for the <i>sudoedit</i> command and are ignored for all other
      commands.</p>
  </dd>
  <dt id="LOG_INPUT"><a class="permalink" href="#LOG_INPUT">LOG_INPUT and
    NOLOG_INPUT</a></dt>
  <dd>
    <p class="Pp">These tags override the value of the <i>log_input</i> flag on
        a per-command basis. For more information, see <i>I/O LOGGING</i>.</p>
  </dd>
  <dt id="LOG_OUTPUT"><a class="permalink" href="#LOG_OUTPUT">LOG_OUTPUT and
    NOLOG_OUTPUT</a></dt>
  <dd>
    <p class="Pp">These tags override the value of the <i>log_output</i> flag on
        a per-command basis. For more information, see <i>I/O LOGGING</i>.</p>
  </dd>
  <dt id="MAIL"><a class="permalink" href="#MAIL">MAIL and NOMAIL</a></dt>
  <dd>
    <p class="Pp">These tags provide fine-grained control over whether mail will
        be sent when a user runs a command by overriding the value of the
        <i>mail_all_cmnds</i> flag on a per-command basis. They have no effect
        when <b>sudo</b> is run with the <b>-l</b> or <b>-v</b> options. A
        NOMAIL tag will also override the <i>mail_always</i> and
        <i>mail_no_perms</i> options. For more information, see the descriptions
        of <i>mail_all_cmnds</i>, <i>mail_always</i>, and <i>mail_no_perms</i>
        in the <i>SUDOERS OPTIONS</i> section below.</p>
  </dd>
  <dt id="PASSWD"><a class="permalink" href="#PASSWD">PASSWD and
    NOPASSWD</a></dt>
  <dd>
    <p class="Pp">By default, <b>sudo</b> requires that a user authenticate
        before running a command. This behavior can be modified via the NOPASSWD
        tag. Like a <i>Runas_Spec</i>, the NOPASSWD tag sets a default for the
        commands that follow it in the <i>Cmnd_Spec_List</i>. Conversely, the
        PASSWD tag can be used to reverse things. For example:</p>
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>ray	rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm</pre>
</div>
<pre></pre>
<div class="Bd-indent">
<p class="Pp">would allow the user <b>ray</b> to run <i>/bin/kill</i>,
    <i>/bin/ls</i>, and <i>/usr/bin/lprm</i> as <b>root</b> on the machine
    &#x201C;rushmore&#x201D; without authenticating himself. If we only want
    <b>ray</b> to be able to run <i>/bin/kill</i> without a password the entry
    would be:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>ray	rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm</pre>
</div>
<pre></pre>
<p class="Pp">Note, however, that the PASSWD tag has no effect on users who are
    in the group specified by the <i>exempt_group</i> setting.</p>
<p class="Pp">By default, if the NOPASSWD tag is applied to any of a user's
    entries for the current host, the user will be able to run &#x2018;sudo
    -l&#x2019; without a password. Additionally, a user may only run
    &#x2018;sudo -v&#x2019; without a password if all of the user's entries for
    the current host have the NOPASSWD tag. This behavior may be overridden via
    the <i>verifypw</i> and <i>listpw</i> options.</p>
</div>
<dl class="Bl-tag">
  <dt id="SETENV"><a class="permalink" href="#SETENV">SETENV and
    NOSETENV</a></dt>
  <dd>
    <p class="Pp">These tags override the value of the <i>setenv</i> flag on a
        per-command basis. If SETENV has been set for a command, the user may
        disable the <i>env_reset</i> flag from the command line via the
        <b>-E</b> option. Additionally, environment variables set on the command
        line are not subject to the restrictions imposed by <i>env_check</i>,
        <i>env_delete</i>, or <i>env_keep</i>. As such, only trusted users
        should be allowed to set variables in this manner. If the command
        matched is <b>ALL</b>, the SETENV tag is implied for that command; this
        default may be overridden by use of the NOSETENV tag.</p>
  </dd>
  <dt id="INTERCEPT"><a class="permalink" href="#INTERCEPT">INTERCEPT and
    NOINTERCEPT</a></dt>
  <dd>
    <p class="Pp">If <b>sudo</b> has been compiled with <i>intercept</i> support
        and the underlying operating system supports it, the INTERCEPT tag can
        be used to cause programs spawned by a command to be validated against
        <i>sudoers</i> and logged just like they would be if run through
        <b>sudo</b> directly. This is useful in conjunction with commands that
        allow shell escapes such as editors, shells, and paginators. There is
        additional overhead due to the policy check that may add latency when
        running commands such as shell scripts that execute a large number of
        sub-commands. For interactive commands, such as a shell or editor, the
        overhead is not usually noticeable.</p>
    <p class="Pp">In the following example, user <b>chuck</b> may run any
        command on the machine &#x201C;research&#x201D; in intercept mode.</p>
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>chuck	research = INTERCEPT: ALL</pre>
</div>
<pre></pre>
<div class="Bd-indent">
<p class="Pp">See the <i>Preventing shell escapes</i> section below for more
    details on how INTERCEPT works and whether or not it will work on your
    system.</p>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Wildcards"><a class="permalink" href="#Wildcards">Wildcards</a></h2>
<p class="Pp"><b>sudo</b> allows shell-style <i>wildcards</i> (aka meta or glob
    characters) to be used in host names, path names, and command line arguments
    in the <i>sudoers</i> file. Wildcard matching is done via the glob(3) and
    fnmatch(3) functions as specified by IEEE Std 1003.1
    (&#x201C;POSIX.1&#x201D;).</p>
<dl class="Bl-tag">
  <dt>*</dt>
  <dd>Matches any set of zero or more characters (including white space).</dd>
  <dt>?</dt>
  <dd>Matches any single character (including white space).</dd>
  <dt>[...]</dt>
  <dd>Matches any character in the specified range.</dd>
  <dt>[!...]</dt>
  <dd>Matches any character <i>not</i> in the specified range.</dd>
  <dt id="x"><a class="permalink" href="#x">\x</a></dt>
  <dd>For any character &#x2018;x&#x2019;, evaluates to &#x2018;x&#x2019;. This
      is used to escape special characters such as: &#x2018;*&#x2019;,
      &#x2018;?&#x2019;, &#x2018;[&#x2019;, and &#x2018;]&#x2019;.</dd>
</dl>
<p class="Pp"><b>These are not regular expressions.</b> Unlike a regular
    expression there is no way to match one or more characters within a
  range.</p>
<p class="Pp">Character classes may be used if your system's glob(3) and
    fnmatch(3) functions support them. However, because the &#x2018;:&#x2019;
    character has special meaning in <i>sudoers</i>, it must be escaped. For
    example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>/bin/ls [[\:alpha\:]]*</pre>
</div>
<pre></pre>
<p class="Pp">Would match any file name beginning with a letter.</p>
<p class="Pp">A forward slash (&#x2018;/&#x2019;) will <i>not</i> be matched by
    wildcards used in the file name portion of the command. This is to make a
    path like:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>/usr/bin/*</pre>
</div>
<pre></pre>
<p class="Pp">match <i>/usr/bin/who</i> but not <i>/usr/bin/X11/xterm</i>.</p>
<p class="Pp">When matching the command line arguments, however, a slash
    <i>does</i> get matched by wildcards since command line arguments may
    contain arbitrary strings and not just path names.</p>
<p class="Pp"><b>Wildcards in command line arguments should be used with
    care.</b>
  <br/>
  Wildcards can match any character, including white space. In most cases, it is
    safer to use a regular expression to match command line arguments. For more
    information, see <i>Wildcards in command arguments</i> below.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Exceptions_to_wildcard_rules"><a class="permalink" href="#Exceptions_to_wildcard_rules">Exceptions
  to wildcard rules</a></h2>
<p class="Pp">The following exceptions apply to the above rules:</p>
<dl class="Bl-tag">
  <dt>&quot;&quot;</dt>
  <dd>If the empty string &#x2018;&quot;&quot;&#x2019; is the only command line
      argument in the <i>sudoers</i> file entry it means that command is not
      allowed to be run with <i>any</i> arguments.</dd>
  <dt id="sudoedit"><a class="permalink" href="#sudoedit">sudoedit</a></dt>
  <dd>Command line arguments to the <i>sudoedit</i> built-in command should
      always be path names, so a forward slash (&#x2018;/&#x2019;) will not be
      matched by a wildcard.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Regular_expressions"><a class="permalink" href="#Regular_expressions">Regular
  expressions</a></h2>
<p class="Pp">Starting with version 1.9.10, it is possible to use regular
    expressions for path names and command line arguments. Regular expressions
    are more expressive than shell-style <i>wildcards</i> and are usually safer
    because they provide a greater degree of control when matching. The type of
    regular expressions supported by <b>sudoers</b> are POSIX extended regular
    expressions, similar to those used by the egrep(1) utility. They are usually
    documented in the regex(7) or re_format(7) manual, depending on the system.
    As an extension, if the regular expression begins with &#x201C;(?i)&#x201D;,
    it will be matched in a case-insensitive manner.</p>
<p class="Pp">In <i>sudoers</i>, regular expressions must start with a
    &#x2018;^&#x2019; character and end with a &#x2018;$&#x2019;. This makes it
    explicit what is, or is not, a regular expression. Either the path name, the
    command line arguments or both may be regular expressions. Because the path
    name and arguments are matched separately, it is even possible to use
    wildcards for the path name and regular expressions for the arguments. It is
    not possible to use a single regular expression to match both the command
    and its arguments. Regular expressions in <i>sudoers</i> are limited to 1024
    characters.</p>
<p class="Pp">There is no need to escape <i>sudoers</i> special characters in a
    regular expression other than the pound sign (&#x2018;#&#x2019;).</p>
<p class="Pp">In the following example, user <b>john</b> can run the passwd(1)
    command as <b>root</b> on any host but is not allowed to change
    <b>root</b>'s password. This kind of rule is impossible to express safely
    using wildcards.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>john	ALL = /usr/bin/passwd ^[a-zA-Z0-9_]+$,\
<br/>
              !/usr/bin/passwd root</pre>
</div>
<pre></pre>
<p class="Pp">It is also possible to use a regular expression in conjunction
    with <b>sudoedit</b> rules. The following rule would give user bob the
    ability to edit the <i>/etc/motd</i>, <i>/etc/issue</i>, and
    <i>/etc/hosts</i> files only.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>bob    ALL = sudoedit ^/etc/(motd|issue|hosts)$</pre>
</div>
<pre></pre>
<p class="Pp">Regular expressions may also be used to match the command itself.
    In this example, a regular expression is used to allow user <b>sid</b> to
    run the <i>/usr/sbin/groupadd</i>, <i>/usr/sbin/groupmod</i>,
    <i>/usr/sbin/groupdel</i>, <i>/usr/sbin/useradd</i>,
    <i>/usr/sbin/usermod</i>, and <i>/usr/sbin/userdel</i> commands as
    <b>root</b>.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>sid    ALL = ^/usr/sbin/(group|user)(add|mod|del)$</pre>
</div>
<pre></pre>
<p class="Pp">One disadvantage of using a regular expression to match the
    command name is that it is not possible to match relative paths such as
    <i>./useradd</i> or <i>../sbin/useradd</i>. This has security implications
    when a regular expression is used for the command name in conjunction with
    the negation operator, &#x2018;!&#x2019;, as such rules can be trivially
    bypassed. Because of this, using a negated regular expression for the
    command name is <b>strongly discouraged</b>. This does not apply to negated
    commands that only use a regular expression to match the command arguments.
    See <i>Regular expressions in command names</i> below for more
  information.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Including_other_files_from_within_sudoers"><a class="permalink" href="#Including_other_files_from_within_sudoers">Including
  other files from within sudoers</a></h2>
<p class="Pp">It is possible to include other <i>sudoers</i> files from within
    the <i>sudoers</i> file currently being parsed using the <i>@include</i> and
    <i>@includedir</i> directives. For compatibility with sudo versions prior to
    1.9.1, <i>#include</i> and <i>#includedir</i> are also accepted.</p>
<p class="Pp">An include file can be used, for example, to keep a site-wide
    <i>sudoers</i> file in addition to a local, per-machine file. For the sake
    of this example the site-wide <i>sudoers</i> file will be
    <i>/etc/sudoers</i> and the per-machine one will be
    <i>/etc/sudoers.local</i>. To include <i>/etc/sudoers.local</i> from within
    <i>/etc/sudoers</i> one would use the following line in
  <i>/etc/sudoers</i>:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>@include /etc/sudoers.local</pre>
</div>
<pre></pre>
<p class="Pp">When <b>sudo</b> reaches this line it will suspend processing of
    the current file (<i>/etc/sudoers</i>) and switch to
    <i>/etc/sudoers.local</i>. Upon reaching the end of
    <i>/etc/sudoers.local</i>, the rest of <i>/etc/sudoers</i> will be
    processed. Files that are included may themselves include other files. A
    hard limit of 128 nested include files is enforced to prevent include file
    loops.</p>
<p class="Pp">Starting with version 1.9.1, the path to the include file may
    contain white space if it is escaped with a backslash (&#x2018;\&#x2019;).
    Alternately, the entire path may be enclosed in double quotes
    (&quot;&quot;), in which case no escaping is necessary. To include a literal
    backslash in the path, &#x2018;\\&#x2019; should be used.</p>
<p class="Pp">If the path to the include file is not fully-qualified (does not
    begin with a &#x2018;/&#x2019;), it must be located in the same directory as
    the sudoers file it was included from. For example, if <i>/etc/sudoers</i>
    contains the line:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>@include sudoers.local</pre>
</div>
<pre></pre>
<p class="Pp">the file that will be included is <i>/etc/sudoers.local</i>.</p>
<p class="Pp">The file name may also include the &#x2018;%h&#x2019; escape,
    signifying the short form of the host name. In other words, if the machine's
    host name is &#x201C;xerxes&#x201D;, then</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>@include /etc/sudoers.%h</pre>
</div>
<pre></pre>
<p class="Pp">will cause <b>sudo</b> to include the file
    <i>/etc/sudoers.xerxes</i>. Any path name separator characters
    (&#x2018;/&#x2019;) present in the host name will be replaced with an
    underbar (&#x2018;_&#x2019;) during expansion.</p>
<p class="Pp">The <i>@includedir</i> directive can be used to create a
    <i>sudoers.d</i> directory that the system package manager can drop
    <i>sudoers</i> file rules into as part of package installation. For example,
    given:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>@includedir /etc/sudoers.d</pre>
</div>
<pre></pre>
<p class="Pp"><b>sudo</b> will suspend processing of the current file and read
    each file in <i>/etc/sudoers.d</i>, skipping file names that end in
    &#x2018;~&#x2019; or contain a &#x2018;.&#x2019; character to avoid causing
    problems with package manager or editor temporary/backup files.</p>
<p class="Pp">Files are parsed in sorted lexical order. That is,
    <i>/etc/sudoers.d/01_first</i> will be parsed before
    <i>/etc/sudoers.d/10_second</i>. Be aware that because the sorting is
    lexical, not numeric, <i>/etc/sudoers.d/1_whoops</i> would be loaded
    <i>after</i> <i>/etc/sudoers.d/10_second</i>. Using a consistent number of
    leading zeroes in the file names can be used to avoid such problems. After
    parsing the files in the directory, control returns to the file that
    contained the <i>@includedir</i> directive.</p>
<p class="Pp">Unlike files included via <i>@include</i>, <b>visudo</b> will not
    edit the files in a <i>@includedir</i> directory unless one of them contains
    a syntax error. It is still possible to run <b>visudo</b> with the <b>-f</b>
    flag to edit the files directly, but this will not catch the redefinition of
    an <i>alias</i> that is also present in a different file.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Other_special_characters_and_reserved_words"><a class="permalink" href="#Other_special_characters_and_reserved_words">Other
  special characters and reserved words</a></h2>
<p class="Pp">The pound sign (&#x2018;#&#x2019;) is used to indicate a comment
    (unless it is part of a #include directive or unless it occurs in the
    context of a user name and is followed by one or more digits, in which case
    it is treated as a user-ID). Both the comment character and any text after
    it, up to the end of the line, are ignored.</p>
<p class="Pp">The reserved word <b>ALL</b> is a built-in <i>alias</i> that
    always causes a match to succeed. It can be used wherever one might
    otherwise use a <i>Cmnd_Alias</i>, <i>User_Alias</i>, <i>Runas_Alias</i>, or
    <i>Host_Alias</i>. Attempting to define an <i>alias</i> named <b>ALL</b>
    will result in a syntax error. Using <b>ALL</b> can be dangerous since in a
    command context, it allows the user to run <i>any</i> command on the
  system.</p>
<p class="Pp">The following option names permitted in an <i>Option_Spec</i> are
    also considered reserved words: CHROOT, TIMEOUT, CWD, NOTBEFORE and
    NOTAFTER. Attempting to define an <i>alias</i> with the same name as one of
    the options will result in a syntax error.</p>
<p class="Pp">An exclamation point (&#x2018;!&#x2019;) can be used as a logical
    <i>not</i> operator in a list or <i>alias</i> as well as in front of a
    <i>Cmnd</i>. This allows one to exclude certain values. For the
    &#x2018;!&#x2019; operator to be effective, there must be something for it
    to exclude. For example, to match all users except for <b>root</b> one would
    use:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>ALL, !root</pre>
</div>
<pre></pre>
<p class="Pp">If the <b>ALL</b>, is omitted, as in:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>!root</pre>
</div>
<pre></pre>
<p class="Pp">it would explicitly deny <b>root</b> but not match any other
    users. This is different from a true &#x201C;negation&#x201D; operator.</p>
<p class="Pp">Note, however, that using a &#x2018;!&#x2019; in conjunction with
    the built-in <b>ALL</b> alias to allow a user to run &#x201C;all but a
    few&#x201D; commands rarely works as intended (see <i>SECURITY NOTES</i>
    below).</p>
<p class="Pp">Long lines can be continued with a backslash (&#x2018;\&#x2019;)
    as the last character on the line.</p>
<p class="Pp">White space between elements in a list as well as special
    syntactic characters in a <i>User Specification</i> (&#x2018;=&#x2019;,
    &#x2018;:&#x2019;, &#x2018;(&#x2019;, &#x2018;)&#x2019;) is optional.</p>
<p class="Pp">The following characters must be escaped with a backslash
    (&#x2018;\&#x2019;) when used as part of a word (e.g., a user name or host
    name): &#x2018;!&#x2019;, &#x2018;=&#x2019;, &#x2018;:&#x2019;,
    &#x2018;,&#x2019;, &#x2018;(&#x2019;, &#x2018;)&#x2019;,
  &#x2018;\&#x2019;.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SUDOERS_OPTIONS"><a class="permalink" href="#SUDOERS_OPTIONS">SUDOERS
  OPTIONS</a></h1>
<p class="Pp"><b>sudo</b>'s behavior can be modified by <i>Default_Entry</i>
    lines, as explained earlier. A list of all supported Defaults parameters,
    grouped by type, are listed below.</p>
<p class="Pp"><b>Boolean Flags</b>:</p>
<dl class="Bl-tag">
  <dt id="always_query_group_plugin"><a class="permalink" href="#always_query_group_plugin">always_query_group_plugin</a></dt>
  <dd>If a <i>group_plugin</i> is configured, use it to resolve groups of the
      form &#x2018;%group&#x2019; as long as there is not also a system group of
      the same name. Normally, only groups of the form &#x2018;%:group&#x2019;
      are passed to the <i>group_plugin</i>. This flag is <i>off</i> by
    default.</dd>
  <dt id="always_set_home"><a class="permalink" href="#always_set_home">always_set_home</a></dt>
  <dd>If enabled, <b>sudo</b> will set the HOME environment variable to the home
      directory of the target user (which is the <i>runas_default</i> user
      unless the <b>-u</b> option is used). This flag is largely obsolete and
      has no effect unless the <i>env_reset</i> flag has been disabled or HOME
      is present in the <i>env_keep</i> list, both of which are strongly
      discouraged. This flag is <i>off</i> by default.</dd>
  <dt id="authenticate"><a class="permalink" href="#authenticate">authenticate</a></dt>
  <dd>If set, users must authenticate themselves via a password (or other means
      of authentication) before they may run commands. This default may be
      overridden via the PASSWD and NOPASSWD tags. This flag is <i>on</i> by
      default.</dd>
  <dt id="case_insensitive_group"><a class="permalink" href="#case_insensitive_group">case_insensitive_group</a></dt>
  <dd>If enabled, group names in <i>sudoers</i> will be matched in a case
      insensitive manner. This may be necessary when users are stored in LDAP or
      AD. This flag is <i>on</i> by default.</dd>
  <dt id="case_insensitive_user"><a class="permalink" href="#case_insensitive_user">case_insensitive_user</a></dt>
  <dd>If enabled, user names in <i>sudoers</i> will be matched in a case
      insensitive manner. This may be necessary when groups are stored in LDAP
      or AD. This flag is <i>on</i> by default.</dd>
  <dt id="closefrom_override"><a class="permalink" href="#closefrom_override">closefrom_override</a></dt>
  <dd>If set, the user may use the <b>-C</b> option which overrides the default
      starting point at which <b>sudo</b> begins closing open file descriptors.
      This flag is <i>off</i> by default.</dd>
  <dt id="compress_io"><a class="permalink" href="#compress_io">compress_io</a></dt>
  <dd>If set, and <b>sudo</b> is configured to log a command's input or output,
      the I/O logs will be compressed using <b>zlib</b>. This flag is <i>on</i>
      by default when <b>sudo</b> is compiled with <b>zlib</b> support.</dd>
  <dt id="exec_background"><a class="permalink" href="#exec_background">exec_background</a></dt>
  <dd>By default, <b>sudo</b> runs a command as the foreground process as long
      as <b>sudo</b> itself is running in the foreground. When the
      <i>exec_background</i> flag is enabled and the command is being run in a
      pseudo-terminal (due to I/O logging or the <i>use_pty</i> flag), the
      command will be run as a background process. Attempts to read from the
      controlling terminal (or to change terminal settings) will result in the
      command being suspended with the SIGTTIN signal (or SIGTTOU in the case of
      terminal settings). If this happens when <b>sudo</b> is a foreground
      process, the command will be granted the controlling terminal and resumed
      in the foreground with no user intervention required. The advantage of
      initially running the command in the background is that <b>sudo</b> need
      not read from the terminal unless the command explicitly requests it.
      Otherwise, any terminal input must be passed to the command, whether it
      has required it or not (the kernel buffers terminals so it is not possible
      to tell whether the command really wants the input). This is different
      from historic <i>sudo</i> behavior or when the command is not being run in
      a pseudo-terminal.
    <p class="Pp">For this to work seamlessly, the operating system must support
        the automatic restarting of system calls. Unfortunately, not all
        operating systems do this by default, and even those that do may have
        bugs. For example, macOS fails to restart the tcgetattr(3) and
        tcsetattr(3) functions (this is a bug in macOS). Furthermore, because
        this behavior depends on the command stopping with the SIGTTIN or
        SIGTTOU signals, programs that catch these signals and suspend
        themselves with a different signal (usually SIGTOP) will not be
        automatically foregrounded. Some versions of the linux su(1) command
        behave this way. This flag is <i>off</i> by default.</p>
    <p class="Pp">This setting is only supported by version 1.8.7 or higher. It
        has no effect unless I/O logging is enabled or the <i>use_pty</i> flag
        is enabled.</p>
  </dd>
  <dt id="env_editor"><a class="permalink" href="#env_editor">env_editor</a></dt>
  <dd>If set, <b>visudo</b> will use the value of the SUDO_EDITOR, VISUAL or
      EDITOR environment variables before falling back on the default editor
      list. <b>visudo</b> is typically run as <b>root</b> so this flag may allow
      a user with <b>visudo</b> privileges to run arbitrary commands as
      <b>root</b> without logging. An alternative is to place a colon-separated
      list of &#x201C;safe&#x201D; editors int the <i>editor</i> setting.
      <b>visudo</b> will then only use SUDO_EDITOR, VISUAL or EDITOR if they
      match a value specified in <i>editor</i>. If the <i>env_reset</i> flag is
      enabled, the SUDO_EDITOR, VISUAL and/or EDITOR environment variables must
      be present in the <i>env_keep</i> list for the <i>env_editor</i> flag to
      function when <b>visudo</b> is invoked via <b>sudo</b>. This flag is
      <i>on</i> by default.</dd>
  <dt id="env_reset"><a class="permalink" href="#env_reset">env_reset</a></dt>
  <dd>If set, <b>sudo</b> will run the command in a minimal environment
      containing the TERM, PATH, HOME, MAIL, SHELL, LOGNAME, USER and SUDO_*
      variables. Any variables in the caller's environment or in the file
      specified by the <i>restricted_env_file</i> setting that match the
      <i>env_keep</i> and <i>env_check</i> lists are then added, followed by any
      variables present in the file specified by the <i>env_file</i> setting (if
      any). The contents of the <i>env_keep</i> and <i>env_check</i> lists, as
      modified by global Defaults parameters in <i>sudoers</i>, are displayed
      when <b>sudo</b> is run by <b>root</b> with the <b>-V</b> option. If the
      <i>secure_path</i> setting is enabled, its value will be used for the PATH
      environment variable. This flag is <i>on</i> by default.</dd>
  <dt id="fast_glob"><a class="permalink" href="#fast_glob">fast_glob</a></dt>
  <dd>Normally, <b>sudo</b> uses the glob(3) function to do shell-style globbing
      when matching path names. However, since it accesses the file system,
      glob(3) can take a long time to complete for some patterns, especially
      when the pattern references a network file system that is mounted on
      demand (auto mounted). The <i>fast_glob</i> flag causes <b>sudo</b> to use
      the fnmatch(3) function, which does not access the file system to do its
      matching. The disadvantage of <i>fast_glob</i> is that it is unable to
      match relative paths such as <i>./ls</i> or <i>../bin/ls</i>. This has
      security implications when path names that include globbing characters are
      used with the negation operator, &#x2018;!&#x2019;, as such rules can be
      trivially bypassed. As such, this flag should not be used when the
      <i>sudoers</i> file contains rules that contain negated path names which
      include globbing characters. This flag is <i>off</i> by default.</dd>
  <dt id="log_passwords"><a class="permalink" href="#log_passwords">log_passwords</a></dt>
  <dd>Most programs that require a user's password will disable echo before
      reading the password to avoid displaying the plaintext password on the
      screen. However, if terminal input is being logged (see <i>I/O
      LOGGING</i>), the password will still be present in the I/O log. If the
      <i>log_passwords</i> option is disabled, <b>sudoers</b> will attempt to
      prevent passwords from being logged. It does this by using the regular
      expressions in <i>passprompt_regex</i> to match a password prompt in the
      terminal output buffer. When a match is found, input characters in the I/O
      log will be replaced with &#x2018;*&#x2019; until either a line feed or
      carriage return is found in the terminal input or a new terminal output
      buffer is received. If, however, a program displays characters as the user
      types (such as <b>sudo</b> when <i>pwfeedback</i> is set), only the first
      character of the password will be replaced in the I/O log. This option has
      no effect unless <i>log_input</i> or <i>log_ttyin</i> are also set. This
      flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.10 or
      higher.</p>
  </dd>
  <dt id="fqdn"><a class="permalink" href="#fqdn">fqdn</a></dt>
  <dd>Set this flag if you want to put fully qualified host names in the
      <i>sudoers</i> file when the local host name (as returned by the
      &#x2018;hostname&#x2019; command) does not contain the domain name. In
      other words, instead of myhost you would use myhost.mydomain.edu. You may
      still use the short form if you wish (and even mix the two). This flag is
      only effective when the &#x201C;canonical&#x201D; host name, as returned
      by the getaddrinfo(3) or gethostbyname(3) function, is a fully-qualified
      domain name. This is usually the case when the system is configured to use
      DNS for host name resolution.
    <p class="Pp">If the system is configured to use the <i>/etc/hosts</i> file
        in preference to DNS, the &#x201C;canonical&#x201D; host name may not be
        fully-qualified. The order that sources are queried for host name
        resolution is usually specified in the <i>/etc/nsswitch.conf</i>,
        <i>/etc/netsvc.conf</i>, <i>/etc/host.conf</i>, or, in some cases,
        <i>/etc/resolv.conf</i> file. In the <i>/etc/hosts</i> file, the first
        host name of the entry is considered to be the &#x201C;canonical&#x201D;
        name; subsequent names are aliases that are not used by <b>sudoers</b>.
        For example, the following hosts file line for the machine
        &#x201C;xyzzy&#x201D; has the fully-qualified domain name as the
        &#x201C;canonical&#x201D; host name, and the short version as an
      alias.</p>
    <p class="Pp"></p>
  </dd>
</dl>
<div class="Bd-indent">192.168.1.1 xyzzy.sudo.ws xyzzy</div>
<div class="Bd-indent">
<p class="Pp">If the machine's hosts file entry is not formatted properly, the
    <i>fqdn</i> flag will not be effective if it is queried before DNS.</p>
<p class="Pp">Beware that when using DNS for host name resolution, turning on
    <i>fqdn</i> requires <b>sudoers</b> to make DNS lookups which renders
    <b>sudo</b> unusable if DNS stops working (for example if the machine is
    disconnected from the network). Just like with the hosts file, you must use
    the &#x201C;canonical&#x201D; name as DNS knows it. That is, you may not use
    a host alias (CNAME entry) due to performance issues and the fact that there
    is no way to get all aliases from DNS.</p>
<p class="Pp">This flag is <i>off</i> by default.</p>
</div>
<dl class="Bl-tag">
  <dt id="ignore_audit_errors"><a class="permalink" href="#ignore_audit_errors">ignore_audit_errors</a></dt>
  <dd>Allow commands to be run even if <b>sudoers</b> cannot write to the audit
      log. If enabled, an audit log write failure is not treated as a fatal
      error. If disabled, a command may only be run after the audit event is
      successfully written. This flag is only effective on systems for which
      <b>sudoers</b> supports audit logging, including FreeBSD, Linux, macOS,
      and Solaris. This flag is <i>on</i> by default.</dd>
  <dt id="ignore_dot"><a class="permalink" href="#ignore_dot">ignore_dot</a></dt>
  <dd>If set, <b>sudo</b> will ignore &quot;.&quot; or &quot;&quot; (both
      denoting the current directory) in the PATH environment variable; the PATH
      itself is not modified. This flag is <i>on</i> by default.</dd>
  <dt id="ignore_iolog_errors"><a class="permalink" href="#ignore_iolog_errors">ignore_iolog_errors</a></dt>
  <dd>Allow commands to be run even if <b>sudoers</b> cannot write to the I/O
      log (local or remote). If enabled, an I/O log write failure is not treated
      as a fatal error. If disabled, the command will be terminated if the I/O
      log cannot be written to. This flag is <i>off</i> by default.</dd>
  <dt id="ignore_logfile_errors"><a class="permalink" href="#ignore_logfile_errors">ignore_logfile_errors</a></dt>
  <dd>Allow commands to be run even if <b>sudoers</b> cannot write to the log
      file. If enabled, a log file write failure is not treated as a fatal
      error. If disabled, a command may only be run after the log file entry is
      successfully written. This flag only has an effect when <b>sudoers</b> is
      configured to use file-based logging via the <i>logfile</i> setting. This
      flag is <i>on</i> by default.</dd>
  <dt id="ignore_local_sudoers"><a class="permalink" href="#ignore_local_sudoers">ignore_local_sudoers</a></dt>
  <dd>If set via LDAP, parsing of <i>/private/etc/sudoers</i> will be skipped.
      This is intended for sites that wish to prevent the usage of local sudoers
      files so that only LDAP is used. This thwarts the efforts of rogue
      operators who would attempt to add roles to <i>/private/etc/sudoers</i>.
      When this flag is enabled, <i>/private/etc/sudoers</i> does not even need
      to exist. Since this flag tells <b>sudo</b> how to behave when no specific
      LDAP entries have been matched, this sudoOption is only meaningful for the
      &#x2018;cn=defaults&#x2019; section. This flag is <i>off</i> by
    default.</dd>
  <dt id="ignore_unknown_defaults"><a class="permalink" href="#ignore_unknown_defaults">ignore_unknown_defaults</a></dt>
  <dd>If set, <b>sudo</b> will not produce a warning if it encounters an unknown
      Defaults entry in the <i>sudoers</i> file or an unknown sudoOption in
      LDAP. This flag is <i>off</i> by default.</dd>
  <dt id="insults"><a class="permalink" href="#insults">insults</a></dt>
  <dd>If set, <b>sudo</b> will insult users when they enter an incorrect
      password. This flag is <i>off</i> by default.</dd>
  <dt id="log_allowed"><a class="permalink" href="#log_allowed">log_allowed</a></dt>
  <dd>If set, <b>sudoers</b> will log commands allowed by the policy to the
      system audit log (where supported) as well as to syslog and/or a log file.
      This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.29 or
      higher.</p>
  </dd>
  <dt id="log_denied"><a class="permalink" href="#log_denied">log_denied</a></dt>
  <dd>If set, <b>sudoers</b> will log commands denied by the policy to the
      system audit log (where supported) as well as to syslog and/or a log file.
      This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.29 or
      higher.</p>
  </dd>
  <dt id="log_exit_status"><a class="permalink" href="#log_exit_status">log_exit_status</a></dt>
  <dd>If set, <b>sudoers</b> will log the exit value of commands that are run to
      syslog and/or a log file. If a command was terminated by a signal, the
      signal name is logged as well. This flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher.</p>
  </dd>
  <dt id="log_host"><a class="permalink" href="#log_host">log_host</a></dt>
  <dd>If set, the host name will be included in log entries written to the file
      configured by the <i>logfile</i> setting. This flag is <i>off</i> by
      default.</dd>
  <dt id="log_input"><a class="permalink" href="#log_input">log_input</a></dt>
  <dd>If set, <b>sudo</b> will run the command in a pseudo-terminal (if
      <b>sudo</b> was run from a terminal) and log all user input. If the
      standard input is not connected to the user's terminal, due to I/O
      redirection or because the command is part of a pipeline, that input is
      also logged. For more information about I/O logging, see the <i>I/O
      LOGGING</i> section. This flag is <i>off</i> by default.</dd>
  <dt id="log_output"><a class="permalink" href="#log_output">log_output</a></dt>
  <dd>If set, <b>sudo</b> will run the command in a pseudo-terminal (if
      <b>sudo</b> was run from a terminal) and log all output that is sent to
      the user's terminal, the standard output or the standard error. If the
      standard output or standard error is not connected to the user's terminal,
      due to I/O redirection or because the command is part of a pipeline, that
      output is also logged. For more information about I/O logging, see the
      <i>I/O LOGGING</i> section. This flag is <i>off</i> by default.</dd>
  <dt id="log_server_keepalive"><a class="permalink" href="#log_server_keepalive">log_server_keepalive</a></dt>
  <dd>If set, <b>sudo</b> will enable the TCP keepalive socket option on the
      connection to the log server. This enables the periodic transmission of
      keepalive messages to the server. If the server does not respond to a
      message, the connection will be closed and the running command will be
      terminated unless the <i>ignore_iolog_errors</i> flag (I/O logging
      enabled) or the <i>ignore_log_errors</i> flag (I/O logging disabled) is
      set. This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="log_server_verify"><a class="permalink" href="#log_server_verify">log_server_verify</a></dt>
  <dd>
    <br/>
    If set, the server certificate received during the TLS handshake must be
      valid and it must contain either the server name (from <i>log_servers</i>)
      or its IP address. If either of these conditions is not met, the TLS
      handshake will fail. This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="log_stderr"><a class="permalink" href="#log_stderr">log_stderr</a></dt>
  <dd>If set, <b>sudo</b> will log the standard error if it is not connected to
      the user's terminal. This can be used to log output to a pipe or
      redirected to a file. This flag is <i>off</i> by default but is enabled
      when either the <i>log_output</i> flag or the LOG_OUTPUT command tag is
      set.</dd>
  <dt id="log_stdin"><a class="permalink" href="#log_stdin">log_stdin</a></dt>
  <dd>If set, <b>sudo</b> will log the standard input if it is not connected to
      the user's terminal. This can be used to log input from a pipe or
      redirected from a file. This flag is <i>off</i> by default but is enabled
      when either the <i>log_input</i> flag or the LOG_INPUT command tag is
    set.</dd>
  <dt id="log_stdout"><a class="permalink" href="#log_stdout">log_stdout</a></dt>
  <dd>If set, <b>sudo</b> will log the standard output if it is not connected to
      the user's terminal. This can be used to log output to a pipe or
      redirected to a file. This flag is <i>off</i> by default but is enabled
      when either the <i>log_output</i> flag or the LOG_OUTPUT command tag is
      set.</dd>
  <dt id="log_subcmds"><a class="permalink" href="#log_subcmds">log_subcmds</a></dt>
  <dd>If set, <b>sudoers</b> will log when a command spawns a child process and
      executes a program using the execve(2), execl(3), execle(3), execlp(3),
      execv(3), execvp(3), execvpe(3), or system(3) library functions. For
      example, if a shell is run by <b>sudo</b>, the individual commands run via
      the shell will be logged. This flag is <i>off</i> by default.
    <p class="Pp">The <i>log_subcmds</i> flag uses the same underlying mechanism
        as the <i>intercept</i> setting. Some commands may not work properly
        when <i>log_subcmds</i> is enabled, due to the way it intercepts
        sub-commands. See <i>Preventing shell escapes</i> for more information
        on what systems support this option and its limitations. This setting is
        only supported by version 1.9.8 or higher and is incompatible with
        SELinux RBAC support unless the system supports seccomp(2) filter
      mode.</p>
  </dd>
  <dt id="log_ttyin"><a class="permalink" href="#log_ttyin">log_ttyin</a></dt>
  <dd>If set, <b>sudo</b> will run the command in a pseudo-terminal and log user
      keystrokes sent to the user's terminal, if one is present. This flag is
      <i>off</i> by default but is enabled when either the <i>log_input</i> flag
      or the LOG_INPUT command tag is set. If no terminal is present, for
      example when running a remote command using ssh(1), this flag will have no
      effect.</dd>
  <dt id="log_ttyout"><a class="permalink" href="#log_ttyout">log_ttyout</a></dt>
  <dd>If set, <b>sudo</b> will run the command in a pseudo-terminal and log all
      output displayed on the user's terminal, if one is present. This flag is
      <i>off</i> by default but is enabled when either the <i>log_output</i>
      flag or the LOG_OUTPUT command tag is set. If no terminal is present, for
      example when running a remote command using ssh(1), this flag will have no
      effect.</dd>
  <dt id="log_year"><a class="permalink" href="#log_year">log_year</a></dt>
  <dd>If set, the four-digit year will be logged in the (non-syslog) <b>sudo</b>
      log file. This flag is <i>off</i> by default.</dd>
  <dt id="long_otp_prompt"><a class="permalink" href="#long_otp_prompt">long_otp_prompt</a></dt>
  <dd>When validating with a One Time Password (OTP) scheme such as <b>S/Key</b>
      or <b>OPIE</b>, a two-line prompt is used to make it easier to cut and
      paste the challenge to a local window. It's not as pretty as the default
      but some people find it more convenient. This flag is <i>off</i> by
      default.</dd>
  <dt id="mail_all_cmnds"><a class="permalink" href="#mail_all_cmnds">mail_all_cmnds</a></dt>
  <dd>Send mail to the <i>mailto</i> user every time a user attempts to run a
      command via <b>sudo</b> (this includes <b>sudoedit</b>). No mail will be
      sent if the user runs <b>sudo</b> with the <b>-l</b> or <b>-v</b> option
      unless there is an authentication error and the <i>mail_badpass</i> flag
      is also set. This flag is <i>off</i> by default.</dd>
  <dt id="mail_always"><a class="permalink" href="#mail_always">mail_always</a></dt>
  <dd>Send mail to the <i>mailto</i> user every time a user runs <b>sudo</b>.
      This flag is <i>off</i> by default.</dd>
  <dt id="mail_badpass"><a class="permalink" href="#mail_badpass">mail_badpass</a></dt>
  <dd>Send mail to the <i>mailto</i> user if the user running <b>sudo</b> does
      not enter the correct password. If the command the user is attempting to
      run is not permitted by <b>sudoers</b> and one of the
      <i>mail_all_cmnds</i>, <i>mail_always</i>, <i>mail_no_host</i>,
      <i>mail_no_perms</i> or <i>mail_no_user</i> flags are set, this flag will
      have no effect. This flag is <i>off</i> by default.</dd>
  <dt id="mail_no_host"><a class="permalink" href="#mail_no_host">mail_no_host</a></dt>
  <dd>If set, mail will be sent to the <i>mailto</i> user if the invoking user
      exists in the <i>sudoers</i> file, but is not allowed to run commands on
      the current host. This flag is <i>off</i> by default.</dd>
  <dt id="mail_no_perms"><a class="permalink" href="#mail_no_perms">mail_no_perms</a></dt>
  <dd>If set, mail will be sent to the <i>mailto</i> user if the invoking user
      is allowed to use <b>sudo</b> but the command they are trying is not
      listed in their <i>sudoers</i> file entry or is explicitly denied. This
      flag is <i>off</i> by default.</dd>
  <dt id="mail_no_user"><a class="permalink" href="#mail_no_user">mail_no_user</a></dt>
  <dd>If set, mail will be sent to the <i>mailto</i> user if the invoking user
      is not in the <i>sudoers</i> file. This flag is <i>on</i> by default.</dd>
  <dt id="match_group_by_gid"><a class="permalink" href="#match_group_by_gid">match_group_by_gid</a></dt>
  <dd>By default, <b>sudoers</b> will look up each group the user is a member of
      by group-ID to determine the group name (this is only done once). The
      resulting list of the user's group names is used when matching groups
      listed in the <i>sudoers</i> file. This works well on systems where the
      number of groups listed in the <i>sudoers</i> file is larger than the
      number of groups a typical user belongs to. On systems where group lookups
      are slow, where users may belong to a large number of groups, or where the
      number of groups listed in the <i>sudoers</i> file is relatively small, it
      may be prohibitively expensive and running commands via <b>sudo</b> may
      take longer than normal. On such systems it may be faster to use the
      <i>match_group_by_gid</i> flag to avoid resolving the user's group-IDs to
      group names. In this case, <b>sudoers</b> must look up any group name
      listed in the <i>sudoers</i> file and use the group-ID instead of the
      group name when determining whether the user is a member of the group.
    <p class="Pp">If <i>match_group_by_gid</i> is enabled, group database
        lookups performed by <b>sudoers</b> will be keyed by group name as
        opposed to group-ID. On systems where there are multiple sources for the
        group database, it is possible to have conflicting group names or
        group-IDs in the local <i>/etc/group</i> file and the remote group
        database. On such systems, enabling or disabling
        <i>match_group_by_gid</i> can be used to choose whether group database
        queries are performed by name (enabled) or ID (disabled), which may aid
        in working around group entry conflicts.</p>
    <p class="Pp">The <i>match_group_by_gid</i> flag has no effect when
        <i>sudoers</i> data is stored in LDAP. This flag is <i>off</i> by
        default.</p>
    <p class="Pp">This setting is only supported by version 1.8.18 or
      higher.</p>
  </dd>
  <dt id="intercept"><a class="permalink" href="#intercept">intercept</a></dt>
  <dd>If set, all commands run via <b>sudo</b> will behave as if the INTERCEPT
      tag has been set, unless overridden by an NOINTERCEPT tag. Some commands
      may not work properly when <i>intercept</i> is enabled, due to the way it
      intercept sub-commands. See the description of INTERCEPT and NOINTERCEPT
      above as well as the <i>Preventing shell escapes</i> section at the end of
      this manual. This flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher and
        is incompatible with SELinux RBAC support unless the system supports
        seccomp(2) filter mode.</p>
  </dd>
  <dt id="intercept_allow_setid"><a class="permalink" href="#intercept_allow_setid">intercept_allow_setid</a></dt>
  <dd>On most systems, the dynamic loader will ignore LD_PRELOAD (or the
      equivalent) when running set-user-ID and set-group-ID programs,
      effectively disabling intercept mode. To prevent this from happening,
      <b>sudoers</b> will not permit a set-user-ID or set-group-ID program to be
      run in intercept mode unless <i>intercept_allow_setid</i> is enable. This
      flag has no effect unless the <i>intercept</i> flag is enabled or the
      INTERCEPT tag has been set for the command. This flag is <i>on</i> by
      default when the <i>intercept_type</i> option is set to <i>trace</i>,
      otherwise it default to <i>off</i>.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher.</p>
  </dd>
  <dt id="intercept_authenticate"><a class="permalink" href="#intercept_authenticate">intercept_authenticate</a></dt>
  <dd>If set, commands run by an intercepted process must be authenticated when
      the user's time stamp is not current. For example, if a shell is run with
      <i>intercept</i> enabled, as soon as the invoking user's time stamp is out
      of date, subsequent commands will need to be authenticated. This flag has
      no effect unless the <i>intercept</i> flag is enabled or the INTERCEPT tag
      has been set for the command. This flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.8 or higher.</p>
  </dd>
  <dt id="intercept_verify"><a class="permalink" href="#intercept_verify">intercept_verify</a></dt>
  <dd>If set, <b>sudo</b> will attempt to verify that a command run in intercept
      mode has the expected path name, command line arguments and environment.
    <p class="Pp">The process will be stopped after execve(2) has completed but
        before the new command has had a chance to run. To verify the command,
        <b>sudo</b> will read the command's path from <i>/proc/PID/exe</i>, the
        command line arguments and environment from the process's memory, and
        compare them against the arguments that were passed to execve(2). In the
        event of a mismatch, the command will be sent a SIGKILL signal and
        terminated.</p>
    <p class="Pp">This can help prevent a time of check versus time of use issue
        with intercept mode where the execve(2) arguments could be altered after
        the <b>sudoers</b> policy check. The checks can only be performed if the
        proc(5) file system is available. This flag has no effect unless the
        <i>intercept</i> flag is enabled or the INTERCEPT tag has been set for
        the command and the <i>intercept_type</i> option is set to
      <i>trace</i>.</p>
    <p class="Pp">This setting is incompatible with programs that change their
        root directory via chroot(2). If a program changes its root directory,
        path names will no longer match those seen by the <b>sudo</b> parent
        process and sub-commands will be terminated before they have a chance to
        run. This flag is <i>on</i> by default.</p>
    <p class="Pp">This setting is only supported by version 1.9.12 or
      higher.</p>
  </dd>
  <dt id="netgroup_tuple"><a class="permalink" href="#netgroup_tuple">netgroup_tuple</a></dt>
  <dd>If set, netgroup lookups will be performed using the full netgroup tuple:
      host name, user name, and domain (if one is set). Historically,
      <b>sudo</b> only matched the user name and domain for netgroups used in a
      <i>User_List</i> and only matched the host name and domain for netgroups
      used in a <i>Host_List</i>. This flag is <i>off</i> by default.</dd>
  <dt id="noexec"><a class="permalink" href="#noexec">noexec</a></dt>
  <dd>If set, all commands run via <b>sudo</b> will behave as if the NOEXEC tag
      has been set, unless overridden by an EXEC tag. See the description of
      EXEC and NOEXEC above as well as the <i>Preventing shell escapes</i>
      section at the end of this manual. This flag is <i>off</i> by
    default.</dd>
  <dt id="noninteractive_auth"><a class="permalink" href="#noninteractive_auth">noninteractive_auth</a></dt>
  <dd>If set, authentication will be attempted even in non-interactive mode
      (when <b>sudo</b>'s <b>-n</b> option is specified). This allows
      authentication methods that don't require user interaction to succeed.
      Authentication methods that require input from the user's terminal will
      still fail. If disabled, authentication will not be attempted in
      non-interactive mode. This flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.10 or
      higher.</p>
  </dd>
  <dt id="pam_acct_mgmt"><a class="permalink" href="#pam_acct_mgmt">pam_acct_mgmt</a></dt>
  <dd>On systems that use PAM for authentication, <b>sudo</b> will perform PAM
      account validation for the invoking user by default. The actual checks
      performed depend on which PAM modules are configured. If enabled, account
      validation will be performed regardless of whether or not a password is
      required. This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.28 or
      higher.</p>
  </dd>
  <dt id="pam_rhost"><a class="permalink" href="#pam_rhost">pam_rhost</a></dt>
  <dd>On systems that use PAM for authentication, <b>sudo</b> will set the PAM
      remote host value to the name of the local host when the <i>pam_rhost</i>
      flag is enabled. On Linux systems, enabling <i>pam_rhost</i> may result in
      DNS lookups of the local host name when PAM is initialized. On Solaris
      versions prior to Solaris 8, <i>pam_rhost</i> must be enabled if
      <i>pam_ruser</i> is also enabled to avoid a crash in the Solaris PAM
      implementation.
    <p class="Pp">This flag is <i>off</i> by default on systems other than
        Solaris.</p>
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="pam_ruser"><a class="permalink" href="#pam_ruser">pam_ruser</a></dt>
  <dd>On systems that use PAM for authentication, <b>sudo</b> will set the PAM
      remote user value to the name of the user that invoked sudo when the
      <i>pam_ruser</i> flag is enabled. This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="pam_session"><a class="permalink" href="#pam_session">pam_session</a></dt>
  <dd>On systems that use PAM for authentication, <b>sudo</b> will create a new
      PAM session for the command to be run in. Unless <b>sudo</b> is given the
      <b>-i</b> or <b>-s</b> options, PAM session modules are run with the
      &#x201C;silent&#x201D; flag enabled. This prevents last login information
      from being displayed for every command on some systems. Disabling
      <i>pam_session</i> may be needed on older PAM implementations or on
      operating systems where opening a PAM session changes the utmp or wtmp
      files. If PAM session support is disabled, resource limits may not be
      updated for the command being run. If <i>pam_session</i>,
      <i>pam_setcred</i>, and <i>use_pty</i> are disabled, <i>log_servers</i>
      has not been set and I/O logging has not been configured, <b>sudo</b> will
      execute the command directly instead of running it as a child process.
      This flag is <i>on</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.7 or higher.</p>
  </dd>
  <dt id="pam_setcred"><a class="permalink" href="#pam_setcred">pam_setcred</a></dt>
  <dd>On systems that use PAM for authentication, <b>sudo</b> will attempt to
      establish credentials for the target user by default, if supported by the
      underlying authentication system. One example of a credential is a
      Kerberos ticket. If <i>pam_session</i>, <i>pam_setcred</i>, and
      <i>use_pty</i> are disabled, <i>log_servers</i> has not been set and I/O
      logging has not been configured, <b>sudo</b> will execute the command
      directly instead of running it as a child process. This flag is <i>on</i>
      by default.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt id="pam_silent"><a class="permalink" href="#pam_silent">pam_silent</a></dt>
  <dd>If set, PAM authentication will be performed in silent mode. This prevents
      PAM authentication modules from generating output. In some cases, this may
      suppress important information about why authentication failed. For
      example, PAM modules such as <i>pam_faillock</i> will only display a
      warning if <i>pam_silent</i> is disabled. This flag is <i>on</i> by
      default.
    <p class="Pp">This setting is only supported by version 1.9.16 or
      higher.</p>
  </dd>
  <dt id="passprompt_override"><a class="permalink" href="#passprompt_override">passprompt_override</a></dt>
  <dd>If set, the prompt specified by <i>passprompt</i> or the SUDO_PROMPT
      environment variable will always be used and will replace the prompt
      provided by a PAM module or other authentication method. This flag is
      <i>off</i> by default.</dd>
  <dt id="path_info"><a class="permalink" href="#path_info">path_info</a></dt>
  <dd>Normally, <b>sudo</b> will tell the user when a command could not be found
      in their PATH environment variable. Some sites may wish to disable this as
      it could be used to gather information on the location of executables that
      the normal user does not have access to. The disadvantage is that if the
      executable is simply not in the user's PATH, <b>sudo</b> will tell the
      user that they are not allowed to run it, which can be confusing. This
      flag is <i>on</i> by default.</dd>
  <dt id="preserve_groups"><a class="permalink" href="#preserve_groups">preserve_groups</a></dt>
  <dd>By default, <b>sudo</b> will initialize the group vector to the list of
      groups the target user is in. When <i>preserve_groups</i> is set, the
      user's existing group vector is left unaltered. The real and effective
      group-IDs, however, are still set to match the target user. This flag is
      <i>off</i> by default.</dd>
  <dt id="pwfeedback"><a class="permalink" href="#pwfeedback">pwfeedback</a></dt>
  <dd>By default, <b>sudo</b> reads the password like most other Unix programs,
      by turning off echo until the user hits the return (or enter) key. Some
      users become confused by this as it appears to them that <b>sudo</b> has
      hung at this point. When <i>pwfeedback</i> is set, <b>sudo</b> will
      provide visual feedback when the user presses a key. This does have a
      security impact as an onlooker may be able to determine the length of the
      password being entered. This flag is <i>off</i> by default.</dd>
  <dt id="requiretty"><a class="permalink" href="#requiretty">requiretty</a></dt>
  <dd>If set, <b>sudo</b> will only run when the user is logged in to a real
      tty. When this flag is set, <b>sudo</b> can only be run from a login
      session and not via other means such as cron(8) or cgi-bin scripts. This
      flag is <i>off</i> by default.</dd>
  <dt id="root_sudo"><a class="permalink" href="#root_sudo">root_sudo</a></dt>
  <dd>If set, <b>root</b> is allowed to run <b>sudo</b> too. Disabling this
      prevents users from &#x201C;chaining&#x201D; <b>sudo</b> commands to get a
      <b>root</b> shell by doing something like &#x2018;sudo sudo
      /bin/sh&#x2019;. Note, however, that turning off <i>root_sudo</i> will
      also prevent <b>root</b> from running <b>sudoedit</b>. Disabling
      <i>root_sudo</i> provides no real additional security; it exists purely
      for historical reasons. This flag is <i>on</i> by default.</dd>
  <dt id="rootpw"><a class="permalink" href="#rootpw">rootpw</a></dt>
  <dd>If set, <b>sudo</b> will prompt for the <b>root</b> password instead of
      the password of the invoking user when running a command or editing a
      file. This flag is <i>off</i> by default.</dd>
  <dt id="runas_allow_unknown_id"><a class="permalink" href="#runas_allow_unknown_id">runas_allow_unknown_id</a></dt>
  <dd>If enabled, allow matching of runas user and group IDs that are not
      present in the password or group databases. In addition to explicitly
      matching unknown user or group IDs in a <i>Runas_List</i>, this option
      also allows the <b>ALL</b> alias to match unknown IDs. This flag is
      <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.30 or higher.
        Older versions of <b>sudo</b> always allowed matching of unknown user
        and group IDs.</p>
  </dd>
  <dt id="runas_check_shell"><a class="permalink" href="#runas_check_shell">runas_check_shell</a></dt>
  <dd>
    <br/>
    If enabled, <b>sudo</b> will only run commands as a user whose shell appears
      in the <i>/etc/shells</i> file, even if the invoking user's
      <i>Runas_List</i> would otherwise permit it. If no <i>/etc/shells</i> file
      is present, a system-dependent list of built-in default shells is used. On
      many operating systems, system users such as &#x201C;bin&#x201D;, do not
      have a valid shell and this flag can be used to prevent commands from
      being run as those users. This flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.30 or
      higher.</p>
  </dd>
  <dt id="runaspw"><a class="permalink" href="#runaspw">runaspw</a></dt>
  <dd>If set, <b>sudo</b> will prompt for the password of the user defined by
      the <i>runas_default</i> option (defaults to <b>root</b>) instead of the
      password of the invoking user when running a command or editing a file.
      This flag is <i>off</i> by default.</dd>
  <dt id="set_home"><a class="permalink" href="#set_home">set_home</a></dt>
  <dd>If enabled and <b>sudo</b> is invoked with the <b>-s</b> option, the HOME
      environment variable will be set to the home directory of the target user
      (which is the <i>runas_default</i> user unless the <b>-u</b> option is
      used). This flag is largely obsolete and has no effect unless the
      <i>env_reset</i> flag has been disabled or HOME is present in the
      <i>env_keep</i> list, both of which are strongly discouraged. This flag is
      <i>off</i> by default.</dd>
  <dt id="set_logname"><a class="permalink" href="#set_logname">set_logname</a></dt>
  <dd>Normally, <b>sudo</b> will set the LOGNAME and USER environment variables
      to the name of the target user (the user specified by <i>runas_default</i>
      unless the <b>-u</b> option is given). However, since some programs
      (including the RCS revision control system) use LOGNAME to determine the
      real identity of the user, it may be desirable to change this behavior.
      This can be done by negating the set_logname option. The
      <i>set_logname</i> option will have no effect if the <i>env_reset</i>
      option has not been disabled and the <i>env_keep</i> list contains LOGNAME
      or USER. This flag is <i>on</i> by default.</dd>
  <dt id="set_utmp"><a class="permalink" href="#set_utmp">set_utmp</a></dt>
  <dd>When enabled, <b>sudo</b> will create an entry in the utmp (or utmpx) file
      when a pseudo-terminal is allocated. A pseudo-terminal is allocated by
      <b>sudo</b> when it is running in a terminal and one or more of the
      <i>log_input</i>, <i>log_output</i>, <i>log_stdin</i>, <i>log_stdout</i>,
      <i>log_stderr</i>, <i>log_ttyin</i>, <i>log_ttyout</i>, or <i>use_pty</i>
      flags is enabled. By default, the new entry will be a copy of the user's
      existing utmp entry (if any), with the tty, time, type, and pid fields
      updated. This flag is <i>on</i> by default.</dd>
  <dt id="setenv"><a class="permalink" href="#setenv">setenv</a></dt>
  <dd>Allow the user to disable the <i>env_reset</i> option from the command
      line via the <b>-E</b> option. Additionally, environment variables set via
      the command line are not subject to the restrictions imposed by
      <i>env_check</i>, <i>env_delete</i>, or <i>env_keep</i>. As such, only
      trusted users should be allowed to set variables in this manner. This flag
      is <i>off</i> by default.</dd>
  <dt id="shell_noargs"><a class="permalink" href="#shell_noargs">shell_noargs</a></dt>
  <dd>If set and <b>sudo</b> is invoked with no arguments it acts as if the
      <b>-s</b> option had been given. That is, it runs a shell as <b>root</b>
      (the shell is determined by the SHELL environment variable if it is set,
      falling back on the shell listed in the invoking user's /etc/passwd entry
      if not). This flag is <i>off</i> by default.</dd>
  <dt id="stay_setuid"><a class="permalink" href="#stay_setuid">stay_setuid</a></dt>
  <dd>Normally, when <b>sudo</b> executes a command the real and effective
      user-IDs are set to the target user (<b>root</b> by default). This option
      changes that behavior such that the real user-ID is left as the invoking
      user's user-ID. In other words, this makes <b>sudo</b> act as a
      set-user-ID wrapper. This can be useful on systems that disable some
      potentially dangerous functionality when a program is run set-user-ID.
      This option is only effective on systems that support either the
      setreuid(2) or setresuid(2) system call. This flag is <i>off</i> by
      default.</dd>
  <dt id="sudoedit_checkdir"><a class="permalink" href="#sudoedit_checkdir">sudoedit_checkdir</a></dt>
  <dd>
    <br/>
    If set, <b>sudoedit</b> will check all directory components of the path to
      be edited for writability by the invoking user. Symbolic links will not be
      followed in writable directories and <b>sudoedit</b> will refuse to edit a
      file located in a writable directory. These restrictions are not enforced
      when <b>sudoedit</b> is run by <b>root</b>. On some systems, if all
      directory components of the path to be edited are not readable by the
      target user, <b>sudoedit</b> will be unable to edit the file. This flag is
      <i>on</i> by default.
    <p class="Pp">This setting was first introduced in version 1.8.15 but
        initially suffered from a race condition. The check for symbolic links
        in writable intermediate directories was added in version 1.8.16.</p>
  </dd>
  <dt id="sudoedit_follow"><a class="permalink" href="#sudoedit_follow">sudoedit_follow</a></dt>
  <dd>By default, <b>sudoedit</b> will not follow symbolic links when opening
      files. The <i>sudoedit_follow</i> option can be enabled to allow
      <b>sudoedit</b> to open symbolic links. It may be overridden on a
      per-command basis by the FOLLOW and NOFOLLOW tags. This flag is <i>off</i>
      by default.
    <p class="Pp">This setting is only supported by version 1.8.15 or
      higher.</p>
  </dd>
  <dt id="syslog_pid"><a class="permalink" href="#syslog_pid">syslog_pid</a></dt>
  <dd>When logging via syslog(3), include the process ID in the log entry. This
      flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.21 or
      higher.</p>
  </dd>
  <dt id="targetpw"><a class="permalink" href="#targetpw">targetpw</a></dt>
  <dd>If set, <b>sudo</b> will prompt for the password of the user specified by
      the <b>-u</b> option (defaults to the value of <i>runas_default</i>)
      instead of the password of the invoking user when running a command or
      editing a file. This flag precludes the use of a user-ID not listed in the
      passwd database as an argument to the <b>-u</b> option. This flag is
      <i>off</i> by default.</dd>
  <dt id="tty_tickets"><a class="permalink" href="#tty_tickets">tty_tickets</a></dt>
  <dd>If set, users must authenticate on a per-tty basis. With this flag
      enabled, <b>sudo</b> will use a separate record in the time stamp file for
      each terminal. If disabled, a single record is used for all login
      sessions.
    <p class="Pp">This option has been superseded by the <i>timestamp_type</i>
        option.</p>
  </dd>
  <dt id="umask_override"><a class="permalink" href="#umask_override">umask_override</a></dt>
  <dd>If set, <b>sudo</b> will set the umask as specified in the <i>sudoers</i>
      file without modification. This makes it possible to specify a umask in
      the <i>sudoers</i> file that is more permissive than the user's own umask
      and matches historical behavior. If <i>umask_override</i> is not set,
      <b>sudo</b> will set the umask to be the union of the user's umask and
      what is specified in <i>sudoers</i>. This flag is <i>off</i> by
    default.</dd>
  <dt id="use_netgroups"><a class="permalink" href="#use_netgroups">use_netgroups</a></dt>
  <dd>If set, netgroups (prefixed with &#x2018;+&#x2019;), may be used in place
      of a user or host. For LDAP-based sudoers, netgroup support requires an
      expensive sub-string match on the server unless the <b>NETGROUP_BASE</b>
      directive is present in the <i>/etc/ldap.conf</i> file. If netgroups are
      not needed, this option can be disabled to reduce the load on the LDAP
      server. This flag is <i>on</i> by default.</dd>
  <dt id="use_pty"><a class="permalink" href="#use_pty">use_pty</a></dt>
  <dd>If set, and <b>sudo</b> is running in a terminal, the command will be run
      in a new pseudo-terminal. If the <b>sudo</b> process is not attached to a
      terminal, <i>use_pty</i> has no effect.
    <p class="Pp">A malicious program run under <b>sudo</b> may be capable of
        injecting commands into the user's terminal or running a background
        process that retains access to the user's terminal device even after the
        main program has finished executing. By running the command in a
        separate pseudo-terminal, this attack is no longer possible.</p>
    <p class="Pp">A side effect of running the command in a new pseudo-terminal
        is that input will be passed to the command even if it is
        non-interactive. This means that, for example, keys pressed while a
        non-interactive command is running will be consumed by <b>sudo</b>
        instead of being passed to the shell after the command exits.</p>
    <p class="Pp">This flag is <i>on</i> by default for <b>sudo</b> 1.9.14 and
        above.</p>
  </dd>
  <dt id="user_command_timeouts"><a class="permalink" href="#user_command_timeouts">user_command_timeouts</a></dt>
  <dd>If set, the user may specify a timeout on the command line. If the timeout
      expires before the command has exited, the command will be terminated. If
      a timeout is specified both in the <i>sudoers</i> file and on the command
      line, the smaller of the two timeouts will be used. See the
      <i>Timeout_Spec</i> section for a description of the timeout syntax. This
      flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.20 or
      higher.</p>
  </dd>
  <dt id="utmp_runas"><a class="permalink" href="#utmp_runas">utmp_runas</a></dt>
  <dd>If set, <b>sudo</b> will store the name of the runas user when updating
      the utmp (or utmpx) file. By default, <b>sudo</b> stores the name of the
      invoking user. This flag is <i>off</i> by default.</dd>
  <dt id="visiblepw"><a class="permalink" href="#visiblepw">visiblepw</a></dt>
  <dd>By default, <b>sudo</b> will refuse to run if the user must enter a
      password but it is not possible to disable echo on the terminal. If the
      <i>visiblepw</i> flag is set, <b>sudo</b> will prompt for a password even
      when it would be visible on the screen. This makes it possible to run
      things like &#x2018;ssh somehost sudo ls&#x2019; since by default, ssh(1)
      does not allocate a tty when running a command. This flag is <i>off</i> by
      default.</dd>
</dl>
<p class="Pp"><b>Integers</b>:</p>
<dl class="Bl-tag">
  <dt id="closefrom"><a class="permalink" href="#closefrom">closefrom</a></dt>
  <dd>Before it executes a command, <b>sudo</b> will close all open file
      descriptors other than standard input, standard output, and standard error
      (file descriptors 0&#x2013;2). The <i>closefrom</i> option can be used to
      specify a different file descriptor at which to start closing. The default
      is 3.</dd>
  <dt id="command_timeout"><a class="permalink" href="#command_timeout">command_timeout</a></dt>
  <dd>The maximum amount of time a command is allowed to run before it is
      terminated. See the <i>Timeout_Spec</i> section for a description of the
      timeout syntax.
    <p class="Pp">This setting is only supported by version 1.8.20 or
      higher.</p>
  </dd>
  <dt id="log_server_timeout"><a class="permalink" href="#log_server_timeout">log_server_timeout</a></dt>
  <dd>The maximum amount of time to wait when connecting to a log server or
      waiting for a server response. See the <i>Timeout_Spec</i> section for a
      description of the timeout syntax. The default value is 30 seconds.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="maxseq"><a class="permalink" href="#maxseq">maxseq</a></dt>
  <dd>The maximum sequence number that will be substituted for the
      &#x2018;%{seq}&#x2019; escape in the I/O log file (see the
      <i>iolog_dir</i> description below for more information). While the value
      substituted for &#x2018;%{seq}&#x2019; is in base 36, <i>maxseq</i> itself
      should be expressed in decimal. Values larger than 2176782336 (which
      corresponds to the base 36 sequence number &#x201C;ZZZZZZ&#x201D;) will be
      silently truncated to 2176782336. The default value is 2176782336.
    <p class="Pp">Once the local sequence number reaches the value of
        <i>maxseq</i>, it will &#x201C;roll over&#x201D; to zero, after which
        <b>sudoers</b> will truncate and reuse any existing I/O log path
      names.</p>
    <p class="Pp">This setting is only supported by version 1.8.7 or higher.</p>
  </dd>
  <dt id="passwd_tries"><a class="permalink" href="#passwd_tries">passwd_tries</a></dt>
  <dd>The number of tries a user gets to enter his/her password before
      <b>sudo</b> logs the failure and exits. The default is 3.</dd>
  <dt id="syslog_maxlen"><a class="permalink" href="#syslog_maxlen">syslog_maxlen</a></dt>
  <dd>On many systems, syslog(3) has a relatively small log buffer. IETF RFC
      5424 states that syslog servers must support messages of at least 480
      bytes and should support messages up to 2048 bytes. By default,
      <b>sudoers</b> creates log messages up to 980 bytes which corresponds to
      the historic BSD syslog implementation which used a 1024 byte buffer to
      store the message, date, hostname, and program name. To prevent syslog
      messages from being truncated, <b>sudoers</b> will split up log messages
      that are larger than <i>syslog_maxlen</i> bytes. When a message is split,
      additional parts will include the string &#x201C;(command
      continued)&#x201D; after the user name and before the continued command
      line arguments.
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
</dl>
<p class="Pp"><b>Integers that can be used in a boolean context</b>:</p>
<dl class="Bl-tag">
  <dt id="loglinelen"><a class="permalink" href="#loglinelen">loglinelen</a></dt>
  <dd>Number of characters per line for the file log. This value is used to
      decide when to wrap lines for nicer log files. This has no effect on the
      syslog log file, only the file log. The default is 80 (use 0 or negate the
      option to disable word wrap).</dd>
  <dt id="passwd_timeout"><a class="permalink" href="#passwd_timeout">passwd_timeout</a></dt>
  <dd>Number of minutes before the <b>sudo</b> password prompt times out, or 0
      for no timeout. The timeout may include a fractional component if minute
      granularity is insufficient, for example 2.5. The default is 0.</dd>
  <dt id="timestamp_timeout"><a class="permalink" href="#timestamp_timeout">timestamp_timeout</a></dt>
  <dd>
    <br/>
    Number of minutes that can elapse before <b>sudo</b> will ask for a password
      again. The timeout may include a fractional component if minute
      granularity is insufficient, for example 2.5. The default is 5. Set this
      to 0 to always prompt for a password. If set to a value less than 0 the
      user's time stamp will not expire until the system is rebooted. This can
      be used to allow users to create or delete their own time stamps via
      &#x2018;sudo -v&#x2019; and &#x2018;sudo -k&#x2019; respectively.</dd>
  <dt id="umask"><a class="permalink" href="#umask">umask</a></dt>
  <dd>File mode creation mask to use when running the command. Negate this
      option or set it to 0777 to prevent <b>sudoers</b> from changing the
      umask. Unless the <i>umask_override</i> flag is set, the actual umask will
      be the union of the user's umask and the value of the <i>umask</i>
      setting, which defaults to 0022. This guarantees that <b>sudo</b> never
      lowers the umask when running a command.
    <p class="Pp">If <i>umask</i> is explicitly set in <i>sudoers</i>, it will
        override any umask setting in PAM or login.conf. If <i>umask</i> is not
        set in <i>sudoers</i>, the umask specified by PAM or login.conf will
        take precedence. The umask setting in PAM is not used for
        <b>sudoedit</b>, which does not create a new PAM session.</p>
  </dd>
</dl>
<p class="Pp"><b>Strings</b>:</p>
<dl class="Bl-tag">
  <dt id="cmddenial_message"><a class="permalink" href="#cmddenial_message">cmddenial_message</a></dt>
  <dd>
    <br/>
    It set, <b>sudo</b> will display this message when a user is denied access
      to run the specified command, but is listed in the <i>sudoers</i> file for
      the host. This can be used to provide additional, site-specific
      information to the user when a command is denied by the security policy.
      It does not override the standard warning the user receives when a command
      is denied.</dd>
  <dt id="authfail_message"><a class="permalink" href="#authfail_message">authfail_message</a></dt>
  <dd>Message that is displayed after a user fails to authenticate. The message
      may include the &#x2018;%d&#x2019; escape which will expand to the number
      of failed password attempts. If set, it overrides the default message,
      &#x201C;%d incorrect password attempt(s)&#x201D;.</dd>
  <dt id="badpass_message"><a class="permalink" href="#badpass_message">badpass_message</a></dt>
  <dd>Message that is displayed if a user enters an incorrect password. The
      default is &#x201C;Sorry, try again.&#x201D; unless insults are
    enabled.</dd>
  <dt id="editor"><a class="permalink" href="#editor">editor</a></dt>
  <dd>A colon (&#x2018;:&#x2019;) separated list of editor path names used by
      <b>sudoedit</b> and <b>visudo</b>. For <b>sudoedit</b>, this list is used
      to find an editor when none of the SUDO_EDITOR, VISUAL or EDITOR
      environment variables are set to an editor that exists and is executable.
      For <b>visudo</b>, it is used as a white list of allowed editors;
      <b>visudo</b> will choose the editor that matches the user's SUDO_EDITOR,
      VISUAL or EDITOR environment variable if possible, or the first editor in
      the list that exists and is executable if not. Unless invoked as
      <b>sudoedit</b>, <b>sudo</b> does not preserve the SUDO_EDITOR, VISUAL or
      EDITOR environment variables unless they are present in the
      <i>env_keep</i> list or the <i>env_reset</i> option is disabled. The
      default is <i>/usr/bin/vi</i>.</dd>
  <dt id="intercept_type"><a class="permalink" href="#intercept_type">intercept_type</a></dt>
  <dd>The underlying mechanism used by the <i>intercept</i> and
      <i>log_subcmds</i> options. It has the following possible values:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="dso"><a class="permalink" href="#dso">dso</a></dt>
  <dd>Preload a dynamic shared object (shared library) that intercepts the
      execve(2), execl(3), execle(3), execlp(3), execv(3), execvp(3),
      execvpe(3), and system(3) library functions. A value of <i>dso</i> is
      incompatible with <b>sudo</b>'s SELinux RBAC support.</dd>
  <dt id="trace"><a class="permalink" href="#trace">trace</a></dt>
  <dd>Use ptrace(2) to intercept the execve(2) system call. This is only
      supported on Linux systems where seccomp(2) filtering is enabled. If the
      <i>/proc/sys/kernel/seccomp/actions_avail</i> file is missing or does not
      contain a &#x201C;trap&#x201D; element, setting <i>intercept_type</i> to
      <i>trace</i> will have no effect and <i>dso</i> will be used instead.</dd>
</dl>
<p class="Pp">The default is to use <i>trace</i> if it is supported by the
    system and <i>dso</i> if it is not.</p>
</div>
<dl class="Bl-tag">
  <dt id="iolog_dir"><a class="permalink" href="#iolog_dir">iolog_dir</a></dt>
  <dd>The top-level directory to use when constructing the path name for the
      input/output log directory. Only used if the <i>log_input</i> or
      <i>log_output</i> options are enabled or when the LOG_INPUT or LOG_OUTPUT
      tags are present for a command. The session sequence number, if any, is
      stored in the directory. The default is <i>/var/log/sudo-io</i>.
    <p class="Pp">The following percent (&#x2018;%&#x2019;) escape sequences are
        supported:</p>
  </dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>%{seq}</dt>
  <dd>expanded to a monotonically increasing base-36 sequence number, such as
      0100A5, where every two digits are used to form a new directory, e.g.,
      <i>01/00/A5</i></dd>
  <dt>%{user}</dt>
  <dd>expanded to the invoking user's login name</dd>
  <dt>%{group}</dt>
  <dd>expanded to the name of the invoking user's real group-ID</dd>
  <dt>%{runas_user}</dt>
  <dd>expanded to the login name of the user the command will be run as (e.g.,
      <b>root</b>)</dd>
  <dt>%{runas_group}</dt>
  <dd>expanded to the group name of the user the command will be run as (e.g.,
      <b>wheel</b>)</dd>
  <dt>%{hostname}</dt>
  <dd>expanded to the local host name without the domain name</dd>
  <dt>%{command}</dt>
  <dd>expanded to the base name of the command being run</dd>
</dl>
<p class="Pp">In addition, any escape sequences supported by the system's
    strftime(3) function will be expanded.</p>
<p class="Pp">To include a literal &#x2018;%&#x2019; character, the string
    &#x2018;%%&#x2019; should be used.</p>
<p class="Pp">Any path name separator characters (&#x2018;/&#x2019;) present in
    the user, group or host name will be replaced with an underbar
    (&#x2018;_&#x2019;) during expansion.</p>
</div>
<dl class="Bl-tag">
  <dt id="iolog_file"><a class="permalink" href="#iolog_file">iolog_file</a></dt>
  <dd>The path name, relative to <i>iolog_dir</i>, in which to store
      input/output logs when the <i>log_input</i> or <i>log_output</i> options
      are enabled or when the LOG_INPUT or LOG_OUTPUT tags are present for a
      command. <i>iolog_file</i> may contain directory components. The default
      is &#x2018;%{seq}&#x2019;.
    <p class="Pp">See the <i>iolog_dir</i> option above for a list of supported
        percent (&#x2018;%&#x2019;) escape sequences.</p>
    <p class="Pp">In addition to the escape sequences, path names that end in
        six or more <i>X</i>s will have the <i>X</i>s replaced with a unique
        combination of digits and letters, similar to the mktemp(3)
      function.</p>
    <p class="Pp">If the path created by concatenating <i>iolog_dir</i> and
        <i>iolog_file</i> already exists, the existing I/O log file will be
        truncated and overwritten unless <i>iolog_file</i> ends in six or more
        <i>X</i>s.</p>
  </dd>
  <dt id="iolog_flush"><a class="permalink" href="#iolog_flush">iolog_flush</a></dt>
  <dd>If set, <b>sudo</b> will flush I/O log data to disk after each write
      instead of buffering it. This makes it possible to view the logs in
      real-time as the program is executing but may significantly reduce the
      effectiveness of I/O log compression. This flag is <i>off</i> by default.
    <p class="Pp">This setting is only supported by version 1.8.20 or
      higher.</p>
  </dd>
  <dt id="iolog_group"><a class="permalink" href="#iolog_group">iolog_group</a></dt>
  <dd>The group name to look up when setting the group-ID on new I/O log files
      and directories. If <i>iolog_group</i> is not set, the primary group-ID of
      the user specified by <i>iolog_user</i> is used. If neither
      <i>iolog_group</i> nor <i>iolog_user</i> are set, I/O log files and
      directories are created with group-ID 0.
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
  <dt id="iolog_mode"><a class="permalink" href="#iolog_mode">iolog_mode</a></dt>
  <dd>The file mode to use when creating I/O log files. Mode bits for read and
      write permissions for owner, group, or other are honored, everything else
      is ignored. The file permissions will always include the owner read and
      write bits, even if they are not present in the specified mode. When
      creating I/O log directories, search (execute) bits are added to match the
      read and write bits specified by <i>iolog_mode</i>. Defaults to 0600 (read
      and write by user only).
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
  <dt id="iolog_user"><a class="permalink" href="#iolog_user">iolog_user</a></dt>
  <dd>The user name to look up when setting the user and group-IDs on new I/O
      log files and directories. If <i>iolog_group</i> is set, it will be used
      instead of the user's primary group-ID. By default, I/O log files and
      directories are created with user and group-ID 0.
    <p class="Pp">This setting can be useful when the I/O logs are stored on a
        Network File System (NFS) share. Having a dedicated user own the I/O log
        files means that <b>sudoers</b> does not write to the log files as
        user-ID 0, which is usually not permitted by NFS.</p>
    <p class="Pp">This setting is only supported by version 1.8.19 or
      higher.</p>
  </dd>
  <dt id="lecture_status_dir"><a class="permalink" href="#lecture_status_dir">lecture_status_dir</a></dt>
  <dd>The directory in which <b>sudo</b> stores per-user lecture status files.
      Once a user has received the lecture, a zero-length file is created in
      this directory so that <b>sudo</b> will not lecture the user again. This
      directory should <i>not</i> be cleared when the system reboots. The
      default is <i>/var/db/sudo/lectured</i>.</dd>
  <dt id="log_server_cabundle"><a class="permalink" href="#log_server_cabundle">log_server_cabundle</a></dt>
  <dd>The path to a certificate authority bundle file, in PEM format, to use
      instead of the system's default certificate authority database when
      authenticating the log server. The default is to use the system's default
      certificate authority database. This setting has no effect unless
      <i>log_servers</i> is set and the remote log server is secured with TLS.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="log_server_peer_cert"><a class="permalink" href="#log_server_peer_cert">log_server_peer_cert</a></dt>
  <dd>The path to the <b>sudo</b> client's certificate file, in PEM format. This
      setting is required when the remote log server is secured with TLS and
      client certificate validation is enabled. For <b>sudo_logsrvd</b>, client
      certificate validation is controlled by the <i>tls_checkpeer</i> option,
      which defaults to <i>false</i>.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="log_server_peer_key"><a class="permalink" href="#log_server_peer_key">log_server_peer_key</a></dt>
  <dd>The path to the <b>sudo</b> client's private key file, in PEM format. This
      setting is required when the remote log server is secured with TLS and
      client certificate validation is enabled. For <b>sudo_logsrvd</b>, client
      certificate validation is controlled by the <i>tls_checkpeer</i> flag,
      which defaults to <i>false</i>.
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="mailsub"><a class="permalink" href="#mailsub">mailsub</a></dt>
  <dd>Subject of the mail sent to the <i>mailto</i> user. The escape
      &#x2018;%h&#x2019; will expand to the host name of the machine. Default is
      &#x201C;*** SECURITY information for %h ***&#x201D;.</dd>
  <dt id="noexec_file"><a class="permalink" href="#noexec_file">noexec_file</a></dt>
  <dd>As of <b>sudo</b> version 1.8.1 this option is no longer supported. The
      path to the noexec file should now be set in the sudo.conf(5) file.</dd>
  <dt id="pam_askpass_service"><a class="permalink" href="#pam_askpass_service">pam_askpass_service</a></dt>
  <dd>On systems that use PAM for authentication, this is the service name used
      when the <b>-A</b> option is specified. The default value is either
      &#x2018;sudo&#x2019; or &#x2018;sudo&#x2019;, depending on whether or not
      the <b>-i</b> option is also specified. See the description of
      <i>pam_service</i> for more information.
    <p class="Pp">This setting is only supported by version 1.9.9 or higher.</p>
  </dd>
  <dt id="pam_login_service"><a class="permalink" href="#pam_login_service">pam_login_service</a></dt>
  <dd>
    <br/>
    On systems that use PAM for authentication, this is the service name used
      when the <b>-i</b> option is specified. The default value is
      &#x2018;sudo&#x2019;. See the description of <i>pam_service</i> for more
      information.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt id="pam_service"><a class="permalink" href="#pam_service">pam_service</a></dt>
  <dd>On systems that use PAM for authentication, the service name specifies the
      PAM policy to apply. This usually corresponds to an entry in the
      <i>pam.conf</i> file or a file in the <i>/etc/pam.d</i> directory. The
      default value is &#x2018;sudo&#x2019;.
    <p class="Pp">This setting is only supported by version 1.8.8 or higher.</p>
  </dd>
  <dt id="passprompt"><a class="permalink" href="#passprompt">passprompt</a></dt>
  <dd>The default prompt to use when asking for a password; can be overridden
      via the <b>-p</b> option or the SUDO_PROMPT environment variable. The
      following percent (&#x2018;%&#x2019;) escape sequences are supported:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>%H</dt>
  <dd>expanded to the local host name including the domain name (only if the
      machine's host name is fully qualified or the <i>fqdn</i> option is
    set)</dd>
  <dt>%h</dt>
  <dd>expanded to the local host name without the domain name</dd>
  <dt>%p</dt>
  <dd>expanded to the user whose password is being asked for (respects the
      <i>rootpw</i>, <i>targetpw</i> and <i>runaspw</i> flags in
    <i>sudoers</i>)</dd>
  <dt>%U</dt>
  <dd>expanded to the login name of the user the command will be run as
      (defaults to <b>root</b>)</dd>
  <dt>%u</dt>
  <dd>expanded to the invoking user's login name</dd>
  <dt>%%</dt>
  <dd>two consecutive &#x2018;%&#x2019; characters are collapsed into a single
      &#x2018;%&#x2019; character</dd>
</dl>
<p class="Pp">On systems that use PAM for authentication, <i>passprompt</i> will
    only be used if the prompt provided by the PAM module matches the string
    &#x201C;Password: &#x201D; or &#x201C;username's Password: &#x201D;. This
    ensures that the <i>passprompt</i> setting does not interfere with
    challenge-response style authentication. The <i>passprompt_override</i> flag
    can be used to change this behavior.</p>
<p class="Pp">The default value is &#x2018;Password: &#x2019;.</p>
</div>
<dl class="Bl-tag">
  <dt id="runas_default"><a class="permalink" href="#runas_default">runas_default</a></dt>
  <dd>The default user to run commands as if the <b>-u</b> option is not
      specified on the command line. This defaults to <b>root</b>.</dd>
  <dt id="sudoers_locale"><a class="permalink" href="#sudoers_locale">sudoers_locale</a></dt>
  <dd>Locale to use when parsing the sudoers file, logging commands, and sending
      email. Changing the locale may affect how sudoers is interpreted. Defaults
      to &#x2018;C&#x2019;.</dd>
  <dt id="timestamp_type"><a class="permalink" href="#timestamp_type">timestamp_type</a></dt>
  <dd><b>sudoers</b> uses per-user time stamp files for credential caching. The
      <i>timestamp_type</i> option can be used to specify the type of time stamp
      record used. It has the following possible values:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="global"><a class="permalink" href="#global">global</a></dt>
  <dd>A single time stamp record is used for all of a user's login sessions,
      regardless of the terminal or parent process ID. An additional record is
      used to serialize password prompts when <b>sudo</b> is used multiple times
      in a pipeline, but this does not affect authentication.</dd>
  <dt id="ppid"><a class="permalink" href="#ppid">ppid</a></dt>
  <dd>A single time stamp record is used for all processes with the same parent
      process ID (usually the shell). Commands run from the same shell (or other
      common parent process) will not require a password for
      <i>timestamp_timeout</i> minutes (5 by default). Commands run via
      <b>sudo</b> with a different parent process ID, for example from a shell
      script, will be authenticated separately.</dd>
  <dt id="tty"><a class="permalink" href="#tty">tty</a></dt>
  <dd>One time stamp record is used for each terminal, which means that a user's
      login sessions are authenticated separately. If no terminal is present,
      the behavior is the same as <i>ppid</i>. Commands run from the same
      terminal will not require a password for <i>timestamp_timeout</i> minutes
      (5 by default).</dd>
  <dt id="kernel"><a class="permalink" href="#kernel">kernel</a></dt>
  <dd>The time stamp is stored in the kernel as an attribute of the terminal
      device. If no terminal is present, the behavior is the same as
      <i>ppid</i>. Negative <i>timestamp_timeout</i> values are not supported
      and positive values are limited to a maximum of 60 minutes. This is
      currently only supported on OpenBSD.</dd>
</dl>
<p class="Pp">The default value is <i>tty</i>.</p>
<p class="Pp">This setting is only supported by version 1.8.21 or higher.</p>
</div>
<dl class="Bl-tag">
  <dt id="timestampdir"><a class="permalink" href="#timestampdir">timestampdir</a></dt>
  <dd>The directory in which <b>sudo</b> stores its time stamp files. This
      directory should be cleared when the system reboots. The default is
      <i>/var/db/sudo/ts</i>.</dd>
  <dt id="timestampowner"><a class="permalink" href="#timestampowner">timestampowner</a></dt>
  <dd>The owner of the lecture status directory, time stamp directory and all
      files stored therein. The default is <b>root</b>.</dd>
  <dt id="env_check"><a class="permalink" href="#env_check">env_check</a></dt>
  <dd>Environment variables to be removed from the user's environment unless
      they are considered &#x201C;safe&#x201D;. For all variables except TZ,
      &#x201C;safe&#x201D; means that the variable's value does not contain any
      &#x2018;%&#x2019; or &#x2018;/&#x2019; characters. This can be used to
      guard against printf-style format vulnerabilities in poorly-written
      programs. The TZ variable is considered unsafe if any of the following are
      true:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt><b>&#x2022;</b></dt>
  <dd>It consists of a fully-qualified path name, optionally prefixed with a
      colon (&#x2018;:&#x2019;), that does not match the location of the
      <i>zoneinfo</i> directory.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>It contains a <i>..</i> path element.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>It contains white space or non-printable characters.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>It is longer than the value of PATH_MAX.</dd>
</dl>
<p class="Pp">The argument may be a double-quoted, space-separated list or a
    single value without double-quotes. The list can be replaced, added to,
    deleted from, or disabled by using the &#x2018;=&#x2019;,
    &#x2018;+=&#x2019;, &#x2018;-=&#x2019;, and &#x2018;!&#x2019; operators
    respectively. Regardless of whether the <i>env_reset</i> option is enabled
    or disabled, variables specified by <i>env_check</i> will be preserved in
    the environment if they pass the aforementioned check. The global list of
    environment variables to check is displayed when <b>sudo</b> is run by
    <b>root</b> with the <b>-V</b> option.</p>
</div>
<dl class="Bl-tag">
  <dt id="env_delete"><a class="permalink" href="#env_delete">env_delete</a></dt>
  <dd>Environment variables to be removed from the user's environment when the
      <i>env_reset</i> option is not in effect. The argument may be a
      double-quoted, space-separated list or a single value without
      double-quotes. The list can be replaced, added to, deleted from, or
      disabled by using the &#x2018;=&#x2019;, &#x2018;+=&#x2019;,
      &#x2018;-=&#x2019;, and &#x2018;!&#x2019; operators respectively. The
      global list of environment variables to remove is displayed when
      <b>sudo</b> is run by <b>root</b> with the <b>-V</b> option. Many
      operating systems will remove potentially dangerous variables from the
      environment of any set-user-ID process (such as <b>sudo</b>).</dd>
  <dt id="env_keep"><a class="permalink" href="#env_keep">env_keep</a></dt>
  <dd>Environment variables to be preserved in the user's environment when the
      <i>env_reset</i> option is in effect. This allows fine-grained control
      over the environment <b>sudo</b>-spawned processes will receive. The
      argument may be a double-quoted, space-separated list or a single value
      without double-quotes. The list can be replaced, added to, deleted from,
      or disabled by using the &#x2018;=&#x2019;, &#x2018;+=&#x2019;,
      &#x2018;-=&#x2019;, and &#x2018;!&#x2019; operators respectively. The
      global list of variables to keep is displayed when <b>sudo</b> is run by
      <b>root</b> with the <b>-V</b> option.
    <p class="Pp">Preserving the HOME environment variable has security
        implications since many programs use it when searching for configuration
        or data files. Adding HOME to <i>env_keep</i> may enable a user to run
        unrestricted commands via <b>sudo</b> and is strongly discouraged. Users
        wishing to edit files with <b>sudo</b> should run <b>sudoedit</b> (or
        <b>sudo</b> <b>-e</b>) to get their accustomed editor configuration
        instead of invoking the editor directly.</p>
  </dd>
  <dt id="log_servers"><a class="permalink" href="#log_servers">log_servers</a></dt>
  <dd>A list of one or more servers to use for remote event and I/O log storage,
      separated by white space. Log servers must be running <b>sudo_logsrvd</b>
      or another service that implements the protocol described by
      sudo_logsrv.proto(5).
    <p class="Pp">Server addresses should be of the form
        &#x201C;host[:port][(tls)]&#x201D;. The host portion may be a host name,
        an IPv4 address, or an IPv6 address in square brackets.</p>
    <p class="Pp">If the optional <i>tls</i> flag is present, the connection
        will be secured with Transport Layer Security (TLS) version 1.2 or 1.3.
        Versions of TLS prior to 1.2 are not supported.</p>
    <p class="Pp">If a port is specified, it may either be a port number or a
        well-known service name as defined by the system service name database.
        If no port is specified, port 30343 will be used for plaintext
        connections and port 30344 will be used for TLS connections.</p>
    <p class="Pp">When <i>log_servers</i> is set, event log data will be logged
        both locally (see the <i>syslog</i> and <i>log_file</i> settings) as
        well as remotely, but I/O log data will only be logged remotely. If
        multiple hosts are specified, they will be attempted in reverse order.
        If no log servers are available, the user will not be able to run a
        command unless either the <i>ignore_iolog_errors</i> flag (I/O logging
        enabled) or the <i>ignore_log_errors</i> flag (I/O logging disabled) is
        set. Likewise, if the connection to the log server is interrupted while
        <b>sudo</b> is running, the command will be terminated unless the
        <i>ignore_iolog_errors</i> flag (I/O logging enabled) or the
        <i>ignore_log_errors</i> flag (I/O logging disabled) is set.</p>
    <p class="Pp">This setting is only supported by version 1.9.0 or higher.</p>
  </dd>
  <dt id="passprompt_regex"><a class="permalink" href="#passprompt_regex">passprompt_regex</a></dt>
  <dd>A list of POSIX extended regular expressions used to match password
      prompts in the terminal output. As an extension, if the regular expression
      begins with &#x201C;(?i)&#x201D;, it will be matched in a case-insensitive
      manner. Each regular expression is limited to 1024 characters. This option
      is only used when <i>log_passwords</i> has been disabled. The default
      value is &#x201C;[Pp]assword[: ]*&#x201D;
    <p class="Pp">This setting is only supported by version 1.9.10 or
      higher.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="GROUP_PROVIDER_PLUGINS"><a class="permalink" href="#GROUP_PROVIDER_PLUGINS">GROUP
  PROVIDER PLUGINS</a></h1>
<p class="Pp">The <b>sudoers</b> plugin supports its own plugin interface to
    allow non-Unix group lookups which can query a group source other than the
    standard Unix group database. This can be used to implement support for the
    <i>nonunix_group</i> syntax described earlier.</p>
<p class="Pp">Group provider plugins are specified via the <i>group_plugin</i>
    setting. The argument to <i>group_plugin</i> should consist of the plugin
    path, either fully-qualified or relative to the
    <i>/usr/local/libexec/sudo</i> directory, followed by any configuration
    options the plugin requires. These options (if specified) will be passed to
    the plugin's initialization function. If options are present, the string
    must be enclosed in double quotes (&quot;&quot;).</p>
<p class="Pp">The following group provider plugins are installed by default:</p>
<dl class="Bl-tag">
  <dt id="group_file"><a class="permalink" href="#group_file">group_file</a></dt>
  <dd>The <i>group_file</i> plugin supports an alternate group file that uses
      the same syntax as the <i>/etc/group</i> file. The path to the group file
      should be specified as an option to the plugin. For example, if the group
      file to be used is <i>/etc/sudo-group</i>:
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>Defaults group_plugin=&quot;group_file.so /etc/sudo-group&quot;</pre>
</div>
<pre></pre>
<dl class="Bl-tag">
  <dt id="system_group"><a class="permalink" href="#system_group">system_group</a></dt>
  <dd>The <i>system_group</i> plugin supports group lookups via the standard C
      library functions getgrnam(3) and getgrid(3). This plugin can be used in
      instances where the user belongs to groups not present in the user's
      supplemental group vector. This plugin takes no options:
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>Defaults group_plugin=system_group.so</pre>
</div>
<pre></pre>
<p class="Pp">The group provider plugin API is described in detail in
    sudo_plugin(5).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EVENT_LOGGING"><a class="permalink" href="#EVENT_LOGGING">EVENT
  LOGGING</a></h1>
<p class="Pp"><b>sudoers</b> can log events in either JSON or <i>sudo</i>
    format, this section describes the <i>sudo</i> log format. Depending on
    <i>sudoers</i> configuration, <b>sudoers</b> can log events via syslog(3),
    to a local log file, or both. The log format is almost identical in both
    cases. Any control characters present in the log data are formatted in octal
    with a leading &#x2018;#&#x2019; character. For example, a horizontal tab is
    stored as &#x2018;#011&#x2019; and an embedded carriage return is stored as
    &#x2018;#015&#x2019;. In addition, space characters in the command path are
    stored as &#x2018;#040&#x2019;. Command line arguments that contain spaces
    are enclosed in single quotes (''). This makes it possible to distinguish
    multiple command line arguments from a single argument that contains spaces.
    Literal single quotes and backslash characters (&#x2018;\&#x2019;) in
    command line arguments are escaped with a backslash.</p>
<section class="Ss">
<h2 class="Ss" id="Accepted_command_log_entries"><a class="permalink" href="#Accepted_command_log_entries">Accepted
  command log entries</a></h2>
<p class="Pp">Commands that sudo runs are logged using the following format
    (split into multiple lines for readability):</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>date hostname progname: username : TTY=ttyname ; CHROOT=chroot ; \
<br/>
    PWD=cwd ; USER=runasuser ; GROUP=runasgroup ; TSID=logid ; \
<br/>
    ENV=env_vars COMMAND=command</pre>
</div>
<pre></pre>
<p class="Pp">Where the fields are as follows:</p>
<dl class="Bl-tag">
  <dt id="date"><a class="permalink" href="#date">date</a></dt>
  <dd>The date the command was run. Typically, this is in the format
      &#x201C;MMM, DD, HH:MM:SS&#x201D;. If logging via syslog(3), the actual
      date format is controlled by the syslog daemon. If logging to a file and
      the <i>log_year</i> option is enabled, the date will also include the
      year.</dd>
  <dt id="hostname"><a class="permalink" href="#hostname">hostname</a></dt>
  <dd>The name of the host <b>sudo</b> was run on. This field is only present
      when logging via syslog(3).</dd>
  <dt id="progname"><a class="permalink" href="#progname">progname</a></dt>
  <dd>The name of the program, usually <i>sudo</i> or <i>sudoedit</i>. This
      field is only present when logging via syslog(3).</dd>
  <dt id="username"><a class="permalink" href="#username">username</a></dt>
  <dd>The login name of the user who ran <b>sudo</b>.</dd>
  <dt id="ttyname"><a class="permalink" href="#ttyname">ttyname</a></dt>
  <dd>The short name of the terminal (e.g., &#x201C;console&#x201D;,
      &#x201C;tty01&#x201D;, or &#x201C;pts/0&#x201D;) <b>sudo</b> was run on,
      or &#x201C;unknown&#x201D; if there was no terminal present.</dd>
  <dt id="chroot"><a class="permalink" href="#chroot">chroot</a></dt>
  <dd>The root directory that the command was run in, if one was specified.</dd>
  <dt id="cwd"><a class="permalink" href="#cwd">cwd</a></dt>
  <dd>The current working directory that <b>sudo</b> was run in.</dd>
  <dt id="runasuser"><a class="permalink" href="#runasuser">runasuser</a></dt>
  <dd>The user the command was run as.</dd>
  <dt id="runasgroup"><a class="permalink" href="#runasgroup">runasgroup</a></dt>
  <dd>The group the command was run as if one was specified on the command
    line.</dd>
  <dt id="logid"><a class="permalink" href="#logid">logid</a></dt>
  <dd>An I/O log identifier that can be used to replay the command's output.
      This is only present when the <i>log_input</i> or <i>log_output</i> option
      is enabled.</dd>
  <dt id="env_vars"><a class="permalink" href="#env_vars">env_vars</a></dt>
  <dd>A list of environment variables specified on the command line, if
      specified.</dd>
  <dt id="command"><a class="permalink" href="#command">command</a></dt>
  <dd>The actual command that was executed, including any command line
      arguments.</dd>
</dl>
<p class="Pp">Messages are logged using the locale specified by
    <i>sudoers_locale</i>, which defaults to the &#x2018;C&#x2019; locale.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Denied_command_log_entries"><a class="permalink" href="#Denied_command_log_entries">Denied
  command log entries</a></h2>
<p class="Pp">If the user is not allowed to run the command, the reason for the
    denial will follow the user name. Possible reasons include:</p>
<dl class="Bl-tag">
  <dt id="user"><a class="permalink" href="#user">user NOT in sudoers</a></dt>
  <dd>The user is not listed in the <i>sudoers</i> file.</dd>
  <dt id="user~2"><a class="permalink" href="#user~2">user NOT authorized on
    host</a></dt>
  <dd>The user is listed in the <i>sudoers</i> file but is not allowed to run
      commands on the host.</dd>
  <dt>command not allowed</dt>
  <dd>The user is listed in the <i>sudoers</i> file for the host but they are
      not allowed to run the specified command.</dd>
  <dt>3 incorrect password attempts</dt>
  <dd>The user failed to enter their password after 3 tries. The actual number
      of tries will vary based on the number of failed attempts and the value of
      the <i>passwd_tries</i> option.</dd>
  <dt id="a"><a class="permalink" href="#a">a password is required</a></dt>
  <dd>The <b>-n</b> option was specified but a password was required.</dd>
  <dt id="sorry,"><a class="permalink" href="#sorry,">sorry, you are not allowed
    to set the following environment variables</a></dt>
  <dd>The user specified environment variables on the command line that were not
      allowed by <i>sudoers</i>.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Error_log_entries"><a class="permalink" href="#Error_log_entries">Error
  log entries</a></h2>
<p class="Pp">If an error occurs, <b>sudoers</b> will log a message and, in most
    cases, send a message to the administrator via email. Possible errors
    include:</p>
<dl class="Bl-tag">
  <dt id="parse"><a class="permalink" href="#parse">parse error in
    /private/etc/sudoers near line N</a></dt>
  <dd><b>sudoers</b> encountered an error when parsing the specified file. In
      some cases, the actual error may be one line above or below the line
      number listed, depending on the type of error.</dd>
  <dt id="problem"><a class="permalink" href="#problem">problem with defaults
    entries</a></dt>
  <dd>The <i>sudoers</i> file contains one or more unknown Defaults settings.
      This does not prevent <b>sudo</b> from running, but the <i>sudoers</i>
      file should be checked using <b>visudo</b>.</dd>
  <dt>timestamp owner (username): No such user</dt>
  <dd>The time stamp directory owner, as specified by the <i>timestampowner</i>
      setting, could not be found in the password database.</dd>
  <dt id="unable"><a class="permalink" href="#unable">unable to open/read
    /private/etc/sudoers</a></dt>
  <dd>The <i>sudoers</i> file could not be opened for reading. This can happen
      when the <i>sudoers</i> file is located on a remote file system that maps
      user-ID 0 to a different value. Normally, <b>sudoers</b> tries to open the
      <i>sudoers</i> file using group permissions to avoid this problem.
      Consider either changing the ownership of <i>/private/etc/sudoers</i> or
      adding an argument like &#x201C;sudoers_uid=N&#x201D; (where
      &#x2018;N&#x2019; is the user-ID that owns the <i>sudoers</i> file) to the
      end of the <b>sudoers</b> <i>Plugin</i> line in the sudo.conf(5)
    file.</dd>
  <dt id="unable~2"><a class="permalink" href="#unable~2">unable to open
    /private/etc/sudoers</a></dt>
  <dd>The <i>/private/etc/sudoers</i> file is missing.</dd>
  <dt>/private/etc/sudoers is not a regular file</dt>
  <dd>The <i>/private/etc/sudoers</i> file exists but is not a regular file or
      symbolic link.</dd>
  <dt>/private/etc/sudoers is owned by uid N, should be 0</dt>
  <dd>The <i>sudoers</i> file has the wrong owner. If you wish to change the
      <i>sudoers</i> file owner, add &#x201C;sudoers_uid=N&#x201D; (where
      &#x2018;N&#x2019; is the user-ID that owns the <i>sudoers</i> file) to the
      <b>sudoers</b> <i>Plugin</i> line in the sudo.conf(5) file.</dd>
  <dt>/private/etc/sudoers is world writable</dt>
  <dd>The permissions on the <i>sudoers</i> file allow all users to write to it.
      The <i>sudoers</i> file must not be world-writable, the default file mode
      is 0440 (readable by owner and group, writable by none). The default mode
      may be changed via the &#x201C;sudoers_mode&#x201D; option to the
      <b>sudoers</b> <i>Plugin</i> line in the sudo.conf(5) file.</dd>
  <dt>/private/etc/sudoers is owned by gid N, should be 1</dt>
  <dd>The <i>sudoers</i> file has the wrong group ownership. If you wish to
      change the <i>sudoers</i> file group ownership, add
      &#x201C;sudoers_gid=N&#x201D; (where &#x2018;N&#x2019; is the group-ID
      that owns the <i>sudoers</i> file) to the <b>sudoers</b> <i>Plugin</i>
      line in the sudo.conf(5) file.</dd>
  <dt id="unable~3"><a class="permalink" href="#unable~3">unable to open
    /var/db/sudo/ts/user-ID</a></dt>
  <dd><b>sudoers</b> was unable to read or create the user's time stamp file.
      This can happen when <i>timestampowner</i> is set to a user other than
      <b>root</b> and the mode on <i>/var/db/sudo</i> is not searchable by group
      or other. The default mode for <i>/var/db/sudo</i> is 0711.</dd>
  <dt id="unable~4"><a class="permalink" href="#unable~4">unable to write to
    /var/db/sudo/ts/user-ID</a></dt>
  <dd><b>sudoers</b> was unable to write to the user's time stamp file.</dd>
  <dt>/var/db/sudo/ts is owned by uid X, should be Y</dt>
  <dd>The time stamp directory is owned by a user other than
      <i>timestampowner</i>. This can occur when the value of
      <i>timestampowner</i> has been changed. <b>sudoers</b> will ignore the
      time stamp directory until the owner is corrected.</dd>
  <dt>/var/db/sudo/ts is group writable</dt>
  <dd>The time stamp directory is group-writable; it should be writable only by
      <i>timestampowner</i>. The default mode for the time stamp directory is
      0700. <b>sudoers</b> will ignore the time stamp directory until the mode
      is corrected.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Notes_on_logging_via_syslog"><a class="permalink" href="#Notes_on_logging_via_syslog">Notes
  on logging via syslog</a></h2>
<p class="Pp">By default, <b>sudoers</b> logs messages via syslog(3). The
    <i>date</i>, <i>hostname</i>, and <i>progname</i> fields are added by the
    system's syslog(3) function, not <b>sudoers</b> itself. As such, they may
    vary in format on different systems.</p>
<p class="Pp">The maximum size of syslog messages varies from system to system.
    The <i>syslog_maxlen</i> setting can be used to change the maximum syslog
    message size from the default value of 980 bytes. For more information, see
    the description of <i>syslog_maxlen</i>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Notes_on_logging_to_a_file"><a class="permalink" href="#Notes_on_logging_to_a_file">Notes
  on logging to a file</a></h2>
<p class="Pp">If the <i>logfile</i> option is set, <b>sudoers</b> will log to a
    local file, such as <i>/var/log/sudo</i>. When logging to a file,
    <b>sudoers</b> uses a format similar to syslog(3), with a few important
    differences:</p>
<dl class="Bl-tag">
  <dt>1.</dt>
  <dd>The <i>progname</i> field is not present.</dd>
  <dt>2.</dt>
  <dd>The <i>hostname</i> is only logged if the <i>log_host</i> option is
      enabled.</dd>
  <dt>3.</dt>
  <dd>The date does not include the year unless the <i>log_year</i> option is
      enabled.</dd>
  <dt>4.</dt>
  <dd>Lines that are longer than <i>loglinelen</i> characters (80 by default)
      are word-wrapped and continued on the next line with a four character
      indent. This makes entries easier to read for a human being, but makes it
      more difficult to use grep(1) on the log files. If the <i>loglinelen</i>
      option is set to 0 (or negated with a &#x2018;!&#x2019;), word wrap will
      be disabled.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="I/O_LOGGING"><a class="permalink" href="#I/O_LOGGING">I/O
  LOGGING</a></h1>
<p class="Pp">When I/O logging is enabled, <b>sudo</b> will runs the command in
    a pseudo-terminal, logging user input and/or output, depending on which
    <b>sudoers</b> flags are enabled. There are five distinct types of I/O that
    can be logged, each with a corresponding <b>sudoers</b> flag.</p>
<table class="tbl">
  <tr>
  </tr>
  <tr>
    <td><b>Type</b></td>
    <td><b>Flag</b></td>
    <td><b>Description</b></td>
  </tr>
  <tr>
  </tr>
  <tr>
    <td>terminal input</td>
    <td>log_ttyin</td>
    <td>keystrokes entered by the user</td>
  </tr>
  <tr>
  </tr>
  <tr>
    <td>terminal output</td>
    <td>log_ttyout</td>
    <td>command output displayed to the screen</td>
  </tr>
  <tr>
  </tr>
  <tr>
    <td>standard input</td>
    <td>log_stdin</td>
    <td>input from a pipe or a file</td>
  </tr>
  <tr>
  </tr>
  <tr>
    <td>standard output</td>
    <td>log_stdout</td>
    <td>output to a pipe or a file</td>
  </tr>
  <tr>
  </tr>
  <tr>
    <td>standard error</td>
    <td>log_stderr</td>
    <td>output to a pipe or a file</td>
  </tr>
</table>
<p class="Pp">In addition to flags described the above, the <i>log_input</i>
    flag and LOG_INPUT command tag set both <i>log_ttyin</i> and
    <i>log_stdin</i>. The <i>log_output</i> flag and LOG_OUTPUT command tag set
    <i>log_ttyout</i>, <i>log_stdout</i>, and <i>log_stderr</i>.</p>
<p class="Pp">To capture terminal input and output, <b>sudo</b> run the command
    in a pseudo-terminal, logging the input and output before passing it on to
    the user. To capture the standard input, standard output or standard error,
    <b>sudo</b> uses a pipe to interpose itself between the input or output
    stream, logging the I/O before passing it to the other end of the pipe.</p>
<p class="Pp">I/O can be logged either to the local machine or to a remote log
    server. For local logs, I/O is logged to the directory specified by the
    <i>iolog_dir</i> option (<i>/var/log/sudo-io</i> by default) using a unique
    session ID that is included in the <b>sudo</b> log line, prefixed with
    &#x2018;TSID=&#x2019;. The <i>iolog_file</i> option may be used to control
    the format of the session ID. For remote logs, the <i>log_servers</i>
    setting is used to specify one or more log servers running
    <b>sudo_logsrvd</b> or another server that implements the protocol described
    by sudo_logsrv.proto(5).</p>
<section class="Ss">
<h2 class="Ss" id="I/O_logging_pitfals"><a class="permalink" href="#I/O_logging_pitfals">I/O
  logging pitfals</a></h2>
<p class="Pp">When logging standard input, anything sent to the standard input
    will be consumed, regardless of whether or not the command run via
    <b>sudo</b> is actively reading the standard input. This may have unexpected
    results when using <b>sudo</b> in a shell script that expects to process the
    standard input. For example, given the following shell script:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>#!/bin/sh
sudo echo testing
echo done</pre>
</div>
<pre></pre>
<p class="Pp">It will behave as expected when the script is passed to the shell
    as a an argument:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sh test.sh
testing
done</pre>
</div>
<pre></pre>
<p class="Pp">However, if the script is passed to the shell on the standard
    input, the &#x2018;sudo echo testing&#x2019; command will consume the rest
    of the script. This means that the &#x2018;echo done&#x2019; statement is
    never executed.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sh -s &lt; test.sh
testing</pre>
</div>
<pre></pre>
<p class="Pp">There are several ways to work around this problem:</p>
<dl class="Bl-tag">
  <dt>1.</dt>
  <dd>Redirect the standard input from <i>/dev/null</i> when running a command
      via <b>sudo</b> that does not need to read the standard input.
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>sudo echo testing &lt; /dev/null</pre>
</div>
<pre></pre>
<dl class="Bl-tag">
  <dt>2.</dt>
  <dd>Pass the script to the shell by path name instead of via the standard
      input.
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>sh test.sh</pre>
</div>
<pre></pre>
<dl class="Bl-tag">
  <dt>3.</dt>
  <dd>Disable logging the standard input for commands that do not need to read
      the standard input.
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>Defaults!/bin/echo !log_stdin</pre>
</div>
<pre></pre>
<p class="Pp">Depending on the command, it may not be desirable to log the
    standard input or standard output. For example, I/O logging of commands that
    send or receive large amount of data via the standard output or standard
    input such as rsync(1) and tar(1) could fill up the log file system with
    superfluous data. It is possible to disable logging of the standard input
    and standard output for such commands as follows:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Cmnd_Alias COPY_CMDS = /usr/bin/tar, /usr/bin/cpio, /usr/bin/rsync
# Log input and output but omit stdin and stdout when copying files.
Defaults log_input, log_output
Defaults!COPY_CMDS !log_stdin, !log_stdout</pre>
</div>
<pre></pre>
<p class="Pp">However, be aware that using the <i>log_input</i> flag or the
    LOG_INPUT command tag will also enable <i>log_stdin</i>. Likewise, the
    <i>log_ouput</i> flag or the LOG_OUTPUT command tag will enable
    <i>log_stdout</i> and <i>log_stderr</i>. Careful ordering of rules may be
    necessary to achieve the results that you expect.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="I/O_log_format"><a class="permalink" href="#I/O_log_format">I/O
  log format</a></h2>
<p class="Pp">For both local and remote I/O logs, each log is stored in a
    separate directory that contains the following files:</p>
<dl class="Bl-tag">
  <dt><i>log</i></dt>
  <dd>A text file containing information about the command. The first line
      consists of the following colon-delimited fields: the time the command was
      run, the name of the user who ran <b>sudo</b>, the name of the target
      user, the name of the target group (optional), the terminal that
      <b>sudo</b> was run from, and the number of lines and columns of the
      terminal. The second and third lines contain the working directory the
      command was run from and the path name of the command itself (with
      arguments if present).</dd>
  <dt id="log.json"><a class="permalink" href="#log.json"><i>log.json</i></a></dt>
  <dd>A JSON-formatted file containing information about the command. This is
      similar to the <i>log</i> file but contains additional information and is
      easily extensible. The <i>log.json</i> file will be used by sudoreplay(8)
      in preference to the <i>log</i> file if it exists. The file may contain
      the following elements:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="timestamp"><a class="permalink" href="#timestamp">timestamp</a></dt>
  <dd>A JSON object containing time the command was run. It consists of two
      values, <i>seconds</i> and <i>nanoseconds</i>.</dd>
  <dt id="columns"><a class="permalink" href="#columns">columns</a></dt>
  <dd>The number of columns of the terminal the command ran on, or zero if no
      terminal was present.</dd>
  <dt id="command~2"><a class="permalink" href="#command~2">command</a></dt>
  <dd>The fully-qualified path of the command that was run.</dd>
  <dt id="lines"><a class="permalink" href="#lines">lines</a></dt>
  <dd>
    <br/>
    The number of lines of the terminal the command ran on, or zero if no
      terminal was present.</dd>
  <dt id="runargv"><a class="permalink" href="#runargv">runargv</a></dt>
  <dd>A JSON array representing the command's argument vector as passed to the
      execve(2) system call.</dd>
  <dt id="runenv"><a class="permalink" href="#runenv">runenv</a></dt>
  <dd>A JSON array representing the command's environment as passed to the
      execve(2) system call.</dd>
  <dt id="rungid"><a class="permalink" href="#rungid">rungid</a></dt>
  <dd>The group ID the command ran as. This element is only present when the
      user specifies a group on the command line.</dd>
  <dt id="rungroup"><a class="permalink" href="#rungroup">rungroup</a></dt>
  <dd>The name of the group the command ran as. This element is only present
      when the user specifies a group on the command line.</dd>
  <dt id="runuid"><a class="permalink" href="#runuid">runuid</a></dt>
  <dd>The user ID the command ran as.</dd>
  <dt id="runuser"><a class="permalink" href="#runuser">runuser</a></dt>
  <dd>The name of the user the command ran as.</dd>
  <dt id="submitcwd"><a class="permalink" href="#submitcwd">submitcwd</a></dt>
  <dd>The current working directory at the time <b>sudo</b> was run.</dd>
  <dt id="submithost"><a class="permalink" href="#submithost">submithost</a></dt>
  <dd>The name of the host the command was run on.</dd>
  <dt id="submituser"><a class="permalink" href="#submituser">submituser</a></dt>
  <dd>The name of the user who ran the command via <b>sudo</b>.</dd>
  <dt id="ttyname~2"><a class="permalink" href="#ttyname~2">ttyname</a></dt>
  <dd>The path name of the terminal the user invoked <b>sudo</b> from. If the
      command was run in a pseudo-terminal, <i>ttyname</i> will be different
      from the terminal the command actually ran in.</dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt id="timing"><a class="permalink" href="#timing"><i>timing</i></a></dt>
  <dd>Timing information used to replay the session. Each line consists of the
      I/O log entry type and amount of time since the last entry, followed by
      type-specific data. The I/O log entry types and their corresponding
      type-specific data are:</dd>
</dl>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt>0</dt>
  <dd>standard input, number of bytes in the entry</dd>
  <dt>1</dt>
  <dd>standard output, number of bytes in the entry</dd>
  <dt>2</dt>
  <dd>standard error, number of bytes in the entry</dd>
  <dt>3</dt>
  <dd>terminal input, number of bytes in the entry</dd>
  <dt>4</dt>
  <dd>terminal output, number of bytes in the entry</dd>
  <dt>5</dt>
  <dd>window change, new number lines and columns</dd>
  <dt>6</dt>
  <dd>bug compatibility for <b>sudo</b> 1.8.7 terminal output</dd>
  <dt>7</dt>
  <dd>command suspend or resume, signal received</dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt id="ttyin"><a class="permalink" href="#ttyin"><i>ttyin</i></a></dt>
  <dd>Raw input from the user's terminal, exactly as it was received. This file
      is only present if the <i>log_input</i> or <i>log_ttyin</i> flags are set
      and <b>sudo</b> was run from a terminal. No post-processing is performed.
      For manual viewing, you may wish to convert carriage return characters in
      the log to line feeds. For example: &#x2018;gunzip -c ttyin | tr
      &quot;\r&quot; &quot;\n&quot;&#x2019;</dd>
  <dt id="stdin"><a class="permalink" href="#stdin"><i>stdin</i></a></dt>
  <dd>The standard input when no terminal is present, or input redirected from a
      pipe or file. This file is only present if the <i>log_input</i> or
      <i>log_stdin</i> flags are set and the standard input is not connected to
      a terminal.</dd>
  <dt id="ttyout"><a class="permalink" href="#ttyout"><i>ttyout</i></a></dt>
  <dd>Output from the pseudo-terminal (what the command writes to the screen).
      Terminal-specific post-processing is performed before the data is logged.
      This means that, for example, line feeds are usually converted to line
      feed/carriage return pairs and tabs may be expanded to spaces. This file
      is only present if the <i>log_output</i> or <i>log_ttyout</i> flags are
      set and <b>sudo</b> was run from a terminal.</dd>
  <dt id="stdout"><a class="permalink" href="#stdout"><i>stdout</i></a></dt>
  <dd>The standard output when no terminal is present, or output redirected to a
      pipe or file. This file is only present if the <i>log_output</i> or
      <i>log_stdout</i> flags are set and the standard output is not connected
      to a terminal.</dd>
  <dt id="stderr"><a class="permalink" href="#stderr"><i>stderr</i></a></dt>
  <dd>The standard error when no terminal is present, or output redirected to a
      pipe or file. This file is only present if the <i>log_output</i> or
      <i>log_stderr</i> flags are set and the standard error is not connected to
      a terminal.</dd>
</dl>
<p class="Pp">All files other than <i>log</i> are compressed in gzip format
    unless the <i>compress_io</i> flag has been disabled. Due to buffering, it
    is not normally possible to display the I/O logs in real-time as the program
    is executing. The I/O log data will not be complete until the program run by
    <b>sudo</b> has exited or has been terminated by a signal. The
    <i>iolog_flush</i> flag can be used to disable buffering, in which case I/O
    log data is written to disk as soon as it is available. The output portion
    of an I/O log file can be viewed with the sudoreplay(8) utility, which can
    also be used to list or search the available logs.</p>
<p class="Pp">User input may contain sensitive information such as passwords
    (even if they are not echoed to the screen), which will be stored in the log
    file unencrypted. In most cases, logging the command output via
    <i>log_output</i> or LOG_OUTPUT is all that is required. When logging input,
    consider disabling the <i>log_passwords</i> flag.</p>
<p class="Pp">Since each session's I/O logs are stored in a separate directory,
    traditional log rotation utilities cannot be used to limit the number of I/O
    logs. The simplest way to limit the number of I/O is by setting the
    <i>maxseq</i> option to the maximum number of logs you wish to store. Once
    the I/O log sequence number reaches <i>maxseq</i>, it will be reset to zero
    and <b>sudoers</b> will truncate and reuse any existing I/O logs.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<dl class="Bl-tag">
  <dt><i>/private/etc/sudo.conf</i></dt>
  <dd>Sudo front-end configuration</dd>
  <dt><i>/private/etc/sudoers</i></dt>
  <dd>List of who can run what</dd>
  <dt><i>/etc/group</i></dt>
  <dd>Local groups file</dd>
  <dt><i>/etc/netgroup</i></dt>
  <dd>List of network groups</dd>
  <dt><i>/var/log/sudo-io</i></dt>
  <dd>I/O log files</dd>
  <dt><i>/var/db/sudo/ts</i></dt>
  <dd>Directory containing time stamps for the <b>sudoers</b> security
    policy</dd>
  <dt><i>/var/db/sudo/lectured</i></dt>
  <dd>Directory containing lecture status files for the <b>sudoers</b> security
      policy</dd>
  <dt><i>/etc/environment</i></dt>
  <dd>Initial environment for <b>-i</b> mode on AIX and Linux systems</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">Below are example <i>sudoers</i> file entries. Admittedly, some of
    these are a bit contrived. First, we allow a few environment variables to
    pass and then define our <i>aliases</i>:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre># Run X applications through sudo; HOME is used to find the
# .Xauthority file.  Other programs use HOME to locate configuration
# files and this may lead to privilege escalation!
Defaults env_keep += &quot;DISPLAY HOME&quot;
# User alias specification
User_Alias	FULLTIMERS = millert, mikef, dowdy
User_Alias	PARTTIMERS = bostley, jwfox, crawl
User_Alias	WEBADMIN = will, wendy, wim
# Runas alias specification
Runas_Alias	OP = root, operator
Runas_Alias	DB = oracle, sybase
Runas_Alias	ADMINGRP = adm, oper
# Host alias specification
Host_Alias	SPARC = bigtime, eclipse, moet, anchor :\
		SGI = grolsch, dandelion, black :\
		ALPHA = widget, thalamus, foobar :\
		HPPA = boa, nag, python
Host_Alias	CUNETS = 128.138.0.0/255.255.0.0
Host_Alias	CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
Host_Alias	SERVERS = primary, mail, www, ns
Host_Alias	CDROM = orion, perseus, hercules
# Cmnd alias specification
Cmnd_Alias	DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\
			/usr/sbin/restore, /usr/sbin/rrestore,\
			sha224:0GomF8mNN3wlDt1HD9XldjJ3SNgpFdbjO1+NsQ== \
			/home/operator/bin/start_backups
Cmnd_Alias	KILL = /usr/bin/kill
Cmnd_Alias	PRINTING = /usr/sbin/lpc, /usr/bin/lprm
Cmnd_Alias	SHUTDOWN = /usr/sbin/shutdown
Cmnd_Alias	HALT = /usr/sbin/halt
Cmnd_Alias	REBOOT = /usr/sbin/reboot
Cmnd_Alias	SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh,\
			 /usr/local/bin/tcsh, /usr/bin/rsh,\
			 /usr/local/bin/zsh
Cmnd_Alias	SU = /usr/bin/su
Cmnd_Alias	PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less</pre>
</div>
<pre></pre>
<p class="Pp">Here we override some of the compiled in default values. We want
    <b>sudo</b> to log via syslog(3) using the <i>auth</i> facility in all cases
    and for commands to be run with the target user's home directory as the
    working directory. We don't want to subject the full time staff to the
    <b>sudo</b> lecture. User <b>millert</b> need not provide a password and we
    don't want to reset the LOGNAME or USER environment variables when running
    commands as <b>root</b>. Additionally, on the machines in the SERVERS
    <i>Host_Alias</i>, we keep an additional local log file and make sure we log
    the year in each log line since the log entries will be kept around for
    several years. Lastly, we disable shell escapes for the commands in the
    PAGERS <i>Cmnd_Alias</i> (<i>/usr/bin/more</i>, <i>/usr/bin/pg</i> and
    <i>/usr/bin/less</i>) . This will not effectively constrain users with
    <b>sudo</b> <b>ALL</b> privileges.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre># Override built-in defaults
Defaults		syslog=auth,runcwd=~
Defaults&gt;root		!set_logname
Defaults:FULLTIMERS	!lecture
Defaults:millert	!authenticate
Defaults@SERVERS	log_year, logfile=/var/log/sudo.log
Defaults!PAGERS		noexec</pre>
</div>
<pre></pre>
<p class="Pp">The <i>User specification</i> is the part that actually determines
    who may run what.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>root		ALL = (ALL) ALL
%wheel		ALL = (ALL) ALL</pre>
</div>
<pre></pre>
<p class="Pp">We let <b>root</b> and any user in group <b>wheel</b> run any
    command on any host as any user.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>FULLTIMERS	ALL = NOPASSWD: ALL</pre>
</div>
<pre></pre>
<p class="Pp">Full time sysadmins (<b>millert</b>, <b>mikef</b>, and
    <b>dowdy</b>) may run any command on any host without authenticating
    themselves.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>PARTTIMERS	ALL = ALL</pre>
</div>
<pre></pre>
<p class="Pp">Part time sysadmins <b>bostley</b>, <b>jwfox</b>, and
    <b>crawl</b>) may run any command on any host but they must authenticate
    themselves first (since the entry lacks the NOPASSWD tag).</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>jack		CSNETS = ALL</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>jack</b> may run any command on the machines in the
    CSNETS alias (the networks 128.138.243.0, 128.138.204.0, and 128.138.242.0).
    Of those networks, only 128.138.204.0 has an explicit netmask (in CIDR
    notation) indicating it is a class C network. For the other networks in
    CSNETS, the local machine's netmask will be used during matching.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>lisa		CUNETS = ALL</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>lisa</b> may run any command on any host in the CUNETS
    alias (the class B network 128.138.0.0).</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>operator	ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
		sudoedit /etc/printcap, /usr/oper/bin/</pre>
</div>
<pre></pre>
<p class="Pp">The <b>operator</b> user may run commands limited to simple
    maintenance. Here, those are commands related to backups, killing processes,
    the printing system, shutting down the system, and any commands in the
    directory <i>/usr/oper/bin/</i>. One command in the DUMPS Cmnd_Alias
    includes a sha224 digest, <i>/home/operator/bin/start_backups</i>. This is
    because the directory containing the script is writable by the operator
    user. If the script is modified (resulting in a digest mismatch) it will no
    longer be possible to run it via <b>sudo</b>.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>joe		ALL = /usr/bin/su operator</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>joe</b> may only su(1) to operator.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>pete		HPPA = /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd *root*
%opers		ALL = (: ADMINGRP) /usr/sbin/</pre>
</div>
<pre></pre>
<p class="Pp">Users in the <b>opers</b> group may run commands in
    <i>/usr/sbin/</i> as themselves with any group in the ADMINGRP
    <i>Runas_Alias</i> (the <b>adm</b> and <b>oper</b> groups).</p>
<p class="Pp">The user <b>pete</b> is allowed to change anyone's password except
    for <b>root</b> on the HPPA machines. Because command line arguments are
    matched as a single, concatenated string, the &#x2018;*&#x2019; wildcard
    will match <i>multiple</i> words. This example assumes that passwd(1) does
    not take multiple user names on the command line. On systems with GNU
    getopt(3), options to passwd(1) may be specified after the user argument. As
    a result, this rule will also allow:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>passwd username --expire</pre>
</div>
<pre></pre>
<p class="Pp">which may not be desirable.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>bob		SPARC = (OP) ALL : SGI = (OP) ALL</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>bob</b> may run anything on the SPARC and SGI machines
    as any user listed in the OP <i>Runas_Alias</i> (<b>root</b> and
    <b>operator</b>.)</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>jim		+biglab = ALL</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>jim</b> may run any command on machines in the
    <i>biglab</i> netgroup. <b>sudo</b> knows that &#x201C;biglab&#x201D; is a
    netgroup due to the &#x2018;+&#x2019; prefix.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>+secretaries	ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser</pre>
</div>
<pre></pre>
<p class="Pp">Users in the <b>secretaries</b> netgroup need to help manage the
    printers as well as add and remove users, so they are allowed to run those
    commands on all machines.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>fred		ALL = (DB) NOPASSWD: ALL</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>fred</b> can run commands as any user in the DB
    <i>Runas_Alias</i> (<b>oracle</b> or <b>sybase</b>) without giving a
    password.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>john		ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*</pre>
</div>
<pre></pre>
<p class="Pp">On the ALPHA machines, user <b>john</b> may su to anyone except
    <b>root</b> but he is not allowed to specify any options to the su(1)
    command.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>jen		ALL, !SERVERS = ALL</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>jen</b> may run any command on any machine except for
    those in the SERVERS <i>Host_Alias</i> (primary, mail, www, and ns).</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>jill		SERVERS = /usr/bin/, !SU, !SHELLS</pre>
</div>
<pre></pre>
<p class="Pp">For any machine in the SERVERS <i>Host_Alias</i>, <b>jill</b> may
    run any commands in the directory <i>/usr/bin/</i> except for those commands
    belonging to the SU and SHELLS <i>Cmnd_Aliases</i>. While not specifically
    mentioned in the rule, the commands in the PAGERS <i>Cmnd_Alias</i> all
    reside in <i>/usr/bin</i> and have the <i>noexec</i> option set.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>steve		CSNETS = (operator) /usr/local/op_commands/</pre>
</div>
<pre></pre>
<p class="Pp">The user <b>steve</b> may run any command in the directory
    /usr/local/op_commands/ but only as user operator.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>matt		valkyrie = KILL</pre>
</div>
<pre></pre>
<p class="Pp">On his personal workstation, valkyrie, <b>matt</b> needs to be
    able to kill hung processes.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>WEBADMIN	www = (www) ALL, (root) /usr/bin/su www</pre>
</div>
<pre></pre>
<p class="Pp">On the host www, any user in the WEBADMIN <i>User_Alias</i> (will,
    wendy, and wim), may run any command as user www (which owns the web pages)
    or simply su(1) to www.</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>ALL		CDROM = NOPASSWD: /sbin/umount /CDROM,\
		/sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM</pre>
</div>
<pre></pre>
<p class="Pp">Any user may mount or unmount a CD-ROM on the machines in the
    CDROM <i>Host_Alias</i> (orion, perseus, hercules) without entering a
    password. This is a bit tedious for users to type, so it is a prime
    candidate for encapsulating in a shell script.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SECURITY_NOTES"><a class="permalink" href="#SECURITY_NOTES">SECURITY
  NOTES</a></h1>
<section class="Ss">
<h2 class="Ss" id="Limitations_of_the_"><a class="permalink" href="#Limitations_of_the_">Limitations
  of the &#x2018;!&#x2019; operator</a></h2>
<p class="Pp">It is generally not effective to &#x201C;subtract&#x201D; commands
    from <b>ALL</b> using the &#x2018;!&#x2019; operator. A user can trivially
    circumvent this by copying the desired command to a different name and then
    executing that. For example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>bill	ALL = ALL, !SU, !SHELLS</pre>
</div>
<pre></pre>
<p class="Pp">Doesn't really prevent <b>bill</b> from running the commands
    listed in SU or SHELLS since he can simply copy those commands to a
    different name, or use a shell escape from an editor or other program.
    Therefore, these kind of restrictions should be considered advisory at best
    (and reinforced by policy).</p>
<p class="Pp">In general, if a user has sudo <b>ALL</b> there is nothing to
    prevent them from creating their own program that gives them a <b>root</b>
    shell (or making their own copy of a shell) regardless of any
    &#x2018;!&#x2019; elements in the user specification.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Security_implications_of_"><a class="permalink" href="#Security_implications_of_">Security
  implications of <i>fast_glob</i></a></h2>
<p class="Pp">If the <i>fast_glob</i> option is in use, it is not possible to
    reliably negate commands where the path name includes globbing (aka
    wildcard) characters. This is because the C library's fnmatch(3) function
    cannot resolve relative paths. While this is typically only an inconvenience
    for rules that grant privileges, it can result in a security issue for rules
    that subtract or revoke privileges.</p>
<p class="Pp">For example, given the following <i>sudoers</i> file entry:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>john	ALL = /usr/bin/passwd [a-zA-Z0-9]*, /usr/bin/chsh [a-zA-Z0-9]*,\
<br/>
              /usr/bin/chfn [a-zA-Z0-9]*, !/usr/bin/* root</pre>
</div>
<pre></pre>
<p class="Pp">User <b>john</b> can still run &#x2018;/usr/bin/passwd
    root&#x2019; if <i>fast_glob</i> is enabled by changing to <i>/usr/bin</i>
    and running &#x2018;./passwd root&#x2019; instead.</p>
<p class="Pp">Another potential issue is that when <b>sudo</b> executes the
    command, it must use the command or path specified by the user instead of a
    path listed in the <i>sudoers</i> file. This may lead to a time of check
    versus time of use race condition.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Wildcards_in_command_arguments"><a class="permalink" href="#Wildcards_in_command_arguments">Wildcards
  in command arguments</a></h2>
<p class="Pp">Command line arguments are matched as a single, concatenated
    string. This mean a wildcard character such as &#x2018;?&#x2019; or
    &#x2018;*&#x2019; will match across word boundaries, which may be
    unexpected. For example, while a sudoers entry like:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>%operator ALL = /bin/cat /var/log/messages*</pre>
</div>
<pre></pre>
<p class="Pp">will allow command like:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sudo cat /var/log/messages.1</pre>
</div>
<pre></pre>
<p class="Pp">It will also allow:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sudo cat /var/log/messages /etc/shadow</pre>
</div>
<pre></pre>
<p class="Pp">which is probably not what was intended. A safer alternative is to
    use a regular expression for matching command line arguments. The above
    example can be rewritten as a regular expression:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>%operator ALL = /bin/cat ^/var/log/messages[^[:space:]]*$</pre>
</div>
<pre></pre>
<p class="Pp">The regular expression will only match a single file with a name
    that begins with <i>/var/log/messages</i> and does not include any white
    space in the name. It is often better to do command line processing outside
    of the <i>sudoers</i> file in a scripting language for anything
  non-trivial.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Regular_expressions_in_command_names"><a class="permalink" href="#Regular_expressions_in_command_names">Regular
  expressions in command names</a></h2>
<p class="Pp">Using a regular expression to match a command name has the same
    security implications as using the <i>fast_glob</i> option:</p>
<dl class="Bl-tag">
  <dt><b>&#x2022;</b></dt>
  <dd>It is not possible to reliably negate commands when the path name is a
      regular expression.</dd>
  <dt><b>&#x2022;</b></dt>
  <dd>When <b>sudo</b> executes the command, it must use the command or path
      specified by the user instead of a path listed in the <i>sudoers</i> file.
      This may lead to a time of check versus time of use race condition.</dd>
</dl>
<p class="Pp">These issues do not apply to rules where only the command line
    options are matched using a regular expression.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Preventing_shell_escapes"><a class="permalink" href="#Preventing_shell_escapes">Preventing
  shell escapes</a></h2>
<p class="Pp">Once <b>sudo</b> executes a program, that program is free to do
    whatever it pleases, including run other programs. This can be a security
    issue since it is not uncommon for a program to allow shell escapes, which
    lets a user bypass <b>sudo</b>'s access control and logging. Common programs
    that permit shell escapes include shells (obviously), editors, paginators,
    mail, and terminal programs.</p>
<p class="Pp">There are four basic approaches to this problem:</p>
<dl class="Bl-tag">
  <dt id="restrict"><a class="permalink" href="#restrict">restrict</a></dt>
  <dd>Avoid giving users access to commands that allow the user to run arbitrary
      commands. Many editors have a restricted mode where shell escapes are
      disabled, though <b>sudoedit</b> is a better solution to running editors
      via <b>sudo</b>. Due to the large number of programs that offer shell
      escapes, restricting users to the set of programs that do not is often
      unworkable.</dd>
  <dt id="intercept~2"><a class="permalink" href="#intercept~2">intercept</a></dt>
  <dd>On most systems, <b>sudo</b>'s <i>intercept</i> functionality can be used
      to transparently intercept an attempt to run a new command, allow or deny
      it based on <i>sudoers</i> rules, and log the result. For example, this
      can be used to restrict the commands run from within a privileged shell or
      editor. However, not all programs operate correctly when <i>intercept</i>
      is enabled.
    <p class="Pp">There are two underlying mechanisms that may be used to
        implement <i>intercept</i> mode: <i>dso</i> and <i>trace</i>. The
        <i>intercept_type</i> setting can be used to select between them.</p>
    <p class="Pp">The first mechanism, <i>dso</i>, overrides the standard C
        library functions that are used to execute a command. It does this by
        setting an environment variable (usually LD_PRELOAD) to the path of a
        dynamic shared object, or shared library, containing custom versions of
        the execve(2), execl(3), execle(3), execlp(3), execv(3), execvp(3),
        execvpe(3), and system(3) library functions that connect back to
        <b>sudo</b> for a policy decision. Note, however, that this applies only
        to dynamically-linked executables. It is not possible to intercept
        commands for statically-linked executables or executables that run under
        binary emulation this way. Because most dynamic loaders ignore
        LD_PRELOAD (or the equivalent) when running set-user-ID and set-group-ID
        programs, <b>sudoers</b> will not permit such programs to be run in
        <i>intercept</i> mode by default. The <i>dso</i> mechanism is
        incompatible with <b>sudo</b>'s SELinux RBAC support (but see below).
        SELinux disables LD_PRELOAD by default and interferes with file
        descriptor inheritance, which <b>sudo</b> relies on.</p>
    <p class="Pp">The second mechanism, <i>trace</i>, is available on Linux
        systems that support seccomp(2) filtering. It uses ptrace(2) and
        seccomp(2) to intercept the execve(2) system call instead of pre-loading
        a dynamic shared object. Both static and dynamic executables are
        supported and it is compatible with <b>sudo</b>'s SELinux RBAC mode.
        Functions utilizing the execveat(2) system call, such as fexecve(3), are
        not currently intercepted. Programs that rely on ptrace(2) themselves,
        such as debuggers and system call tracers (such as strace(1) and
        truss(1)) will be unable to function if <i>intercept</i> is enabled in
        <i>trace</i> mode. This same restriction applies to the
        <i>log_subcmds</i> sudoers option.</p>
    <p class="Pp">The <i>intercept</i> feature is known to work on Solaris,
        *BSD, Linux, macOS, HP-UX 11.x and AIX 5.3 and above. It should be
        supported on most operating systems that support the LD_PRELOAD
        environment variable or an equivalent. It is not possible to intercept
        shell built-in commands or restrict the ability to read or write
        sensitive files from within a shell.</p>
    <p class="Pp">To enable intercept mode on a per-command basis, use the
        INTERCEPT tag as documented in the User Specification section above.
        Here is that example again:</p>
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>chuck	research = INTERCEPT: ALL</pre>
</div>
<pre></pre>
<div class="Bd-indent">
<p class="Pp">This allows user <b>chuck</b> to run any command on the machine
    &#x201C;research&#x201D; in intercept mode. Any commands run via shell
    escapes will be validated and logged by <b>sudo</b>. If you are unsure
    whether or not your system is capable of supporting <i>intercept</i>, you
    can always just try it out and check whether or not external commands run
    via a shell are logged when <i>intercept</i> is enabled.</p>
<p class="Pp">There is an inherent race condition between when a command is
    checked against <b>sudoers</b> rules and when it is actually executed. If a
    user is allowed to run arbitrary commands, they may be able to change the
    execve(2) arguments in the program after the <b>sudoers</b> policy check has
    completed but before the new command is executed. Starting with version
    1.9.12, the <i>trace</i> method will verify that the command and its
    arguments have not changed after execve(2) has completed but before
    execution of the new program has had a chance to run. This is not the case
    with the <i>dso</i> method. See the description of the
    <i>intercept_verify</i> setting for more information.</p>
</div>
<dl class="Bl-tag">
  <dt id="log"><a class="permalink" href="#log">log</a></dt>
  <dd>There are two separate but related ways to log additional commands. The
      first is to enable I/O logging using the <i>log_output</i> flag. This will
      log the command's output but will not create an event log entry when the
      additional command is run. The second is to enable the <i>log_subcmds</i>
      flag in <i>sudoers</i> which will create an event log entry every time a
      new command is run. If I/O logging is also enabled, the log entry will
      include a time offset into the I/O log to indicate when the command was
      run. This offset can be passed to the sudoreplay(8) utility to replay the
      I/O log at the exact moment when the command was run. The
      <i>log_subcmds</i> flag uses the same mechanism as <i>intercept</i> (see
      above) and has the same limitations.</dd>
  <dt id="noexec~2"><a class="permalink" href="#noexec~2">noexec</a></dt>
  <dd><b>sudo</b>'s <i>noexec</i> functionality can be used to prevent a program
      run by <b>sudo</b> from executing any other programs. On most systems, it
      uses the same LD_PRELOAD mechanism as <i>intercept</i> (see above) and
      thus the same caveats apply. The <i>noexec</i> functionality is capable of
      blocking execution of commands run via the execve(2), execl(3), execle(3),
      execlp(3), exect(3), execv(3), execveat(3), execvP(3), execvp(3),
      execvpe(3), fexecve(3), popen(3), posix_spawn(3), posix_spawnp(3),
      system(3), and wordexp(3) functions. On Linux, a seccomp(2) filter is used
      to implement <i>noexec</i>. On Solaris 10 and higher, <i>noexec</i> uses
      Solaris privileges instead of the LD_PRELOAD environment variable.
    <p class="Pp">To enable <i>noexec</i> for a command, use the NOEXEC tag as
        documented in the User Specification section above. Here is that example
        again:</p>
    <pre>
    </pre>
  </dd>
</dl>
<div class="Bd-indent">
<pre>aaron	shanty = NOEXEC: /usr/bin/more, /usr/bin/vi</pre>
</div>
<pre></pre>
<div class="Bd-indent">
<p class="Pp">This allows user <b>aaron</b> to run <i>/usr/bin/more</i> and
    <i>/usr/bin/vi</i> with <i>noexec</i> enabled. This will prevent those two
    commands from executing other commands (such as a shell). If you are unsure
    whether or not your system is capable of supporting <i>noexec</i> you can
    always just try it out and check whether shell escapes work when
    <i>noexec</i> is enabled.</p>
</div>
<p class="Pp">Restricting shell escapes is not a panacea. Programs running as
    <b>root</b> are still capable of many potentially hazardous operations (such
    as changing or overwriting files) that could lead to unintended privilege
    escalation. In the specific case of an editor, a safer approach is to give
    the user permission to run <b>sudoedit</b> (see below).</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Secure_editing"><a class="permalink" href="#Secure_editing">Secure
  editing</a></h2>
<p class="Pp">The <b>sudoers</b> plugin includes <b>sudoedit</b> support which
    allows users to securely edit files with the editor of their choice. As
    <b>sudoedit</b> is a built-in command, it must be specified in the
    <i>sudoers</i> file without a leading path. However, it may take command
    line arguments just as a normal command does. Wildcards used in
    <i>sudoedit</i> command line arguments are expected to be path names, so a
    forward slash (&#x2018;/&#x2019;) will not be matched by a wildcard.</p>
<p class="Pp">Unlike other <b>sudo</b> commands, the editor is run with the
    permissions of the invoking user and with the environment unmodified. More
    information may be found in the description of the <b>-e</b> option in
    sudo(8).</p>
<p class="Pp">For example, to allow user operator to edit the &#x201C;message of
    the day&#x201D; file on any machine:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>operator ALL = sudoedit /etc/motd</pre>
</div>
<pre></pre>
<p class="Pp">The operator user then runs <b>sudoedit</b> as follows:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>$ sudoedit /etc/motd</pre>
</div>
<pre></pre>
<p class="Pp">The editor will run as the operator user, not <b>root</b>, on a
    temporary copy of <i>/etc/motd</i>. After the file has been edited,
    <i>/etc/motd</i> will be updated with the contents of the temporary
  copy.</p>
<p class="Pp">Users should <i>never</i> be granted <b>sudoedit</b> permission to
    edit a file that resides in a directory the user has write access to, either
    directly or via a wildcard. If the user has write access to the directory it
    is possible to replace the legitimate file with a link to another file,
    allowing the editing of arbitrary files. To prevent this, starting with
    version 1.8.16, symbolic links will not be followed in writable directories
    and <b>sudoedit</b> will refuse to edit a file located in a writable
    directory unless the <i>sudoedit_checkdir</i> option has been disabled or
    the invoking user is <b>root</b>. Additionally, in version 1.8.15 and
    higher, <b>sudoedit</b> will refuse to open a symbolic link unless either
    the <i>sudoedit_follow</i> option is enabled or the <i>sudoedit</i> command
    is prefixed with the FOLLOW tag in the <i>sudoers</i> file.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Time_stamp_file_checks"><a class="permalink" href="#Time_stamp_file_checks">Time
  stamp file checks</a></h2>
<p class="Pp"><b>sudoers</b> will check the ownership of its time stamp
    directory (<i>/var/db/sudo/ts</i> by default) and ignore the directory's
    contents if it is not owned by <b>root</b> or if it is writable by a user
    other than <b>root</b>. Older versions of <b>sudo</b> stored time stamp
    files in <i>/tmp</i>; this is no longer recommended as it may be possible
    for a user to create the time stamp themselves on systems that allow
    unprivileged users to change the ownership of files they create.</p>
<p class="Pp">While the time stamp directory <i>should</i> be cleared at reboot
    time, not all systems contain a <i>/run</i> or <i>/var/run</i> directory. To
    avoid potential problems, <b>sudoers</b> will ignore time stamp files that
    date from before the machine booted on systems where the boot time is
    available.</p>
<p class="Pp">Some systems with graphical desktop environments allow
    unprivileged users to change the system clock. Since <b>sudoers</b> relies
    on the system clock for time stamp validation, it may be possible on such
    systems for a user to run <b>sudo</b> for longer than
    <i>timestamp_timeout</i> by setting the clock back. To combat this,
    <b>sudoers</b> uses a monotonic clock (which never moves backwards) for its
    time stamps if the system supports it.</p>
<p class="Pp"><b>sudoers</b> will not honor time stamps set far in the future.
    Time stamps with a date greater than current_time + 2 * TIMEOUT will be
    ignored and <b>sudoers</b> will log and complain.</p>
<p class="Pp">If the <i>timestamp_type</i> option is set to &#x201C;tty&#x201D;,
    the time stamp record includes the device number of the terminal the user
    authenticated with. This provides per-terminal granularity but time stamp
    records may still outlive the user's session.</p>
<p class="Pp">Unless the <i>timestamp_type</i> option is set to
    &#x201C;global&#x201D;, the time stamp record also includes the session ID
    of the process that last authenticated. This prevents processes in different
    terminal sessions from using the same time stamp record. On systems where a
    process's start time can be queried, the start time of the session leader is
    recorded in the time stamp record. If no terminal is present or the
    <i>timestamp_type</i> option is set to &#x201C;ppid&#x201D;, the start time
    of the parent process is used instead. In most cases this will prevent a
    time stamp record from being reused without the user entering a password
    when logging out and back in again.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DEBUGGING"><a class="permalink" href="#DEBUGGING">DEBUGGING</a></h1>
<p class="Pp">Versions 1.8.4 and higher of the <b>sudoers</b> plugin support a
    flexible debugging framework that can help track down what the plugin is
    doing internally if there is a problem. This can be configured in the
    sudo.conf(5) file.</p>
<p class="Pp">The <b>sudoers</b> plugin uses the same debug flag format as the
    <b>sudo</b> front-end: <i>subsystem</i>@<i>priority</i>.</p>
<p class="Pp">The priorities used by <b>sudoers</b>, in order of decreasing
    severity, are: <i>crit</i>, <i>err</i>, <i>warn</i>, <i>notice</i>,
    <i>diag</i>, <i>info</i>, <i>trace</i>, and <i>debug</i>. Each priority,
    when specified, also includes all priorities higher than it. For example, a
    priority of <i>notice</i> would include debug messages logged at
    <i>notice</i> and higher.</p>
<p class="Pp">The following subsystems are used by the <b>sudoers</b>
  plugin:</p>
<dl class="Bl-tag">
  <dt id="alias"><a class="permalink" href="#alias"><i>alias</i></a></dt>
  <dd><i>User_Alias</i>, <i>Runas_Alias</i>, <i>Host_Alias</i> and
      <i>Cmnd_Alias</i> processing</dd>
  <dt id="all"><a class="permalink" href="#all"><i>all</i></a></dt>
  <dd>matches every subsystem</dd>
  <dt id="audit"><a class="permalink" href="#audit"><i>audit</i></a></dt>
  <dd>BSM and Linux audit code</dd>
  <dt id="auth"><a class="permalink" href="#auth"><i>auth</i></a></dt>
  <dd>user authentication</dd>
  <dt id="defaults"><a class="permalink" href="#defaults"><i>defaults</i></a></dt>
  <dd><i>sudoers</i> file <i>Defaults</i> settings</dd>
  <dt id="env"><a class="permalink" href="#env"><i>env</i></a></dt>
  <dd>environment handling</dd>
  <dt id="ldap"><a class="permalink" href="#ldap"><i>ldap</i></a></dt>
  <dd>LDAP-based sudoers</dd>
  <dt id="logging"><a class="permalink" href="#logging"><i>logging</i></a></dt>
  <dd>logging support</dd>
  <dt id="match"><a class="permalink" href="#match"><i>match</i></a></dt>
  <dd>matching of users, groups, hosts, and netgroups in the <i>sudoers</i>
    file</dd>
  <dt id="netif"><a class="permalink" href="#netif"><i>netif</i></a></dt>
  <dd>network interface handling</dd>
  <dt id="nss"><a class="permalink" href="#nss"><i>nss</i></a></dt>
  <dd>network service switch handling in <b>sudoers</b></dd>
  <dt id="parser"><a class="permalink" href="#parser"><i>parser</i></a></dt>
  <dd><i>sudoers</i> file parsing</dd>
  <dt id="perms"><a class="permalink" href="#perms"><i>perms</i></a></dt>
  <dd>permission setting</dd>
  <dt id="plugin"><a class="permalink" href="#plugin"><i>plugin</i></a></dt>
  <dd>The equivalent of <i>main</i> for the plugin.</dd>
  <dt id="pty"><a class="permalink" href="#pty"><i>pty</i></a></dt>
  <dd>pseudo-terminal related code</dd>
  <dt id="rbtree"><a class="permalink" href="#rbtree"><i>rbtree</i></a></dt>
  <dd>redblack tree internals</dd>
  <dt id="sssd"><a class="permalink" href="#sssd"><i>sssd</i></a></dt>
  <dd>SSSD-based sudoers</dd>
  <dt id="util"><a class="permalink" href="#util"><i>util</i></a></dt>
  <dd>utility functions</dd>
</dl>
<p class="Pp">For example:</p>
<pre>
</pre>
<div class="Bd-indent">
<pre>Debug sudoers.so /var/log/sudoers_debug match@info,nss@info</pre>
</div>
<pre></pre>
<p class="Pp">For more information, see the sudo.conf(5) manual.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">ssh(1), su(1), fnmatch(3), glob(3), mktemp(3), strftime(3),
    sudo.conf(5), sudo_logsrv.proto(5), sudo_plugin(5), sudoers.ldap(5),
    sudoers_timestamp(5), sudo(8), sudo_logsrvd(8), visudo(8)</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp">Many people have worked on <b>sudo</b> over the years; this
    version consists of code written primarily by:</p>
<p class="Pp"></p>
<div class="Bd-indent">Todd C. Miller</div>
<p class="Pp">See the CONTRIBUTORS.md file in the <b>sudo</b> distribution
    (https://www.sudo.ws/about/contributors/) for an exhaustive list of people
    who have contributed to <b>sudo</b>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<p class="Pp">The <i>sudoers</i> file should <b>always</b> be edited by the
    <b>visudo</b> utility which locks the file and checks for syntax errors. If
    <i>sudoers</i> contains syntax errors, <b>sudo</b> may refuse to run, which
    is a serious problem if <b>sudo</b> is your only method of obtaining
    superuser privileges. Recent versions of <b>sudoers</b> will attempt to
    recover after a syntax error by ignoring the rest of the line after
    encountering an error. Older versions of <b>sudo</b> will not run if
    <i>sudoers</i> contains a syntax error.</p>
<p class="Pp">When using netgroups of machines (as opposed to users), if you
    store fully qualified host name in the netgroup (as is usually the case),
    you either need to have the machine's host name be fully qualified as
    returned by the <i>hostname</i> command or use the <i>fqdn</i> option in
    <i>sudoers</i>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">If you believe you have found a bug in <b>sudoers</b>, you can
    either file a bug report in the sudo bug database,
    https://bugzilla.sudo.ws/, or open an issue at
    https://github.com/sudo-project/sudo/issues. If you would prefer to use
    email, messages may be sent to the sudo-workers mailing list,
    https://www.sudo.ws/mailman/listinfo/sudo-workers (public) or
    &lt;sudo@sudo.ws&gt; (private).</p>
<p class="Pp">Please do not report security vulnerabilities through public
    GitHub issues, Bugzilla or mailing lists. Instead, report them via email to
    &lt;Todd.Miller@sudo.ws&gt;. You may encrypt your message with PGP if you
    would like, using the key found at https://www.sudo.ws/dist/PGPKEYS.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h1>
<p class="Pp">Limited free support is available via the sudo-users mailing list,
    see https://www.sudo.ws/mailman/listinfo/sudo-users to subscribe or search
    the archives.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DISCLAIMER"><a class="permalink" href="#DISCLAIMER">DISCLAIMER</a></h1>
<p class="Pp"><b>sudo</b> is provided &#x201C;AS IS&#x201D; and any express or
    implied warranties, including, but not limited to, the implied warranties of
    merchantability and fitness for a particular purpose are disclaimed. See the
    LICENSE.md file distributed with <b>sudo</b> or
    https://www.sudo.ws/about/license/ for complete details.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">January 16, 2023</td>
    <td class="foot-os">Sudo 1.9.13p2</td>
  </tr>
</table>
</body>
</html>
