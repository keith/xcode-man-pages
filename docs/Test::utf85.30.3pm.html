<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>Test::utf8(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Test::utf8(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Test::utf8(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">Test::utf8 - handy utf8 tests</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>  # check the string is good
  is_valid_string($string);   # check the string is valid
  is_sane_utf8($string);      # check not double encoded
  # check the string has certain attributes
  is_flagged_utf8($string1);   # has utf8 flag set
  is_within_ascii($string2);   # only has ascii chars in it
  isnt_within_ascii($string3); # has chars outside the ascii range
  is_within_latin_1($string4); # only has latin-1 chars in it
  isnt_within_ascii($string5); # has chars outside the latin-1 range
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This module is a collection of tests useful for dealing with utf8
    strings in Perl.</p>
<p class="Pp">This module has two types of tests: The validity tests check if a
    string is valid and not corrupt, whereas the characteristics tests will
    check that string has a given set of characteristics.</p>
<section class="Ss">
<h2 class="Ss" id="Validity_Tests"><a class="permalink" href="#Validity_Tests">Validity
  Tests</a></h2>
<dl class="Bl-tag">
  <dt id="is_valid_string($string,"><a class="permalink" href="#is_valid_string($string,">is_valid_string($string,
    $testname)</a></dt>
  <dd>Checks if the string is &quot;valid&quot;, i.e. this passes and returns
      true unless the internal utf8 flag hasn't been set on scalar that isn't
      made up of a valid utf-8 byte sequence.
    <p class="Pp">This should <i>never</i> happen and, in theory, this test
        should always pass. Unless you (or a module you use) goes monkeying
        around inside a scalar using Encode's private functions or XS code you
        shouldn't ever end up in a situation where you've got a corrupt scalar.
        But if you do, and you do, then this function should help you detect the
        problem.</p>
    <p class="Pp">To be clear, here's an example of the error case this can
        detect:</p>
    <p class="Pp"></p>
    <pre>  my $mark = &quot;Mark&quot;;
  my $leon = &quot;L\x{e9}on&quot;;
  is_valid_string($mark);  # passes, not utf-8
  is_valid_string($leon);  # passes, not utf-8
  my $iloveny = &quot;I \x{2665} NY&quot;;
  is_valid_string($iloveny);      # passes, proper utf-8
  my $acme = &quot;L\x{c3}\x{a9}on&quot;;
  Encode::_utf8_on($acme);      # (please don't do things like this)
  is_valid_string($acme);       # passes, proper utf-8 byte sequence upgraded
  Encode::_utf8_on($leon);      # (this is why you don't do things like this)
  is_valid_string($leon);       # fails! the byte \x{e9} isn't valid utf-8
    </pre>
  </dd>
  <dt id="is_sane_utf8($string,"><a class="permalink" href="#is_sane_utf8($string,">is_sane_utf8($string,
    $name)</a></dt>
  <dd>This test fails if the string contains something that looks like it might
      be dodgy utf8, i.e. containing something that looks like the multi-byte
      sequence for a latin-1 character but perl hasn't been instructed to treat
      as such. Strings that are not utf8 always automatically pass.
    <p class="Pp">Some examples may help:</p>
    <p class="Pp"></p>
    <pre>  # This will pass as it's a normal latin-1 string
  is_sane_utf8(&quot;Hello L\x{e9}eon&quot;);
  # this will fail because the \x{c3}\x{a9} looks like the
  # utf8 byte sequence for e-acute
  my $string = &quot;Hello L\x{c3}\x{a9}on&quot;;
  is_sane_utf8($string);
  # this will pass because the utf8 is correctly interpreted as utf8
  Encode::_utf8_on($string)
  is_sane_utf8($string);
    </pre>
    <p class="Pp">Obviously this isn't a hundred percent reliable. The edge case
        where this will fail is where you have
        <span class="Li">&quot;\x{c2}&quot;</span> (which is &quot;LATIN CAPITAL
        LETTER WITH CIRCUMFLEX&quot;) or
        <span class="Li">&quot;\x{c3}&quot;</span> (which is &quot;LATIN CAPITAL
        LETTER WITH TILDE&quot;) followed by one of the latin-1 punctuation
        symbols.</p>
    <p class="Pp"></p>
    <pre>  # a capital letter A with tilde surrounded by smart quotes
  # this will fail because it'll see the &quot;\x{c2}\x{94}&quot; and think
  # it's actually the utf8 sequence for the end smart quote
  is_sane_utf8(&quot;\x{93}\x{c2}\x{94}&quot;);
    </pre>
    <p class="Pp">However, since this hardly comes up this test is reasonably
        reliable in most cases. Still, care should be applied in cases where
        dynamic data is placed next to latin-1 punctuation to avoid false
        negatives.</p>
    <p class="Pp">There exists two situations to cause this test to fail; The
        string contains utf8 byte sequences and the string hasn't been flagged
        as utf8 (this normally means that you got it from an external source
        like a C library; When Perl needs to store a string internally as utf8
        it does it's own encoding and flagging transparently) or a utf8 flagged
        string contains byte sequences that when translated to characters
        themselves look like a utf8 byte sequence. The test diagnostics tells
        you which is the case.</p>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="String_Characteristic_Tests"><a class="permalink" href="#String_Characteristic_Tests">String
  Characteristic Tests</a></h2>
<p class="Pp">These routines allow you to check the range of characters in a
    string. Note that these routines are blind to the actual encoding perl
    internally uses to store the characters, they just check if the string
    contains only characters that can be represented in the named encoding:</p>
<dl class="Bl-tag">
  <dt id="is_within_ascii"><a class="permalink" href="#is_within_ascii">is_within_ascii</a></dt>
  <dd>Tests that a string only contains characters that are in the ASCII
      character set.</dd>
  <dt id="is_within_latin_1"><a class="permalink" href="#is_within_latin_1">is_within_latin_1</a></dt>
  <dd>Tests that a string only contains characters that are in latin-1.</dd>
</dl>
<p class="Pp">Simply check if a scalar is or isn't flagged as utf8 by perl's
    internals:</p>
<dl class="Bl-tag">
  <dt id="is_flagged_utf8($string,"><a class="permalink" href="#is_flagged_utf8($string,">is_flagged_utf8($string,
    $name)</a></dt>
  <dd>Passes if the string is flagged by perl's internals as utf8, fails if it's
      not.</dd>
  <dt id="isnt_flagged_utf8($string,$name)"><a class="permalink" href="#isnt_flagged_utf8($string,$name)">isnt_flagged_utf8($string,$name)</a></dt>
  <dd>The opposite of <span class="Li">&quot;is_flagged_utf8&quot;</span>,
      passes if and only if the string isn't flagged as utf8 by perl's
      internals.
    <p class="Pp">Note: you can refer to this function as
        <span class="Li">&quot;isn't_flagged_utf8&quot;</span> if you really
        want to.</p>
  </dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Written by Mark Fowler <b>mark@twoshortplanks.com</b></p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp">Copyright Mark Fowler 2004,2012. All rights reserved.</p>
<p class="Pp">This program is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">None known. Please report any to me via the CPAN RT system. See
    http://rt.cpan.org/ for more details.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">Test::DoubleEncodedEntities for testing for double encoded HTML
    entities.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-03-01</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
