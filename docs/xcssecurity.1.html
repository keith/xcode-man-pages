<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   generated with Ronn/v0.7.3
   http://github.com/rtomayko/ronn/tree/0.7.3
 -->
<head>

<style>
@media (prefers-color-scheme: dark) {
  body {
    background: #000;
    color: #d0d0d0;
  }

  a, a:visited {
    color: #1899eb;
  }
}
</style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    table.head, table.foot { width: 100%; }
    td.head-rtitle, td.foot-os { text-align: right; }
    td.head-vol { text-align: center; }
    .Nd, .Bf, .Op { display: inline; }
    .Pa, .Ad { font-style: italic; }
    .Ms { font-weight: bold; }
    .Bl-diag > dt { font-weight: bold; }
    code.Nm, .Fl, .Cm, .Ic, code.In, .Fd, .Fn, .Cd { font-weight: bold;
      font-family: inherit; }
  </style>
  <title>XCSSECURITY(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">XCSSECURITY(1)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">XCSSECURITY(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><b>xcssecurity</b> - command-line tool for performing Xcode Server
    security operations</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><b>xcssecurity</b> <i>command</i> [<i>options</i>...]</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><b>xcssecurity</b> is a command-line tool for performing security
    operations needed by Xcode Server. It was originally designed as a
    replacement for the keychain functionality in security(1), but now also
    provides tasks required for SSL and client-side certificate
  authentication.</p>
<p class="Pp">Note that many of <b>xcssecurity</b>&#x00B4;s options can be
    provided either through command-line switches, or through environmental
    variables. When sensitive data is concerned (e.g., user passwords), it is
    best to use the environmental variables so that the data is not exposed in
    process lists.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COMMON_OPTIONS"><a class="permalink" href="#COMMON_OPTIONS">COMMON
  OPTIONS</a></h1>
<p class="Pp">A number of options are supported by multiple commands.</p>
<dl class="Bl-tag">
  <dt id="u"><a class="permalink" href="#u"><b>-u</b>, <b>-a</b>,
    <i>XCS_USERNAME</i></a></dt>
  <dd>The username used when creating user accounts or adding users to the
      Keychain. <b>xcssecurity</b> will also check the <i>XCS_USERNAME</i>
      environmental variable.</dd>
  <dt id="p"><a class="permalink" href="#p"><b>-p</b>, <b>-w</b>,
    <i>XCS_PASSWORD</i></a></dt>
  <dd>The password used when creating user accounts, adding users to the
      Keychain, or creating new Keychains. If the password is a valid path to a
      file on the filesystem, <b>xcssecurity</b> will read the contents of that
      file and use it as the password; you may also pass &quot;-&quot; to read a
      password from <i>STDIN</i>. <b>xcssecurity</b> will also check the
      <i>XCS_PASSWORD</i> environmental variable.</dd>
</dl>
<dl class="Bl-tag">
  <dt></dt>
  <dd>If a password is required and no password is provided, <b>xcssecurity</b>
      will prompt you to enter one.</dd>
</dl>
<dl class="Bl-tag">
  <dt id="k"><a class="permalink" href="#k"><b>-k</b>,
    <i>XCS_KEYCHAIN</i></a></dt>
  <dd>The path to the Keychain to use when creating Keychains, or when adding,
      removing, or finding users in the Keychain. <b>xcssecurity</b> will also
      check the <i>XCS_KEYCHAIN</i> environmental variable.</dd>
  <dt id="m"><a class="permalink" href="#m"><b>-m</b>,
    <i>XCS_KEYCHAIN_PASSWORD</i></a></dt>
  <dd>The master password for the Keychain provided via the <b>-k</b> parameter.
      Like <b>-p</b> (and friends), this can be a path to a file.
      <b>xcssecurity</b> will also check the <i>XCS_KEYCHAIN_PASSWORD</i>
      environmental variable.</dd>
  <dt id="n"><a class="permalink" href="#n"><b>-n</b>,
    <i>XCS_OD_NODE</i></a></dt>
  <dd>The Open Directory node to use when creating and deleting users and
      groups. <b>xcssecurity</b> will also check the <i>XCS_OD_NODE</i>
      environmental variable. To use the local system Open Directory database,
      pass &quot;/Local/Default&quot;.</dd>
  <dt id="T"><a class="permalink" href="#T"><b>-T</b></a></dt>
  <dd>The path to an application trusted to access this Keychain or account in a
      Keychain. This flag may be passed multiple times to provide access to
      multiple applications.</dd>
</dl>
<dl class="Bl-tag">
  <dt></dt>
  <dd>Under normal circumstances, if no trusted applications are specified,
      <b>xcssecurity</b> will automatically become a trusted application. If,
      however, at least one <b>-T</b> flag is passed, you <i>must</i> explicitly
      list <b>xcssecurity</b> if you want it to have access to the Keychain item
      in question.</dd>
</dl>
<p class="Pp">Note that the commands described below are shown with the
    canonical form of their parameters, but the alternatives listed above (and
    the corresponding environmental variables) can also be used.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DATA_GENERATION_COMMANDS"><a class="permalink" href="#DATA_GENERATION_COMMANDS">DATA
  GENERATION COMMANDS</a></h1>
<section class="Ss">
<h2 class="Ss" id="generate"><a class="permalink" href="#generate">generate-random-data</a></h2>
<p class="Pp"><b>generate-random-data</b> <b>-c</b> <i>length</i>
  [<b>-t</b>]</p>
<p class="Pp">Generates <i>length</i> of cryptographically-secure random data
    and prints it to <i>STDOUT</i>.</p>
<dl class="Bl-tag">
  <dt id="c"><a class="permalink" href="#c"><b>-c</b></a></dt>
  <dd>The amount of random data to generate. The meaning of this property is
      dependent on what type of data is being generated; if you do not specify a
      type (via <b>-t</b>), then the default is number of raw bytes.</dd>
  <dt id="t"><a class="permalink" href="#t"><b>-t</b>
    (raw|base64|ascii)</a></dt>
  <dd>Optionally, the type of random data to produce. &quot;raw&quot; will
      produce <i>length</i> bytes of random data, and output it directly.
      &quot;base64&quot; will also produce <i>length</i> bytes of random data,
      but will output the base 64-encoded version of that data (so the actual
      output will be longer than <i>length</i> bytes). &quot;ascii&quot; will
      generate a string composed of <i>length</i> printable characters.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="generate~2"><a class="permalink" href="#generate~2">generate-shared-secret</a></h2>
<p class="Pp"><b>generate-shared-secret</b> <b>-c</b> <i>length</i> <b>-o</b>
    <i>filename</i> [<b>-t</b>]</p>
<p class="Pp">Generates a shared secret file filled with <i>length</i> of random
    data at <i>filename</i>, and locks down its permissions so that only the
    file&#x00B4;s owner (read: the user invoking <b>xcssecurity</b>) is allowed
    to read it.</p>
<dl class="Bl-tag">
  <dt id="c~2"><a class="permalink" href="#c~2"><b>-c</b></a></dt>
  <dd>The amount of random data to generate. The meaning of this property is
      dependent on what type of data is being generated; if you do not specify a
      type (via <b>-t</b>), then the default is number of raw bytes.</dd>
  <dt id="t~2"><a class="permalink" href="#t~2"><b>-t</b>
    (raw|base64|ascii)</a></dt>
  <dd>Optionally, the type of random data to produce. &quot;raw&quot; will
      produce <i>length</i> bytes of random data, and output it directly.
      &quot;base64&quot; will also produce <i>length</i> bytes of random data,
      but will output the base 64-encoded version of that data (so the actual
      output will be longer than <i>length</i> bytes). &quot;ascii&quot; will
      generate a string composed of <i>length</i> printable characters.</dd>
  <dt id="o"><a class="permalink" href="#o"><b>-o</b></a></dt>
  <dd>The filename of the new shared secret file.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="MESSAGE_SIGNING_AND_VERIFYING_COMMANDS"><a class="permalink" href="#MESSAGE_SIGNING_AND_VERIFYING_COMMANDS">MESSAGE
  SIGNING AND VERIFYING COMMANDS</a></h1>
<section class="Ss">
<h2 class="Ss" id="message"><a class="permalink" href="#message">message-sign</a></h2>
<p class="Pp"><b>message-sign</b> <b>-i</b> <i>filename</i> [<b>-cn</b>
    <i>common_name</i>] [<b>-e</b> <i>email</i>] [<b>-km</b>]</p>
<p class="Pp">Produces a DER-encoded CSM Signed Data message from the input data
    in <i>filename</i>, and outputs the result to <i>STDOUT</i>. The signing
    identity used when signing the message will be located using the strategy
    described in <b>identify-find</b>, and will behave as though the
    <b>--first</b> and <b>--require</b> options are set. Note that you may pass
    &quot;-&quot; to <b>-i</b> to have the input data read from
  <i>STDIN</i>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="message~2"><a class="permalink" href="#message~2">message-verify</a></h2>
<p class="Pp"><b>message-verify</b> <b>-i</b> <i>filename</i>
  [<b>--strict</b>]</p>
<p class="Pp">Verifies the signature attached to the data in <i>filename</i>,
    which is expected to be a DER-encoded CSM Signed Data message. If the
    signature is valid, <b>xcssecurity</b> will exit with a 0 status, but may
    emit warnings to <i>STDERR</i> if certificate validation fails. If the
    signature is invalid, <b>xcssecurity</b> will exit with non-zero status, and
    emit errors to <i>STDERR</i>. Note that you may pass &quot;-&quot; to
    <b>-i</b> to have the input data read from <i>STDIN</i>.</p>
<p class="Pp">You may optionally pass the <b>--strict</b> flag to have
    <b>xcssecurity</b> treat certificate validation failure as a hard error
    rather than just a warning.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="message~3"><a class="permalink" href="#message~3">message-unwrap</a></h2>
<p class="Pp"><b>message-unwrap</b> <b>-i</b> <i>filename</i> [<b>--verify</b>
    [<b>--strict</b>]]</p>
<p class="Pp">Reads the message content of the signed message in <i>filename</i>
    and outputs it to <i>STDOUT</i>. <i>filename</i> is expected to be a
    DER-encoded CSM Signed Data message. Note that you may pass &quot;-&quot; to
    <b>-i</b> to have the input data read from <i>STDIN</i>.</p>
<p class="Pp">By default, this command does not perform any signature
    verification or certificate validation on the message data. You may
    optionally pass <b>--verify</b> to engage the same behavior as described in
    <b>message-verify</b> (failure on invalid signature, success but warnings to
    <i>STDERR</i> on invalid certificate chain), and additionally pass
    <b>--strict</b> to cause failure on an invalid signature <i>or</i>
    certificate chain.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="KEYCHAIN_COMMANDS"><a class="permalink" href="#KEYCHAIN_COMMANDS">KEYCHAIN
  COMMANDS</a></h1>
<section class="Ss">
<h2 class="Ss" id="keychain"><a class="permalink" href="#keychain">keychain-add</a></h2>
<p class="Pp"><b>keychain-add</b> <b>-u</b> <i>username</i> <b>-p</b>
    <i>password</i> <b>-s</b> <i>service</i> [<b>-kmT</b>]</p>
<p class="Pp">Adds a generic password item to the Keychain. You must provide a
    username, password, and service name, and you may optionally provide a list
    of trusted applications, and the path to a specific Keychain (and its master
    password). If no Keychain file is specified, the currently active Keychain
    will be used.</p>
<dl class="Bl-tag">
  <dt id="s"><a class="permalink" href="#s"><b>-s</b>,
    <i>XCS_SERVICE_NAME</i></a></dt>
  <dd>The name of the service as it should appear in the Keychain.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~2"><a class="permalink" href="#keychain~2">keychain-remove</a></h2>
<p class="Pp"><b>keychain-remove</b> <b>-u</b> <i>username</i> <b>-s</b>
    <i>service</i> [<b>-km</b>]</p>
<p class="Pp">Finds a generic password item in the Keychain, and removes it. You
    must specify at least the username and service name of the Keychain item,
    and you may optionally provide the path to a specific Keychain (and its
    master password). If no Keychain file is specified, the currently active
    Keychain will be used.</p>
<dl class="Bl-tag">
  <dt id="s~2"><a class="permalink" href="#s~2"><b>-s</b>,
    <i>XCS_SERVICE_NAME</i></a></dt>
  <dd>The name of the service as it appears in the Keychain.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~3"><a class="permalink" href="#keychain~3">keychain-find</a></h2>
<p class="Pp"><b>keychain-find</b> <b>-u</b> <i>username</i> <b>-s</b>
    <i>service</i> [<b>-km</b>]</p>
<p class="Pp">Finds a generic password item in the Keychain, and outputs its
    password data to <i>STDOUT</i>. You must specify at least the username and
    service name of the Keychain item, and you may optionally provide the path
    to a specific Keychain (and its master password). If no Keychain file is
    specified, the currently active Keychain will be used.</p>
<dl class="Bl-tag">
  <dt id="s~3"><a class="permalink" href="#s~3"><b>-s</b>,
    <i>XCS_SERVICE_NAME</i></a></dt>
  <dd>The name of the service as it appears in the Keychain.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~4"><a class="permalink" href="#keychain~4">keychain-create</a></h2>
<p class="Pp"><b>keychain-create</b> <b>-k</b> <i>keychain_path</i> <b>-m|-p</b>
    <i>master_password</i> [<b>-T</b>]</p>
<p class="Pp">Creates a new Keychain file at the specified location, locked by
    the specified master password. You may optionally specify a list of trusted
    applications that can have access to the Keychain file.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~5"><a class="permalink" href="#keychain~5">keychain-delete</a></h2>
<p class="Pp"><b>keychain-delete</b> <b>-k</b> <i>keychain_path</i> <b>-m|-p</b>
    <i>master_password</i></p>
<p class="Pp">Deletes the Keychain file at the specified location, locked by the
    specified master password. This both removes the Keychain from the active
    search path, and deletes the file from disk.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~6"><a class="permalink" href="#keychain~6">keychain-status</a></h2>
<p class="Pp"><b>keychain-status</b> [<b>-k</b>]</p>
<p class="Pp">Checks whether the specified Keychain (or if none is specified,
    the login Keychain) is currently locked, and prints the result.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~7"><a class="permalink" href="#keychain~7">keychain-autolock</a></h2>
<p class="Pp"><b>keychain-autolock</b> [<b>--set</b> [<b>--interval</b>
    <i>seconds</i> <b>--sleep</b>]] [<b>-km</b>]</p>
<p class="Pp">Gets or sets the Keychain&#x00B4;s automatic locking settings. If
    <b>--set</b> is not specified, this command prints out a JSON representation
    of the auto-locking settings for the specified keychain. If <b>--set</b>
    <i>is</i> passed, new auto-locking settings will be configured.</p>
<dl class="Bl-tag">
  <dt id="set"><a class="permalink" href="#set"><b>--set</b></a></dt>
  <dd>If passed, looks for the <b>--interval</b> and <b>--sleep</b> flags, and
      writes the new automatic locking settings to the Keychain. Otherwise,
      those arguments are ignored, and the current automatic locking settings
      for the Keychain are displayed.</dd>
  <dt id="interval"><a class="permalink" href="#interval"><b>--interval</b></a></dt>
  <dd>The duration, in seconds, after which the Keychain should automatically
      lock. Simply omit this flag to indicate that the Keychain should not lock
      automatically after a time interval.</dd>
  <dt id="sleep"><a class="permalink" href="#sleep"><b>--sleep</b></a></dt>
  <dd>Indicates that the Keychain should lock automatically when the system goes
      to sleep. Omit this flag to disable this behavior.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~8"><a class="permalink" href="#keychain~8">keychain-search-list-add</a></h2>
<p class="Pp"><b>keychain-search-list-add</b> <b>-k</b> <i>keychain_path</i>
    <b>-m|-p</b> <i>master_password</i> [<b>--front</b>]</p>
<p class="Pp">Adds the specified Keychain to the global Keychain search list for
    the current security context, usually the current user.</p>
<dl class="Bl-tag">
  <dt id="front"><a class="permalink" href="#front"><b>--front</b></a></dt>
  <dd>If passed, adds the Keychain to the front of the global search list rather
      than the end.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~9"><a class="permalink" href="#keychain~9">keychain-search-list-remove</a></h2>
<p class="Pp"><b>keychain-search-list-remove</b> <b>-k</b>
  <i>keychain_path</i></p>
<p class="Pp">Removes the specified Keychain from the global Keychain search
    list for the current security context.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="keychain~10"><a class="permalink" href="#keychain~10">keychain-update-applications-access</a></h2>
<p class="Pp"><b>keychain-update-applications-access</b> <b>-k</b>
    <i>keychain_path</i> <b>-m</b> <i>master_password</i> [<b>-T</b>]</p>
<p class="Pp">Updates the list of trusted applications on the items already in
    the keychain.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CERTIFICATE_COMMANDS"><a class="permalink" href="#CERTIFICATE_COMMANDS">CERTIFICATE
  COMMANDS</a></h1>
<section class="Ss">
<h2 class="Ss" id="certificate"><a class="permalink" href="#certificate">certificate-create</a></h2>
<p class="Pp"><b>certificate-create</b> <b>-cn</b> <i>common_name</i> <b>-e</b>
    <i>email</i> <b>-t</b> <i>type</i> [<b>-km</b> <b>--randomizeSN</b>]</p>
<p class="Pp">Creates a new self-signed certificate with the given parameters,
    and outputs it to <i>STDOUT</i>. The certificate will also be stored in the
    Keychain specified by the <b>-k</b> flag, or else the currently active
    Keychain if one is not provided. This will also be the Keychain used to
    store the certificate&#x00B4;s corresponding public/private keypair.</p>
<dl class="Bl-tag">
  <dt id="cn"><a class="permalink" href="#cn"><b>-cn</b>,
    <i>XCS_COMMON_NAME</i></a></dt>
  <dd>The Common Name to be used on the generated certificate.</dd>
  <dt id="e"><a class="permalink" href="#e"><b>-e</b>, <i>XCS_EMAIL</i></a></dt>
  <dd>The email address to be used on the generated certificate.</dd>
  <dt id="t~3"><a class="permalink" href="#t~3"><b>-t</b>
    (smime|client-ssl|server-ssl|client-vpn|server-vpn|codesign),
    <i>XCS_CERTIFICATE_TYPE</i></a></dt>
  <dd>The type of certificate to produce, from the list shown above.</dd>
  <dt id="randomizeSN"><a class="permalink" href="#randomizeSN"><b>--randomizeSN</b></a></dt>
  <dd>If passed, a cryptographically-secure random serial number will be chosen
      for the certificate, and any value passed as <i>XCS_SERIAL_NUMBER</i> will
      be ignored.</dd>
</dl>
<p class="Pp">The <b>certificate-create</b> command also checks a number of
    environmental variables when building the request, which you may optionally
    provide to fill in additional details.</p>
<dl class="Bl-tag">
  <dt id="XCS_ORGANIZATION"><a class="permalink" href="#XCS_ORGANIZATION"><i>XCS_ORGANIZATION</i></a></dt>
  <dd>The &quot;Organization&quot; (O) field of the certificate.</dd>
  <dt id="XCS_ORGANIZATIONAL_UNIT"><a class="permalink" href="#XCS_ORGANIZATIONAL_UNIT"><i>XCS_ORGANIZATIONAL_UNIT</i></a></dt>
  <dd>The &quot;Organizational Unit&quot; (OU) field of the certificate.</dd>
  <dt id="XCS_LOCALITY"><a class="permalink" href="#XCS_LOCALITY"><i>XCS_LOCALITY</i></a></dt>
  <dd>The &quot;Locality&quot; field of the certificate, which should represent
      the city, town, principality, etc.</dd>
  <dt id="XCS_STATE"><a class="permalink" href="#XCS_STATE"><i>XCS_STATE</i></a></dt>
  <dd>The &quot;State/Province&quot; field of the certificate.</dd>
  <dt id="XCS_COUNTRY"><a class="permalink" href="#XCS_COUNTRY"><i>XCS_COUNTRY</i></a></dt>
  <dd>The &quot;Country&quot; field of the certificate.</dd>
  <dt id="XCS_VALIDITY_PERIOD"><a class="permalink" href="#XCS_VALIDITY_PERIOD"><i>XCS_VALIDITY_PERIOD</i></a></dt>
  <dd>The duration over which the certificate will be valid, represented in
      days.</dd>
  <dt id="XCS_SERIAL_NUMBER"><a class="permalink" href="#XCS_SERIAL_NUMBER"><i>XCS_SERIAL_NUMBER</i></a></dt>
  <dd>The serial number of the certificate. See also the <b>--randomizeSN</b>
      flag.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="certificate~2"><a class="permalink" href="#certificate~2">certificate-find</a></h2>
<p class="Pp"><b>certificate-find</b> [<b>-cn</b> <i>common_name</i>] [<b>-e</b>
    <i>email</i>] [<b>-km</b> <b>--first</b> <b>--require</b>]</p>
<p class="Pp">Locates a certificate (or certificates) matching the provided
    common name and/or email address, and outputs PEM-encoded data to
    <i>STDOUT</i>. If multiple certificates are found, all of them will be
    written out in sequence. You may optionally specify a Keychain to search
    with the <b>-k</b> flag; if one is not provided, the currently active
    keychain search list will be searched.</p>
<p class="Pp">If no search criteria are provided (i.e., neither a common name
    nor an email address is specified), all certificates in the specified
    keychain will be returned.</p>
<p class="Pp">By default, all certificates found will be written out, and if
    <i>no</i> matching certificates are found, nothing will be written out, but
    <b>xcssecurity</b> will exit with a successful status (0). You can control
    these behaviors with the <b>--first</b> and <b>--require</b> flags.</p>
<dl class="Bl-tag">
  <dt id="cn~2"><a class="permalink" href="#cn~2"><b>-cn</b>,
    <i>XCS_COMMON_NAME</i></a></dt>
  <dd>The Common Name to search for.</dd>
  <dt id="e~2"><a class="permalink" href="#e~2"><b>-e</b>,
    <i>XCS_EMAIL</i></a></dt>
  <dd>The email address to search for. If an email address is specified, the
      certificates returned will either a) have an email address set that
      matches the provided address; or b) will not have an email address
    set.</dd>
  <dt id="first"><a class="permalink" href="#first"><b>--first</b></a></dt>
  <dd>If specified, only the first matching certificate will be written to
      <i>STDOUT</i>, rather than all matching certificates.</dd>
  <dt id="require"><a class="permalink" href="#require"><b>--require</b></a></dt>
  <dd>By default, <b>xcssecurity</b> will exit with a status code of 0 even if
      no certificates are located. Passing this flag will indicate that
      <b>xcssecurity</b> should consider an empty result set a failure, which
      means it will emit an error message to <i>STDERR</i>, and exit with a
      status code of 3.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="certificate~3"><a class="permalink" href="#certificate~3">certificate-request</a></h2>
<p class="Pp"><b>certificate-request</b> <b>-cn</b> <i>common_name</i> <b>-e</b>
    <i>email</i> [<b>-km</b>]</p>
<p class="Pp">Creates a new Certificate Signing Request (CSR) with the given
    parameters, and outputs it to <i>STDOUT</i>. You can then use this CSR in
    Keychain Access to create a signed certificate from a CA, or you can use
    <b>xcssecurity authority-fulfill-request ...</b> to do so programmatically.
    You may optionally specify a path to a Keychain (and its master password) to
    choose where the CSR&#x00B4;s corresponding keypair is stored.</p>
<dl class="Bl-tag">
  <dt id="cn~3"><a class="permalink" href="#cn~3"><b>-cn</b>,
    <i>XCS_COMMON_NAME</i></a></dt>
  <dd>The Common Name to be used on the generated certificate.</dd>
  <dt id="e~3"><a class="permalink" href="#e~3"><b>-e</b>,
    <i>XCS_EMAIL</i></a></dt>
  <dd>The email address to be used on the generated certificate.</dd>
</dl>
<p class="Pp">The <b>certificate-request</b> command also checks a number of
    environmental variables when building the request. These variables are the
    same checked by <b>certificate-create</b>, described above. Note well,
    however, that <i>XCS_VALIDITY_PERIOD</i> and <i>XCS_SERIAL_NUMBER</i> are
    ignored for certificate signing requests.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="certificate~4"><a class="permalink" href="#certificate~4">certificate-import</a></h2>
<p class="Pp"><b>certificate-import</b> <b>-c</b> <i>filename</i> [<b>-km</b>
    <b>--identity</b>]</p>
<p class="Pp">Imports the certificate at <i>filename</i> into the Keychain
    specified by the <b>-k</b> flag (or else into the currently active
    Keychain). Optionally, this command can also pair the certificate with a
    corresponding keypair (if one exists) to create a Signing Identity.</p>
<dl class="Bl-tag">
  <dt id="c~3"><a class="permalink" href="#c~3"><b>-c</b>,
    <i>XCS_CERTIFICATE_PATH</i></a></dt>
  <dd>The path to the certificate file. This should be a DER-encoded
      certificate, optionally with PEM armor, and usually exists in a file
      ending in .crt, .der, or .pem.</dd>
  <dt id="identity"><a class="permalink" href="#identity"><b>--identity</b></a></dt>
  <dd>If passed, <b>xcssecurity</b> will search the specified Keychain for a
      keypair that matches the certificate, and will import the certificate as
      part of a Signing Identity. Note that this does not change the mechanics
      of the actual import, but will raise an error if the corresponding keypair
      can&#x00B4;t be found (which is a useful check to have).</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="IDENTITY_COMMANDS"><a class="permalink" href="#IDENTITY_COMMANDS">IDENTITY
  COMMANDS</a></h1>
<section class="Ss">
<h2 class="Ss" id="identity~2"><a class="permalink" href="#identity~2">identity-find</a></h2>
<p class="Pp"><b>identity-find</b> [<b>-cn</b> <i>common_name</i>] [<b>-e</b>
    <i>email</i>] <b>-p</b> <i>passphrase</i> [<b>-km</b> <b>--first</b>
    <b>--require</b>]</p>
<p class="Pp">Locates a signing identity (or identities) matching the provided
    common name and/or email address, and outputs PKCS12-encoded data to
    <i>STDOUT</i>. If multiple identities are found, each of them will first be
    PEM-encoded, and then all of them will be written out in sequence. You may
    optionally specify a Keychain to search with the <b>-k</b> flag; if one is
    not provided, the currently active keychain search list will be
  searched.</p>
<p class="Pp">If no search criteria are provided (i.e., neither a common name
    nor an email address is specified), all identities in the specified keychain
    will be returned.</p>
<p class="Pp">By default, all identities found will be written out, and if
    <i>no</i> matching identities are found, nothing will be written out, but
    <b>xcssecurity</b> will exit with a successful status (0). You can control
    these behaviors with the <b>--first</b> and <b>--require</b> flags.</p>
<p class="Pp">Note that a passphrase is required when exporting identities, as
    private keys are included, and are considered sensitive information.</p>
<dl class="Bl-tag">
  <dt id="cn~4"><a class="permalink" href="#cn~4"><b>-cn</b>,
    <i>XCS_COMMON_NAME</i></a></dt>
  <dd>The Common Name to search for.</dd>
  <dt id="e~4"><a class="permalink" href="#e~4"><b>-e</b>,
    <i>XCS_EMAIL</i></a></dt>
  <dd>The email address to search for. If an email address is specified, the
      certificates of the identities returned will either a) have an email
      address set that matches the provided address; or b) will not have an
      email address set.</dd>
  <dt id="first~2"><a class="permalink" href="#first~2"><b>--first</b></a></dt>
  <dd>If specified, only the first matching identity will be written to
      <i>STDOUT</i>, rather than all matching identities.</dd>
  <dt id="require~2"><a class="permalink" href="#require~2"><b>--require</b></a></dt>
  <dd>By default, <b>xcssecurity</b> will exit with a status code of 0 even if
      no identities are located. Passing this flag will indicate that
      <b>xcssecurity</b> should consider an empty result set a failure, which
      means it will emit an error message to <i>STDERR</i>, and exit with a
      status code of 3.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="identity~3"><a class="permalink" href="#identity~3">identity-export</a></h2>
<p class="Pp"><b>identity-export</b> [<b>-cn</b> <i>common_name</i>] [<b>-e</b>
    <i>email</i>] <b>-co</b> <i>certificate_filename</i> <b>-ko</b>
    <i>key_filename</i> [<b>-km</b>]</p>
<p class="Pp">Locates a signing identity (or identities) matching the provided
    common name and/or email address, and exports the certificate and associated
    private key to <i>certificate_filename</i> and <i>key_filename</i>,
    respectively. If multiple identities are found, only the first will be
    exported. You may optionally specify a Keychain to search with the <b>-k</b>
    flag; if one is not provided, the currently active keychain search list will
    be searched.</p>
<p class="Pp">This behaves similarly to <b>identity-find</b> with both
    <b>--first</b> and <b>--require</b> set, except that the data will be
    exported into separate files rather than into a single PKCS12 stream. This
    command is useful for provisioning server-side SSL certificates.</p>
<dl class="Bl-tag">
  <dt id="cn~5"><a class="permalink" href="#cn~5"><b>-cn</b>,
    <i>XCS_COMMON_NAME</i></a></dt>
  <dd>The Common Name to search for.</dd>
  <dt id="e~5"><a class="permalink" href="#e~5"><b>-e</b>,
    <i>XCS_EMAIL</i></a></dt>
  <dd>The email address to search for. If an email address is specified, the
      certificates of the identities returned will either a) have an email
      address set that matches the provided address; or b) will not have an
      email address set.</dd>
  <dt id="co"><a class="permalink" href="#co"><b>-co</b>,
    <i>XCS_CERTIFICATE_PATH</i></a></dt>
  <dd>The path to which the certificate file should be exported. The certificate
      will be PEM-encoded, and typically this path should end with .crt.</dd>
  <dt id="ko"><a class="permalink" href="#ko"><b>-ko</b>,
    <i>XCS_KEY_PATH</i></a></dt>
  <dd>The path to which the private key should be exported. The key will be
      PEM-encoded, and typically this path should end with .key.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CERTIFICATE_AUTHORITY_COMMANDS"><a class="permalink" href="#CERTIFICATE_AUTHORITY_COMMANDS">CERTIFICATE
  AUTHORITY COMMANDS</a></h1>
<section class="Ss">
<h2 class="Ss" id="authority"><a class="permalink" href="#authority">authority-create</a></h2>
<p class="Pp"><b>authority-create</b> <b>-cn</b> <i>common_name</i> <b>-e</b>
    <i>email</i> <b>-t</b> <i>type</i> [<b>-okm</b> <b>--trust</b>]</p>
<p class="Pp">Creates a new Certificate Authority with the given parameters.
    Specifically, you must provide a Common Name and email address for the
    certificate authority, and also a type parameter indicating which flavor of
    certificates this authority will be responsible for generating. The
    authority will be (optionally) stored at the filename passed to <b>-o</b>,
    and its identity (certificate and keypair) will be stored in the specified
    Keychain, or else the currently active Keychain if one is not provided. If
    you use a custom Keychain, don&#x00B4;t forget to specify its master
    password with the <b>-m</b> flag.</p>
<dl class="Bl-tag">
  <dt id="cn~6"><a class="permalink" href="#cn~6"><b>-cn</b>,
    <i>XCS_COMMON_NAME</i></a></dt>
  <dd>The name of the Certificate Authority. This name will be used both as the
      display name in Keychain Access, and as the Common Name (CN) field for the
      CA&#x00B4;s root certificate.</dd>
  <dt id="e~6"><a class="permalink" href="#e~6"><b>-e</b>,
    <i>XCS_EMAIL</i></a></dt>
  <dd>The email address of the Certificate Authority. This name will be used in
      the CA&#x00B4;s root certificate, and can also be used in signed
      certificate request invitations when inviting clients to request
      certificates.</dd>
  <dt id="t~4"><a class="permalink" href="#t~4"><b>-t</b>
    (smime|client-ssl|server-ssl|client-vpn|server-vpn|codesign),
    <i>XCS_CERTIFICATE_TYPE</i></a></dt>
  <dd>The type of certificates this Certificate Authority should be capable of
      producing, from the list shown above.</dd>
  <dt id="o~2"><a class="permalink" href="#o~2"><b>-o</b></a></dt>
  <dd>The location at which to create the new Certificate Authority. This should
      be a (nonexistent) directory which will be created, and will contain the
      certificate and public key as a PEM file. If a path is not provided, it
      will be created in the ~/Library/Application Support/Certificate Authority
      directory.</dd>
</dl>
<dl class="Bl-tag">
  <dt></dt>
  <dd><b>Note well</b>: this functionality currently presents a warning about
      not being able to create an invitation. This is erroneous, and Certificate
      Authority creation succeeds as expected.</dd>
</dl>
<dl class="Bl-tag">
  <dt id="trust"><a class="permalink" href="#trust"><b>--trust</b></a></dt>
  <dd>If passed, the system will be configured to automatically trust any
      certificates signed by your new Certificate Authority. You <i>must</i> run
      <b>xcssecurity</b> as root for this to take effect without user
      interaction; otherwise, a dialog asking for confirmation will be
      displayed.</dd>
</dl>
<p class="Pp">The <b>authority-create</b> command also checks a number of
    environmental variables when building the authority&#x00B4;s certificate.
    These variables are the same checked by <b>certificate-create</b>, described
    above. Of particular note is that all CAs must have a country, so if the
    <i>XCS_COUNTRY</i> variable is not specified, it will automatically be
    determined from the user&#x00B4;s current locale.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="authority~2"><a class="permalink" href="#authority~2">authority-fulfill-request</a></h2>
<p class="Pp"><b>authority-fulfill-request</b> <b>-cn|-p</b> <i>name_or_path</i>
    <b>-r</b> <i>request</i> [<b>-km</b> <b>-dk -dm</b> <b>--pem</b>]</p>
<p class="Pp">Takes a Certificate Signing Request (CSR) generated with either
    <b>xcssecurity</b> or Keychain Access (or similar), and for the specified
    Certificate Authority, generates a signed certificate, and exports the data
    to <i>STDOUT</i>. To locate the Certificate Authority, you must pass
    <i>either</i> <b>-cn</b> and the authority&#x00B4;s name, or <b>-p</b> and
    the path to its directory on disk, but not both. Don&#x00B4;t forget to pass
    the appropriate Keychain path/master password if your CA&#x00B4;s
    certificate and keypair are not in the currently active Keychain.</p>
<p class="Pp">Currently, the certificate will be stored in some Keychain, in
    addition to being echoed to <i>STDOUT</i>. If you do not inform
    <b>xcssecurity</b> which Keychain to use, the login Keychain will be used.
    You can use the <b>-dk</b> and <b>-dm</b> to specify the destination
    Keychain&#x00B4;s path and master password, respectively.</p>
<dl class="Bl-tag">
  <dt id="cn~7"><a class="permalink" href="#cn~7"><b>-cn</b>,
    <i>XCS_COMMON_NAME</i></a></dt>
  <dd>The name of the Certificate Authority as provided when the authority was
      created. This flag is mutually exclusive with <b>-p</b>.</dd>
  <dt id="p~2"><a class="permalink" href="#p~2"><b>-p</b>,
    <i>XCS_AUTHORITY_PATH</i></a></dt>
  <dd>The path to the directory containing the Certificate Authority&#x00B4;s
      certificate. This flag is mutually exclusive with <b>-cn</b>.</dd>
  <dt id="r"><a class="permalink" href="#r"><b>-r</b></a></dt>
  <dd>The path to the Certificate Signing Request file. You may pass
      &quot;-&quot; to read the CSR from <i>STDIN</i>.</dd>
  <dt id="dk"><a class="permalink" href="#dk"><b>-dk</b>,
    <i>XCS_DESTINATION_KEYCHAIN</i></a></dt>
  <dd>The path to the Keychain into which the signed certificate will be
      inserted.</dd>
  <dt id="dm"><a class="permalink" href="#dm"><b>-dm</b>,
    <i>XCS_DESTINATION_KEYCHAIN_PASSWORD</i></a></dt>
  <dd>The master password for the Keychain passed via <b>-dk</b>, if
    required.</dd>
  <dt id="pem"><a class="permalink" href="#pem"><b>--pem</b></a></dt>
  <dd>If passed, the resulting certificate will be output PEM-encoded.</dd>
</dl>
<p class="Pp">The <b>authority-fulfill-request</b> command also checks the
    <i>XCS_VALIDITY_PERIOD</i> and <i>XCS_SERIAL_NUMBER</i> environmental
    variables when issuing the requested certificate. These variables are the
    same checked by <b>certificate-create</b>, described above.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="OPEN_DIRECTORY_COMMANDS"><a class="permalink" href="#OPEN_DIRECTORY_COMMANDS">OPEN
  DIRECTORY COMMANDS</a></h1>
<section class="Ss">
<h2 class="Ss" id="user"><a class="permalink" href="#user">user-create</a></h2>
<p class="Pp"><b>user-create</b> <b>-u</b> <i>username</i> <b>-p</b>
    <i>password</i> <b>-n</b> <i>OD_node_name</i></p>
<p class="Pp">Creates a new user in the specified Open Directory node.</p>
<p class="Pp">The <b>user-create</b> command also respects a number of
    environmental variables that you may wish to set.</p>
<dl class="Bl-tag">
  <dt id="XCS_LAST_NAME"><a class="permalink" href="#XCS_LAST_NAME"><i>XCS_LAST_NAME</i></a></dt>
  <dd>The user&#x00B4;s last name.</dd>
  <dt id="XCS_REAL_NAME"><a class="permalink" href="#XCS_REAL_NAME"><i>XCS_REAL_NAME</i></a></dt>
  <dd>The user&#x00B4;s real name.</dd>
  <dt id="XCS_OD_UNIQUE_ID"><a class="permalink" href="#XCS_OD_UNIQUE_ID"><i>XCS_OD_UNIQUE_ID</i></a></dt>
  <dd>A unique identifier for the Open Directory user. This is used as the
      user&#x00B4;s UID when the user logs in to the system.</dd>
  <dt id="XCS_OD_GROUP_ID"><a class="permalink" href="#XCS_OD_GROUP_ID"><i>XCS_OD_GROUP_ID</i></a></dt>
  <dd>The group identifier (GID) of the primary group for the Open Directory
      user.</dd>
  <dt id="XCS_NFS_HOME_DIRECTORY"><a class="permalink" href="#XCS_NFS_HOME_DIRECTORY"><i>XCS_NFS_HOME_DIRECTORY</i></a></dt>
  <dd>The NFS (or local) home directory of the user.</dd>
  <dt id="XCS_SHELL"><a class="permalink" href="#XCS_SHELL"><i>XCS_SHELL</i></a></dt>
  <dd>The login shell to be used for the user. Pass &quot;/dev/null&quot; to
      prevent login to an interactive console.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="user~2"><a class="permalink" href="#user~2">user-delete</a></h2>
<p class="Pp"><b>user-delete</b> <b>-u</b> <i>username</i> <b>-n</b>
    <i>OD_node_name</i></p>
<p class="Pp">Deletes a user from the specified Open Directory node.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="user~3"><a class="permalink" href="#user~3">user-authenticate</a></h2>
<p class="Pp"><b>user-authenticate</b> <b>-u</b> <i>username</i> <b>-p</b>
    <i>password</i></p>
<p class="Pp">Attempts to authenticate a user with the provided username and
    password. On success, <b>xcssecurity</b> will print nothing and quit. On
    failure, <b>xcssecurity</b> will echo the relevant error to <i>STDERR</i>,
    and exit with a nonzero status.</p>
<p class="Pp">Remember that both the username and password can also be passed as
    environmental variables.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="user~4"><a class="permalink" href="#user~4">user-is-admin</a></h2>
<p class="Pp"><b>user-is-admin</b> <b>-u</b> <i>username</i></p>
<p class="Pp">Checks to see whether <i>username</i> is a member of the
    &quot;admin&quot; (Administrators) group. On success, <b>xcssecurity</b>
    will print nothing and quit. On failure, <b>xcssecurity</b> will echo the
    relevant error to <i>STDERR</i>, and exit with a nonzero status.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="group"><a class="permalink" href="#group">group-create</a></h2>
<p class="Pp"><b>group-create</b> <b>-g</b> <i>group_name</i> <b>-n</b>
    <i>OD_node_name</i></p>
<p class="Pp">Creates a new group in the specified Open Directory node.</p>
<dl class="Bl-tag">
  <dt id="g"><a class="permalink" href="#g"><b>-g</b>,
    <i>XCS_GROUP_NAME</i></a></dt>
  <dd>The name of the Open Directory (or local) group to be created.</dd>
</dl>
<p class="Pp">The <b>group-create</b> command also respects a few environmental
    variables that you may wish to set.</p>
<dl class="Bl-tag">
  <dt id="XCS_REAL_NAME~2"><a class="permalink" href="#XCS_REAL_NAME~2"><i>XCS_REAL_NAME</i></a></dt>
  <dd>The real, descriptive name of the group.</dd>
  <dt id="XCS_OD_GROUP_ID~2"><a class="permalink" href="#XCS_OD_GROUP_ID~2"><i>XCS_OD_GROUP_ID</i></a></dt>
  <dd>The group identifier (GID) of the Open Directory group.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="group~2"><a class="permalink" href="#group~2">group-delete</a></h2>
<p class="Pp"><b>group-delete</b> <b>-g</b> <i>group_name</i> <b>-n</b>
    <i>OD_node_name</i></p>
<p class="Pp">Deletes a group from the specified Open Directory node.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="group~3"><a class="permalink" href="#group~3">group-expand</a></h2>
<p class="Pp"><b>group-expand</b> <b>-g</b> <i>group_name</i> [<b>-g</b>
    <i>g2</i> [<b>-g</b> <i>g3</i>...]] [<b>--deduplicate</b>
    <b>--preserve-nonexistent</b> <b>--warn-unavailable</b>]</p>
<p class="Pp">Produces the user list for each provided group, and returns the
    results as JSON to <i>STDOUT</i>. You may pass any number of groups via
    separate <b>-g</b> flags, each of which can be represented as a record name
    or a UUID; the results will be aggregated into a single list. By default, if
    a user appears in multiple groups, their username will appear in the list
    multiple times; you can change this behavior by passing the
    <b>--deduplicate</b> flag.</p>
<p class="Pp">By default, if a username is passed instead of a group name, it
    will be passed through into the final list. In this way, you can easily
    expand access control lists by providing a mix of users and groups, and
    receiving back a flattened list of users only.</p>
<p class="Pp">If any of the groups (or users) you pass via <b>-g</b> arguments
    do not exist, by default, they will silently be omitted from the output. You
    may pass the <b>--preserve-nonexistent</b> flag to ask that they be passed
    through into the result unmodified.</p>
<p class="Pp">Because of the nature of network services, it is possible that
    some of the Open Directory nodes in your search path may be unavailable
    during group expansion. In this case, by default, the groups that reside on
    those Open Directory nodes will be silently omitted from the output (or, if
    using <b>--preserve-nonexistent</b>, will appear in the output unexpanded).
    If you&#x00B4;d like a &quot;heads up&quot; that this may be happening, you
    can pass the <b>--warn-unavailable</b> flag, which will first check each of
    your configured Open Directory nodes for their availability. If any of the
    nodes are discovered to be unreachable, warnings will be generated and
    output to <i>STDERR</i>. They will always be prefixed with
    &quot;xcssecurity: warning: &quot;, so they should be easy enough to
  parse.</p>
<p class="Pp">Note that there is also a special mode for this command: if you
    pass &quot;-&quot; (hyphen) as a group name, <b>xcssecurity</b> will instead
    read a JSON object from <i>STDIN</i>, and expand the group names contained
    there. The JSON object can either be an array (in which case it works as
    though each entry were passed as a <b>-g</b> flag), or an object with keys
    that map to arrays, in which case an object with the same structure will be
    output when the command completes (i.e., each array in the object will be
    expanded independently).</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="EXIT_CODES"><a class="permalink" href="#EXIT_CODES">EXIT
  CODES</a></h1>
<p class="Pp">On success, <b>xcssecurity</b> will exit with a status code of 0.
    On failure, it will exit with a status code greater than 0, and report
    information about the failure to <i>STDERR</i>.</p>
<p class="Pp">A status code of 1 means that <b>xcssecurity</b> was invoked
    incorrectly, possibly with an unrecognized command.</p>
<p class="Pp">A status code of 2 means that a required parameter was
  missing.</p>
<p class="Pp">A status code of 3 means that the underlying operation failed.
    More information on why this happened will be output to <i>STDERR</i>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp"><b>xcssecurity</b> is Copyright (C) 2013-14 Apple, Inc. All rights
    reserved.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">security(1)</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">November 2017</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
